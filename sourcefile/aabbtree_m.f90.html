<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for BROWNPAK">
   
    <meta name="author" content="Sarit Dutta" >
    <link rel="icon" href="../favicon.png">

    <title>aabbtree_m.f90 &ndash; BROWNPAK</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">BROWNPAK <small>0.7</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
    <li><a href="../blockdata/nitbd.html">Block Data</a></li>
    
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../blockdata/nitbd.html">Block Data</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>aabbtree_m.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 2.3% of total for source files.">196 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/aabbtree_m.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">aabbtree_m.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/aabbtree_m.html">aabbtree_m</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/aabbtree_m.f90.html#src">aabbtree_m.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~aabbtree_m.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileaabbtree_mf90EfferentGraph" width="441pt" height="144pt"
 viewBox="0.00 0.00 441.00 143.99" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~aabbtree_m.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 139.9891)">
<title>sourcefile~~aabbtree_m.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-139.9891 437,-139.9891 437,4 -4,4"/>
<!-- sourcefile~aabbtree_m.f90 -->
<g id="sourcefile~~aabbtree_m.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~aabbtree_m.f90</title>
<polygon fill="none" stroke="#000000" points="433,-84 347,-84 347,-60 433,-60 433,-84"/>
<text text-anchor="middle" x="390" y="-69.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">aabbtree_m.f90</text>
</g>
<!-- sourcefile~constants_m.f90 -->
<g id="sourcefile~~aabbtree_m.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~constants_m.f90</title>
<g id="a_sourcefile~~aabbtree_m.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/constants_m.f90.html" xlink:title="constants_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="90,-84 0,-84 0,-60 90,-60 90,-84"/>
<text text-anchor="middle" x="45" y="-69.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">constants_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~aabbtree_m.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M371.3348,-84.0835C355.8175,-93.5273 332.8234,-106.1623 311,-113 248.1366,-132.6963 229.1952,-141.4518 164,-132"/>
</g>
<!-- sourcefile~aabb_m.fpp -->
<g id="sourcefile~~aabbtree_m.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~aabb_m.fpp</title>
<g id="a_sourcefile~~aabbtree_m.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/aabb_m.fpp.html" xlink:title="aabb_m.fpp">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="308.5,-104 240.5,-104 240.5,-80 308.5,-80 308.5,-104"/>
<text text-anchor="middle" x="274.5" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">aabb_m.fpp</text>
</a>
</g>
</g>
<!-- sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~aabb_m.fpp -->
<g id="sourcefile~~aabbtree_m.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~aabb_m.fpp</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M346.9921,-79.4473C337.6661,-81.0621 327.7904,-82.7722 318.4295,-84.3932"/>
<polygon fill="#ff0000" stroke="#ff0000" points="317.7804,-80.9534 308.5242,-86.1084 318.9748,-87.8507 317.7804,-80.9534"/>
</g>
<!-- sourcefile~vector_m.f90 -->
<g id="sourcefile~~aabbtree_m.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~vector_m.f90</title>
<g id="a_sourcefile~~aabbtree_m.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/vector_m.f90.html" xlink:title="vector_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="311,-24 238,-24 238,0 311,0 311,-24"/>
<text text-anchor="middle" x="274.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">vector_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~vector_m.f90 -->
<g id="sourcefile~~aabbtree_m.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~vector_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M366.6269,-59.8581C349.4061,-50.9122 325.7732,-38.6354 306.7554,-28.756"/>
<polygon fill="#ff0000" stroke="#ff0000" points="308.3259,-25.6279 297.8384,-24.1238 305.099,-31.8397 308.3259,-25.6279"/>
</g>
<!-- sourcefile~strings_m.f90 -->
<g id="sourcefile~~aabbtree_m.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~strings_m.f90</title>
<g id="a_sourcefile~~aabbtree_m.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/strings_m.f90.html" xlink:title="strings_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="202,-104 126,-104 126,-80 202,-80 202,-104"/>
<text text-anchor="middle" x="164" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">strings_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~strings_m.f90 -->
<g id="sourcefile~~aabbtree_m.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~strings_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M346.8681,-68.4151C316.321,-66.6793 274.462,-65.9265 238,-71 228.3794,-72.3387 218.252,-74.6118 208.6825,-77.1804"/>
<polygon fill="#ff0000" stroke="#ff0000" points="207.623,-73.8428 198.9565,-79.9373 209.532,-80.5775 207.623,-73.8428"/>
</g>
<!-- sourcefile~aabb_m.fpp&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~aabbtree_m.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~aabb_m.fpp&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M164,-132C128.4225,-126.8421 92.1955,-105.8431 69.2131,-90.132"/>
<polygon fill="#7fff00" stroke="#7fff00" points="70.9851,-87.0992 60.7934,-84.2043 66.9554,-92.823 70.9851,-87.0992"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M257.0886,-104.1943C235.7903,-117.7043 198.325,-136.9763 164,-132"/>
</g>
<!-- sourcefile~aabb_m.fpp&#45;&gt;sourcefile~strings_m.f90 -->
<g id="sourcefile~~aabbtree_m.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~aabb_m.fpp&#45;&gt;sourcefile~strings_m.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M240.4447,-92C231.5966,-92 221.8937,-92 212.459,-92"/>
<polygon fill="#7fff00" stroke="#7fff00" points="212.3798,-88.5001 202.3798,-92 212.3798,-95.5001 212.3798,-88.5001"/>
</g>
<!-- sourcefile~vector_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~aabbtree_m.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~vector_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M237.6942,-22.9581C226.28,-26.2764 213.6422,-29.8691 202,-33 168.2515,-42.0758 130.2179,-51.5429 100.0384,-58.8767"/>
<polygon fill="#00ffff" stroke="#00ffff" points="99.0174,-55.5227 90.1223,-61.2784 100.6652,-62.326 99.0174,-55.5227"/>
</g>
<!-- sourcefile~qsort_m.f90 -->
<g id="sourcefile~~aabbtree_m.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~qsort_m.f90</title>
<g id="a_sourcefile~~aabbtree_m.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/qsort_m.f90.html" xlink:title="qsort_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="198,-24 130,-24 130,0 198,0 198,-24"/>
<text text-anchor="middle" x="164" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">qsort_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~vector_m.f90&#45;&gt;sourcefile~qsort_m.f90 -->
<g id="sourcefile~~aabbtree_m.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~vector_m.f90&#45;&gt;sourcefile~qsort_m.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M237.7051,-12C228.1995,-12 217.8704,-12 208.0362,-12"/>
<polygon fill="#00ffff" stroke="#00ffff" points="208.0223,-8.5001 198.0223,-12 208.0223,-15.5001 208.0223,-8.5001"/>
</g>
<!-- sourcefile~strings_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~aabbtree_m.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~strings_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M125.6926,-85.5618C117.586,-84.1993 108.8757,-82.7354 100.2832,-81.2913"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="100.7356,-77.8183 90.2938,-79.6124 99.5753,-84.7215 100.7356,-77.8183"/>
</g>
<!-- sourcefile~qsort_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~aabbtree_m.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~qsort_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M139.9186,-24.1419C122.1759,-33.0878 97.8269,-45.3646 78.2328,-55.244"/>
<polygon fill="#ff0000" stroke="#ff0000" points="76.3991,-52.2488 69.0456,-59.8762 79.5506,-58.4992 76.3991,-52.2488"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~aabbtree_m.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileaabbtree_mf90AfferentGraph" width="641pt" height="90pt"
 viewBox="0.00 0.00 641.00 89.66" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~aabbtree_m.f90~~AfferentGraph" class="graph" transform="scale(.9539 .9539) rotate(0) translate(4 90)">
<title>sourcefile~~aabbtree_m.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-90 668,-90 668,4 -4,4"/>
<!-- sourcefile~aabbtree_m.f90 -->
<g id="sourcefile~~aabbtree_m.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~aabbtree_m.f90</title>
<polygon fill="none" stroke="#000000" points="86,-65 0,-65 0,-41 86,-41 86,-65"/>
<text text-anchor="middle" x="43" y="-50.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">aabbtree_m.f90</text>
</g>
<!-- sourcefile~aabbtree_sm.fpp -->
<g id="sourcefile~~aabbtree_m.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~aabbtree_sm.fpp</title>
<g id="a_sourcefile~~aabbtree_m.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/aabbtree_sm.fpp.html" xlink:title="aabbtree_sm.fpp">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="213,-86 122,-86 122,-62 213,-62 213,-86"/>
<text text-anchor="middle" x="167.5" y="-71.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">aabbtree_sm.fpp</text>
</a>
</g>
</g>
<!-- sourcefile~aabbtree_sm.fpp&#45;&gt;sourcefile~aabbtree_m.f90 -->
<g id="sourcefile~~aabbtree_m.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~aabbtree_sm.fpp&#45;&gt;sourcefile~aabbtree_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M121.8477,-66.2996C113.4678,-64.8861 104.655,-63.3996 96.0796,-61.9532"/>
<polygon fill="#ff0000" stroke="#ff0000" points="96.6048,-58.4924 86.1619,-60.2803 95.4405,-65.3949 96.6048,-58.4924"/>
</g>
<!-- sourcefile~pairtab_m.fpp -->
<g id="sourcefile~~aabbtree_m.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~pairtab_m.fpp</title>
<g id="a_sourcefile~~aabbtree_m.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/pairtab_m.fpp.html" xlink:title="pairtab_m.fpp">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="206,-44 129,-44 129,-20 206,-20 206,-44"/>
<text text-anchor="middle" x="167.5" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pairtab_m.fpp</text>
</a>
</g>
</g>
<!-- sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~aabbtree_m.f90 -->
<g id="sourcefile~~aabbtree_m.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~aabbtree_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M128.7899,-38.5294C118.4061,-40.2809 106.9976,-42.2052 95.9847,-44.0628"/>
<polygon fill="#ff0000" stroke="#ff0000" points="95.3014,-40.6285 86.0229,-45.7431 96.4658,-47.531 95.3014,-40.6285"/>
</g>
<!-- sourcefile~interaction_m.f90 -->
<g id="sourcefile~~aabbtree_m.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~interaction_m.f90</title>
<g id="a_sourcefile~~aabbtree_m.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/interaction_m.f90.html" xlink:title="interaction_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="342,-44 249,-44 249,-20 342,-20 342,-44"/>
<text text-anchor="middle" x="295.5" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">interaction_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~interaction_m.f90&#45;&gt;sourcefile~pairtab_m.fpp -->
<g id="sourcefile~~aabbtree_m.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~interaction_m.f90&#45;&gt;sourcefile~pairtab_m.fpp</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M248.927,-32C238.3098,-32 227,-32 216.2929,-32"/>
<polygon fill="#00ffff" stroke="#00ffff" points="216.2543,-28.5001 206.2543,-32 216.2543,-35.5001 216.2543,-28.5001"/>
</g>
<!-- sourcefile~setup_m.f90 -->
<g id="sourcefile~~aabbtree_m.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~setup_m.f90</title>
<g id="a_sourcefile~~aabbtree_m.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/setup_m.f90.html" xlink:title="setup_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="574,-44 504,-44 504,-20 574,-20 574,-44"/>
<text text-anchor="middle" x="539" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">setup_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~setup_m.f90&#45;&gt;sourcefile~interaction_m.f90 -->
<g id="sourcefile~~aabbtree_m.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~setup_m.f90&#45;&gt;sourcefile~interaction_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M503.9715,-32.5912C492.5076,-32.7586 479.7109,-32.9175 468,-33 428.001,-33.2817 417.9993,-33.2424 378,-33 369.6609,-32.9495 360.848,-32.8702 352.2079,-32.7779"/>
<polygon fill="#ff0000" stroke="#ff0000" points="352.2225,-29.2779 342.1835,-32.6644 352.1432,-36.2775 352.2225,-29.2779"/>
</g>
<!-- sourcefile~bd_solver_m.f90 -->
<g id="sourcefile~~aabbtree_m.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~bd_solver_m.f90</title>
<g id="a_sourcefile~~aabbtree_m.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/bd_solver_m.f90.html" xlink:title="bd_solver_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="468,-24 378,-24 378,0 468,0 468,-24"/>
<text text-anchor="middle" x="423" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">bd_solver_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~setup_m.f90&#45;&gt;sourcefile~bd_solver_m.f90 -->
<g id="sourcefile~~aabbtree_m.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~setup_m.f90&#45;&gt;sourcefile~bd_solver_m.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M503.8814,-25.9451C495.8294,-24.5568 487.0767,-23.0477 478.4017,-21.552"/>
<polygon fill="#00ffff" stroke="#00ffff" points="478.7496,-18.0604 468.3003,-19.8104 477.5602,-24.9586 478.7496,-18.0604"/>
</g>
<!-- sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~interaction_m.f90 -->
<g id="sourcefile~~aabbtree_m.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~interaction_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M377.6893,-19.1076C369.5474,-20.3847 360.9666,-21.7307 352.5436,-23.052"/>
<polygon fill="#ff0000" stroke="#ff0000" points="351.7247,-19.6376 342.3879,-24.645 352.8095,-26.553 351.7247,-19.6376"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~aabbtree_m.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~aabbtree_m.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="664,-44 610,-44 610,-20 664,-20 664,-44"/>
<text text-anchor="middle" x="637" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~setup_m.f90 -->
<g id="sourcefile~~aabbtree_m.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~setup_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M609.9616,-32C601.9804,-32 593.0189,-32 584.2209,-32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="584.0365,-28.5001 574.0365,-32 584.0364,-35.5001 584.0365,-28.5001"/>
</g>
</g>
</svg>
</div><script>var pansourcefileaabbtree_mf90AfferentGraph = svgPanZoom('#sourcefileaabbtree_mf90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/aabbtree_m.html">aabbtree_m</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/aabbtree_m.f90.html#src">aabbtree_m.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">! This code is adapted from the C++ implementation by </span>
<a name="ln-2"></a><span class="c">! [Lester Hedges](http://lesterhedges.net). The original</span>
<a name="ln-3"></a><span class="c">! C++ implementation can be found [here](https://github.com/lohedges/aabbcc#readme).</span>
<a name="ln-4"></a><span class="c">!</span>
<a name="ln-5"></a> <span class="c">!****************************************************************************!</span>
<a name="ln-6"></a> <span class="c">!                                                                            !</span>
<a name="ln-7"></a> <span class="c">! The zlib/libpng License (Zlib)                                             !</span>
<a name="ln-8"></a> <span class="c">!                                                                            !</span>
<a name="ln-9"></a> <span class="c">! Copyright (c) 2009 Erin Catto http://www.box2d.org                         !</span>
<a name="ln-10"></a> <span class="c">! Copyright (c) 2016 Lester Hedges &lt;lester.hedges+aabbcc@gmail.com&gt;          !</span>
<a name="ln-11"></a> <span class="c">!                                                                            !</span>
<a name="ln-12"></a> <span class="c">! This software is provided &#39;as-is&#39;, without any express or implied          !</span>
<a name="ln-13"></a> <span class="c">! warranty. In no event will the authors be held liable for any damages      !</span>
<a name="ln-14"></a> <span class="c">! arising from the use of this software.                                     !</span>
<a name="ln-15"></a> <span class="c">!                                                                            !</span>
<a name="ln-16"></a> <span class="c">! Permission is granted to anyone to use this software for any purpose,      !</span>
<a name="ln-17"></a> <span class="c">! including commercial applications, and to alter it and redistribute it     !</span>
<a name="ln-18"></a> <span class="c">! freely, subject to the following restrictions:                             !</span>
<a name="ln-19"></a> <span class="c">!                                                                            !</span>
<a name="ln-20"></a> <span class="c">! 1. The origin of this software must not be misrepresented; you must not    !</span>
<a name="ln-21"></a> <span class="c">!    claim that you wrote the original software. If you use this software    !</span>
<a name="ln-22"></a> <span class="c">!    in a product, an acknowledgment in the product documentation would be   !</span>
<a name="ln-23"></a> <span class="c">!    appreciated but is not required.                                        !</span>
<a name="ln-24"></a> <span class="c">!                                                                            !</span>
<a name="ln-25"></a> <span class="c">! 2. Altered source versions must be plainly marked as such, and must not be !</span>
<a name="ln-26"></a> <span class="c">!    misrepresented as being the original software.                          !</span>
<a name="ln-27"></a> <span class="c">!                                                                            !</span>
<a name="ln-28"></a> <span class="c">! 3. This notice may not be removed or altered from any source distribution. !</span>
<a name="ln-29"></a> <span class="c">!                                                                            !</span>
<a name="ln-30"></a> <span class="c">! This code was adapted from parts of the Box2D Physics Engine,              !</span>
<a name="ln-31"></a> <span class="c">! http://www.box2d.org                                                       !</span>
<a name="ln-32"></a> <span class="c">!                                                                            !</span>
<a name="ln-33"></a> <span class="c">!****************************************************************************!</span>
<a name="ln-34"></a>
<a name="ln-35"></a><span class="k">module </span><span class="n">aabbtree_m</span>
<a name="ln-36"></a><span class="c">!! Implements an axis-aligned bounding box (AABB) tree.</span>
<a name="ln-37"></a><span class="c">!! This code is adapted from the C++ implementation by </span>
<a name="ln-38"></a><span class="c">!! [Lester Hedges](http://lesterhedges.net). The original</span>
<a name="ln-39"></a><span class="c">!! C++ implementation can be found [here](https://github.com/lohedges/aabbcc#readme).</span>
<a name="ln-40"></a>
<a name="ln-41"></a><span class="k">use </span><span class="n">constants_m</span>
<a name="ln-42"></a><span class="k">use </span><span class="n">strings_m</span>
<a name="ln-43"></a><span class="k">use </span><span class="n">vector_m</span>
<a name="ln-44"></a><span class="k">use </span><span class="n">aabb_m</span>
<a name="ln-45"></a>
<a name="ln-46"></a><span class="k">implicit none</span>
<a name="ln-47"></a>
<a name="ln-48"></a><span class="k">private</span>
<a name="ln-49"></a>
<a name="ln-50"></a><span class="k">public</span> <span class="kd">::</span> <span class="n">aabbtree_t</span>
<a name="ln-51"></a>
<a name="ln-52"></a><span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">NULL_NODE</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-53"></a>
<a name="ln-54"></a><span class="k">type </span><span class="n">node_t</span>
<a name="ln-55"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">next</span> <span class="o">=</span> <span class="n">NULL_NODE</span>
<a name="ln-56"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">parent</span> <span class="o">=</span> <span class="n">NULL_NODE</span>
<a name="ln-57"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">left</span> <span class="o">=</span> <span class="n">NULL_NODE</span>
<a name="ln-58"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">right</span> <span class="o">=</span> <span class="n">NULL_NODE</span>
<a name="ln-59"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">height</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-60"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">atom</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-61"></a>    <span class="k">type</span><span class="p">(</span><span class="n">aabb_t</span><span class="p">)</span> <span class="kd">::</span> <span class="n">aabb</span>
<a name="ln-62"></a>    <span class="k">contains</span>
<a name="ln-63"></a><span class="k">        procedure</span> <span class="kd">::</span> <span class="n">init</span> <span class="o">=&gt;</span> <span class="n">node_init</span>
<a name="ln-64"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">isleaf</span> <span class="o">=&gt;</span> <span class="n">node_isleaf</span>
<a name="ln-65"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">asstr</span> <span class="o">=&gt;</span> <span class="n">node_asstr</span>
<a name="ln-66"></a><span class="k">end type </span><span class="n">node_t</span>
<a name="ln-67"></a>
<a name="ln-68"></a><span class="k">type</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">)</span> <span class="kd">::</span> <span class="n">stack</span>
<a name="ln-69"></a>
<a name="ln-70"></a><span class="k">type </span><span class="n">aabbtree_t</span>
<a name="ln-71"></a>    <span class="k">type</span><span class="p">(</span><span class="n">node_t</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">nodes</span>
<a name="ln-72"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">atnd_tab</span>
<a name="ln-73"></a>        <span class="c">!! Atom -&gt; node map.</span>
<a name="ln-74"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">capacity</span>
<a name="ln-75"></a>        <span class="c">!! Maximum number of nodes that the tree can currently handle. This may</span>
<a name="ln-76"></a>        <span class="c">!! increase as more atoms are inserted.</span>
<a name="ln-77"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">freestore</span>
<a name="ln-78"></a>        <span class="c">!! Pointer to head to the free store.</span>
<a name="ln-79"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">size</span>
<a name="ln-80"></a>        <span class="c">!! Number of nodes in the tree.</span>
<a name="ln-81"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">root</span>
<a name="ln-82"></a>        <span class="c">!! Pointer to the tree root.</span>
<a name="ln-83"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tskin</span>
<a name="ln-84"></a>        <span class="c">!! Thickness of the skin for fattened AABBs, as a fraction of the AABB</span>
<a name="ln-85"></a>        <span class="c">!! base length.</span>
<a name="ln-86"></a>    <span class="k">contains</span>
<a name="ln-87"></a><span class="k">        procedure</span> <span class="kd">::</span> <span class="n">init</span>
<a name="ln-88"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="k">print</span>
<a name="ln-89"></a><span class="k">        procedure</span> <span class="kd">::</span> <span class="n">clear</span>
<a name="ln-90"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">delete</span>
<a name="ln-91"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">insert</span>
<a name="ln-92"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">remove</span>
<a name="ln-93"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">remove_all</span>
<a name="ln-94"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">update_fatm</span>
<a name="ln-95"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">update_fatmaabb</span>
<a name="ln-96"></a>        <span class="k">generic</span>   <span class="kd">::</span> <span class="n">update</span> <span class="o">=&gt;</span> <span class="n">update_fatm</span><span class="p">,</span> <span class="n">update_fatmaabb</span>
<a name="ln-97"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">query_watm</span>
<a name="ln-98"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">query_waabb</span>
<a name="ln-99"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">query_watmaabb</span>
<a name="ln-100"></a>        <span class="k">generic</span>   <span class="kd">::</span> <span class="n">query</span> <span class="o">=&gt;</span> <span class="n">query_watm</span><span class="p">,</span> <span class="n">query_waabb</span><span class="p">,</span> <span class="n">query_watmaabb</span>
<a name="ln-101"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">get_num_atoms</span>
<a name="ln-102"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">get_aabb</span>
<a name="ln-103"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">get_height</span>
<a name="ln-104"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">get_max_balance</span>
<a name="ln-105"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">get_srfarea_ratio</span>
<a name="ln-106"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">rebuild</span>
<a name="ln-107"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">validate</span>
<a name="ln-108"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">insert_leaf</span>
<a name="ln-109"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">remove_leaf</span>
<a name="ln-110"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">balance</span>
<a name="ln-111"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">calc_height</span>
<a name="ln-112"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">fs_acquire</span>
<a name="ln-113"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">fs_return</span>
<a name="ln-114"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">validate_structure</span>
<a name="ln-115"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">validate_metrics</span>
<a name="ln-116"></a><span class="k">end type </span><span class="n">aabbtree_t</span>
<a name="ln-117"></a>
<a name="ln-118"></a><span class="k">interface</span>
<a name="ln-119"></a><span class="k">    module subroutine </span><span class="n">node_init</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-120"></a>        <span class="c">!! Initializes a node.</span>
<a name="ln-121"></a>        <span class="k">class</span><span class="p">(</span><span class="n">node_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-122"></a>            <span class="c">!! A *node_t* instance.</span>
<a name="ln-123"></a>        <span class="k">end subroutine</span>
<a name="ln-124"></a>
<a name="ln-125"></a><span class="k">    module function </span><span class="n">node_isleaf</span><span class="p">(</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a name="ln-126"></a>        <span class="c">!! Is this a leaf node? </span>
<a name="ln-127"></a>        <span class="k">class</span><span class="p">(</span><span class="n">node_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-128"></a>            <span class="c">!! A *node_t* instance.</span>
<a name="ln-129"></a>        <span class="kt">logical</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-130"></a>            <span class="c">!! *true* if this is a leaf node, *false* otherwise.</span>
<a name="ln-131"></a>        <span class="k">end function</span>
<a name="ln-132"></a>
<a name="ln-133"></a><span class="k">    module function </span><span class="n">node_asstr</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">frmt</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
<a name="ln-134"></a>        <span class="c">!! Returns a string representation of a node.</span>
<a name="ln-135"></a>        <span class="k">class</span><span class="p">(</span><span class="n">node_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-136"></a>            <span class="c">!! A *node_t* instance.</span>
<a name="ln-137"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">frmt</span>
<a name="ln-138"></a>            <span class="c">!! Format string for real numbers, e.g. &#39;(f15.6)&#39;. Default: *(g0.6)*.</span>
<a name="ln-139"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">buf</span>
<a name="ln-140"></a>            <span class="c">!! Return value</span>
<a name="ln-141"></a>        <span class="k">end function</span>
<a name="ln-142"></a>
<a name="ln-143"></a><span class="k">    module subroutine </span><span class="n">init</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">natoms</span><span class="p">,</span> <span class="n">tskin</span><span class="p">)</span>
<a name="ln-144"></a>        <span class="c">!! Initializes an AABB tree.</span>
<a name="ln-145"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-146"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-147"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">natoms</span>
<a name="ln-148"></a>            <span class="c">!! Estimated number of atoms to be handled by this tree.</span>
<a name="ln-149"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tskin</span>
<a name="ln-150"></a>            <span class="c">!! Thickness of the skin for fattened AABBs, as a fraction of the</span>
<a name="ln-151"></a>            <span class="c">!! AABB base length.</span>
<a name="ln-152"></a>        <span class="k">end subroutine</span>
<a name="ln-153"></a>
<a name="ln-154"></a><span class="k">    module recursive subroutine print</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<a name="ln-155"></a>        <span class="c">!! Prints a subtree of an AABB tree rooted at `p` in order.</span>
<a name="ln-156"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-157"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-158"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-159"></a>            <span class="c">!! Pointer to the root of the subtree. Default is the root of the</span>
<a name="ln-160"></a>            <span class="c">!! whole tree.</span>
<a name="ln-161"></a>        <span class="k">end subroutine</span>
<a name="ln-162"></a>
<a name="ln-163"></a><span class="k">    module subroutine </span><span class="n">clear</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-164"></a>        <span class="c">!! Clears an AABB tree. Associated memory is not deallocated.</span>
<a name="ln-165"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-166"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-167"></a>        <span class="k">end subroutine</span>
<a name="ln-168"></a>
<a name="ln-169"></a><span class="k">    module subroutine </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-170"></a>        <span class="c">!! Deletes an AABB tree. All associated memory is deallocated.</span>
<a name="ln-171"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-172"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-173"></a>        <span class="k">end subroutine</span>
<a name="ln-174"></a>
<a name="ln-175"></a><span class="k">    module subroutine </span><span class="n">insert</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ia</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span>
<a name="ln-176"></a>        <span class="c">!! Inserts an atom into an AABB tree.</span>
<a name="ln-177"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-178"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-179"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ia</span>
<a name="ln-180"></a>            <span class="c">!! Atom index</span>
<a name="ln-181"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pos</span>
<a name="ln-182"></a>            <span class="c">!! Atom position</span>
<a name="ln-183"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">radius</span>
<a name="ln-184"></a>            <span class="c">!! Atom radius (or cutoff distance for point particles)</span>
<a name="ln-185"></a>        <span class="k">end subroutine</span>
<a name="ln-186"></a>
<a name="ln-187"></a><span class="k">    module subroutine </span><span class="n">remove</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ia</span><span class="p">)</span>
<a name="ln-188"></a>        <span class="c">!! Removes an atom from an AABB tree.</span>
<a name="ln-189"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-190"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-191"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ia</span>
<a name="ln-192"></a>            <span class="c">!! Atom index</span>
<a name="ln-193"></a>        <span class="k">end subroutine</span>
<a name="ln-194"></a>
<a name="ln-195"></a><span class="k">    module subroutine </span><span class="n">remove_all</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-196"></a>        <span class="c">!! Removes all atoms from an AABB tree.</span>
<a name="ln-197"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-198"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-199"></a>        <span class="k">end subroutine</span>
<a name="ln-200"></a>
<a name="ln-201"></a><span class="k">    module subroutine </span><span class="n">update_fatm</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ia</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="nb">lstat</span><span class="p">)</span>
<a name="ln-202"></a>        <span class="c">!! Updates an AABB tree for the case when an atom leaves its fattened</span>
<a name="ln-203"></a>        <span class="c">!! AABB.</span>
<a name="ln-204"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-205"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-206"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ia</span>
<a name="ln-207"></a>            <span class="c">!! Atom index</span>
<a name="ln-208"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pos</span>
<a name="ln-209"></a>            <span class="c">!! Atom position</span>
<a name="ln-210"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">radius</span>
<a name="ln-211"></a>            <span class="c">!! Atom radius (or cutoff distance for point particles)</span>
<a name="ln-212"></a>        <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">lstat</span>
<a name="ln-213"></a>            <span class="c">!! *true* if the atom was reinserted, *false* otherwise.</span>
<a name="ln-214"></a>        <span class="k">end subroutine</span>
<a name="ln-215"></a>
<a name="ln-216"></a><span class="k">    module subroutine </span><span class="n">update_fatmaabb</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ia</span><span class="p">,</span> <span class="n">lbnd</span><span class="p">,</span> <span class="n">ubnd</span><span class="p">,</span> <span class="nb">lstat</span><span class="p">)</span>
<a name="ln-217"></a>        <span class="c">!! Updates an AABB tree for the case when an atom leaves its fattened</span>
<a name="ln-218"></a>        <span class="c">!! AABB, with the bounds of the new AABB for the atom as input.</span>
<a name="ln-219"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-220"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-221"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ia</span>
<a name="ln-222"></a>            <span class="c">!! Atom index</span>
<a name="ln-223"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lbnd</span>
<a name="ln-224"></a>            <span class="c">!! Lower bound of atom AABB</span>
<a name="ln-225"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ubnd</span>
<a name="ln-226"></a>            <span class="c">!! Upper bound of atom AABB</span>
<a name="ln-227"></a>        <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">lstat</span>
<a name="ln-228"></a>            <span class="c">!! *true* if the atom was reinserted, *false* otherwise.</span>
<a name="ln-229"></a>        <span class="k">end subroutine</span>
<a name="ln-230"></a>
<a name="ln-231"></a><span class="k">    module subroutine </span><span class="n">query_watm</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ia</span><span class="p">,</span> <span class="n">nbrs</span><span class="p">)</span>
<a name="ln-232"></a>        <span class="c">!! Query an AABB tree for a set of potential neighbors of an atom.</span>
<a name="ln-233"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-234"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-235"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ia</span>
<a name="ln-236"></a>            <span class="c">!! Atom index</span>
<a name="ln-237"></a>        <span class="k">type</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nbrs</span>
<a name="ln-238"></a>            <span class="c">!! List of potential neighbors.</span>
<a name="ln-239"></a>        <span class="k">end subroutine</span>
<a name="ln-240"></a>
<a name="ln-241"></a><span class="k">    module subroutine </span><span class="n">query_watmaabb</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ia</span><span class="p">,</span> <span class="n">aabb</span><span class="p">,</span> <span class="n">nbrs</span><span class="p">)</span>
<a name="ln-242"></a>        <span class="c">!! Query an AABB tree for a set of potential neighbors of an atom &amp; its</span>
<a name="ln-243"></a>        <span class="c">!! bounding AABB.</span>
<a name="ln-244"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-245"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-246"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ia</span>
<a name="ln-247"></a>            <span class="c">!! Atom index.</span>
<a name="ln-248"></a>        <span class="k">type</span><span class="p">(</span><span class="n">aabb_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">aabb</span>
<a name="ln-249"></a>            <span class="c">!! Bounding AABB for atom with index `ia`.</span>
<a name="ln-250"></a>        <span class="k">type</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nbrs</span>
<a name="ln-251"></a>            <span class="c">!! List of potential neighbors.</span>
<a name="ln-252"></a>        <span class="k">end subroutine</span>
<a name="ln-253"></a>
<a name="ln-254"></a><span class="k">    module subroutine </span><span class="n">query_waabb</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">aabb</span><span class="p">,</span> <span class="n">atms</span><span class="p">)</span>
<a name="ln-255"></a>        <span class="c">!! Query an AABB tree for the set of atoms whose AABBS overlap with</span>
<a name="ln-256"></a>        <span class="c">!! `aabb`. </span>
<a name="ln-257"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-258"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-259"></a>        <span class="k">type</span><span class="p">(</span><span class="n">aabb_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">aabb</span>
<a name="ln-260"></a>            <span class="c">!! An *aabb_t* instance.</span>
<a name="ln-261"></a>        <span class="k">type</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">atms</span>
<a name="ln-262"></a>            <span class="c">!! List of potential neighbors.</span>
<a name="ln-263"></a>        <span class="k">end subroutine</span>
<a name="ln-264"></a>
<a name="ln-265"></a><span class="k">    module function </span><span class="n">get_num_atoms</span><span class="p">(</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">na</span><span class="p">)</span>
<a name="ln-266"></a>        <span class="c">!! Returns the number of atoms in an AABB tree.</span>
<a name="ln-267"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-268"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-269"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">na</span>
<a name="ln-270"></a>            <span class="c">!! Return value</span>
<a name="ln-271"></a>        <span class="k">end function</span>
<a name="ln-272"></a>
<a name="ln-273"></a><span class="k">    module function </span><span class="n">get_aabb</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ia</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">aabb</span><span class="p">)</span>
<a name="ln-274"></a>        <span class="c">!! Returns a copy of the AABB associated with atom with index `ia`.</span>
<a name="ln-275"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-276"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-277"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ia</span>
<a name="ln-278"></a>            <span class="c">!! Atom index.</span>
<a name="ln-279"></a>        <span class="k">type</span><span class="p">(</span><span class="n">aabb_t</span><span class="p">)</span> <span class="kd">::</span> <span class="n">aabb</span>
<a name="ln-280"></a>            <span class="c">!! AABB of atom `ia`.</span>
<a name="ln-281"></a>        <span class="k">end function</span>
<a name="ln-282"></a>
<a name="ln-283"></a><span class="k">    module function </span><span class="n">get_height</span><span class="p">(</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
<a name="ln-284"></a>        <span class="c">!! Returns the height of an AABB tree.</span>
<a name="ln-285"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-286"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-287"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">height</span>
<a name="ln-288"></a>            <span class="c">!! Return value.</span>
<a name="ln-289"></a>        <span class="k">end function</span>
<a name="ln-290"></a>
<a name="ln-291"></a><span class="k">    module function </span><span class="n">get_max_balance</span><span class="p">(</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">max_balance</span><span class="p">)</span>
<a name="ln-292"></a>        <span class="c">!! Returns the maximum difference between the height of two children</span>
<a name="ln-293"></a>        <span class="c">!! of a node.</span>
<a name="ln-294"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-295"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-296"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">max_balance</span>
<a name="ln-297"></a>            <span class="c">!! Return value.</span>
<a name="ln-298"></a>        <span class="k">end function</span>
<a name="ln-299"></a><span class="k">        </span>
<a name="ln-300"></a><span class="k">    module function </span><span class="n">get_srfarea_ratio</span><span class="p">(</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">saratio</span><span class="p">)</span>
<a name="ln-301"></a>        <span class="c">!! Returns the ratio of the sum of the node surface area to the surface</span>
<a name="ln-302"></a>        <span class="c">!! area of the root node.</span>
<a name="ln-303"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-304"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-305"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">saratio</span>
<a name="ln-306"></a>            <span class="c">!! Return value.</span>
<a name="ln-307"></a>        <span class="k">end function</span>
<a name="ln-308"></a>
<a name="ln-309"></a><span class="k">    module subroutine </span><span class="n">rebuild</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-310"></a>        <span class="c">!! Rebuilds an optimal AABB tree.</span>
<a name="ln-311"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-312"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-313"></a>        <span class="k">end subroutine</span>
<a name="ln-314"></a>
<a name="ln-315"></a><span class="k">    module subroutine </span><span class="n">validate</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-316"></a>        <span class="c">!! Validates an AABB tree.</span>
<a name="ln-317"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-318"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-319"></a>        <span class="k">end subroutine</span>
<a name="ln-320"></a>
<a name="ln-321"></a><span class="k">    module subroutine </span><span class="n">insert_leaf</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">leaf</span><span class="p">)</span>
<a name="ln-322"></a>        <span class="c">!! Inserts a leaf node into a tree.</span>
<a name="ln-323"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-324"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-325"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">leaf</span>
<a name="ln-326"></a>            <span class="c">!! Pointer to a leaf node</span>
<a name="ln-327"></a>        <span class="k">end subroutine</span>
<a name="ln-328"></a>
<a name="ln-329"></a><span class="k">    module subroutine </span><span class="n">remove_leaf</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">leaf</span><span class="p">)</span>
<a name="ln-330"></a>        <span class="c">!! Removes a leaf node from a tree.</span>
<a name="ln-331"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-332"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-333"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">leaf</span>
<a name="ln-334"></a>            <span class="c">!! Pointer to a leaf node</span>
<a name="ln-335"></a>        <span class="k">end subroutine</span>
<a name="ln-336"></a>
<a name="ln-337"></a><span class="k">    module function </span><span class="n">balance</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<a name="ln-338"></a>        <span class="c">!! Balances an AABB tree.</span>
<a name="ln-339"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-340"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-341"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-342"></a>            <span class="c">!! Node index</span>
<a name="ln-343"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">q</span>
<a name="ln-344"></a>
<a name="ln-345"></a>        <span class="k">end function</span>
<a name="ln-346"></a>
<a name="ln-347"></a><span class="k">    module recursive function </span><span class="n">calc_height</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
<a name="ln-348"></a>        <span class="c">!! Calculates the height of a subtree.</span>
<a name="ln-349"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-350"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-351"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-352"></a>            <span class="c">!! Pointer to the root of the subtree. Default: Root of the whole</span>
<a name="ln-353"></a>            <span class="c">!! tree.</span>
<a name="ln-354"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">height</span>
<a name="ln-355"></a>            <span class="c">!! Return value</span>
<a name="ln-356"></a>        <span class="k">end function</span>
<a name="ln-357"></a>
<a name="ln-358"></a><span class="k">    module function </span><span class="n">fs_acquire</span><span class="p">(</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<a name="ln-359"></a>        <span class="c">!! Acquires a new node from the free store and returns a pointer to it.</span>
<a name="ln-360"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-361"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-362"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-363"></a>            <span class="c">!! Return value</span>
<a name="ln-364"></a>        <span class="k">end function</span>
<a name="ln-365"></a>
<a name="ln-366"></a><span class="k">    module subroutine </span><span class="n">fs_return</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<a name="ln-367"></a>        <span class="c">!! Returns a node to the free store.</span>
<a name="ln-368"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-369"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-370"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-371"></a>            <span class="c">!! Node pointer.</span>
<a name="ln-372"></a>        <span class="k">end subroutine</span>
<a name="ln-373"></a>
<a name="ln-374"></a><span class="k">    module recursive subroutine </span><span class="n">validate_structure</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<a name="ln-375"></a>        <span class="c">!! Asserts that an AABB subtree has a valid structure.</span>
<a name="ln-376"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-377"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-378"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-379"></a>            <span class="c">!! Pointer to the root of the subtree.</span>
<a name="ln-380"></a>        <span class="k">end subroutine</span>
<a name="ln-381"></a>
<a name="ln-382"></a><span class="k">    module recursive subroutine </span><span class="n">validate_metrics</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<a name="ln-383"></a>        <span class="c">!! Asserts that an AABB subtree has a valid metric.</span>
<a name="ln-384"></a>        <span class="k">class</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-385"></a>            <span class="c">!! An *aabbtree_t* instance.</span>
<a name="ln-386"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-387"></a>            <span class="c">!! Pointer to the root of the subtree.</span>
<a name="ln-388"></a>        <span class="k">end subroutine</span>
<a name="ln-389"></a><span class="k">end interface</span>
<a name="ln-390"></a>
<a name="ln-391"></a><span class="c">!*******************************************************************************</span>
<a name="ln-392"></a>
<a name="ln-393"></a><span class="k">end module </span><span class="n">aabbtree_m</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> BROWNPAK was developed by Sarit Dutta</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>