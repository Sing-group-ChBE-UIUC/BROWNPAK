<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for BROWNPAK">
   
    <meta name="author" content="Sarit Dutta" >
    <link rel="icon" href="../favicon.png">

    <title>m_mpcd.f90 &ndash; BROWNPAK</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">BROWNPAK <small>0.2</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>m_mpcd.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 5.5% of total for source files.">337 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/m_mpcd.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">m_mpcd.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_mpcd.html">m_mpcd</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_mpcd.f90.html#src">m_mpcd.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_mpcd.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilem_mpcdf90EfferentGraph" width="641pt" height="645pt"
 viewBox="0.00 0.00 641.00 644.53" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph" class="graph" transform="scale(.7436 .7436) rotate(0) translate(4 862.7436)">
<title>sourcefile~~m_mpcd.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-862.7436 858,-862.7436 858,4 -4,4"/>
<!-- sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~m_mpcd.f90</title>
<polygon fill="none" stroke="#000000" points="854,-275.7852 784,-275.7852 784,-251.7852 854,-251.7852 854,-275.7852"/>
<text text-anchor="middle" x="819" y="-261.3852" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_mpcd.f90</text>
</g>
<!-- sourcefile~m_strings.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~m_strings.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/m_strings.f90.html" xlink:title="m_strings.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="483,-809.7852 407,-809.7852 407,-785.7852 483,-785.7852 483,-809.7852"/>
<text text-anchor="middle" x="445" y="-795.3852" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_strings.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_strings.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_strings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M701.5,-701.7852C628.2679,-744.5845 598.5712,-728.8277 520,-760.7852 505.3897,-766.7277 489.6738,-774.2894 476.4215,-781.0261"/>
<polygon fill="#ff0000" stroke="#ff0000" points="474.5424,-778.0571 467.2582,-785.7507 477.7503,-784.2788 474.5424,-778.0571"/>
</g>
<!-- sourcefile~m_utils_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~m_utils_math.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/m_utils_math.f90.html" xlink:title="m_utils_math.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="370,-774.7852 278,-774.7852 278,-750.7852 370,-750.7852 370,-774.7852"/>
<text text-anchor="middle" x="324" y="-760.3852" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_utils_math.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_utils_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_utils_math.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M445,-643.7852C438.0263,-643.3126 374.8912,-708.9428 342.6977,-742.9252"/>
<polygon fill="#ff0000" stroke="#ff0000" points="339.9224,-740.7661 335.5965,-750.4375 345.0094,-745.5747 339.9224,-740.7661"/>
</g>
<!-- sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~m_globals.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/m_globals.f90.html" xlink:title="m_globals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="484,-310.7852 406,-310.7852 406,-286.7852 484,-286.7852 484,-310.7852"/>
<text text-anchor="middle" x="445" y="-296.3852" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_globals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M817.9518,-275.8561C811.9389,-341.709 779.3291,-656.2992 701.5,-701.7852"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M701.5,-701.7852C550.7901,-789.8652 732.5149,-450.3971 619,-317.7852 603.676,-299.8832 590.4643,-309.5466 569.5,-298.7852"/>
</g>
<!-- sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~m_cell_list.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/m_cell_list.f90.html" xlink:title="m_cell_list.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="609,-72.7852 530,-72.7852 530,-48.7852 609,-48.7852 609,-72.7852"/>
<text text-anchor="middle" x="569.5" y="-58.3852" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_cell_list.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_cell_list.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M808.4113,-251.6393C780.3141,-220.0129 700.4328,-133.9547 619,-81.7852 616.5682,-80.2273 614.0012,-78.7392 611.3673,-77.3268"/>
<polygon fill="#ff0000" stroke="#ff0000" points="612.769,-74.1156 602.253,-72.8252 609.669,-80.3918 612.769,-74.1156"/>
</g>
<!-- sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~m_stats_io.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/m_stats_io.f90.html" xlink:title="m_stats_io.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="610,-793.7852 529,-793.7852 529,-769.7852 610,-769.7852 610,-793.7852"/>
<text text-anchor="middle" x="569.5" y="-779.3852" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_stats_io.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_stats_io.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M701.5,-701.7852C663.6649,-723.8974 656.7751,-733.5706 619,-755.7852 613.8004,-758.843 608.2085,-761.9482 602.7211,-764.8977"/>
<polygon fill="#ff0000" stroke="#ff0000" points="600.8791,-761.9123 593.6725,-769.6786 604.1493,-768.1016 600.8791,-761.9123"/>
</g>
<!-- sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~m_config_io.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/m_config_io.f90.html" xlink:title="m_config_io.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="613,-713.7852 526,-713.7852 526,-689.7852 613,-689.7852 613,-713.7852"/>
<text text-anchor="middle" x="569.5" y="-699.3852" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_config_io.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_config_io.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M701.5,-701.7852C678.2849,-715.3529 648.621,-716.4834 623.2965,-713.7275"/>
<polygon fill="#ff0000" stroke="#ff0000" points="623.4749,-710.2209 613.1044,-712.3894 622.5637,-717.1614 623.4749,-710.2209"/>
</g>
<!-- sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~m_interaction.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/m_interaction.f90.html" xlink:title="m_interaction.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="748,-275.7852 655,-275.7852 655,-251.7852 748,-251.7852 748,-275.7852"/>
<text text-anchor="middle" x="701.5" y="-261.3852" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_interaction.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M783.7461,-263.7852C775.6808,-263.7852 766.9081,-263.7852 758.1958,-263.7852"/>
<polygon fill="#ff0000" stroke="#ff0000" points="758.042,-260.2853 748.0419,-263.7852 758.0419,-267.2853 758.042,-260.2853"/>
</g>
<!-- sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~m_constants_math.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/m_constants_math.f90.html" xlink:title="m_constants_math.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="242,-540.7852 123,-540.7852 123,-516.7852 242,-516.7852 242,-540.7852"/>
<text text-anchor="middle" x="182.5" y="-526.3852" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_constants_math.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M701.5,-701.7852C648.6668,-732.8734 630.6616,-665.9184 569.5,-661.7852"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M445,-643.7852C389.0849,-635.6612 377.4836,-623.006 324,-604.7852"/>
</g>
<!-- sourcefile~m_ran_num.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~m_ran_num.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node10"><a xlink:href=".././sourcefile/m_ran_num.f90.html" xlink:title="m_ran_num.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="225.5,-656.7852 139.5,-656.7852 139.5,-632.7852 225.5,-632.7852 225.5,-656.7852"/>
<text text-anchor="middle" x="182.5" y="-642.3852" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ran_num.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_ran_num.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_ran_num.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M569.5,-661.7852C540.5585,-659.8294 444.1857,-702.2062 406,-733.7852 384.8981,-751.2362 394.3717,-771.3012 370,-783.7852 333.6077,-802.4266 314.1847,-802.8265 278,-783.7852 253.6059,-770.9484 213.4307,-701.7949 193.8869,-666.1153"/>
<polygon fill="#ff0000" stroke="#ff0000" points="196.7954,-664.1365 188.9519,-657.0141 190.6418,-667.4733 196.7954,-664.1365"/>
</g>
<!-- sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~m_logger.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node11"><a xlink:href=".././sourcefile/m_logger.f90.html" xlink:title="m_logger.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="219.5,-274.7852 145.5,-274.7852 145.5,-250.7852 219.5,-250.7852 219.5,-274.7852"/>
<text text-anchor="middle" x="182.5" y="-260.3852" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_logger.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_logger.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M569.5,-661.7852C513.7186,-658.0156 500.7807,-647.5651 445,-643.7852"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M445,-643.7852C424.6941,-642.4092 420.8618,-633.6903 406,-619.7852 334.3181,-552.7177 329.8494,-523.1398 278,-439.7852 244.2387,-385.5095 209.928,-318.3485 193.1175,-284.4844"/>
<polygon fill="#ff0000" stroke="#ff0000" points="196.0474,-282.5125 188.4823,-275.0949 189.7705,-285.6112 196.0474,-282.5125"/>
</g>
<!-- sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~m_precision.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node12"><a xlink:href=".././sourcefile/m_precision.f90.html" xlink:title="m_precision.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="87,-483.7852 0,-483.7852 0,-459.7852 87,-459.7852 87,-483.7852"/>
<text text-anchor="middle" x="43.5" y="-469.3852" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_precision.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M701.5,-701.7852C651.5456,-731.1794 666.273,-769.2484 619,-802.7852 511.1819,-879.2745 454.6098,-861.1918 324,-840.7852"/>
</g>
<!-- sourcefile~m_strings.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~m_strings.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M427.9,-809.7959C404.9325,-824.5267 362.5408,-846.8461 324,-840.7852"/>
</g>
<!-- sourcefile~m_utils_math.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~m_utils_math.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M294.7537,-750.6095C288.5455,-746.9211 282.5125,-742.3383 278,-736.7852 244.7592,-695.8789 264.1636,-671.6083 242,-623.7852 229.4122,-596.624 210.4685,-567.803 197.3524,-549.124"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="200.089,-546.9331 191.4351,-540.8207 194.3884,-550.9956 200.089,-546.9331"/>
</g>
<!-- sourcefile~m_utils_math.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~m_utils_math.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M277.8492,-774.6406C248.3685,-779.5068 210.5527,-780.4742 182.5,-762.7852"/>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M439.9561,-286.7535C425.9545,-255.4623 383.6684,-174.5136 324,-182.7852"/>
</g>
<!-- sourcefile~m_trajectory.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~m_trajectory.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node14"><a xlink:href=".././sourcefile/m_trajectory.f90.html" xlink:title="m_trajectory.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="368,-234.7852 280,-234.7852 280,-210.7852 368,-210.7852 368,-234.7852"/>
<text text-anchor="middle" x="324" y="-220.3852" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_trajectory.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_trajectory.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_trajectory.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M427.658,-286.6969C412.6066,-276.3331 390.1301,-261.1611 370,-248.7852 365.2135,-245.8425 360.0841,-242.8195 355.05,-239.9232"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="356.6104,-236.7844 346.1861,-234.8913 353.1546,-242.8719 356.6104,-236.7844"/>
</g>
<!-- sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~m_simbox.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node17"><a xlink:href=".././sourcefile/m_simbox.f90.html" xlink:title="m_simbox.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="363,-656.7852 285,-656.7852 285,-632.7852 363,-632.7852 363,-656.7852"/>
<text text-anchor="middle" x="324" y="-642.3852" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_simbox.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_simbox.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M442.2653,-311.0556C429.3429,-368.9597 374.8238,-612.3505 370,-618.7852 367.8437,-621.6616 365.2697,-624.2666 362.4563,-626.6159"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="360.1815,-623.938 354.0422,-632.5728 364.2262,-629.6512 360.1815,-623.938"/>
</g>
<!-- sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M531.0174,-72.9776C526.9338,-75.419 523.1351,-78.3273 520,-81.7852 484.0269,-121.4624 501.572,-146.193 484,-196.7852 474.2621,-224.8221 461.8495,-256.7128 453.6752,-277.2591"/>
<polygon fill="#5cff00" stroke="#5cff00" points="450.3919,-276.0435 449.9283,-286.6282 456.8914,-278.6428 450.3919,-276.0435"/>
</g>
<!-- sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M445,-26.7852C391.2273,-26.047 377.7778,-26.7852 324,-26.7852"/>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M541.4134,-48.7419C516.56,-39.1514 479.0541,-27.2527 445,-26.7852"/>
</g>
<!-- sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~m_vector.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node19"><a xlink:href=".././sourcefile/m_vector.f90.html" xlink:title="m_vector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="360.5,-97.7852 287.5,-97.7852 287.5,-73.7852 360.5,-73.7852 360.5,-97.7852"/>
<text text-anchor="middle" x="324" y="-83.3852" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_vector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_vector.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M445,-26.7852C407.2865,-26.2675 369.0361,-49.8494 345.9134,-67.3519"/>
<polygon fill="#5cff00" stroke="#5cff00" points="343.531,-64.7724 337.8247,-73.6993 347.8524,-70.2793 343.531,-64.7724"/>
</g>
<!-- sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_strings.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_strings.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M528.734,-787.0242C517.435,-788.4763 505.0596,-790.0667 493.3719,-791.5687"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="492.7945,-788.1141 483.3222,-792.8603 493.6868,-795.057 492.7945,-788.1141"/>
</g>
<!-- sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M555.7479,-769.6658C544.2093,-758.6512 528.3183,-741.3282 520,-722.7852 474.7732,-621.967 503.8369,-585.4879 484,-476.7852 473.6929,-420.3039 458.3993,-354.4465 450.3695,-320.8929"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="453.686,-319.7153 447.9424,-310.8124 446.8805,-321.3539 453.686,-319.7153"/>
</g>
<!-- sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M545.6408,-793.814C512.5658,-810.2875 455.6354,-837.8425 445,-837.7852"/>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M445,-837.7852C425.7194,-837.6814 419.5241,-832.5275 406,-818.7852 379.5016,-791.8594 393.1277,-771.6561 370,-741.7852 337.5311,-699.8494 313.9398,-704.7874 278,-665.7852 243.5531,-628.4031 211.4952,-577.9647 194.7114,-549.8881"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="197.531,-547.7794 189.4329,-540.9477 191.5031,-551.3384 197.531,-547.7794"/>
</g>
<!-- sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M445,-837.7852C391.242,-835.8095 377.1495,-849.0893 324,-840.7852"/>
</g>
<!-- sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_strings.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_strings.f90</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M541.8202,-713.8376C534.3565,-717.7335 526.5435,-722.4464 520,-727.7852 500.4225,-743.7583 502.7178,-754.8128 484,-771.7852 480.8804,-774.614 477.4283,-777.3615 473.9057,-779.9451"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="471.9124,-777.0681 465.6814,-785.637 475.896,-782.8241 471.9124,-777.0681"/>
</g>
<!-- sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M536.2064,-689.6801C530.0187,-686.0672 524.1923,-681.4982 520,-675.7852 466.8257,-603.3221 501.6212,-564.921 484,-476.7852 472.7438,-420.4853 457.8469,-354.5522 450.1282,-320.939"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="453.4572,-319.7983 447.8014,-310.8394 446.6359,-321.3699 453.4572,-319.7983"/>
</g>
<!-- sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M539.4504,-713.8445C498.6909,-730.4923 428.3923,-760.3201 406,-776.7852 368.7543,-804.1721 369.6695,-847.9672 324,-840.7852"/>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M324,-840.7852C308.6906,-838.3933 223.8208,-789.7332 182.5,-762.7852"/>
</g>
<!-- sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_simbox.f90</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M525.8924,-691.6604C482.9793,-681.6969 417.5696,-666.5101 372.9109,-656.1413"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="373.6856,-652.7281 363.1531,-653.8757 372.1024,-659.5468 373.6856,-652.7281"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M684.4105,-275.8075C658.4098,-292.4871 607.8875,-318.4903 569.5,-298.7852"/>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M569.5,-298.7852C546.6173,-287.0391 518.1065,-286.2132 494.1444,-288.6932"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="493.6726,-285.2248 484.183,-289.9363 494.5395,-292.171 493.6726,-285.2248"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_cell_list.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M697.3587,-251.7802C684.6244,-215.4281 645.3176,-107.4693 619,-81.7852 617.7599,-80.5749 616.4393,-79.4297 615.0565,-78.3466"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="616.8669,-75.3484 606.5831,-72.7998 613.033,-81.2052 616.8669,-75.3484"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M699.0338,-275.9873C692.0329,-307.7239 669.2077,-393.8464 619,-443.7852 522.26,-540.0071 460.4452,-528.7852 324,-528.7852"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M700.96,-251.539C698.5873,-213.583 685.9202,-97.0324 619,-39.7852 546.4881,22.2455 501.0833,-4.7266 406,-12.7852 369.1603,-15.9075 360.9718,-26.7852 324,-26.7852"/>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M324,-26.7852C228.3722,-24.1528 185.2743,-31.1662 123,-103.7852 77.4621,-156.8877 52.496,-378.4618 45.5364,-449.6553"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="42.0397,-449.4541 44.5736,-459.7414 49.0081,-450.1193 42.0397,-449.4541"/>
</g>
<!-- sourcefile~m_ia_vdw.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~m_ia_vdw.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node13"><a xlink:href=".././sourcefile/m_ia_vdw.f90.html" xlink:title="m_ia_vdw.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="608,-350.7852 531,-350.7852 531,-326.7852 608,-326.7852 608,-350.7852"/>
<text text-anchor="middle" x="569.5" y="-336.3852" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_vdw.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_vdw.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_vdw.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M681.6649,-275.9617C665.0586,-286.0603 640.6653,-300.6723 619,-312.7852 613.6264,-315.7895 607.8772,-318.9011 602.2684,-321.8823"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="600.2705,-318.9786 593.0526,-326.7344 603.5317,-325.1725 600.2705,-318.9786"/>
</g>
<!-- sourcefile~m_ia_angle.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~m_ia_angle.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node15"><a xlink:href=".././sourcefile/m_ia_angle.f90.html" xlink:title="m_ia_angle.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="611.5,-434.7852 527.5,-434.7852 527.5,-410.7852 611.5,-410.7852 611.5,-434.7852"/>
<text text-anchor="middle" x="569.5" y="-420.3852" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_angle.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_angle.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_angle.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M697.2808,-275.8367C687.5036,-302.1497 660.885,-365.3002 619,-401.7852 617.4954,-403.0958 615.897,-404.334 614.2308,-405.5027"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="612.2221,-402.6265 605.4574,-410.7806 615.8306,-408.6248 612.2221,-402.6265"/>
</g>
<!-- sourcefile~m_ia_external.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~m_ia_external.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node16"><a xlink:href=".././sourcefile/m_ia_external.f90.html" xlink:title="m_ia_external.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="617.5,-198.7852 521.5,-198.7852 521.5,-174.7852 617.5,-174.7852 617.5,-198.7852"/>
<text text-anchor="middle" x="569.5" y="-184.3852" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_external.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_external.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_external.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M685.6577,-251.656C669.4687,-239.5973 643.3229,-221.0346 619,-207.7852 616.0898,-206.1999 613.0348,-204.6505 609.9312,-203.1574"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="611.1196,-199.8521 600.5706,-198.868 608.2035,-206.2158 611.1196,-199.8521"/>
</g>
<!-- sourcefile~m_connectivity.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~m_connectivity.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node18"><a xlink:href=".././sourcefile/m_connectivity.f90.html" xlink:title="m_connectivity.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="619,-156.7852 520,-156.7852 520,-132.7852 619,-132.7852 619,-156.7852"/>
<text text-anchor="middle" x="569.5" y="-142.3852" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_connectivity.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_connectivity.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_connectivity.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M694.0416,-251.6496C681.0544,-231.3956 652.4537,-190.4931 619,-165.7852 617.1391,-164.4108 615.1747,-163.1058 613.1442,-161.8695"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="614.3956,-158.5672 603.9347,-156.8877 611.0651,-164.7241 614.3956,-158.5672"/>
</g>
<!-- sourcefile~m_verlet.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~m_verlet.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node20"><a xlink:href=".././sourcefile/m_verlet.f90.html" xlink:title="m_verlet.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="604.5,-114.7852 534.5,-114.7852 534.5,-90.7852 604.5,-90.7852 604.5,-114.7852"/>
<text text-anchor="middle" x="569.5" y="-100.3852" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_verlet.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_verlet.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_verlet.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M697.33,-251.5583C687.6512,-224.8625 661.2164,-160.7939 619,-123.7852 617.289,-122.2852 615.455,-120.8805 613.537,-119.5665"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="615.1041,-116.4277 604.7106,-114.3722 611.5538,-122.4606 615.1041,-116.4277"/>
</g>
<!-- sourcefile~m_ia_bond.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~m_ia_bond.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node21"><a xlink:href=".././sourcefile/m_ia_bond.f90.html" xlink:title="m_ia_bond.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="610.5,-617.7852 528.5,-617.7852 528.5,-593.7852 610.5,-593.7852 610.5,-617.7852"/>
<text text-anchor="middle" x="569.5" y="-603.3852" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_bond.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_bond.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_bond.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M699.647,-276.0653C691.5891,-328.15 658.2334,-530.3923 619,-579.7852 616.5236,-582.9028 613.5702,-585.6888 610.356,-588.1695"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="608.3666,-585.2889 601.9527,-593.7217 612.2255,-591.1292 608.3666,-585.2889"/>
</g>
<!-- sourcefile~m_ia_tether.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~m_ia_tether.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node22"><a xlink:href=".././sourcefile/m_ia_tether.f90.html" xlink:title="m_ia_tether.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="612,-392.7852 527,-392.7852 527,-368.7852 612,-368.7852 612,-392.7852"/>
<text text-anchor="middle" x="569.5" y="-378.3852" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_tether.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_tether.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_tether.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M693.7708,-275.9838C680.5993,-295.9191 652.0022,-335.6693 619,-359.7852 616.9555,-361.2792 614.7886,-362.6923 612.5481,-364.025"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="610.8259,-360.9767 603.6451,-368.7669 614.1166,-367.155 610.8259,-360.9767"/>
</g>
<!-- sourcefile~m_ia_dihedral.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~m_ia_dihedral.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node23"><a xlink:href=".././sourcefile/m_ia_dihedral.f90.html" xlink:title="m_ia_dihedral.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="617.5,-240.7852 521.5,-240.7852 521.5,-216.7852 617.5,-216.7852 617.5,-240.7852"/>
<text text-anchor="middle" x="569.5" y="-226.3852" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_dihedral.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_dihedral.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_dihedral.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M656.0731,-251.7402C646.0135,-249.0729 635.2454,-246.2177 624.8404,-243.4588"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="625.5737,-240.0323 615.0106,-240.8524 623.7796,-246.7985 625.5737,-240.0323"/>
</g>
<!-- sourcefile~m_constants_math.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~m_constants_math.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M153.0217,-516.697C132.4736,-508.2708 104.8454,-496.9412 82.4794,-487.7696"/>
<polygon fill="#002eff" stroke="#002eff" points="83.5161,-484.4119 72.9358,-483.856 80.8602,-490.8885 83.5161,-484.4119"/>
</g>
<!-- sourcefile~m_ran_num.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~m_ran_num.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M162.2207,-632.6052C149.9354,-624.5803 134.4748,-613.2723 123,-600.7852 92.2215,-567.2915 66.7521,-520.1925 53.4612,-493.1471"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="56.4691,-491.3261 48.978,-483.8338 50.1618,-494.3623 56.4691,-491.3261"/>
</g>
<!-- sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M532.1459,-326.7839C519.7032,-322.7862 505.6717,-318.2781 492.5619,-314.0661"/>
<polygon fill="#ff0000" stroke="#ff0000" points="493.3494,-310.643 482.758,-310.9163 491.2081,-317.3075 493.3494,-310.643"/>
</g>
<!-- sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M530.7859,-345.2372C516.1356,-347.6491 499.3055,-350.3843 484,-352.7852 412.962,-363.9285 384.53,-337.9691 324,-376.7852"/>
</g>
<!-- sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_logger.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M324,-262.7852C294,-251.8133 257.9694,-251.9874 229.7745,-254.8154"/>
<polygon fill="#ff0000" stroke="#ff0000" points="229.3038,-251.3463 219.7671,-255.9616 230.1004,-258.3008 229.3038,-251.3463"/>
</g>
<!-- sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M324,-262.7852C308.6557,-257.1733 196.2772,-214.0028 182.5,-222.7852"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M530.7616,-342.0912C496.0307,-343.3113 444.731,-340.6799 406,-319.7852 384.064,-307.9511 390.7853,-290.5404 370,-276.7852 352.1787,-264.9915 344.0702,-270.1255 324,-262.7852"/>
</g>
<!-- sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_logger.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M281.5453,-234.7865C265.0772,-239.4418 246.1603,-244.7894 229.3006,-249.5553"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="228.3165,-246.1963 219.6457,-252.2847 230.2207,-252.9324 228.3165,-246.1963"/>
</g>
<!-- sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M279.9945,-211.5709C250.3324,-206.5656 211.478,-205.1911 182.5,-222.7852"/>
</g>
<!-- sourcefile~m_ia_angle.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~m_ia_angle.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M534.3372,-410.7037C529.2665,-408.1734 524.3125,-405.2111 520,-401.7852 491.3569,-379.0307 468.4221,-342.6918 455.7737,-319.8151"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="458.8092,-318.0697 450.996,-310.9139 452.6414,-321.3802 458.8092,-318.0697"/>
</g>
<!-- sourcefile~m_ia_angle.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~m_ia_angle.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M324,-528.7852C300.6729,-528.7852 275.1826,-528.7852 252.3434,-528.7852"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="252.0536,-525.2853 242.0536,-528.7852 252.0535,-532.2853 252.0536,-525.2853"/>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M445,-490.7852C389.4651,-500.437 380.3674,-528.7852 324,-528.7852"/>
</g>
<!-- sourcefile~m_ia_angle.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~m_ia_angle.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M555.0124,-434.9094C532.9706,-452.32 488.9192,-483.1522 445,-490.7852"/>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M445,-490.7852C321.9576,-512.1696 174.7295,-494.3695 97.2639,-481.7204"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="97.6998,-478.2448 87.2602,-480.0518 96.548,-485.1494 97.6998,-478.2448"/>
</g>
<!-- sourcefile~m_ia_external.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~m_ia_external.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M535.0345,-198.8462C529.7617,-201.4027 524.5629,-204.3783 520,-207.7852 493.8244,-227.3294 471.142,-257.8629 457.7672,-278.0939"/>
<polygon fill="#5cff00" stroke="#5cff00" points="454.7691,-276.2851 452.2978,-286.5877 460.6545,-280.0748 454.7691,-276.2851"/>
</g>
<!-- sourcefile~m_ia_external.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~m_ia_external.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M521.1598,-196.477C487.1887,-204.7401 441.6308,-218.8319 406,-240.7852 386.7356,-252.6546 386.2673,-261.057 370,-276.7852 329.7608,-315.6908 312.783,-318.9334 278,-362.7852 240.176,-410.4709 207.613,-474.8419 192.1281,-507.6511"/>
<polygon fill="#5cff00" stroke="#5cff00" points="188.932,-506.2238 187.8839,-516.7666 195.2778,-509.1785 188.932,-506.2238"/>
</g>
<!-- sourcefile~m_ia_external.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~m_ia_external.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M445,-182.7852C391.486,-177.4654 377.2684,-175.4008 324,-182.7852"/>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M521.2166,-186.7365C498.1063,-186.3297 470.0704,-185.2774 445,-182.7852"/>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M298.4752,-632.6931C291.4665,-628.7687 284.1189,-624.0509 278,-618.7852 258.3223,-601.8511 260.6061,-590.8901 242,-572.7852 232.2887,-563.3355 220.4801,-554.2038 209.9507,-546.7321"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="211.6968,-543.6842 201.481,-540.8757 207.7156,-549.4419 211.6968,-543.6842"/>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_ran_num.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_ran_num.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M284.9599,-644.7852C269.8615,-644.7852 252.3338,-644.7852 236.0904,-644.7852"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="235.6401,-641.2853 225.64,-644.7852 235.64,-648.2853 235.6401,-641.2853"/>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M289.7809,-632.6651C248.2216,-617.06 176.9886,-587.4142 123,-549.7852 98.8709,-532.9677 75.3485,-508.5977 60.2306,-491.5876"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="62.7298,-489.1283 53.5183,-483.8938 57.455,-493.7301 62.7298,-489.1283"/>
</g>
<!-- sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M533.2072,-156.8319C528.4593,-159.3375 523.898,-162.3018 520,-165.7852 485.1436,-196.9338 462.7205,-248.2785 452.1411,-277.2153"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="448.7921,-276.1886 448.7782,-286.7835 455.3961,-278.5098 448.7921,-276.1886"/>
</g>
<!-- sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M445,-144.7852C388.6854,-142.3464 379.8335,-175.0452 324,-182.7852"/>
</g>
<!-- sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_vector.f90</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M519.8007,-145.7693C496.9988,-145.9679 469.6176,-145.8513 445,-144.7852"/>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M445,-144.7852C407.7323,-143.1713 369.9004,-120.6353 346.6945,-103.8934"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="348.6566,-100.9905 338.5484,-97.8163 344.4709,-106.6013 348.6566,-100.9905"/>
</g>
<!-- sourcefile~m_table.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~m_table.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node25"><a xlink:href=".././sourcefile/m_table.f90.html" xlink:title="m_table.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="478.5,-116.7852 411.5,-116.7852 411.5,-92.7852 478.5,-92.7852 478.5,-116.7852"/>
<text text-anchor="middle" x="445" y="-102.3852" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_table.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_table.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_table.f90</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M532.1459,-132.7839C518.2953,-128.3339 502.476,-123.2514 488.1508,-118.6489"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="489.106,-115.2797 478.5147,-115.553 486.9648,-121.9441 489.106,-115.2797"/>
</g>
<!-- sourcefile~m_vector.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~m_vector.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M314.7295,-97.8841C293.9044,-124.2752 240.6639,-187.4707 182.5,-222.7852"/>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M182.5,-222.7852C158.7712,-237.1922 142.8605,-222.3899 123,-241.7852 63.6618,-299.7333 48.5799,-404.0598 44.7728,-449.5574"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="41.2806,-449.3243 44.0425,-459.5527 48.262,-449.8344 41.2806,-449.3243"/>
</g>
<!-- sourcefile~m_qsort.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~m_qsort.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node24"><a xlink:href=".././sourcefile/m_qsort.f90.html" xlink:title="m_qsort.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="216.5,-136.7852 148.5,-136.7852 148.5,-112.7852 216.5,-112.7852 216.5,-136.7852"/>
<text text-anchor="middle" x="182.5" y="-122.3852" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_qsort.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_vector.f90&#45;&gt;sourcefile~m_qsort.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~m_vector.f90&#45;&gt;sourcefile~m_qsort.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M287.1919,-95.9302C268.6434,-101.0425 246.0158,-107.2791 226.5489,-112.6445"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="225.4059,-109.329 216.6954,-115.3603 227.2659,-116.0773 225.4059,-109.329"/>
</g>
<!-- sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M534.3677,-113.6487C529.1176,-116.362 524.1001,-119.7001 520,-123.7852 508.4565,-135.2865 470.1967,-232.9021 453.2277,-277.1438"/>
<polygon fill="#002eff" stroke="#002eff" points="449.8826,-276.0927 449.5818,-286.6833 456.4213,-278.5918 449.8826,-276.0927"/>
</g>
<!-- sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M537.235,-90.7332C512.3909,-81.9957 476.998,-70.7133 445,-64.7852"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M445,-64.7852C389.5757,-54.5171 380.3674,-26.7852 324,-26.7852"/>
</g>
<!-- sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_vector.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M445,-64.7852C419.0682,-59.981 389.9466,-64.7223 366.7718,-70.9061"/>
<polygon fill="#002eff" stroke="#002eff" points="365.5607,-67.6119 356.9038,-73.72 367.4803,-74.3436 365.5607,-67.6119"/>
</g>
<!-- sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_table.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_table.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M534.4885,-103.3476C520.3469,-103.5748 503.869,-103.8395 488.935,-104.0794"/>
<polygon fill="#002eff" stroke="#002eff" points="488.8328,-100.5805 478.8904,-104.2408 488.9454,-107.5796 488.8328,-100.5805"/>
</g>
<!-- sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_strings.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_strings.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M551.9039,-617.9168C541.669,-625.6089 529.0456,-636.2595 520,-647.7852 488.0015,-688.557 464.2396,-745.1553 452.7316,-775.8557"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="449.3278,-774.9727 449.1786,-785.5664 455.9016,-777.3779 449.3278,-774.9727"/>
</g>
<!-- sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M564.6195,-593.7504C545.8349,-547.4304 478.0463,-380.2729 453.7451,-320.3495"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="456.9837,-319.022 449.9821,-311.0704 450.4968,-321.6527 456.9837,-319.022"/>
</g>
<!-- sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M445,-605.7852C391.8726,-614.1355 374.9065,-622.128 324,-604.7852"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M528.3164,-602.5887C503.9427,-601.4897 472.5447,-601.4559 445,-605.7852"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M324,-604.7852C302.1722,-597.3489 296.6858,-594.298 278,-580.7852 259.9175,-567.7086 261.3122,-556.9662 242,-545.7852 241.7036,-545.6136 241.4054,-545.4437 241.1055,-545.2754"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="242.5211,-542.0718 231.9986,-540.8363 239.454,-548.3641 242.5211,-542.0718"/>
</g>
<!-- sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_logger.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M545.6997,-593.7428C512.6313,-576.4383 451.7036,-542.4476 406,-504.7852 318.463,-432.6496 232.4115,-327.0307 198.0867,-283.1093"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="200.6425,-280.6939 191.7454,-274.9412 195.1132,-284.9866 200.6425,-280.6939"/>
</g>
<!-- sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M182.5,-762.7852C85.0433,-701.3328 54.4499,-550.6464 46.1974,-493.8918"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="49.6471,-493.2848 44.8316,-483.8476 42.711,-494.228 49.6471,-493.2848"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M445,-605.7852C424.8944,-608.9453 421.9713,-617.1701 406,-629.7852 388.2435,-643.8104 388.2648,-652.4286 370,-665.7852 332.1326,-693.4766 222.1819,-787.8071 182.5,-762.7852"/>
</g>
<!-- sourcefile~m_ia_tether.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~m_ia_tether.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M537.4205,-368.7413C531.4797,-366.0766 525.438,-363.0599 520,-359.7852 499.983,-347.7313 479.5566,-330.7474 465.086,-317.7605"/>
<polygon fill="#e700ff" stroke="#e700ff" points="467.4438,-315.1738 457.7,-311.0134 462.7227,-320.3421 467.4438,-315.1738"/>
</g>
<!-- sourcefile~m_ia_tether.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~m_ia_tether.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M537.7854,-392.8864C531.7513,-395.5646 525.5822,-398.5715 520,-401.7852 502.6672,-411.7638 501.7225,-419.5163 484,-428.7852 405.9551,-469.6028 307.946,-498.4113 245.2565,-514.3086"/>
<polygon fill="#e700ff" stroke="#e700ff" points="244.3577,-510.9255 235.5069,-516.749 246.0575,-517.716 244.3577,-510.9255"/>
</g>
<!-- sourcefile~m_ia_tether.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~m_ia_tether.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M526.7358,-377.7639C493.0884,-374.3743 445.4577,-367.3097 406,-352.7852 343.9118,-329.9304 330.5267,-317.0124 278,-276.7852 260.2833,-263.217 261.1377,-253.2622 242,-241.7852 218.1929,-227.5079 206.2288,-208.3782 182.5,-222.7852"/>
</g>
<!-- sourcefile~m_ia_dihedral.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~m_ia_dihedral.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M548.0977,-240.8186C528.0552,-252.0875 497.898,-269.0434 475.3703,-281.7096"/>
<polygon fill="#ff008b" stroke="#ff008b" points="473.541,-278.7227 466.5397,-286.6745 476.9717,-284.8244 473.541,-278.7227"/>
</g>
<!-- sourcefile~m_ia_dihedral.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~m_ia_dihedral.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M324,-376.7852C272.4533,-417.8599 222.3682,-477.7839 197.9436,-508.69"/>
<polygon fill="#ff008b" stroke="#ff008b" points="195.1618,-506.5656 191.7552,-516.5979 200.6745,-510.8796 195.1618,-506.5656"/>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M521.2482,-235.5956C486.8935,-242.1883 440.8317,-254.7092 406,-277.7852 358.3709,-309.3394 368.6822,-341.1804 324,-376.7852"/>
</g>
<!-- sourcefile~m_ia_dihedral.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~m_ia_dihedral.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M539.1938,-216.6735C505.5402,-203.3702 454.6591,-183.7454 445,-182.7852"/>
</g>
<!-- sourcefile~m_qsort.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~m_qsort.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M172.0761,-136.791C158.9814,-152.4152 136.5848,-181.0125 123,-208.7852 81.6704,-293.2794 56.8417,-403.6511 47.6154,-449.9016"/>
<polygon fill="#ff0000" stroke="#ff0000" points="44.1752,-449.2574 45.6968,-459.7424 51.0458,-450.597 44.1752,-449.2574"/>
</g>
<!-- sourcefile~m_table.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~m_table.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M426.6508,-116.8955C393.5479,-138.7043 326.9708,-182.3734 324,-182.7852"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M324,-182.7852C259.2657,-191.7591 238.3629,-188.8678 182.5,-222.7852"/>
</g>
<!-- sourcefile~m_table.f90&#45;&gt;sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~m_table.f90&#45;&gt;sourcefile~m_vector.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M411.2948,-99.4926C398.8127,-97.5327 384.4237,-95.2732 370.9746,-93.1614"/>
<polygon fill="#00ffff" stroke="#00ffff" points="371.3422,-89.6763 360.9203,-91.5826 370.2563,-96.5916 371.3422,-89.6763"/>
</g>
</g>
</svg>
</div><script>var pansourcefilem_mpcdf90EfferentGraph = svgPanZoom('#sourcefilem_mpcdf90EfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_mpcd.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilem_mpcdf90AfferentGraph" width="274pt" height="52pt"
 viewBox="0.00 0.00 274.00 52.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_mpcd.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 48)">
<title>sourcefile~~m_mpcd.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-48 270,-48 270,4 -4,4"/>
<!-- sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_mpcd.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~m_mpcd.f90</title>
<polygon fill="none" stroke="#000000" points="70,-44 0,-44 0,-20 70,-20 70,-44"/>
<text text-anchor="middle" x="35" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_mpcd.f90</text>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~m_mpcd.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="266,-44 212,-44 212,-20 266,-20 266,-44"/>
<text text-anchor="middle" x="239" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_mpcd.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_mpcd.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M211.7124,-32.5275C200.6304,-32.7172 187.7042,-32.9071 176,-33 144.8899,-33.2469 137.1103,-33.2191 106,-33 97.6743,-32.9414 88.7997,-32.8441 80.2455,-32.7326"/>
<polygon fill="#ff0000" stroke="#ff0000" points="80.076,-29.23 70.0285,-32.5912 79.9791,-36.2293 80.076,-29.23"/>
</g>
<!-- sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_mpcd.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~m_setup.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/m_setup.f90.html" xlink:title="m_setup.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="176,-24 106,-24 106,0 176,0 176,-24"/>
<text text-anchor="middle" x="141" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_setup.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_mpcd.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M211.9616,-26.482C203.8936,-24.8354 194.824,-22.9845 185.9341,-21.1702"/>
<polygon fill="#00ffff" stroke="#00ffff" points="186.5344,-17.7207 176.0365,-19.1503 185.1346,-24.5793 186.5344,-17.7207"/>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_mpcd.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_mpcd.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M105.9979,-18.6042C97.7627,-20.158 88.8696,-21.8359 80.2555,-23.4612"/>
<polygon fill="#ff0000" stroke="#ff0000" points="79.5052,-20.041 70.3275,-25.3344 80.8031,-26.9196 79.5052,-20.041"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_mpcd.html">m_mpcd</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_mpcd.f90.html#src">m_mpcd.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">module </span><span class="n">m_mpcd</span>
<a name="ln-2"></a>    <span class="c">!! Routines implementing the MPCD solver.</span>
<a name="ln-3"></a>
<a name="ln-4"></a><span class="k">use </span><span class="n">f95_precision</span>
<a name="ln-5"></a><span class="k">use </span><span class="n">lapack95</span>
<a name="ln-6"></a>
<a name="ln-7"></a><span class="k">use </span><span class="n">m_precision</span>
<a name="ln-8"></a><span class="k">use </span><span class="n">m_constants_math</span>
<a name="ln-9"></a><span class="k">use </span><span class="n">m_utils_math</span>
<a name="ln-10"></a><span class="k">use </span><span class="n">m_strings</span>
<a name="ln-11"></a><span class="k">use </span><span class="n">m_ran_num</span>
<a name="ln-12"></a><span class="k">use </span><span class="n">m_globals</span>
<a name="ln-13"></a><span class="k">use </span><span class="n">m_cell_list</span>
<a name="ln-14"></a><span class="k">use </span><span class="n">m_interaction</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">ia_calc_forces</span>
<a name="ln-15"></a><span class="k">use </span><span class="n">m_stats_io</span>
<a name="ln-16"></a><span class="k">use </span><span class="n">m_config_io</span>
<a name="ln-17"></a><span class="k">use </span><span class="n">m_logger</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">logger</span> <span class="o">=&gt;</span> <span class="n">master_logger</span>
<a name="ln-18"></a>
<a name="ln-19"></a><span class="k">implicit none</span>
<a name="ln-20"></a>
<a name="ln-21"></a><span class="k">private</span>
<a name="ln-22"></a>
<a name="ln-23"></a><span class="k">public</span> <span class="kd">::</span> <span class="n">mpcd_init</span><span class="p">,</span> <span class="n">mpcd_run</span><span class="p">,</span> <span class="n">mpcd_finish</span>
<a name="ln-24"></a>
<a name="ln-25"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">mass</span>
<a name="ln-26"></a>    <span class="c">!! *(num_atoms_tot,)* array. Stores mass of each atom (including MPCD</span>
<a name="ln-27"></a>    <span class="c">!! atoms). The mass of each MPCD atom is taken as unity.</span>
<a name="ln-28"></a>
<a name="ln-29"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">buf_aic</span>
<a name="ln-30"></a>    <span class="c">!! Buffer for atoms in cell storing mass, coordinates, &amp; velocities.</span>
<a name="ln-31"></a>    <span class="c">!! For *nc* atoms, the first *nc* elements stores the mass, the next</span>
<a name="ln-32"></a>    <span class="c">!! *3\*nc* elements stores the coordinates, and the next *3\*nc* elements</span>
<a name="ln-33"></a>    <span class="c">!! store the velocities. The velocities part of this buffer may be overwritten</span>
<a name="ln-34"></a>    <span class="c">!! for relative velocity calculations.</span>
<a name="ln-35"></a>
<a name="ln-36"></a><span class="k">contains</span>
<a name="ln-37"></a> 
<a name="ln-38"></a><span class="c">!*******************************************************************************</span>
<a name="ln-39"></a> 
<a name="ln-40"></a><span class="k">subroutine </span><span class="n">mpcd_init</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-41"></a>    <span class="c">!! Initializes the MPCD solver. </span>
<a name="ln-42"></a>
<a name="ln-43"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-44"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">at_i</span>
<a name="ln-45"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lexists</span>
<a name="ln-46"></a>
<a name="ln-47"></a>    <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-48"></a>
<a name="ln-49"></a>    <span class="c">!Allocate memory for velocities</span>
<a name="ln-50"></a>    <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">velocities</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-51"></a><span class="k">        allocate</span><span class="p">(</span> <span class="n">velocities</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">num_atoms_tot</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-52"></a>        <span class="n">velocities</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-53"></a>    <span class="k">end if</span>
<a name="ln-54"></a>
<a name="ln-55"></a>    <span class="c">!Mass of each atom</span>
<a name="ln-56"></a>    <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">mass</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-57"></a><span class="k">        allocate</span><span class="p">(</span> <span class="n">mass</span><span class="p">(</span><span class="n">num_atoms_tot</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-58"></a>        <span class="n">mass</span> <span class="o">=</span> <span class="mf">1.0_rp</span>
<a name="ln-59"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-60"></a>            <span class="n">at_i</span> <span class="o">=</span> <span class="n">atoms</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-61"></a>            <span class="n">mass</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">atom_mass</span><span class="p">(</span><span class="n">at_i</span><span class="p">)</span>
<a name="ln-62"></a>        <span class="k">end do</span>
<a name="ln-63"></a><span class="k">    end if</span>
<a name="ln-64"></a>
<a name="ln-65"></a>    <span class="c">!In case of new simulation, need to assign MPCD atom positions.</span>
<a name="ln-66"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lrevive</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-67"></a><span class="k">        call </span><span class="n">simbox</span><span class="p">%</span><span class="n">get_rnd_points</span><span class="p">(</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">num_atoms</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">num_atoms_tot</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-68"></a>    <span class="k">end if</span>
<a name="ln-69"></a>
<a name="ln-70"></a>    <span class="c">!Allocate buffer for atoms in a cell. Setting it to thrice the average</span>
<a name="ln-71"></a>    <span class="c">!number of MPCD atoms per cell. Each atom has 7 quantities (mass,</span>
<a name="ln-72"></a>    <span class="c">!coordinates, &amp; velocities) associated with it. The buffer will be expanded</span>
<a name="ln-73"></a>    <span class="c">!if necessary.</span>
<a name="ln-74"></a>    <span class="k">allocate</span><span class="p">(</span> <span class="n">buf_aic</span><span class="p">(</span><span class="mi">7</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">mpcd_avnc</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-75"></a>    <span class="n">buf_aic</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-76"></a>
<a name="ln-77"></a>    <span class="c">!Opening trajectory file</span>
<a name="ln-78"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">write_traj</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-79"></a><span class="k">        if</span> <span class="p">(</span> <span class="n">lrevive</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-80"></a>            <span class="c">!Append (write) to existing (new) trajectory file</span>
<a name="ln-81"></a>            <span class="c">!Check if trajectory file exists</span>
<a name="ln-82"></a>            <span class="k">inquire</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="n">fn_traj</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="n">exist</span><span class="o">=</span><span class="n">lexists</span><span class="p">)</span>
<a name="ln-83"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">lexists</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-84"></a>                <span class="c">!Open existing file for appending</span>
<a name="ln-85"></a>                <span class="k">call </span><span class="n">traj</span><span class="p">%</span><span class="k">open</span><span class="p">(</span><span class="n">fn_traj</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="s1">&#39;rw&#39;</span><span class="p">,</span> <span class="n">ierr</span><span class="p">)</span>
<a name="ln-86"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-87"></a><span class="k">            else</span>
<a name="ln-88"></a>                <span class="c">!Create new trajectory file</span>
<a name="ln-89"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">traj_wmpcd</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-90"></a>                    <span class="c">!With MPCD data</span>
<a name="ln-91"></a>                    <span class="k">call </span><span class="n">traj</span><span class="p">%</span><span class="n">create</span><span class="p">(</span><span class="n">fn_traj</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-92"></a>                        <span class="n">num_atoms</span><span class="p">,</span> <span class="n">num_mpcd_atoms</span><span class="p">,</span> <span class="n">traj_frmcmp</span><span class="p">)</span>
<a name="ln-93"></a>                <span class="k">else</span>
<a name="ln-94"></a>                    <span class="c">!Without MPCD data</span>
<a name="ln-95"></a>                    <span class="k">call </span><span class="n">traj</span><span class="p">%</span><span class="n">create</span><span class="p">(</span><span class="n">fn_traj</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-96"></a>                        <span class="n">num_atoms</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">traj_frmcmp</span><span class="p">)</span>
<a name="ln-97"></a>                <span class="k">end if</span>
<a name="ln-98"></a><span class="k">            end if</span>
<a name="ln-99"></a><span class="k">        else</span>
<a name="ln-100"></a>            <span class="c">!Create new trajectory file</span>
<a name="ln-101"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">traj_wmpcd</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-102"></a>                <span class="c">!With MPCD data</span>
<a name="ln-103"></a>                <span class="k">call </span><span class="n">traj</span><span class="p">%</span><span class="n">create</span><span class="p">(</span><span class="n">fn_traj</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-104"></a>                    <span class="n">num_atoms</span><span class="p">,</span> <span class="n">num_mpcd_atoms</span><span class="p">,</span> <span class="n">traj_frmcmp</span><span class="p">)</span>
<a name="ln-105"></a>            <span class="k">else</span>
<a name="ln-106"></a>                <span class="c">!Without MPCD data</span>
<a name="ln-107"></a>                <span class="k">call </span><span class="n">traj</span><span class="p">%</span><span class="n">create</span><span class="p">(</span><span class="n">fn_traj</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-108"></a>                    <span class="n">num_atoms</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">traj_frmcmp</span><span class="p">)</span>
<a name="ln-109"></a>            <span class="k">end if</span>
<a name="ln-110"></a><span class="k">        end if</span>
<a name="ln-111"></a><span class="k">    end if</span>
<a name="ln-112"></a>
<a name="ln-113"></a><span class="k">    end subroutine</span>
<a name="ln-114"></a>
<a name="ln-115"></a><span class="c">!******************************************************************************</span>
<a name="ln-116"></a>
<a name="ln-117"></a><span class="k">subroutine </span><span class="n">mpcd_finish</span><span class="p">()</span>
<a name="ln-118"></a>    <span class="c">!! Clean up MPCD solver.</span>
<a name="ln-119"></a>
<a name="ln-120"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">mass</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">mass</span><span class="p">)</span>
<a name="ln-121"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">buf_aic</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">buf_aic</span><span class="p">)</span>
<a name="ln-122"></a>    <span class="k">call </span><span class="n">traj</span><span class="p">%</span><span class="k">close</span><span class="p">()</span>
<a name="ln-123"></a>
<a name="ln-124"></a>    <span class="k">end subroutine</span>
<a name="ln-125"></a>
<a name="ln-126"></a><span class="c">!******************************************************************************</span>
<a name="ln-127"></a>
<a name="ln-128"></a><span class="k">subroutine </span><span class="n">mpcd_run</span><span class="p">()</span>
<a name="ln-129"></a>    <span class="c">!! Driver for MPCD integrator.</span>
<a name="ln-130"></a>    <span class="c">!!</span>
<a name="ln-131"></a>    <span class="c">!! Repeatedly calls [[mpcd_stream]] and [[mpcd_collide]] to update atom</span>
<a name="ln-132"></a>    <span class="c">!! positions.</span>
<a name="ln-133"></a>    <span class="c">!!</span>
<a name="ln-134"></a>    <span class="c">!! Handling of flow field is not imlemented yet. If a non-zero `flow_style`</span>
<a name="ln-135"></a>    <span class="c">!! is specified, it will be set to zero.</span>
<a name="ln-136"></a>
<a name="ln-137"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-138"></a>
<a name="ln-139"></a>    <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-140"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">flow_style</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">flow_style</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-141"></a>
<a name="ln-142"></a>    <span class="c">!Log &amp; dump starting configuration</span>
<a name="ln-143"></a>    <span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;mpcd_run&#39;</span><span class="p">,</span> <span class="s1">&#39; nts: &#39;</span><span class="o">//</span><span class="n">str_from_num</span><span class="p">(</span><span class="n">nts</span><span class="p">))</span>
<a name="ln-144"></a>    <span class="k">call </span><span class="n">write_dump</span><span class="p">(</span><span class="n">fn_revive</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)))</span>
<a name="ln-145"></a>
<a name="ln-146"></a>    <span class="c">!Equilibration run</span>
<a name="ln-147"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">leql</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-148"></a><span class="k">        do while</span> <span class="p">(</span><span class="n">nts</span> <span class="o">&lt;</span> <span class="n">nts_eql</span><span class="p">)</span>
<a name="ln-149"></a>            <span class="c">!Streaming</span>
<a name="ln-150"></a>            <span class="k">call </span><span class="n">mpcd_stream</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-151"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-152"></a>
<a name="ln-153"></a>            <span class="c">!Collision</span>
<a name="ln-154"></a>            <span class="k">call </span><span class="n">mpcd_collide</span><span class="p">()</span>
<a name="ln-155"></a>
<a name="ln-156"></a>            <span class="n">nts</span> <span class="o">=</span> <span class="n">nts</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-157"></a>
<a name="ln-158"></a>            <span class="c">!Logging</span>
<a name="ln-159"></a>            <span class="k">if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span><span class="n">nts_log</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-160"></a><span class="k">                call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;mpcd_run&#39;</span><span class="p">,</span> <span class="s1">&#39; nts: &#39;</span><span class="o">//</span><span class="n">str_from_num</span><span class="p">(</span><span class="n">nts</span><span class="p">))</span>
<a name="ln-161"></a>            <span class="k">end if</span>
<a name="ln-162"></a>
<a name="ln-163"></a>            <span class="c">!Dump revive file</span>
<a name="ln-164"></a>            <span class="k">if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span><span class="n">nts_dump</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-165"></a><span class="k">                call </span><span class="n">write_dump</span><span class="p">(</span><span class="n">fn_revive</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)))</span>
<a name="ln-166"></a>            <span class="k">end if</span>
<a name="ln-167"></a>
<a name="ln-168"></a>            <span class="c">!Equilibration stats</span>
<a name="ln-169"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">write_eql_stats</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-170"></a><span class="k">                if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span><span class="n">nts_eql_samp</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">stats_write</span><span class="p">()</span>
<a name="ln-171"></a>            <span class="k">end if</span>
<a name="ln-172"></a><span class="k">        end do</span>
<a name="ln-173"></a>
<a name="ln-174"></a><span class="k">        call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;finish_equil_run&#39;</span><span class="p">,</span> <span class="s1">&#39;Equilibration completed&#39;</span><span class="p">)</span>
<a name="ln-175"></a>        <span class="k">call </span><span class="n">stats_finish</span><span class="p">()</span>
<a name="ln-176"></a>        <span class="k">call </span><span class="n">write_dump</span><span class="p">(</span><span class="n">fn_revive</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)))</span>
<a name="ln-177"></a>        <span class="n">leql</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-178"></a>        <span class="n">nts</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-179"></a>        <span class="c">!If continue on to production run, create new stats file.</span>
<a name="ln-180"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">nts_sim</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">stats_init</span><span class="p">()</span>
<a name="ln-181"></a>    <span class="k">end if</span>
<a name="ln-182"></a>
<a name="ln-183"></a>    <span class="c">!Production run</span>
<a name="ln-184"></a>    <span class="k">do while</span> <span class="p">(</span><span class="n">nts</span> <span class="o">&lt;</span> <span class="n">nts_sim</span><span class="p">)</span>
<a name="ln-185"></a>        <span class="k">call </span><span class="n">mpcd_stream</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-186"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-187"></a>
<a name="ln-188"></a><span class="k">        call </span><span class="n">mpcd_collide</span><span class="p">()</span>
<a name="ln-189"></a>
<a name="ln-190"></a>        <span class="n">nts</span> <span class="o">=</span> <span class="n">nts</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-191"></a>
<a name="ln-192"></a>        <span class="c">!Logging</span>
<a name="ln-193"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span><span class="n">nts_log</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-194"></a><span class="k">            call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;mpcd_run&#39;</span><span class="p">,</span> <span class="s1">&#39; nts: &#39;</span><span class="o">//</span><span class="n">str_from_num</span><span class="p">(</span><span class="n">nts</span><span class="p">))</span>
<a name="ln-195"></a>        <span class="k">end if</span>
<a name="ln-196"></a>
<a name="ln-197"></a>        <span class="c">!Dump revive file</span>
<a name="ln-198"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span><span class="n">nts_dump</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-199"></a><span class="k">            call </span><span class="n">write_dump</span><span class="p">(</span><span class="n">fn_revive</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)))</span>
<a name="ln-200"></a>        <span class="k">end if</span>
<a name="ln-201"></a>
<a name="ln-202"></a><span class="k">        if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span><span class="n">nts_samp</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-203"></a>            <span class="c">!Write stats</span>
<a name="ln-204"></a>            <span class="k">call </span><span class="n">stats_write</span><span class="p">()</span>
<a name="ln-205"></a>            <span class="c">!Write traj</span>
<a name="ln-206"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">write_traj</span><span class="p">)</span> <span class="k">call </span><span class="n">traj</span><span class="p">%</span><span class="n">append_frame</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-207"></a>                <span class="n">velocities</span><span class="p">,</span> <span class="n">forces</span><span class="p">,</span> <span class="n">charge</span><span class="p">)</span>
<a name="ln-208"></a>        <span class="k">end if</span>
<a name="ln-209"></a><span class="k">    end do</span>
<a name="ln-210"></a>    <span class="c">!Dump the final configuration</span>
<a name="ln-211"></a>    <span class="k">call </span><span class="n">write_dump</span><span class="p">(</span><span class="n">fn_revive</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)))</span>
<a name="ln-212"></a>
<a name="ln-213"></a>    <span class="k">end subroutine</span>
<a name="ln-214"></a>
<a name="ln-215"></a><span class="c">!******************************************************************************</span>
<a name="ln-216"></a>
<a name="ln-217"></a><span class="k">subroutine </span><span class="n">mpcd_stream</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-218"></a>    <span class="c">!! Performs one step of streaming.</span>
<a name="ln-219"></a>
<a name="ln-220"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-221"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dt_md</span>
<a name="ln-222"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">half_dt</span>
<a name="ln-223"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">istp</span>
<a name="ln-224"></a>
<a name="ln-225"></a>    <span class="n">dt_md</span> <span class="o">=</span> <span class="n">tim_stp</span><span class="o">/</span><span class="n">nts_md</span>
<a name="ln-226"></a>    <span class="n">half_dt</span> <span class="o">=</span> <span class="mf">0.5_rp</span><span class="o">*</span><span class="n">dt_md</span>
<a name="ln-227"></a>    <span class="n">istp</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-228"></a>
<a name="ln-229"></a>    <span class="c">!Set cell size to collision cells</span>
<a name="ln-230"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">use_cell_list</span><span class="p">)</span> <span class="k">call </span><span class="n">cl_set_cell_size</span><span class="p">(</span><span class="n">rcutoff</span><span class="p">)</span>
<a name="ln-231"></a>
<a name="ln-232"></a>    <span class="c">!Setting these to zero for the case num_atoms = 0.</span>
<a name="ln-233"></a>    <span class="n">energy_tot</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-234"></a>    <span class="n">stress</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-235"></a>
<a name="ln-236"></a>    <span class="c">!Update non-MPCD atoms via MD steps</span>
<a name="ln-237"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_atoms</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-238"></a><span class="k">        do while</span> <span class="p">(</span><span class="n">istp</span> <span class="o">&lt;</span> <span class="n">nts_md</span><span class="p">)</span>
<a name="ln-239"></a>            <span class="c">!Update velocities over a half-step</span>
<a name="ln-240"></a>            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-241"></a>                <span class="n">velocities</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">velocities</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">half_dt</span><span class="o">*</span><span class="n">forces</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">mass</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-242"></a>            <span class="k">end do</span>
<a name="ln-243"></a>
<a name="ln-244"></a>            <span class="c">!Update position over full step</span>
<a name="ln-245"></a>            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-246"></a>                <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">dt_md</span><span class="o">*</span><span class="n">velocities</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-247"></a>            <span class="k">end do</span>
<a name="ln-248"></a>
<a name="ln-249"></a>            <span class="c">!Wrap around periodic boundaries</span>
<a name="ln-250"></a>            <span class="k">call </span><span class="n">simbox</span><span class="p">%</span><span class="n">wrap_all</span><span class="p">(</span><span class="n">coordinates</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">num_atoms</span><span class="p">))</span>
<a name="ln-251"></a>
<a name="ln-252"></a>            <span class="c">!Update forces over full step</span>
<a name="ln-253"></a>            <span class="k">call </span><span class="n">ia_calc_forces</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-254"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-255"></a>
<a name="ln-256"></a>            <span class="c">!Update velocities over full step</span>
<a name="ln-257"></a>            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-258"></a>                <span class="n">velocities</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">velocities</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">half_dt</span><span class="o">*</span><span class="n">forces</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">mass</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-259"></a>            <span class="k">end do</span>
<a name="ln-260"></a>
<a name="ln-261"></a><span class="k">            </span><span class="n">istp</span> <span class="o">=</span> <span class="n">istp</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-262"></a>        <span class="k">end do</span>
<a name="ln-263"></a><span class="k">    end if</span>
<a name="ln-264"></a>
<a name="ln-265"></a>    <span class="c">!Update MPCD particles over a streaming step</span>
<a name="ln-266"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">num_atoms</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms_tot</span>
<a name="ln-267"></a>        <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">tim_stp</span><span class="o">*</span><span class="n">velocities</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-268"></a>    <span class="k">end do</span>
<a name="ln-269"></a>
<a name="ln-270"></a>    <span class="c">!Wrap MPCD particles around periodic boundaries</span>
<a name="ln-271"></a>    <span class="k">call </span><span class="n">simbox</span><span class="p">%</span><span class="n">wrap_all</span><span class="p">(</span><span class="n">coordinates</span><span class="p">(:,</span><span class="n">num_atoms</span><span class="o">+</span><span class="mi">1</span><span class="p">:))</span>
<a name="ln-272"></a>
<a name="ln-273"></a>    <span class="k">end subroutine</span>
<a name="ln-274"></a>
<a name="ln-275"></a><span class="c">!******************************************************************************</span>
<a name="ln-276"></a>
<a name="ln-277"></a><span class="k">subroutine </span><span class="n">mpcd_collide</span><span class="p">()</span>
<a name="ln-278"></a>    <span class="c">!! Performs one step of MPCD collision.</span>
<a name="ln-279"></a>
<a name="ln-280"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gsv</span>
<a name="ln-281"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">,</span> <span class="n">com</span><span class="p">,</span> <span class="n">vcom</span><span class="p">,</span> <span class="n">vrcom</span>
<a name="ln-282"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">angmom</span><span class="p">,</span> <span class="n">angvel</span>
<a name="ln-283"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mat_mi</span><span class="p">,</span> <span class="n">inv_mat_mi</span>
<a name="ln-284"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">stress_kin</span>
<a name="ln-285"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">aic</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-286"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mass_tot</span><span class="p">,</span> <span class="n">massi</span><span class="p">,</span> <span class="n">var</span>
<a name="ln-287"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">num_cells</span><span class="p">,</span> <span class="n">na_cell</span>
<a name="ln-288"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ofstc</span><span class="p">,</span> <span class="n">ofstv</span>
<a name="ln-289"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">iatm</span><span class="p">,</span> <span class="n">icell</span><span class="p">,</span> <span class="n">ibeg</span><span class="p">,</span> <span class="n">iend</span>
<a name="ln-290"></a>
<a name="ln-291"></a>    <span class="c">!Grid shift vector</span>
<a name="ln-292"></a>    <span class="k">call </span><span class="n">get_rv_uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5_rp</span><span class="p">,</span> <span class="mf">0.5_rp</span><span class="p">,</span> <span class="n">gsv</span><span class="p">)</span>
<a name="ln-293"></a>
<a name="ln-294"></a>    <span class="c">!Forward shift</span>
<a name="ln-295"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms_tot</span>
<a name="ln-296"></a>        <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">gsv</span>
<a name="ln-297"></a>    <span class="k">end do</span>
<a name="ln-298"></a>
<a name="ln-299"></a>    <span class="c">!Wrap around periodic boundaries</span>
<a name="ln-300"></a>    <span class="k">call </span><span class="n">simbox</span><span class="p">%</span><span class="n">wrap_all</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
<a name="ln-301"></a>
<a name="ln-302"></a>    <span class="c">!Set cell size to collision cells</span>
<a name="ln-303"></a>    <span class="k">call </span><span class="n">cl_set_cell_size</span><span class="p">(</span><span class="mf">1.0_rp</span><span class="p">)</span>
<a name="ln-304"></a>    <span class="k">call </span><span class="n">cl_build</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
<a name="ln-305"></a>
<a name="ln-306"></a>    <span class="n">num_cells</span> <span class="o">=</span> <span class="n">cl_get_num_cells</span><span class="p">()</span>
<a name="ln-307"></a>
<a name="ln-308"></a>    <span class="c">!Momentum exchange via collision, velocity update (MPC-AT+a version)</span>
<a name="ln-309"></a>
<a name="ln-310"></a>    <span class="c">!Loop over all collision cells</span>
<a name="ln-311"></a>    <span class="k">do </span><span class="n">icell</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">num_cells</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-312"></a>        <span class="c">!Get cell contents</span>
<a name="ln-313"></a>        <span class="k">call </span><span class="n">cl_get_contents</span><span class="p">(</span><span class="n">icell</span><span class="p">,</span> <span class="n">aic</span><span class="p">)</span>
<a name="ln-314"></a>
<a name="ln-315"></a>        <span class="c">!Number of atoms in cell</span>
<a name="ln-316"></a>        <span class="n">na_cell</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">aic</span><span class="p">)</span>
<a name="ln-317"></a>
<a name="ln-318"></a>        <span class="c">!For fewer than 2 atoms, no need for relative velocities.</span>
<a name="ln-319"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">na_cell</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">cycle</span>
<a name="ln-320"></a>
<a name="ln-321"></a>        <span class="c">!Check if cell velocity buffer needs to be expanded</span>
<a name="ln-322"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">size</span><span class="p">(</span><span class="n">buf_aic</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="o">*</span><span class="n">na_cell</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-323"></a><span class="k">            deallocate</span><span class="p">(</span><span class="n">buf_aic</span><span class="p">)</span>
<a name="ln-324"></a>            <span class="k">allocate</span><span class="p">(</span> <span class="n">buf_aic</span><span class="p">(</span><span class="mi">7</span><span class="o">*</span><span class="n">na_cell</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-325"></a>        <span class="k">end if</span>
<a name="ln-326"></a>        
<a name="ln-327"></a>        <span class="c">!Populate buf_aic</span>
<a name="ln-328"></a>        <span class="n">ofstc</span> <span class="o">=</span> <span class="n">na_cell</span><span class="p">;</span> <span class="n">ofstv</span> <span class="o">=</span> <span class="n">na_cell</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">na_cell</span>
<a name="ln-329"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">aic</span><span class="p">)</span>
<a name="ln-330"></a>            <span class="n">iatm</span> <span class="o">=</span> <span class="n">aic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-331"></a>            <span class="n">buf_aic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">mass</span><span class="p">(</span><span class="n">iatm</span><span class="p">)</span>
<a name="ln-332"></a>
<a name="ln-333"></a>            <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstc</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstc</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-334"></a>            <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">iatm</span><span class="p">)</span>
<a name="ln-335"></a>
<a name="ln-336"></a>            <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-337"></a>            <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span> <span class="o">=</span> <span class="n">velocities</span><span class="p">(:,</span><span class="n">iatm</span><span class="p">)</span>
<a name="ln-338"></a>        <span class="k">end do</span>
<a name="ln-339"></a>
<a name="ln-340"></a>        <span class="c">!Total mass, center-of-mass, &amp; c.o.m. velocity</span>
<a name="ln-341"></a>        <span class="n">com</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">vcom</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">mass_tot</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-342"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na_cell</span>
<a name="ln-343"></a>            <span class="n">mass_tot</span> <span class="o">=</span> <span class="n">mass_tot</span> <span class="o">+</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-344"></a>
<a name="ln-345"></a>            <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstc</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstc</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-346"></a>            <span class="n">com</span> <span class="o">=</span> <span class="n">com</span> <span class="o">+</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span>
<a name="ln-347"></a>
<a name="ln-348"></a>            <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-349"></a>            <span class="n">vcom</span> <span class="o">=</span> <span class="n">vcom</span> <span class="o">+</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span>
<a name="ln-350"></a>        <span class="k">end do</span>
<a name="ln-351"></a><span class="k">        </span><span class="n">com</span> <span class="o">=</span> <span class="n">com</span><span class="o">/</span><span class="n">mass_tot</span>
<a name="ln-352"></a>        <span class="n">vcom</span> <span class="o">=</span> <span class="n">vcom</span><span class="o">/</span><span class="n">mass_tot</span>
<a name="ln-353"></a>
<a name="ln-354"></a>        <span class="c">!Draw relative velocities &amp; store in the buf_aic. This overwrites the</span>
<a name="ln-355"></a>        <span class="c">!existing velocities.</span>
<a name="ln-356"></a>        <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">na_cell</span>
<a name="ln-357"></a>        <span class="k">call </span><span class="n">get_rv_gaussian</span><span class="p">(</span> <span class="mf">0.0_rp</span><span class="p">,</span> <span class="mf">1.0_rp</span><span class="p">,</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-358"></a>        <span class="c">!Multiply by the variance, i.e. kT/m</span>
<a name="ln-359"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na_cell</span>
<a name="ln-360"></a>            <span class="n">var</span> <span class="o">=</span> <span class="mf">1.0_rp</span><span class="o">/</span><span class="n">buf_aic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-361"></a>            <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-362"></a>            <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span> <span class="o">=</span> <span class="n">var</span><span class="o">*</span><span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span>
<a name="ln-363"></a>        <span class="k">end do</span>
<a name="ln-364"></a>
<a name="ln-365"></a>        <span class="c">!Calcuate the mean of the relative velocities.</span>
<a name="ln-366"></a>        <span class="n">vrcom</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-367"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na_cell</span>
<a name="ln-368"></a>            <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-369"></a>            <span class="n">vrcom</span> <span class="o">=</span> <span class="n">vrcom</span> <span class="o">+</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span>
<a name="ln-370"></a>        <span class="k">end do</span>
<a name="ln-371"></a><span class="k">        </span><span class="n">vrcom</span> <span class="o">=</span> <span class="n">vrcom</span><span class="o">/</span><span class="n">mass_tot</span>
<a name="ln-372"></a>
<a name="ln-373"></a>        <span class="c">!Subtract off the c.o.m. position &amp; vrcom</span>
<a name="ln-374"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na_cell</span>
<a name="ln-375"></a>            <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstc</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstc</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-376"></a>            <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span> <span class="o">=</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span> <span class="o">-</span> <span class="n">com</span>
<a name="ln-377"></a>
<a name="ln-378"></a>            <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-379"></a>            <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span> <span class="o">=</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span> <span class="o">-</span> <span class="n">vrcom</span>
<a name="ln-380"></a>        <span class="k">end do</span>
<a name="ln-381"></a>
<a name="ln-382"></a>        <span class="c">!Add the relative velocities to the c.o.m. velocity. This produces new</span>
<a name="ln-383"></a>        <span class="c">!velocities that do not conserve angular momentum, i.e. this is</span>
<a name="ln-384"></a>        <span class="c">!MPC-AT-a.</span>
<a name="ln-385"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na_cell</span>
<a name="ln-386"></a>            <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-387"></a>            <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span> <span class="o">=</span>  <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span> <span class="o">+</span> <span class="n">vcom</span>
<a name="ln-388"></a>        <span class="k">end do</span>
<a name="ln-389"></a>
<a name="ln-390"></a>        <span class="c">!For only two atoms in the cell, the above is equivalent to MPC-AT+a.</span>
<a name="ln-391"></a>        <span class="c">!Just copy the velocities back and move on to the next cell.</span>
<a name="ln-392"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">na_cell</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-393"></a>            <span class="c">!Explicitly unrolling the loop over i as i = 1 &amp; i = 2.</span>
<a name="ln-394"></a>            <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">iatm</span> <span class="o">=</span> <span class="n">aic</span><span class="p">(</span><span class="n">i</span><span class="p">);</span> <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-395"></a>            <span class="n">velocities</span><span class="p">(:,</span><span class="n">iatm</span><span class="p">)</span> <span class="o">=</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span>
<a name="ln-396"></a>            <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">iatm</span> <span class="o">=</span> <span class="n">aic</span><span class="p">(</span><span class="n">i</span><span class="p">);</span> <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-397"></a>            <span class="n">velocities</span><span class="p">(:,</span><span class="n">iatm</span><span class="p">)</span> <span class="o">=</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span>
<a name="ln-398"></a>            <span class="k">cycle</span>
<a name="ln-399"></a><span class="k">        end if</span>
<a name="ln-400"></a>
<a name="ln-401"></a>        <span class="c">!Calculate moment of intertia matrix (symmetric) about the c.o.m. and angular</span>
<a name="ln-402"></a>        <span class="c">!momentum.</span>
<a name="ln-403"></a>        <span class="n">mat_mi</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">angmom</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-404"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na_cell</span>
<a name="ln-405"></a>            <span class="n">massi</span> <span class="o">=</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-406"></a>            <span class="n">ri</span> <span class="o">=</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">ofstc</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">ofstc</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<a name="ln-407"></a>            <span class="n">mat_mi</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_mi</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="p">(</span> <span class="n">ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ri</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>
<a name="ln-408"></a>            <span class="n">mat_mi</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_mi</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">massi</span><span class="o">*</span><span class="p">(</span> <span class="n">ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ri</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-409"></a>            <span class="n">mat_mi</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_mi</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">massi</span><span class="o">*</span><span class="p">(</span> <span class="n">ri</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">ri</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-410"></a>            <span class="n">mat_mi</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_mi</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="p">(</span> <span class="n">ri</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ri</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>
<a name="ln-411"></a>            <span class="n">mat_mi</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_mi</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">massi</span><span class="o">*</span><span class="p">(</span> <span class="n">ri</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-412"></a>            <span class="n">mat_mi</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_mi</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="p">(</span> <span class="n">ri</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>
<a name="ln-413"></a>
<a name="ln-414"></a>            <span class="n">vi</span> <span class="o">=</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<a name="ln-415"></a>            <span class="k">call </span><span class="n">cross</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">,</span> <span class="n">vrcom</span><span class="p">)</span> <span class="c">!Using vrcom as a buffer here</span>
<a name="ln-416"></a>            <span class="n">angmom</span> <span class="o">=</span> <span class="n">angmom</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="n">vrcom</span>
<a name="ln-417"></a>        <span class="k">end do</span>
<a name="ln-418"></a>        <span class="c">!Update the symmetric elements</span>
<a name="ln-419"></a>        <span class="n">mat_mi</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_mi</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-420"></a>        <span class="n">mat_mi</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_mi</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-421"></a>        <span class="n">mat_mi</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_mi</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-422"></a>
<a name="ln-423"></a>        <span class="c">!Solve for angular velocity. If the mat_mi is singular, do a least</span>
<a name="ln-424"></a>        <span class="c">!squares solutions. Else, get the explicit inverse and multiply.</span>
<a name="ln-425"></a>        <span class="c">!Checking determinant against a small value 1E-8.</span>
<a name="ln-426"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">det</span><span class="p">(</span><span class="n">mat_mi</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0E-10_rp</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-427"></a>            <span class="c">!Invert the moment of inertia matrix</span>
<a name="ln-428"></a>            <span class="k">call </span><span class="n">invert_mat33</span><span class="p">(</span><span class="n">mat_mi</span><span class="p">,</span> <span class="n">inv_mat_mi</span><span class="p">)</span>
<a name="ln-429"></a>            <span class="c">!Solve for angular velocity</span>
<a name="ln-430"></a>            <span class="n">angvel</span> <span class="o">=</span> <span class="nb">matmul</span><span class="p">(</span><span class="n">inv_mat_mi</span><span class="p">,</span> <span class="o">-</span><span class="n">angmom</span><span class="p">)</span>
<a name="ln-431"></a>        <span class="k">else</span>
<a name="ln-432"></a>            <span class="c">!TODO: The following must be replaced with a more efficient SVD</span>
<a name="ln-433"></a>            <span class="c">!routine for 3 x 3 matrices. As of now, calling LAPACK for</span>
<a name="ln-434"></a>            <span class="c">!least-squares solution.</span>
<a name="ln-435"></a>            <span class="n">angmom</span> <span class="o">=</span> <span class="o">-</span><span class="n">angmom</span>
<a name="ln-436"></a>            <span class="k">call </span><span class="n">gelsy</span><span class="p">(</span><span class="n">mat_mi</span><span class="p">,</span> <span class="n">angmom</span><span class="p">)</span>
<a name="ln-437"></a>            <span class="n">angvel</span> <span class="o">=</span> <span class="n">angmom</span>
<a name="ln-438"></a>        <span class="k">end if</span>
<a name="ln-439"></a>
<a name="ln-440"></a>        <span class="c">!Correct velocities to enforce angular mometum conservation</span>
<a name="ln-441"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na_cell</span>
<a name="ln-442"></a>            <span class="n">iatm</span> <span class="o">=</span> <span class="n">aic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-443"></a>            <span class="n">massi</span> <span class="o">=</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-444"></a>            <span class="n">ri</span> <span class="o">=</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">ofstc</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">ofstc</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<a name="ln-445"></a>            <span class="k">call </span><span class="n">cross</span><span class="p">(</span><span class="n">angvel</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">)</span> <span class="c">!Using vi as a buffer here</span>
<a name="ln-446"></a>             
<a name="ln-447"></a>            <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-448"></a>            <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span> <span class="o">=</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span> <span class="o">+</span> <span class="n">vi</span>
<a name="ln-449"></a>        <span class="k">end do</span>
<a name="ln-450"></a>
<a name="ln-451"></a>        <span class="c">!Copy back</span>
<a name="ln-452"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na_cell</span>
<a name="ln-453"></a>            <span class="n">iatm</span> <span class="o">=</span> <span class="n">aic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-454"></a>            <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-455"></a>            <span class="n">velocities</span><span class="p">(:,</span><span class="n">iatm</span><span class="p">)</span> <span class="o">=</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span>
<a name="ln-456"></a>        <span class="k">end do</span>
<a name="ln-457"></a><span class="k">    end do</span>
<a name="ln-458"></a>
<a name="ln-459"></a>    <span class="c">!Reverse shift</span>
<a name="ln-460"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms_tot</span>
<a name="ln-461"></a>        <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">gsv</span>
<a name="ln-462"></a>    <span class="k">end do</span>
<a name="ln-463"></a>
<a name="ln-464"></a>    <span class="c">!Wrap around periodic boundaries</span>
<a name="ln-465"></a>    <span class="k">call </span><span class="n">simbox</span><span class="p">%</span><span class="n">wrap_all</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
<a name="ln-466"></a>
<a name="ln-467"></a>    <span class="c">!Update energy and stress</span>
<a name="ln-468"></a>    <span class="n">energy_kin</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-469"></a>    <span class="n">stress_kin</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-470"></a>    <span class="n">stress_slvnt</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-471"></a>
<a name="ln-472"></a>    <span class="n">mass_tot</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">com</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">vcom</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-473"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms_tot</span>
<a name="ln-474"></a>        <span class="n">massi</span> <span class="o">=</span> <span class="n">mass</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-475"></a>        <span class="n">mass_tot</span> <span class="o">=</span> <span class="n">mass_tot</span> <span class="o">+</span> <span class="n">massi</span>
<a name="ln-476"></a>        <span class="n">com</span> <span class="o">=</span> <span class="n">com</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-477"></a>        <span class="n">vcom</span> <span class="o">=</span> <span class="n">vcom</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="n">velocities</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-478"></a>    <span class="k">end do</span>
<a name="ln-479"></a><span class="k">    </span><span class="n">com</span> <span class="o">=</span> <span class="n">com</span><span class="o">/</span><span class="n">mass_tot</span>
<a name="ln-480"></a>    <span class="n">vcom</span> <span class="o">=</span> <span class="n">vcom</span><span class="o">/</span><span class="n">mass_tot</span>
<a name="ln-481"></a>
<a name="ln-482"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-483"></a>        <span class="n">massi</span> <span class="o">=</span> <span class="n">mass</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-484"></a>        <span class="n">energy_kin</span> <span class="o">=</span> <span class="n">energy_kin</span> <span class="o">+</span> <span class="mf">0.5_rp</span><span class="o">*</span><span class="n">massi</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">velocities</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-485"></a>
<a name="ln-486"></a>        <span class="n">vi</span> <span class="o">=</span> <span class="n">velocities</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">vcom</span>
<a name="ln-487"></a>        <span class="n">stress_kin</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_kin</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-488"></a>        <span class="n">stress_kin</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_kin</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-489"></a>        <span class="n">stress_kin</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_kin</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-490"></a>
<a name="ln-491"></a>        <span class="n">stress_kin</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_kin</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-492"></a>        <span class="n">stress_kin</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_kin</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-493"></a>        <span class="n">stress_kin</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_kin</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-494"></a>
<a name="ln-495"></a>        <span class="n">stress_kin</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_kin</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-496"></a>        <span class="n">stress_kin</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_kin</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-497"></a>        <span class="n">stress_kin</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_kin</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-498"></a>    <span class="k">end do</span>
<a name="ln-499"></a>
<a name="ln-500"></a><span class="k">    do </span><span class="n">i</span> <span class="o">=</span> <span class="n">num_atoms</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms_tot</span>
<a name="ln-501"></a>        <span class="c">!Mass of MPCD particles is 1 (non-dimensionalized form).</span>
<a name="ln-502"></a>        <span class="n">energy_kin</span> <span class="o">=</span> <span class="n">energy_kin</span> <span class="o">+</span> <span class="mf">0.5_rp</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">velocities</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-503"></a>
<a name="ln-504"></a>        <span class="n">vi</span> <span class="o">=</span> <span class="n">velocities</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">vcom</span>
<a name="ln-505"></a>        <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-506"></a>        <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-507"></a>        <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-508"></a>
<a name="ln-509"></a>        <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-510"></a>        <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-511"></a>        <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-512"></a>
<a name="ln-513"></a>        <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-514"></a>        <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-515"></a>        <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-516"></a>    <span class="k">end do</span>
<a name="ln-517"></a><span class="k">    </span><span class="n">energy_tot</span> <span class="o">=</span> <span class="n">energy_tot</span> <span class="o">+</span> <span class="n">energy_kin</span>
<a name="ln-518"></a>
<a name="ln-519"></a>    <span class="n">stress_kin</span> <span class="o">=</span> <span class="n">stress_kin</span><span class="o">/</span><span class="n">simbox</span><span class="p">%</span><span class="n">volume</span>
<a name="ln-520"></a>    <span class="n">stress</span> <span class="o">=</span> <span class="n">stress</span> <span class="o">+</span> <span class="n">stress_kin</span>
<a name="ln-521"></a>    <span class="n">stress_slvnt</span> <span class="o">=</span> <span class="n">stress_slvnt</span><span class="o">/</span><span class="n">simbox</span><span class="p">%</span><span class="n">volume</span>
<a name="ln-522"></a>
<a name="ln-523"></a>    <span class="k">end subroutine</span>
<a name="ln-524"></a>
<a name="ln-525"></a><span class="c">!******************************************************************************</span>
<a name="ln-526"></a>
<a name="ln-527"></a><span class="k">end module </span><span class="n">m_mpcd</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> BROWNPAK was developed by Sarit Dutta</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>