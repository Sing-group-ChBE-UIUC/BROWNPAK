<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for BROWNPAK">
   
    <meta name="author" content="Sarit Dutta" >
    <link rel="icon" href="../favicon.png">

    <title>m_mpcd.f90 &ndash; BROWNPAK</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">BROWNPAK <small>0.2</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>m_mpcd.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 5.4% of total for source files.">337 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/m_mpcd.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">m_mpcd.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_mpcd.html">m_mpcd</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_mpcd.f90.html#src">m_mpcd.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_mpcd.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilem_mpcdf90EfferentGraph" width="641pt" height="615pt"
 viewBox="0.00 0.00 641.00 615.21" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph" class="graph" transform="scale(.7436 .7436) rotate(0) translate(4 823.3182)">
<title>sourcefile~~m_mpcd.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-823.3182 858,-823.3182 858,4 -4,4"/>
<!-- sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~m_mpcd.f90</title>
<polygon fill="none" stroke="#000000" points="854,-351.9675 784,-351.9675 784,-327.9675 854,-327.9675 854,-351.9675"/>
<text text-anchor="middle" x="819" y="-337.5675" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_mpcd.f90</text>
</g>
<!-- sourcefile~m_strings.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~m_strings.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/m_strings.f90.html" xlink:title="m_strings.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="483,-769.9675 407,-769.9675 407,-745.9675 483,-745.9675 483,-769.9675"/>
<text text-anchor="middle" x="445" y="-755.5675" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_strings.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_strings.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_strings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M569.5,-723.9675C542.1912,-727.5704 512.3994,-735.5539 488.8073,-742.8797"/>
<polygon fill="#ff0000" stroke="#ff0000" points="487.5715,-739.5998 479.1013,-745.9643 489.6917,-746.271 487.5715,-739.5998"/>
</g>
<!-- sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~m_globals.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/m_globals.f90.html" xlink:title="m_globals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="484,-453.9675 406,-453.9675 406,-429.9675 484,-429.9675 484,-453.9675"/>
<text text-anchor="middle" x="445" y="-439.5675" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_globals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M817.2072,-352.2337C808.263,-411.4147 766.3041,-666.1372 701.5,-703.9675"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M701.5,-703.9675C616.6821,-753.4811 690.7015,-566.0837 619,-498.9675 584.8079,-466.9619 532.3389,-452.9163 493.956,-446.759"/>
<polygon fill="#ff0000" stroke="#ff0000" points="494.4313,-443.2913 484.0267,-445.2901 493.4068,-450.216 494.4313,-443.2913"/>
</g>
<!-- sourcefile~m_utils_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~m_utils_math.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/m_utils_math.f90.html" xlink:title="m_utils_math.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="370,-769.9675 278,-769.9675 278,-745.9675 370,-745.9675 370,-769.9675"/>
<text text-anchor="middle" x="324" y="-755.5675" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_utils_math.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_utils_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_utils_math.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M569.5,-723.9675C497.2303,-733.5023 477.9056,-724.9922 406,-736.9675 395.9978,-738.6333 385.4304,-740.9267 375.329,-743.3884"/>
<polygon fill="#ff0000" stroke="#ff0000" points="374.2606,-740.0482 365.4212,-745.8891 375.9737,-746.8353 374.2606,-740.0482"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M701.5,-703.9675C650.8884,-734.9394 628.0718,-714.4739 569.5,-723.9675"/>
</g>
<!-- sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~m_constants_math.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/m_constants_math.f90.html" xlink:title="m_constants_math.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="242,-555.9675 123,-555.9675 123,-531.9675 242,-531.9675 242,-555.9675"/>
<text text-anchor="middle" x="182.5" y="-541.5675" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_constants_math.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M701.5,-703.9675C666.5754,-725.3396 656.8068,-678.6882 619,-662.9675 581.3003,-647.2913 485.3738,-610.0475 445,-603.9675"/>
</g>
<!-- sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~m_cell_list.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/m_cell_list.f90.html" xlink:title="m_cell_list.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="609,-61.9675 530,-61.9675 530,-37.9675 609,-37.9675 609,-61.9675"/>
<text text-anchor="middle" x="569.5" y="-47.5675" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_cell_list.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_cell_list.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M701.5,-130.9675C666.6698,-101.9432 658.4573,-93.2986 619,-70.9675 616.1565,-69.3582 613.1653,-67.7964 610.1199,-66.2992"/>
<polygon fill="#ff0000" stroke="#ff0000" points="611.458,-63.0616 600.9146,-62.0186 608.5063,-69.4089 611.458,-63.0616"/>
</g>
<!-- sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~m_logger.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/m_logger.f90.html" xlink:title="m_logger.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="219.5,-335.9675 145.5,-335.9675 145.5,-311.9675 219.5,-311.9675 219.5,-335.9675"/>
<text text-anchor="middle" x="182.5" y="-321.5675" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_logger.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_logger.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M324,-249.9675C281.8996,-263.8632 237.1795,-289.2758 209.5422,-306.3935"/>
<polygon fill="#ff0000" stroke="#ff0000" points="207.4589,-303.5688 200.8529,-311.852 211.1825,-309.4963 207.4589,-303.5688"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M701.5,-130.9675C699.3884,-129.2079 326.6102,-249.106 324,-249.9675"/>
</g>
<!-- sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~m_precision.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/m_precision.f90.html" xlink:title="m_precision.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="87,-395.9675 0,-395.9675 0,-371.9675 87,-371.9675 87,-395.9675"/>
<text text-anchor="middle" x="43.5" y="-381.5675" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_precision.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M701.5,-703.9675C657.6703,-730.7892 664.4158,-760.929 619,-784.9675 534.6613,-829.6078 501.0833,-820.0261 406,-811.9675 369.1603,-808.8452 360.9669,-798.5676 324,-797.9675"/>
</g>
<!-- sourcefile~m_ran_num.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~m_ran_num.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/m_ran_num.f90.html" xlink:title="m_ran_num.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="225.5,-415.9675 139.5,-415.9675 139.5,-391.9675 225.5,-391.9675 225.5,-415.9675"/>
<text text-anchor="middle" x="182.5" y="-401.5675" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ran_num.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_ran_num.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_ran_num.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M701.5,-130.9675C658.34,-91.7659 669.1019,-58.7896 619,-28.9675 566.5656,2.243 544.7646,-9.5464 484,-3.9675 387.5646,4.8864 331.9839,5.431 278,-74.9675 202.4023,-187.5556 322.8293,-269.0743 242,-377.9675 239.7155,-381.0451 236.9884,-383.7639 233.9763,-386.1648"/>
<polygon fill="#ff0000" stroke="#ff0000" points="231.8568,-383.3703 225.4466,-391.806 235.7182,-389.209 231.8568,-383.3703"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M815.4675,-327.9366C804.5128,-292.64 767.8028,-188.253 701.5,-130.9675"/>
</g>
<!-- sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~m_stats_io.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node10"><a xlink:href=".././sourcefile/m_stats_io.f90.html" xlink:title="m_stats_io.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="610,-775.9675 529,-775.9675 529,-751.9675 610,-751.9675 610,-775.9675"/>
<text text-anchor="middle" x="569.5" y="-761.5675" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_stats_io.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_stats_io.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M701.5,-703.9675C671.9729,-721.2044 636.6213,-737.0401 609.937,-748.1096"/>
<polygon fill="#ff0000" stroke="#ff0000" points="608.4513,-744.9359 600.5249,-751.966 611.1053,-751.4133 608.4513,-744.9359"/>
</g>
<!-- sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~m_interaction.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node11"><a xlink:href=".././sourcefile/m_interaction.f90.html" xlink:title="m_interaction.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="748,-351.9675 655,-351.9675 655,-327.9675 748,-327.9675 748,-351.9675"/>
<text text-anchor="middle" x="701.5" y="-337.5675" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_interaction.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M783.7461,-339.9675C775.6808,-339.9675 766.9081,-339.9675 758.1958,-339.9675"/>
<polygon fill="#ff0000" stroke="#ff0000" points="758.042,-336.4676 748.0419,-339.9675 758.0419,-343.4676 758.042,-336.4676"/>
</g>
<!-- sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~m_config_io.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node12"><a xlink:href=".././sourcefile/m_config_io.f90.html" xlink:title="m_config_io.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="613,-695.9675 526,-695.9675 526,-671.9675 613,-671.9675 613,-695.9675"/>
<text text-anchor="middle" x="569.5" y="-681.5675" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_config_io.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_config_io.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M701.5,-703.9675C671.239,-721.6328 630.6862,-711.4598 602.5497,-700.1668"/>
<polygon fill="#ff0000" stroke="#ff0000" points="603.7246,-696.8632 593.1525,-696.1695 600.9845,-703.3046 603.7246,-696.8632"/>
</g>
<!-- sourcefile~m_strings.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~m_strings.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M423.4073,-769.9807C399.7349,-781.9748 360.2803,-798.5564 324,-797.9675"/>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M416.2148,-453.9924C367.4451,-472.6788 265.7541,-504.3298 182.5,-481.9675"/>
</g>
<!-- sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~m_simbox.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node13"><a xlink:href=".././sourcefile/m_simbox.f90.html" xlink:title="m_simbox.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="363,-533.9675 285,-533.9675 285,-509.9675 363,-509.9675 363,-533.9675"/>
<text text-anchor="middle" x="324" y="-519.5675" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_simbox.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_simbox.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M426.1631,-454.1255C419.701,-458.4015 412.4695,-463.3046 406,-467.9675 389.5563,-479.8194 386.8684,-484.7281 370,-495.9675 365.4195,-499.0195 360.4593,-502.069 355.5489,-504.9497"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="353.8029,-501.9162 346.8569,-509.9165 357.2759,-507.994 353.8029,-501.9162"/>
</g>
<!-- sourcefile~m_trajectory.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~m_trajectory.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node20"><a xlink:href=".././sourcefile/m_trajectory.f90.html" xlink:title="m_trajectory.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="368,-415.9675 280,-415.9675 280,-391.9675 368,-391.9675 368,-415.9675"/>
<text text-anchor="middle" x="324" y="-401.5675" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_trajectory.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_trajectory.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_trajectory.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M406.7148,-429.9441C395.7906,-426.5133 383.7442,-422.7301 372.3046,-419.1375"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="373.0407,-415.7002 362.4514,-416.0431 370.9433,-422.3786 373.0407,-415.7002"/>
</g>
<!-- sourcefile~m_utils_math.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~m_utils_math.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M296.3415,-745.7951C289.7877,-742.0245 283.1996,-737.4034 278,-731.9675 230.3255,-682.1257 201.0983,-603.8216 188.9873,-565.9439"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="192.2017,-564.4918 185.8998,-555.9749 185.515,-566.5628 192.2017,-564.4918"/>
</g>
<!-- sourcefile~m_utils_math.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~m_utils_math.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M277.6971,-769.0904C248.5144,-773.5273 211.0852,-774.2926 182.5,-757.9675"/>
</g>
<!-- sourcefile~m_constants_math.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~m_constants_math.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M165.0273,-531.8648C152.5672,-522.7776 135.8193,-509.601 123,-495.9675 95.8666,-467.1108 70.4728,-428.5461 55.9853,-405.022"/>
<polygon fill="#5cff00" stroke="#5cff00" points="58.8233,-402.9521 50.6423,-396.22 52.8395,-406.5845 58.8233,-402.9521"/>
</g>
<!-- sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M530.1273,-62.1124C526.3017,-64.5536 522.807,-67.4748 520,-70.9675 465.3378,-138.9813 501.3397,-178.4505 484,-263.9675 472.5907,-320.2365 457.7577,-386.1826 450.0893,-419.8058"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="446.5964,-419.3801 447.7787,-429.9087 453.4202,-420.9408 446.5964,-419.3801"/>
</g>
<!-- sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M445,-17.9675C327.2307,-12.7956 276.1391,15.643 182.5,-55.9675"/>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M182.5,-55.9675C156.9246,-74.1455 141.6124,-68.7064 123,-93.9675 60.54,-178.7392 47.152,-309.9532 44.2826,-361.8026"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="40.7822,-361.7301 43.8056,-371.8844 47.7744,-362.061 40.7822,-361.7301"/>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M540.3569,-37.7937C515.4626,-28.5382 478.4719,-17.4656 445,-17.9675"/>
</g>
<!-- sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~m_vector.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node22"><a xlink:href=".././sourcefile/m_vector.f90.html" xlink:title="m_vector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="360.5,-107.9675 287.5,-107.9675 287.5,-83.9675 360.5,-83.9675 360.5,-107.9675"/>
<text text-anchor="middle" x="324" y="-93.5675" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_vector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_vector.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M445,-17.9675C401.8919,-16.0744 361.8959,-52.2095 340.4202,-75.9419"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="337.5572,-73.8997 333.6217,-83.7365 342.8326,-78.5009 337.5572,-73.8997"/>
</g>
<!-- sourcefile~m_ran_num.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~m_ran_num.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M139.2815,-397.749C125.9425,-395.8297 111.0889,-393.6925 97.1364,-391.685"/>
<polygon fill="#002eff" stroke="#002eff" points="97.5671,-388.211 87.1705,-390.251 96.5701,-395.1396 97.5671,-388.211"/>
</g>
<!-- sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_strings.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_strings.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M528.734,-762.0029C517.435,-761.4583 505.0596,-760.8619 493.3719,-760.2987"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="493.4791,-756.7999 483.3222,-759.8143 493.1421,-763.7918 493.4791,-756.7999"/>
</g>
<!-- sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M535.7479,-751.8597C529.6698,-748.2599 524.003,-743.6967 520,-737.9675 450.6623,-638.729 548.0676,-570.6873 484,-467.9675 482.3851,-465.3783 480.4064,-462.9897 478.2052,-460.7986"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="480.0154,-457.7555 470.0694,-454.1048 475.568,-463.1611 480.0154,-457.7555"/>
</g>
<!-- sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M445,-797.9675C425.7258,-797.4597 421.2583,-790.7547 406,-778.9675 386.5439,-763.9374 386.5738,-755.1266 370,-736.9675 310.5655,-671.8478 236.8597,-597.85 202.2262,-563.4557"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="204.6274,-560.9077 195.0617,-556.3525 199.6989,-565.8787 204.6274,-560.9077"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M544.7173,-776.139C519.938,-787.0097 480.5117,-800.8151 445,-797.9675"/>
</g>
<!-- sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M445,-797.9675C391.3943,-793.6689 377.7707,-798.8404 324,-797.9675"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M654.8134,-328.4297C616.4649,-321.5063 561.8451,-317.6741 520,-338.9675 502.6292,-347.8068 473.6345,-393.2835 457.2502,-420.769"/>
<polygon fill="#e700ff" stroke="#e700ff" points="454.0783,-419.258 452.0205,-429.651 460.1103,-422.8096 454.0783,-419.258"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M692.4403,-352.1541C678.5239,-370.0734 650.2025,-403.5064 619,-422.9675 549.7137,-466.1816 514.4713,-439.0514 445,-481.9675"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_cell_list.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M699.1988,-327.8727C690.0466,-280.8561 654.976,-110.8797 619,-70.9675 618.1211,-69.9924 617.1893,-69.0611 616.2133,-68.1716"/>
<polygon fill="#e700ff" stroke="#e700ff" points="618.1341,-65.2398 608.0021,-62.1423 613.991,-70.8821 618.1341,-65.2398"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M692.4851,-327.9004C678.6258,-310.1907 650.3763,-277.2832 619,-258.9675 501.1626,-190.1807 455.8787,-138.9632 324,-173.9675"/>
</g>
<!-- sourcefile~m_ia_external.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~m_ia_external.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node14"><a xlink:href=".././sourcefile/m_ia_external.f90.html" xlink:title="m_ia_external.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="617.5,-615.9675 521.5,-615.9675 521.5,-591.9675 617.5,-591.9675 617.5,-615.9675"/>
<text text-anchor="middle" x="569.5" y="-601.5675" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_external.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_external.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_external.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M700.7855,-352.0728C697.873,-390.8113 683.7281,-513.2678 619,-582.9675 618.1067,-583.9294 617.1621,-584.849 616.1747,-585.7281"/>
<polygon fill="#e700ff" stroke="#e700ff" points="613.9607,-583.0097 607.9027,-591.7018 618.0589,-588.6846 613.9607,-583.0097"/>
</g>
<!-- sourcefile~m_verlet.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~m_verlet.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node15"><a xlink:href=".././sourcefile/m_verlet.f90.html" xlink:title="m_verlet.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="604.5,-145.9675 534.5,-145.9675 534.5,-121.9675 604.5,-121.9675 604.5,-145.9675"/>
<text text-anchor="middle" x="569.5" y="-131.5675" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_verlet.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_verlet.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_verlet.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M698.862,-327.9331C691.4465,-296.6012 667.7064,-211.3716 619,-159.9675 616.0331,-156.8363 612.6047,-154.0087 608.9644,-151.4737"/>
<polygon fill="#e700ff" stroke="#e700ff" points="610.5548,-148.3428 600.2034,-146.0844 606.8871,-154.3051 610.5548,-148.3428"/>
</g>
<!-- sourcefile~m_connectivity.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~m_connectivity.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node16"><a xlink:href=".././sourcefile/m_connectivity.f90.html" xlink:title="m_connectivity.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="619,-103.9675 520,-103.9675 520,-79.9675 619,-79.9675 619,-103.9675"/>
<text text-anchor="middle" x="569.5" y="-89.5675" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_connectivity.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_connectivity.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_connectivity.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M700.4486,-327.8706C696.6093,-290.8108 680.1826,-177.4583 619,-112.9675 617.9559,-111.867 616.845,-110.8216 615.6798,-109.8287"/>
<polygon fill="#e700ff" stroke="#e700ff" points="617.5425,-106.8607 607.338,-104.0113 613.5384,-112.6024 617.5425,-106.8607"/>
</g>
<!-- sourcefile~m_ia_vdw.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~m_ia_vdw.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node17"><a xlink:href=".././sourcefile/m_ia_vdw.f90.html" xlink:title="m_ia_vdw.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="608,-291.9675 531,-291.9675 531,-267.9675 608,-267.9675 608,-291.9675"/>
<text text-anchor="middle" x="569.5" y="-277.5675" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_vdw.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_vdw.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_vdw.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M674.7878,-327.8256C654.8386,-318.7577 627.3599,-306.2675 605.4771,-296.3207"/>
<polygon fill="#e700ff" stroke="#e700ff" points="606.7244,-293.0431 596.1724,-292.0913 603.8278,-299.4157 606.7244,-293.0431"/>
</g>
<!-- sourcefile~m_ia_angle.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~m_ia_angle.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node18"><a xlink:href=".././sourcefile/m_ia_angle.f90.html" xlink:title="m_ia_angle.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="611.5,-573.9675 527.5,-573.9675 527.5,-549.9675 611.5,-549.9675 611.5,-573.9675"/>
<text text-anchor="middle" x="569.5" y="-559.5675" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_angle.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_angle.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_angle.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M699.7825,-352.1349C694.3364,-386.408 674.4175,-484.8951 619,-540.9675 617.9337,-542.0464 616.8033,-543.073 615.6212,-544.0495"/>
<polygon fill="#e700ff" stroke="#e700ff" points="613.4911,-541.2657 607.2022,-549.7921 617.4356,-547.0486 613.4911,-541.2657"/>
</g>
<!-- sourcefile~m_ia_dihedral.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~m_ia_dihedral.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node19"><a xlink:href=".././sourcefile/m_ia_dihedral.f90.html" xlink:title="m_ia_dihedral.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="617.5,-531.9675 521.5,-531.9675 521.5,-507.9675 617.5,-507.9675 617.5,-531.9675"/>
<text text-anchor="middle" x="569.5" y="-517.5675" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_dihedral.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_dihedral.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_dihedral.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M697.706,-352.293C688.4576,-380.5835 662.2845,-451.0349 619,-493.9675 615.7726,-497.1686 612.0697,-500.0686 608.1732,-502.6705"/>
<polygon fill="#e700ff" stroke="#e700ff" points="606.229,-499.755 599.4431,-507.8915 609.8219,-505.7626 606.229,-499.755"/>
</g>
<!-- sourcefile~m_ia_tether.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~m_ia_tether.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node21"><a xlink:href=".././sourcefile/m_ia_tether.f90.html" xlink:title="m_ia_tether.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="612,-371.9675 527,-371.9675 527,-347.9675 612,-347.9675 612,-371.9675"/>
<text text-anchor="middle" x="569.5" y="-357.5675" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_tether.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_tether.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_tether.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M654.9617,-347.0187C644.3869,-348.621 633.08,-350.3342 622.2672,-351.9725"/>
<polygon fill="#e700ff" stroke="#e700ff" points="621.4546,-348.5556 612.0918,-353.5142 622.5033,-355.4766 621.4546,-348.5556"/>
</g>
<!-- sourcefile~m_ia_bond.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~m_ia_bond.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node23"><a xlink:href=".././sourcefile/m_ia_bond.f90.html" xlink:title="m_ia_bond.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="610.5,-413.9675 528.5,-413.9675 528.5,-389.9675 610.5,-389.9675 610.5,-413.9675"/>
<text text-anchor="middle" x="569.5" y="-399.5675" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_bond.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_bond.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_bond.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M678.2102,-352.0084C661.7832,-360.3861 639.1966,-371.6749 619,-380.9675 615.4289,-382.6106 611.6933,-384.2813 607.9439,-385.9261"/>
<polygon fill="#e700ff" stroke="#e700ff" points="606.4713,-382.7497 598.6815,-389.9309 609.2494,-389.1748 606.4713,-382.7497"/>
</g>
<!-- sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_strings.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_strings.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M545.607,-695.9915C537.4064,-700.2568 528.2247,-705.1873 520,-709.9675 503.6635,-719.4622 485.83,-730.8324 471.6529,-740.1227"/>
<polygon fill="#ff008b" stroke="#ff008b" points="469.3362,-737.4581 462.917,-745.8869 473.1914,-743.3008 469.3362,-737.4581"/>
</g>
<!-- sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M556.1122,-671.6758C544.8071,-660.5508 529.054,-643.1626 520,-624.9675 488.1072,-560.8755 524.6638,-526.886 484,-467.9675 482.1049,-465.2216 479.8164,-462.6883 477.3092,-460.3701"/>
<polygon fill="#ff008b" stroke="#ff008b" points="479.3266,-457.5036 469.3062,-454.0624 474.9935,-463.0014 479.3266,-457.5036"/>
</g>
<!-- sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M527.5315,-671.9531C502.0003,-667.1187 469.6705,-665.6065 445,-679.9675"/>
</g>
<!-- sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_simbox.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M557.546,-671.5451C546.8791,-660.0601 531.2516,-642.2122 520,-624.9675 500.2324,-594.6709 512.8204,-573.8313 484,-551.9675 452.4741,-528.0513 407.5713,-521.3222 373.3548,-520.134"/>
<polygon fill="#ff008b" stroke="#ff008b" points="373.1732,-516.6298 363.1056,-519.9302 373.034,-523.6284 373.1732,-516.6298"/>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M284.9599,-528.0373C274.7103,-529.6309 263.3411,-531.3986 252.0141,-533.1596"/>
<polygon fill="#ff0000" stroke="#ff0000" points="251.4438,-529.7062 242.1002,-534.701 252.5193,-536.6231 251.4438,-529.7062"/>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M284.7343,-510.5698C256.3787,-502.4117 217.1399,-491.2719 182.5,-481.9675"/>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_ran_num.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_ran_num.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M309.39,-509.7839C284.7113,-489.2038 234.5984,-447.4135 205.2743,-422.9595"/>
<polygon fill="#ff0000" stroke="#ff0000" points="207.1641,-419.9782 197.2425,-416.2616 202.681,-425.3542 207.1641,-419.9782"/>
</g>
<!-- sourcefile~m_ia_external.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~m_ia_external.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M531.0174,-591.7751C526.9338,-589.3337 523.1351,-586.4254 520,-582.9675 484.0269,-543.2903 516.1164,-510.8264 484,-467.9675 481.9505,-465.2324 479.5237,-462.695 476.8986,-460.3639"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="478.6709,-457.3121 468.6075,-453.9987 474.4082,-462.8645 478.6709,-457.3121"/>
</g>
<!-- sourcefile~m_ia_external.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~m_ia_external.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M521.3627,-607.2982C498.1614,-608.057 470.0071,-607.7334 445,-603.9675"/>
</g>
<!-- sourcefile~m_ia_external.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~m_ia_external.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M550.2421,-616.0678C525.9047,-631.2797 482.6432,-658.0549 445,-679.9675"/>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M445,-679.9675C380.0816,-717.7573 399.1065,-799.1867 324,-797.9675"/>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M324,-797.9675C258.6552,-796.9067 239.2506,-790.3779 182.5,-757.9675"/>
</g>
<!-- sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M564.6195,-146.0415C545.8349,-192.5124 478.0463,-360.2144 453.7451,-420.333"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="450.4849,-419.0594 449.9821,-429.6423 456.9747,-421.6828 450.4849,-419.0594"/>
</g>
<!-- sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M445,-135.9675C388.633,-136.1873 378.4809,-159.5067 324,-173.9675"/>
</g>
<!-- sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_vector.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M445,-135.9675C413.3035,-136.0911 379.1892,-123.5495 355.2895,-112.4794"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="356.5547,-109.2042 346.0257,-108.0245 353.521,-115.5126 356.5547,-109.2042"/>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M534.3522,-134.76C509.4157,-135.2666 475.156,-135.8499 445,-135.9675"/>
</g>
<!-- sourcefile~m_table.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~m_table.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node24"><a xlink:href=".././sourcefile/m_table.f90.html" xlink:title="m_table.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="478.5,-107.9675 411.5,-107.9675 411.5,-83.9675 478.5,-83.9675 478.5,-107.9675"/>
<text text-anchor="middle" x="445" y="-93.5675" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_table.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_table.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_table.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M534.4885,-123.2812C520.2109,-118.9234 503.5519,-113.8388 488.5047,-109.246"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="489.4766,-105.8833 478.8904,-106.3115 487.433,-112.5784 489.4766,-105.8833"/>
</g>
<!-- sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M530.2636,-104.2242C526.4135,-106.6453 522.8758,-109.5313 520,-112.9675 517.4742,-115.9854 466.3073,-345.9152 449.9687,-419.5501"/>
<polygon fill="#5cff00" stroke="#5cff00" points="446.4875,-419.0821 447.7391,-429.6028 453.3214,-420.5979 446.4875,-419.0821"/>
</g>
<!-- sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M445,-55.9675C328.5352,-49.1073 276.9564,12.5095 182.5,-55.9675"/>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M539.1536,-79.8988C514.3115,-70.8283 478.0096,-59.4002 445,-55.9675"/>
</g>
<!-- sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_vector.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M445,-55.9675C412.6326,-54.0609 377.6711,-67.4451 353.6923,-79.2384"/>
<polygon fill="#5cff00" stroke="#5cff00" points="352.0634,-76.1403 344.7555,-83.8113 355.2521,-82.3718 352.0634,-76.1403"/>
</g>
<!-- sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_table.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_table.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M519.9366,-93.5599C509.6696,-93.8898 498.9218,-94.2351 488.8754,-94.5578"/>
<polygon fill="#5cff00" stroke="#5cff00" points="488.5919,-91.065 478.7094,-94.8845 488.8167,-98.0614 488.5919,-91.065"/>
</g>
<!-- sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M539.1888,-292.0735C532.3085,-295.803 525.436,-300.4217 520,-305.9675 494.956,-331.5174 501.3238,-346.6644 484,-377.9675 475.8666,-392.6641 466.0187,-408.8131 458.2538,-421.2125"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="455.1626,-419.5528 452.7848,-429.8774 461.0821,-423.289 455.1626,-419.5528"/>
</g>
<!-- sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M553.4552,-292.1598C519.8855,-317.5504 439.5822,-377.6686 370,-424.9675 314.7384,-462.5318 248.3641,-503.7754 211.2518,-526.4995"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="209.1799,-523.6638 202.4715,-531.8644 212.8296,-529.6371 209.1799,-523.6638"/>
</g>
<!-- sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_logger.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M445,-249.9675C393.1759,-235.6038 375.068,-233.1119 324,-249.9675"/>
</g>
<!-- sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M530.9081,-271.3795C506.2313,-265.7129 473.6031,-257.8952 445,-249.9675"/>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M445,-249.9675C383.8013,-233.0055 385.3804,-157.6754 324,-173.9675"/>
</g>
<!-- sourcefile~m_ia_angle.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~m_ia_angle.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M532.523,-549.8423C527.9855,-547.3648 523.6645,-544.4291 520,-540.9675 493.7027,-516.1261 507.8662,-495.1529 484,-467.9675 481.5472,-465.1736 478.7277,-462.5488 475.7506,-460.1217"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="477.7793,-457.2692 467.6451,-454.1788 473.6401,-462.9144 477.7793,-457.2692"/>
</g>
<!-- sourcefile~m_ia_angle.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~m_ia_angle.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M538.5369,-574.0654C504.8299,-586.9706 454.4458,-605.39 445,-603.9675"/>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M445,-603.9675C389.2611,-595.5736 380.3618,-566.762 324,-565.9675"/>
</g>
<!-- sourcefile~m_ia_angle.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~m_ia_angle.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M536.394,-573.9873C530.7335,-576.6043 525.0546,-579.6104 520,-582.9675 501.4111,-595.3137 503.9947,-608.0586 484,-617.9675 419.5711,-649.8969 387.2587,-607.7783 324,-641.9675"/>
</g>
<!-- sourcefile~m_ia_dihedral.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~m_ia_dihedral.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M550.3197,-507.9509C529.6347,-494.9916 496.5049,-474.2356 472.9292,-459.4653"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="474.7397,-456.4694 464.4072,-454.1262 471.0232,-462.4014 474.7397,-456.4694"/>
</g>
<!-- sourcefile~m_ia_dihedral.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~m_ia_dihedral.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M445,-565.9675C394.1084,-583.3484 377.7724,-566.7255 324,-565.9675"/>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M538.1858,-532.0275C513.101,-541.5695 476.9459,-555.0571 445,-565.9675"/>
</g>
<!-- sourcefile~m_ia_dihedral.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~m_ia_dihedral.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M182.5,-757.9675C117.7046,-720.9626 63.5242,-481.3636 47.9824,-406.3703"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="51.3297,-405.2687 45.8982,-396.1721 44.4715,-406.6704 51.3297,-405.2687"/>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M445,-565.9675C384.9025,-586.4925 379.8682,-611.7727 324,-641.9675"/>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M324,-641.9675C252.4598,-680.6325 253.1157,-798.2963 182.5,-757.9675"/>
</g>
<!-- sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_logger.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M307.5571,-391.9329C291.3592,-380.3716 265.6719,-362.8124 242,-349.9675 235.8088,-346.608 229.0953,-343.3396 222.4831,-340.3179"/>
<polygon fill="#002eff" stroke="#002eff" points="223.501,-336.9406 212.9408,-336.0853 220.6628,-343.3394 223.501,-336.9406"/>
</g>
<!-- sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M182.5,-481.9675C132.8389,-468.6284 86.4179,-428.0851 61.8111,-403.5239"/>
<polygon fill="#002eff" stroke="#002eff" points="64.1071,-400.8659 54.6119,-396.1658 59.1036,-405.7613 64.1071,-400.8659"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M302.5015,-416.0649C263.3173,-438.0808 184.1297,-482.4052 182.5,-481.9675"/>
</g>
<!-- sourcefile~m_ia_tether.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~m_ia_tether.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M537.4205,-372.0114C531.4797,-374.6761 525.438,-377.6928 520,-380.9675 499.983,-393.0214 479.5566,-410.0053 465.086,-422.9922"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="462.7227,-420.4106 457.7,-429.7393 467.4438,-425.5789 462.7227,-420.4106"/>
</g>
<!-- sourcefile~m_ia_tether.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~m_ia_tether.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M445,-481.9675C389.3041,-516.3738 389.4597,-566.8903 324,-565.9675"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M324,-565.9675C298.551,-565.6087 270.8272,-562.0186 246.718,-557.839"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="247.0863,-554.3491 236.6239,-556.0193 245.8443,-561.238 247.0863,-554.3491"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M532.127,-372.0816C527.7045,-374.5537 523.5202,-377.4909 520,-380.9675 491.681,-408.9359 511.5808,-434.2709 484,-462.9675 470.6393,-476.8687 461.4034,-471.8343 445,-481.9675"/>
</g>
<!-- sourcefile~m_ia_tether.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~m_ia_tether.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M182.5,-363.9675C154.4559,-369.1476 123.0195,-373.7695 97.1458,-377.2618"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="96.6079,-373.8024 87.1572,-378.5915 97.5316,-380.7412 96.6079,-373.8024"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M526.9526,-355.6838C455.2025,-349.5079 305.892,-341.1752 182.5,-363.9675"/>
</g>
<!-- sourcefile~m_vector.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~m_vector.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M298.9099,-83.9189C263.5003,-67.7358 201.1018,-42.482 182.5,-55.9675"/>
</g>
<!-- sourcefile~m_qsort.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~m_qsort.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~EfferentGraph_node25"><a xlink:href=".././sourcefile/m_qsort.f90.html" xlink:title="m_qsort.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="216.5,-126.9675 148.5,-126.9675 148.5,-102.9675 216.5,-102.9675 216.5,-126.9675"/>
<text text-anchor="middle" x="182.5" y="-112.5675" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_qsort.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_vector.f90&#45;&gt;sourcefile~m_qsort.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~m_vector.f90&#45;&gt;sourcefile~m_qsort.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M287.1919,-100.9099C268.7285,-103.3891 246.2233,-106.411 226.817,-109.0168"/>
<polygon fill="#e700ff" stroke="#e700ff" points="226.1406,-105.5761 216.6954,-110.3759 227.0723,-112.5139 226.1406,-105.5761"/>
</g>
<!-- sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_strings.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_strings.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M561.8943,-414.0181C550.9663,-431.8782 530.9378,-466.7418 520,-498.9675 491.6744,-582.4227 515.452,-611.6396 484,-693.9675 478.0795,-709.4648 468.3824,-725.4006 460.1391,-737.494"/>
<polygon fill="#ff008b" stroke="#ff008b" points="457.1004,-735.7303 454.2055,-745.922 462.8242,-739.7601 457.1004,-735.7303"/>
</g>
<!-- sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M532.1459,-413.9688C519.7032,-417.9665 505.6717,-422.4746 492.5619,-426.6866"/>
<polygon fill="#ff008b" stroke="#ff008b" points="491.2081,-423.4452 482.758,-429.8364 493.3494,-430.1097 491.2081,-423.4452"/>
</g>
<!-- sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M554.2681,-414.0172C537.563,-426.9466 509.7026,-447.682 484,-462.9675 467.4282,-472.8228 461.4034,-471.8343 445,-481.9675"/>
</g>
<!-- sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_logger.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M528.9408,-389.9017C488.8581,-378.3328 425.6409,-361.0371 370,-349.9675 322.7136,-340.56 268.0468,-333.3961 229.9881,-328.9939"/>
<polygon fill="#ff008b" stroke="#ff008b" points="230.0453,-325.4779 219.714,-327.8259 229.2546,-332.4331 230.0453,-325.4779"/>
</g>
<!-- sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M528.4081,-397.2721C432.2187,-386.3706 199.2597,-360.5242 182.5,-363.9675"/>
</g>
<!-- sourcefile~m_table.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~m_table.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M324,-173.9675C199.0011,-179.1239 93.8154,-311.5168 57.2764,-363.3929"/>
<polygon fill="#ff0000" stroke="#ff0000" points="54.257,-361.6056 51.4479,-371.8212 60.0145,-365.5871 54.257,-361.6056"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M426.9284,-108.0345C394.6223,-129.5473 329.7826,-172.4326 324,-173.9675"/>
</g>
<!-- sourcefile~m_table.f90&#45;&gt;sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~m_table.f90&#45;&gt;sourcefile~m_vector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M411.2948,-95.9675C398.8127,-95.9675 384.4237,-95.9675 370.9746,-95.9675"/>
<polygon fill="#ff0000" stroke="#ff0000" points="370.9203,-92.4676 360.9203,-95.9675 370.9203,-99.4676 370.9203,-92.4676"/>
</g>
<!-- sourcefile~m_qsort.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_mpcd.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~m_qsort.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M160.6774,-127.0686C148.1368,-134.9922 132.9487,-146.3842 123,-159.9675 75.8836,-224.2967 54.6008,-319.1355 46.9967,-361.7745"/>
<polygon fill="#00ffff" stroke="#00ffff" points="43.5016,-361.4508 45.2772,-371.8958 50.4028,-362.6233 43.5016,-361.4508"/>
</g>
</g>
</svg>
</div><script>var pansourcefilem_mpcdf90EfferentGraph = svgPanZoom('#sourcefilem_mpcdf90EfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_mpcd.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilem_mpcdf90AfferentGraph" width="274pt" height="52pt"
 viewBox="0.00 0.00 274.00 52.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_mpcd.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 48)">
<title>sourcefile~~m_mpcd.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-48 270,-48 270,4 -4,4"/>
<!-- sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_mpcd.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~m_mpcd.f90</title>
<polygon fill="none" stroke="#000000" points="70,-44 0,-44 0,-20 70,-20 70,-44"/>
<text text-anchor="middle" x="35" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_mpcd.f90</text>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~m_mpcd.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="266,-44 212,-44 212,-20 266,-20 266,-44"/>
<text text-anchor="middle" x="239" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_mpcd.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_mpcd.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M211.7124,-32.5275C200.6304,-32.7172 187.7042,-32.9071 176,-33 144.8899,-33.2469 137.1103,-33.2191 106,-33 97.6743,-32.9414 88.7997,-32.8441 80.2455,-32.7326"/>
<polygon fill="#ff0000" stroke="#ff0000" points="80.076,-29.23 70.0285,-32.5912 79.9791,-36.2293 80.076,-29.23"/>
</g>
<!-- sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_mpcd.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~m_setup.f90</title>
<g id="a_sourcefile~~m_mpcd.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/m_setup.f90.html" xlink:title="m_setup.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="176,-24 106,-24 106,0 176,0 176,-24"/>
<text text-anchor="middle" x="141" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_setup.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_mpcd.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M211.9616,-26.482C203.8936,-24.8354 194.824,-22.9845 185.9341,-21.1702"/>
<polygon fill="#00ffff" stroke="#00ffff" points="186.5344,-17.7207 176.0365,-19.1503 185.1346,-24.5793 186.5344,-17.7207"/>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_mpcd.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_mpcd.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M105.9979,-18.6042C97.7627,-20.158 88.8696,-21.8359 80.2555,-23.4612"/>
<polygon fill="#ff0000" stroke="#ff0000" points="79.5052,-20.041 70.3275,-25.3344 80.8031,-26.9196 79.5052,-20.041"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_mpcd.html">m_mpcd</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_mpcd.f90.html#src">m_mpcd.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">module </span><span class="n">m_mpcd</span>
<a name="ln-2"></a>    <span class="c">!! Routines implementing the MPCD solver.</span>
<a name="ln-3"></a>
<a name="ln-4"></a><span class="k">use </span><span class="n">f95_precision</span>
<a name="ln-5"></a><span class="k">use </span><span class="n">lapack95</span>
<a name="ln-6"></a>
<a name="ln-7"></a><span class="k">use </span><span class="n">m_precision</span>
<a name="ln-8"></a><span class="k">use </span><span class="n">m_constants_math</span>
<a name="ln-9"></a><span class="k">use </span><span class="n">m_utils_math</span>
<a name="ln-10"></a><span class="k">use </span><span class="n">m_strings</span>
<a name="ln-11"></a><span class="k">use </span><span class="n">m_ran_num</span>
<a name="ln-12"></a><span class="k">use </span><span class="n">m_globals</span>
<a name="ln-13"></a><span class="k">use </span><span class="n">m_cell_list</span>
<a name="ln-14"></a><span class="k">use </span><span class="n">m_interaction</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">ia_calc_forces</span>
<a name="ln-15"></a><span class="k">use </span><span class="n">m_stats_io</span>
<a name="ln-16"></a><span class="k">use </span><span class="n">m_config_io</span>
<a name="ln-17"></a><span class="k">use </span><span class="n">m_logger</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">logger</span> <span class="o">=&gt;</span> <span class="n">master_logger</span>
<a name="ln-18"></a>
<a name="ln-19"></a><span class="k">implicit none</span>
<a name="ln-20"></a>
<a name="ln-21"></a><span class="k">private</span>
<a name="ln-22"></a>
<a name="ln-23"></a><span class="k">public</span> <span class="kd">::</span> <span class="n">mpcd_init</span><span class="p">,</span> <span class="n">mpcd_run</span><span class="p">,</span> <span class="n">mpcd_finish</span>
<a name="ln-24"></a>
<a name="ln-25"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">mass</span>
<a name="ln-26"></a>    <span class="c">!! *(num_atoms_tot,)* array. Stores mass of each atom (including MPCD</span>
<a name="ln-27"></a>    <span class="c">!! atoms). The mass of each MPCD atom is taken as unity.</span>
<a name="ln-28"></a>
<a name="ln-29"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">buf_aic</span>
<a name="ln-30"></a>    <span class="c">!! Buffer for atoms in cell storing mass, coordinates, &amp; velocities.</span>
<a name="ln-31"></a>    <span class="c">!! For *nc* atoms, the first *nc* elements stores the mass, the next</span>
<a name="ln-32"></a>    <span class="c">!! *3\*nc* elements stores the coordinates, and the next *3\*nc* elements</span>
<a name="ln-33"></a>    <span class="c">!! store the velocities. The velocities part of this buffer may be overwritten</span>
<a name="ln-34"></a>    <span class="c">!! for relative velocity calculations.</span>
<a name="ln-35"></a>
<a name="ln-36"></a><span class="k">contains</span>
<a name="ln-37"></a> 
<a name="ln-38"></a><span class="c">!*******************************************************************************</span>
<a name="ln-39"></a> 
<a name="ln-40"></a><span class="k">subroutine </span><span class="n">mpcd_init</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-41"></a>    <span class="c">!! Initializes the MPCD solver. </span>
<a name="ln-42"></a>
<a name="ln-43"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-44"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">at_i</span>
<a name="ln-45"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lexists</span>
<a name="ln-46"></a>
<a name="ln-47"></a>    <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-48"></a>
<a name="ln-49"></a>    <span class="c">!Allocate memory for velocities</span>
<a name="ln-50"></a>    <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">velocities</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-51"></a><span class="k">        allocate</span><span class="p">(</span> <span class="n">velocities</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">num_atoms_tot</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-52"></a>        <span class="n">velocities</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-53"></a>    <span class="k">end if</span>
<a name="ln-54"></a>
<a name="ln-55"></a>    <span class="c">!Mass of each atom</span>
<a name="ln-56"></a>    <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">mass</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-57"></a><span class="k">        allocate</span><span class="p">(</span> <span class="n">mass</span><span class="p">(</span><span class="n">num_atoms_tot</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-58"></a>        <span class="n">mass</span> <span class="o">=</span> <span class="mf">1.0_rp</span>
<a name="ln-59"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-60"></a>            <span class="n">at_i</span> <span class="o">=</span> <span class="n">atoms</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-61"></a>            <span class="n">mass</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">atom_mass</span><span class="p">(</span><span class="n">at_i</span><span class="p">)</span>
<a name="ln-62"></a>        <span class="k">end do</span>
<a name="ln-63"></a><span class="k">    end if</span>
<a name="ln-64"></a>
<a name="ln-65"></a>    <span class="c">!In case of new simulation, need to assign MPCD atom positions.</span>
<a name="ln-66"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lrevive</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-67"></a><span class="k">        call </span><span class="n">simbox</span><span class="p">%</span><span class="n">get_rnd_points</span><span class="p">(</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">num_atoms</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">num_atoms_tot</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-68"></a>    <span class="k">end if</span>
<a name="ln-69"></a>
<a name="ln-70"></a>    <span class="c">!Allocate buffer for atoms in a cell. Setting it to thrice the average</span>
<a name="ln-71"></a>    <span class="c">!number of MPCD atoms per cell. Each atom has 7 quantities (mass,</span>
<a name="ln-72"></a>    <span class="c">!coordinates, &amp; velocities) associated with it. The buffer will be expanded</span>
<a name="ln-73"></a>    <span class="c">!if necessary.</span>
<a name="ln-74"></a>    <span class="k">allocate</span><span class="p">(</span> <span class="n">buf_aic</span><span class="p">(</span><span class="mi">7</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">mpcd_avnc</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-75"></a>    <span class="n">buf_aic</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-76"></a>
<a name="ln-77"></a>    <span class="c">!Opening trajectory file</span>
<a name="ln-78"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">write_traj</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-79"></a><span class="k">        if</span> <span class="p">(</span> <span class="n">lrevive</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-80"></a>            <span class="c">!Append (write) to existing (new) trajectory file</span>
<a name="ln-81"></a>            <span class="c">!Check if trajectory file exists</span>
<a name="ln-82"></a>            <span class="k">inquire</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="n">fn_traj</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="n">exist</span><span class="o">=</span><span class="n">lexists</span><span class="p">)</span>
<a name="ln-83"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">lexists</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-84"></a>                <span class="c">!Open existing file for appending</span>
<a name="ln-85"></a>                <span class="k">call </span><span class="n">traj</span><span class="p">%</span><span class="k">open</span><span class="p">(</span><span class="n">fn_traj</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="s1">&#39;rw&#39;</span><span class="p">,</span> <span class="n">ierr</span><span class="p">)</span>
<a name="ln-86"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-87"></a><span class="k">            else</span>
<a name="ln-88"></a>                <span class="c">!Create new trajectory file</span>
<a name="ln-89"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">traj_wmpcd</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-90"></a>                    <span class="c">!With MPCD data</span>
<a name="ln-91"></a>                    <span class="k">call </span><span class="n">traj</span><span class="p">%</span><span class="n">create</span><span class="p">(</span><span class="n">fn_traj</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-92"></a>                        <span class="n">num_atoms</span><span class="p">,</span> <span class="n">num_mpcd_atoms</span><span class="p">,</span> <span class="n">traj_frmcmp</span><span class="p">)</span>
<a name="ln-93"></a>                <span class="k">else</span>
<a name="ln-94"></a>                    <span class="c">!Without MPCD data</span>
<a name="ln-95"></a>                    <span class="k">call </span><span class="n">traj</span><span class="p">%</span><span class="n">create</span><span class="p">(</span><span class="n">fn_traj</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-96"></a>                        <span class="n">num_atoms</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">traj_frmcmp</span><span class="p">)</span>
<a name="ln-97"></a>                <span class="k">end if</span>
<a name="ln-98"></a><span class="k">            end if</span>
<a name="ln-99"></a><span class="k">        else</span>
<a name="ln-100"></a>            <span class="c">!Create new trajectory file</span>
<a name="ln-101"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">traj_wmpcd</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-102"></a>                <span class="c">!With MPCD data</span>
<a name="ln-103"></a>                <span class="k">call </span><span class="n">traj</span><span class="p">%</span><span class="n">create</span><span class="p">(</span><span class="n">fn_traj</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-104"></a>                    <span class="n">num_atoms</span><span class="p">,</span> <span class="n">num_mpcd_atoms</span><span class="p">,</span> <span class="n">traj_frmcmp</span><span class="p">)</span>
<a name="ln-105"></a>            <span class="k">else</span>
<a name="ln-106"></a>                <span class="c">!Without MPCD data</span>
<a name="ln-107"></a>                <span class="k">call </span><span class="n">traj</span><span class="p">%</span><span class="n">create</span><span class="p">(</span><span class="n">fn_traj</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-108"></a>                    <span class="n">num_atoms</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">traj_frmcmp</span><span class="p">)</span>
<a name="ln-109"></a>            <span class="k">end if</span>
<a name="ln-110"></a><span class="k">        end if</span>
<a name="ln-111"></a><span class="k">    end if</span>
<a name="ln-112"></a>
<a name="ln-113"></a><span class="k">    end subroutine</span>
<a name="ln-114"></a>
<a name="ln-115"></a><span class="c">!******************************************************************************</span>
<a name="ln-116"></a>
<a name="ln-117"></a><span class="k">subroutine </span><span class="n">mpcd_finish</span><span class="p">()</span>
<a name="ln-118"></a>    <span class="c">!! Clean up MPCD solver.</span>
<a name="ln-119"></a>
<a name="ln-120"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">mass</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">mass</span><span class="p">)</span>
<a name="ln-121"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">buf_aic</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">buf_aic</span><span class="p">)</span>
<a name="ln-122"></a>    <span class="k">call </span><span class="n">traj</span><span class="p">%</span><span class="k">close</span><span class="p">()</span>
<a name="ln-123"></a>
<a name="ln-124"></a>    <span class="k">end subroutine</span>
<a name="ln-125"></a>
<a name="ln-126"></a><span class="c">!******************************************************************************</span>
<a name="ln-127"></a>
<a name="ln-128"></a><span class="k">subroutine </span><span class="n">mpcd_run</span><span class="p">()</span>
<a name="ln-129"></a>    <span class="c">!! Driver for MPCD integrator.</span>
<a name="ln-130"></a>    <span class="c">!!</span>
<a name="ln-131"></a>    <span class="c">!! Repeatedly calls [[mpcd_stream]] and [[mpcd_collide]] to update atom</span>
<a name="ln-132"></a>    <span class="c">!! positions.</span>
<a name="ln-133"></a>    <span class="c">!!</span>
<a name="ln-134"></a>    <span class="c">!! Handling of flow field is not imlemented yet. If a non-zero `flow_style`</span>
<a name="ln-135"></a>    <span class="c">!! is specified, it will be set to zero.</span>
<a name="ln-136"></a>
<a name="ln-137"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-138"></a>
<a name="ln-139"></a>    <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-140"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">flow_style</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">flow_style</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-141"></a>
<a name="ln-142"></a>    <span class="c">!Log &amp; dump starting configuration</span>
<a name="ln-143"></a>    <span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;mpcd_run&#39;</span><span class="p">,</span> <span class="s1">&#39; nts: &#39;</span><span class="o">//</span><span class="n">str_from_num</span><span class="p">(</span><span class="n">nts</span><span class="p">))</span>
<a name="ln-144"></a>    <span class="k">call </span><span class="n">write_dump</span><span class="p">(</span><span class="n">fn_revive</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)))</span>
<a name="ln-145"></a>
<a name="ln-146"></a>    <span class="c">!Equilibration run</span>
<a name="ln-147"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">leql</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-148"></a><span class="k">        do while</span> <span class="p">(</span><span class="n">nts</span> <span class="o">&lt;</span> <span class="n">nts_eql</span><span class="p">)</span>
<a name="ln-149"></a>            <span class="c">!Streaming</span>
<a name="ln-150"></a>            <span class="k">call </span><span class="n">mpcd_stream</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-151"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-152"></a>
<a name="ln-153"></a>            <span class="c">!Collision</span>
<a name="ln-154"></a>            <span class="k">call </span><span class="n">mpcd_collide</span><span class="p">()</span>
<a name="ln-155"></a>
<a name="ln-156"></a>            <span class="n">nts</span> <span class="o">=</span> <span class="n">nts</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-157"></a>
<a name="ln-158"></a>            <span class="c">!Logging</span>
<a name="ln-159"></a>            <span class="k">if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span><span class="n">nts_log</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-160"></a><span class="k">                call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;mpcd_run&#39;</span><span class="p">,</span> <span class="s1">&#39; nts: &#39;</span><span class="o">//</span><span class="n">str_from_num</span><span class="p">(</span><span class="n">nts</span><span class="p">))</span>
<a name="ln-161"></a>            <span class="k">end if</span>
<a name="ln-162"></a>
<a name="ln-163"></a>            <span class="c">!Dump revive file</span>
<a name="ln-164"></a>            <span class="k">if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span><span class="n">nts_dump</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-165"></a><span class="k">                call </span><span class="n">write_dump</span><span class="p">(</span><span class="n">fn_revive</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)))</span>
<a name="ln-166"></a>            <span class="k">end if</span>
<a name="ln-167"></a>
<a name="ln-168"></a>            <span class="c">!Equilibration stats</span>
<a name="ln-169"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">write_eql_stats</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-170"></a><span class="k">                if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span><span class="n">nts_eql_samp</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">stats_write</span><span class="p">()</span>
<a name="ln-171"></a>            <span class="k">end if</span>
<a name="ln-172"></a><span class="k">        end do</span>
<a name="ln-173"></a>
<a name="ln-174"></a><span class="k">        call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;finish_equil_run&#39;</span><span class="p">,</span> <span class="s1">&#39;Equilibration completed&#39;</span><span class="p">)</span>
<a name="ln-175"></a>        <span class="k">call </span><span class="n">stats_finish</span><span class="p">()</span>
<a name="ln-176"></a>        <span class="k">call </span><span class="n">write_dump</span><span class="p">(</span><span class="n">fn_revive</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)))</span>
<a name="ln-177"></a>        <span class="n">leql</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-178"></a>        <span class="n">nts</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-179"></a>        <span class="c">!If continue on to production run, create new stats file.</span>
<a name="ln-180"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">nts_sim</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">stats_init</span><span class="p">()</span>
<a name="ln-181"></a>    <span class="k">end if</span>
<a name="ln-182"></a>
<a name="ln-183"></a>    <span class="c">!Production run</span>
<a name="ln-184"></a>    <span class="k">do while</span> <span class="p">(</span><span class="n">nts</span> <span class="o">&lt;</span> <span class="n">nts_sim</span><span class="p">)</span>
<a name="ln-185"></a>        <span class="k">call </span><span class="n">mpcd_stream</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-186"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-187"></a>
<a name="ln-188"></a><span class="k">        call </span><span class="n">mpcd_collide</span><span class="p">()</span>
<a name="ln-189"></a>
<a name="ln-190"></a>        <span class="n">nts</span> <span class="o">=</span> <span class="n">nts</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-191"></a>
<a name="ln-192"></a>        <span class="c">!Logging</span>
<a name="ln-193"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span><span class="n">nts_log</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-194"></a><span class="k">            call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;mpcd_run&#39;</span><span class="p">,</span> <span class="s1">&#39; nts: &#39;</span><span class="o">//</span><span class="n">str_from_num</span><span class="p">(</span><span class="n">nts</span><span class="p">))</span>
<a name="ln-195"></a>        <span class="k">end if</span>
<a name="ln-196"></a>
<a name="ln-197"></a>        <span class="c">!Dump revive file</span>
<a name="ln-198"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span><span class="n">nts_dump</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-199"></a><span class="k">            call </span><span class="n">write_dump</span><span class="p">(</span><span class="n">fn_revive</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)))</span>
<a name="ln-200"></a>        <span class="k">end if</span>
<a name="ln-201"></a>
<a name="ln-202"></a><span class="k">        if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span><span class="n">nts_samp</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-203"></a>            <span class="c">!Write stats</span>
<a name="ln-204"></a>            <span class="k">call </span><span class="n">stats_write</span><span class="p">()</span>
<a name="ln-205"></a>            <span class="c">!Write traj</span>
<a name="ln-206"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">write_traj</span><span class="p">)</span> <span class="k">call </span><span class="n">traj</span><span class="p">%</span><span class="n">append_frame</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-207"></a>                <span class="n">velocities</span><span class="p">,</span> <span class="n">forces</span><span class="p">,</span> <span class="n">charge</span><span class="p">)</span>
<a name="ln-208"></a>        <span class="k">end if</span>
<a name="ln-209"></a><span class="k">    end do</span>
<a name="ln-210"></a>    <span class="c">!Dump the final configuration</span>
<a name="ln-211"></a>    <span class="k">call </span><span class="n">write_dump</span><span class="p">(</span><span class="n">fn_revive</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)))</span>
<a name="ln-212"></a>
<a name="ln-213"></a>    <span class="k">end subroutine</span>
<a name="ln-214"></a>
<a name="ln-215"></a><span class="c">!******************************************************************************</span>
<a name="ln-216"></a>
<a name="ln-217"></a><span class="k">subroutine </span><span class="n">mpcd_stream</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-218"></a>    <span class="c">!! Performs one step of streaming.</span>
<a name="ln-219"></a>
<a name="ln-220"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-221"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dt_md</span>
<a name="ln-222"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">half_dt</span>
<a name="ln-223"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">istp</span>
<a name="ln-224"></a>
<a name="ln-225"></a>    <span class="n">dt_md</span> <span class="o">=</span> <span class="n">tim_stp</span><span class="o">/</span><span class="n">nts_md</span>
<a name="ln-226"></a>    <span class="n">half_dt</span> <span class="o">=</span> <span class="mf">0.5_rp</span><span class="o">*</span><span class="n">dt_md</span>
<a name="ln-227"></a>    <span class="n">istp</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-228"></a>
<a name="ln-229"></a>    <span class="c">!Set cell size to collision cells</span>
<a name="ln-230"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">use_cell_list</span><span class="p">)</span> <span class="k">call </span><span class="n">cl_set_cell_size</span><span class="p">(</span><span class="n">rcutoff</span><span class="p">)</span>
<a name="ln-231"></a>
<a name="ln-232"></a>    <span class="c">!Setting these to zero for the case num_atoms = 0.</span>
<a name="ln-233"></a>    <span class="n">energy_tot</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-234"></a>    <span class="n">stress</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-235"></a>
<a name="ln-236"></a>    <span class="c">!Update non-MPCD atoms via MD steps</span>
<a name="ln-237"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_atoms</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-238"></a><span class="k">        do while</span> <span class="p">(</span><span class="n">istp</span> <span class="o">&lt;</span> <span class="n">nts_md</span><span class="p">)</span>
<a name="ln-239"></a>            <span class="c">!Update velocities over a half-step</span>
<a name="ln-240"></a>            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-241"></a>                <span class="n">velocities</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">velocities</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">half_dt</span><span class="o">*</span><span class="n">forces</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">mass</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-242"></a>            <span class="k">end do</span>
<a name="ln-243"></a>
<a name="ln-244"></a>            <span class="c">!Update position over full step</span>
<a name="ln-245"></a>            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-246"></a>                <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">dt_md</span><span class="o">*</span><span class="n">velocities</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-247"></a>            <span class="k">end do</span>
<a name="ln-248"></a>
<a name="ln-249"></a>            <span class="c">!Wrap around periodic boundaries</span>
<a name="ln-250"></a>            <span class="k">call </span><span class="n">simbox</span><span class="p">%</span><span class="n">wrap_all</span><span class="p">(</span><span class="n">coordinates</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">num_atoms</span><span class="p">))</span>
<a name="ln-251"></a>
<a name="ln-252"></a>            <span class="c">!Update forces over full step</span>
<a name="ln-253"></a>            <span class="k">call </span><span class="n">ia_calc_forces</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-254"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-255"></a>
<a name="ln-256"></a>            <span class="c">!Update velocities over full step</span>
<a name="ln-257"></a>            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-258"></a>                <span class="n">velocities</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">velocities</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">half_dt</span><span class="o">*</span><span class="n">forces</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">mass</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-259"></a>            <span class="k">end do</span>
<a name="ln-260"></a>
<a name="ln-261"></a><span class="k">            </span><span class="n">istp</span> <span class="o">=</span> <span class="n">istp</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-262"></a>        <span class="k">end do</span>
<a name="ln-263"></a><span class="k">    end if</span>
<a name="ln-264"></a>
<a name="ln-265"></a>    <span class="c">!Update MPCD particles over a streaming step</span>
<a name="ln-266"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">num_atoms</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms_tot</span>
<a name="ln-267"></a>        <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">tim_stp</span><span class="o">*</span><span class="n">velocities</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-268"></a>    <span class="k">end do</span>
<a name="ln-269"></a>
<a name="ln-270"></a>    <span class="c">!Wrap MPCD particles around periodic boundaries</span>
<a name="ln-271"></a>    <span class="k">call </span><span class="n">simbox</span><span class="p">%</span><span class="n">wrap_all</span><span class="p">(</span><span class="n">coordinates</span><span class="p">(:,</span><span class="n">num_atoms</span><span class="o">+</span><span class="mi">1</span><span class="p">:))</span>
<a name="ln-272"></a>
<a name="ln-273"></a>    <span class="k">end subroutine</span>
<a name="ln-274"></a>
<a name="ln-275"></a><span class="c">!******************************************************************************</span>
<a name="ln-276"></a>
<a name="ln-277"></a><span class="k">subroutine </span><span class="n">mpcd_collide</span><span class="p">()</span>
<a name="ln-278"></a>    <span class="c">!! Performs one step of MPCD collision.</span>
<a name="ln-279"></a>
<a name="ln-280"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gsv</span>
<a name="ln-281"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">,</span> <span class="n">com</span><span class="p">,</span> <span class="n">vcom</span><span class="p">,</span> <span class="n">vrcom</span>
<a name="ln-282"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">angmom</span><span class="p">,</span> <span class="n">angvel</span>
<a name="ln-283"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mat_mi</span><span class="p">,</span> <span class="n">inv_mat_mi</span>
<a name="ln-284"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">stress_kin</span>
<a name="ln-285"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">aic</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-286"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mass_tot</span><span class="p">,</span> <span class="n">massi</span><span class="p">,</span> <span class="n">var</span>
<a name="ln-287"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">num_cells</span><span class="p">,</span> <span class="n">na_cell</span>
<a name="ln-288"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ofstc</span><span class="p">,</span> <span class="n">ofstv</span>
<a name="ln-289"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">iatm</span><span class="p">,</span> <span class="n">icell</span><span class="p">,</span> <span class="n">ibeg</span><span class="p">,</span> <span class="n">iend</span>
<a name="ln-290"></a>
<a name="ln-291"></a>    <span class="c">!Grid shift vector</span>
<a name="ln-292"></a>    <span class="k">call </span><span class="n">get_rv_uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5_rp</span><span class="p">,</span> <span class="mf">0.5_rp</span><span class="p">,</span> <span class="n">gsv</span><span class="p">)</span>
<a name="ln-293"></a>
<a name="ln-294"></a>    <span class="c">!Forward shift</span>
<a name="ln-295"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms_tot</span>
<a name="ln-296"></a>        <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">gsv</span>
<a name="ln-297"></a>    <span class="k">end do</span>
<a name="ln-298"></a>
<a name="ln-299"></a>    <span class="c">!Wrap around periodic boundaries</span>
<a name="ln-300"></a>    <span class="k">call </span><span class="n">simbox</span><span class="p">%</span><span class="n">wrap_all</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
<a name="ln-301"></a>
<a name="ln-302"></a>    <span class="c">!Set cell size to collision cells</span>
<a name="ln-303"></a>    <span class="k">call </span><span class="n">cl_set_cell_size</span><span class="p">(</span><span class="mf">1.0_rp</span><span class="p">)</span>
<a name="ln-304"></a>    <span class="k">call </span><span class="n">cl_build</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
<a name="ln-305"></a>
<a name="ln-306"></a>    <span class="n">num_cells</span> <span class="o">=</span> <span class="n">cl_get_num_cells</span><span class="p">()</span>
<a name="ln-307"></a>
<a name="ln-308"></a>    <span class="c">!Momentum exchange via collision, velocity update (MPC-AT+a version)</span>
<a name="ln-309"></a>
<a name="ln-310"></a>    <span class="c">!Loop over all collision cells</span>
<a name="ln-311"></a>    <span class="k">do </span><span class="n">icell</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">num_cells</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-312"></a>        <span class="c">!Get cell contents</span>
<a name="ln-313"></a>        <span class="k">call </span><span class="n">cl_get_contents</span><span class="p">(</span><span class="n">icell</span><span class="p">,</span> <span class="n">aic</span><span class="p">)</span>
<a name="ln-314"></a>
<a name="ln-315"></a>        <span class="c">!Number of atoms in cell</span>
<a name="ln-316"></a>        <span class="n">na_cell</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">aic</span><span class="p">)</span>
<a name="ln-317"></a>
<a name="ln-318"></a>        <span class="c">!For fewer than 2 atoms, no need for relative velocities.</span>
<a name="ln-319"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">na_cell</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">cycle</span>
<a name="ln-320"></a>
<a name="ln-321"></a>        <span class="c">!Check if cell velocity buffer needs to be expanded</span>
<a name="ln-322"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">size</span><span class="p">(</span><span class="n">buf_aic</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="o">*</span><span class="n">na_cell</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-323"></a><span class="k">            deallocate</span><span class="p">(</span><span class="n">buf_aic</span><span class="p">)</span>
<a name="ln-324"></a>            <span class="k">allocate</span><span class="p">(</span> <span class="n">buf_aic</span><span class="p">(</span><span class="mi">7</span><span class="o">*</span><span class="n">na_cell</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-325"></a>        <span class="k">end if</span>
<a name="ln-326"></a>        
<a name="ln-327"></a>        <span class="c">!Populate buf_aic</span>
<a name="ln-328"></a>        <span class="n">ofstc</span> <span class="o">=</span> <span class="n">na_cell</span><span class="p">;</span> <span class="n">ofstv</span> <span class="o">=</span> <span class="n">na_cell</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">na_cell</span>
<a name="ln-329"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">aic</span><span class="p">)</span>
<a name="ln-330"></a>            <span class="n">iatm</span> <span class="o">=</span> <span class="n">aic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-331"></a>            <span class="n">buf_aic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">mass</span><span class="p">(</span><span class="n">iatm</span><span class="p">)</span>
<a name="ln-332"></a>
<a name="ln-333"></a>            <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstc</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstc</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-334"></a>            <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">iatm</span><span class="p">)</span>
<a name="ln-335"></a>
<a name="ln-336"></a>            <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-337"></a>            <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span> <span class="o">=</span> <span class="n">velocities</span><span class="p">(:,</span><span class="n">iatm</span><span class="p">)</span>
<a name="ln-338"></a>        <span class="k">end do</span>
<a name="ln-339"></a>
<a name="ln-340"></a>        <span class="c">!Total mass, center-of-mass, &amp; c.o.m. velocity</span>
<a name="ln-341"></a>        <span class="n">com</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">vcom</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">mass_tot</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-342"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na_cell</span>
<a name="ln-343"></a>            <span class="n">mass_tot</span> <span class="o">=</span> <span class="n">mass_tot</span> <span class="o">+</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-344"></a>
<a name="ln-345"></a>            <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstc</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstc</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-346"></a>            <span class="n">com</span> <span class="o">=</span> <span class="n">com</span> <span class="o">+</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span>
<a name="ln-347"></a>
<a name="ln-348"></a>            <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-349"></a>            <span class="n">vcom</span> <span class="o">=</span> <span class="n">vcom</span> <span class="o">+</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span>
<a name="ln-350"></a>        <span class="k">end do</span>
<a name="ln-351"></a><span class="k">        </span><span class="n">com</span> <span class="o">=</span> <span class="n">com</span><span class="o">/</span><span class="n">mass_tot</span>
<a name="ln-352"></a>        <span class="n">vcom</span> <span class="o">=</span> <span class="n">vcom</span><span class="o">/</span><span class="n">mass_tot</span>
<a name="ln-353"></a>
<a name="ln-354"></a>        <span class="c">!Draw relative velocities &amp; store in the buf_aic. This overwrites the</span>
<a name="ln-355"></a>        <span class="c">!existing velocities.</span>
<a name="ln-356"></a>        <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">na_cell</span>
<a name="ln-357"></a>        <span class="k">call </span><span class="n">get_rv_gaussian</span><span class="p">(</span> <span class="mf">0.0_rp</span><span class="p">,</span> <span class="mf">1.0_rp</span><span class="p">,</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-358"></a>        <span class="c">!Multiply by the variance, i.e. kT/m</span>
<a name="ln-359"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na_cell</span>
<a name="ln-360"></a>            <span class="n">var</span> <span class="o">=</span> <span class="mf">1.0_rp</span><span class="o">/</span><span class="n">buf_aic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-361"></a>            <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-362"></a>            <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span> <span class="o">=</span> <span class="n">var</span><span class="o">*</span><span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span>
<a name="ln-363"></a>        <span class="k">end do</span>
<a name="ln-364"></a>
<a name="ln-365"></a>        <span class="c">!Calcuate the mean of the relative velocities.</span>
<a name="ln-366"></a>        <span class="n">vrcom</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-367"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na_cell</span>
<a name="ln-368"></a>            <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-369"></a>            <span class="n">vrcom</span> <span class="o">=</span> <span class="n">vrcom</span> <span class="o">+</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span>
<a name="ln-370"></a>        <span class="k">end do</span>
<a name="ln-371"></a><span class="k">        </span><span class="n">vrcom</span> <span class="o">=</span> <span class="n">vrcom</span><span class="o">/</span><span class="n">mass_tot</span>
<a name="ln-372"></a>
<a name="ln-373"></a>        <span class="c">!Subtract off the c.o.m. position &amp; vrcom</span>
<a name="ln-374"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na_cell</span>
<a name="ln-375"></a>            <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstc</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstc</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-376"></a>            <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span> <span class="o">=</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span> <span class="o">-</span> <span class="n">com</span>
<a name="ln-377"></a>
<a name="ln-378"></a>            <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-379"></a>            <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span> <span class="o">=</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span> <span class="o">-</span> <span class="n">vrcom</span>
<a name="ln-380"></a>        <span class="k">end do</span>
<a name="ln-381"></a>
<a name="ln-382"></a>        <span class="c">!Add the relative velocities to the c.o.m. velocity. This produces new</span>
<a name="ln-383"></a>        <span class="c">!velocities that do not conserve angular momentum, i.e. this is</span>
<a name="ln-384"></a>        <span class="c">!MPC-AT-a.</span>
<a name="ln-385"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na_cell</span>
<a name="ln-386"></a>            <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-387"></a>            <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span> <span class="o">=</span>  <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span> <span class="o">+</span> <span class="n">vcom</span>
<a name="ln-388"></a>        <span class="k">end do</span>
<a name="ln-389"></a>
<a name="ln-390"></a>        <span class="c">!For only two atoms in the cell, the above is equivalent to MPC-AT+a.</span>
<a name="ln-391"></a>        <span class="c">!Just copy the velocities back and move on to the next cell.</span>
<a name="ln-392"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">na_cell</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-393"></a>            <span class="c">!Explicitly unrolling the loop over i as i = 1 &amp; i = 2.</span>
<a name="ln-394"></a>            <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">iatm</span> <span class="o">=</span> <span class="n">aic</span><span class="p">(</span><span class="n">i</span><span class="p">);</span> <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-395"></a>            <span class="n">velocities</span><span class="p">(:,</span><span class="n">iatm</span><span class="p">)</span> <span class="o">=</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span>
<a name="ln-396"></a>            <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">iatm</span> <span class="o">=</span> <span class="n">aic</span><span class="p">(</span><span class="n">i</span><span class="p">);</span> <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-397"></a>            <span class="n">velocities</span><span class="p">(:,</span><span class="n">iatm</span><span class="p">)</span> <span class="o">=</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span>
<a name="ln-398"></a>            <span class="k">cycle</span>
<a name="ln-399"></a><span class="k">        end if</span>
<a name="ln-400"></a>
<a name="ln-401"></a>        <span class="c">!Calculate moment of intertia matrix (symmetric) about the c.o.m. and angular</span>
<a name="ln-402"></a>        <span class="c">!momentum.</span>
<a name="ln-403"></a>        <span class="n">mat_mi</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">angmom</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-404"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na_cell</span>
<a name="ln-405"></a>            <span class="n">massi</span> <span class="o">=</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-406"></a>            <span class="n">ri</span> <span class="o">=</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">ofstc</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">ofstc</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<a name="ln-407"></a>            <span class="n">mat_mi</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_mi</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="p">(</span> <span class="n">ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ri</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>
<a name="ln-408"></a>            <span class="n">mat_mi</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_mi</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">massi</span><span class="o">*</span><span class="p">(</span> <span class="n">ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ri</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-409"></a>            <span class="n">mat_mi</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_mi</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">massi</span><span class="o">*</span><span class="p">(</span> <span class="n">ri</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">ri</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-410"></a>            <span class="n">mat_mi</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_mi</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="p">(</span> <span class="n">ri</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ri</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>
<a name="ln-411"></a>            <span class="n">mat_mi</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_mi</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">massi</span><span class="o">*</span><span class="p">(</span> <span class="n">ri</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-412"></a>            <span class="n">mat_mi</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_mi</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="p">(</span> <span class="n">ri</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>
<a name="ln-413"></a>
<a name="ln-414"></a>            <span class="n">vi</span> <span class="o">=</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<a name="ln-415"></a>            <span class="k">call </span><span class="n">cross</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">,</span> <span class="n">vrcom</span><span class="p">)</span> <span class="c">!Using vrcom as a buffer here</span>
<a name="ln-416"></a>            <span class="n">angmom</span> <span class="o">=</span> <span class="n">angmom</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="n">vrcom</span>
<a name="ln-417"></a>        <span class="k">end do</span>
<a name="ln-418"></a>        <span class="c">!Update the symmetric elements</span>
<a name="ln-419"></a>        <span class="n">mat_mi</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_mi</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-420"></a>        <span class="n">mat_mi</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_mi</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-421"></a>        <span class="n">mat_mi</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat_mi</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-422"></a>
<a name="ln-423"></a>        <span class="c">!Solve for angular velocity. If the mat_mi is singular, do a least</span>
<a name="ln-424"></a>        <span class="c">!squares solutions. Else, get the explicit inverse and multiply.</span>
<a name="ln-425"></a>        <span class="c">!Checking determinant against a small value 1E-8.</span>
<a name="ln-426"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">det</span><span class="p">(</span><span class="n">mat_mi</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0E-10_rp</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-427"></a>            <span class="c">!Invert the moment of inertia matrix</span>
<a name="ln-428"></a>            <span class="k">call </span><span class="n">invert_mat33</span><span class="p">(</span><span class="n">mat_mi</span><span class="p">,</span> <span class="n">inv_mat_mi</span><span class="p">)</span>
<a name="ln-429"></a>            <span class="c">!Solve for angular velocity</span>
<a name="ln-430"></a>            <span class="n">angvel</span> <span class="o">=</span> <span class="nb">matmul</span><span class="p">(</span><span class="n">inv_mat_mi</span><span class="p">,</span> <span class="o">-</span><span class="n">angmom</span><span class="p">)</span>
<a name="ln-431"></a>        <span class="k">else</span>
<a name="ln-432"></a>            <span class="c">!TODO: The following must be replaced with a more efficient SVD</span>
<a name="ln-433"></a>            <span class="c">!routine for 3 x 3 matrices. As of now, calling LAPACK for</span>
<a name="ln-434"></a>            <span class="c">!least-squares solution.</span>
<a name="ln-435"></a>            <span class="n">angmom</span> <span class="o">=</span> <span class="o">-</span><span class="n">angmom</span>
<a name="ln-436"></a>            <span class="k">call </span><span class="n">gelsy</span><span class="p">(</span><span class="n">mat_mi</span><span class="p">,</span> <span class="n">angmom</span><span class="p">)</span>
<a name="ln-437"></a>            <span class="n">angvel</span> <span class="o">=</span> <span class="n">angmom</span>
<a name="ln-438"></a>        <span class="k">end if</span>
<a name="ln-439"></a>
<a name="ln-440"></a>        <span class="c">!Correct velocities to enforce angular mometum conservation</span>
<a name="ln-441"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na_cell</span>
<a name="ln-442"></a>            <span class="n">iatm</span> <span class="o">=</span> <span class="n">aic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-443"></a>            <span class="n">massi</span> <span class="o">=</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-444"></a>            <span class="n">ri</span> <span class="o">=</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">ofstc</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">ofstc</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<a name="ln-445"></a>            <span class="k">call </span><span class="n">cross</span><span class="p">(</span><span class="n">angvel</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">vi</span><span class="p">)</span> <span class="c">!Using vi as a buffer here</span>
<a name="ln-446"></a>             
<a name="ln-447"></a>            <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-448"></a>            <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span> <span class="o">=</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span> <span class="o">+</span> <span class="n">vi</span>
<a name="ln-449"></a>        <span class="k">end do</span>
<a name="ln-450"></a>
<a name="ln-451"></a>        <span class="c">!Copy back</span>
<a name="ln-452"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na_cell</span>
<a name="ln-453"></a>            <span class="n">iatm</span> <span class="o">=</span> <span class="n">aic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-454"></a>            <span class="n">ibeg</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">ofstv</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span>
<a name="ln-455"></a>            <span class="n">velocities</span><span class="p">(:,</span><span class="n">iatm</span><span class="p">)</span> <span class="o">=</span> <span class="n">buf_aic</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span>
<a name="ln-456"></a>        <span class="k">end do</span>
<a name="ln-457"></a><span class="k">    end do</span>
<a name="ln-458"></a>
<a name="ln-459"></a>    <span class="c">!Reverse shift</span>
<a name="ln-460"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms_tot</span>
<a name="ln-461"></a>        <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">gsv</span>
<a name="ln-462"></a>    <span class="k">end do</span>
<a name="ln-463"></a>
<a name="ln-464"></a>    <span class="c">!Wrap around periodic boundaries</span>
<a name="ln-465"></a>    <span class="k">call </span><span class="n">simbox</span><span class="p">%</span><span class="n">wrap_all</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
<a name="ln-466"></a>
<a name="ln-467"></a>    <span class="c">!Update energy and stress</span>
<a name="ln-468"></a>    <span class="n">energy_kin</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-469"></a>    <span class="n">stress_kin</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-470"></a>    <span class="n">stress_slvnt</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-471"></a>
<a name="ln-472"></a>    <span class="n">mass_tot</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">com</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">vcom</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-473"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms_tot</span>
<a name="ln-474"></a>        <span class="n">massi</span> <span class="o">=</span> <span class="n">mass</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-475"></a>        <span class="n">mass_tot</span> <span class="o">=</span> <span class="n">mass_tot</span> <span class="o">+</span> <span class="n">massi</span>
<a name="ln-476"></a>        <span class="n">com</span> <span class="o">=</span> <span class="n">com</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-477"></a>        <span class="n">vcom</span> <span class="o">=</span> <span class="n">vcom</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="n">velocities</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-478"></a>    <span class="k">end do</span>
<a name="ln-479"></a><span class="k">    </span><span class="n">com</span> <span class="o">=</span> <span class="n">com</span><span class="o">/</span><span class="n">mass_tot</span>
<a name="ln-480"></a>    <span class="n">vcom</span> <span class="o">=</span> <span class="n">vcom</span><span class="o">/</span><span class="n">mass_tot</span>
<a name="ln-481"></a>
<a name="ln-482"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-483"></a>        <span class="n">massi</span> <span class="o">=</span> <span class="n">mass</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-484"></a>        <span class="n">energy_kin</span> <span class="o">=</span> <span class="n">energy_kin</span> <span class="o">+</span> <span class="mf">0.5_rp</span><span class="o">*</span><span class="n">massi</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">velocities</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-485"></a>
<a name="ln-486"></a>        <span class="n">vi</span> <span class="o">=</span> <span class="n">velocities</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">vcom</span>
<a name="ln-487"></a>        <span class="n">stress_kin</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_kin</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-488"></a>        <span class="n">stress_kin</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_kin</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-489"></a>        <span class="n">stress_kin</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_kin</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-490"></a>
<a name="ln-491"></a>        <span class="n">stress_kin</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_kin</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-492"></a>        <span class="n">stress_kin</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_kin</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-493"></a>        <span class="n">stress_kin</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_kin</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-494"></a>
<a name="ln-495"></a>        <span class="n">stress_kin</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_kin</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-496"></a>        <span class="n">stress_kin</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_kin</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-497"></a>        <span class="n">stress_kin</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_kin</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">massi</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-498"></a>    <span class="k">end do</span>
<a name="ln-499"></a>
<a name="ln-500"></a><span class="k">    do </span><span class="n">i</span> <span class="o">=</span> <span class="n">num_atoms</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms_tot</span>
<a name="ln-501"></a>        <span class="c">!Mass of MPCD particles is 1 (non-dimensionalized form).</span>
<a name="ln-502"></a>        <span class="n">energy_kin</span> <span class="o">=</span> <span class="n">energy_kin</span> <span class="o">+</span> <span class="mf">0.5_rp</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">velocities</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-503"></a>
<a name="ln-504"></a>        <span class="n">vi</span> <span class="o">=</span> <span class="n">velocities</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">vcom</span>
<a name="ln-505"></a>        <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-506"></a>        <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-507"></a>        <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-508"></a>
<a name="ln-509"></a>        <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-510"></a>        <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-511"></a>        <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-512"></a>
<a name="ln-513"></a>        <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">vi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-514"></a>        <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">vi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-515"></a>        <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">stress_slvnt</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">vi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-516"></a>    <span class="k">end do</span>
<a name="ln-517"></a><span class="k">    </span><span class="n">energy_tot</span> <span class="o">=</span> <span class="n">energy_tot</span> <span class="o">+</span> <span class="n">energy_kin</span>
<a name="ln-518"></a>
<a name="ln-519"></a>    <span class="n">stress_kin</span> <span class="o">=</span> <span class="n">stress_kin</span><span class="o">/</span><span class="n">simbox</span><span class="p">%</span><span class="n">volume</span>
<a name="ln-520"></a>    <span class="n">stress</span> <span class="o">=</span> <span class="n">stress</span> <span class="o">+</span> <span class="n">stress_kin</span>
<a name="ln-521"></a>    <span class="n">stress_slvnt</span> <span class="o">=</span> <span class="n">stress_slvnt</span><span class="o">/</span><span class="n">simbox</span><span class="p">%</span><span class="n">volume</span>
<a name="ln-522"></a>
<a name="ln-523"></a>    <span class="k">end subroutine</span>
<a name="ln-524"></a>
<a name="ln-525"></a><span class="c">!******************************************************************************</span>
<a name="ln-526"></a>
<a name="ln-527"></a><span class="k">end module </span><span class="n">m_mpcd</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> BROWNPAK was developed by Sarit Dutta</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>