<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for BROWNPAK">
   
    <meta name="author" content="Sarit Dutta" >
    <link rel="icon" href="../favicon.png">

    <title>cell_list_m.f90 &ndash; BROWNPAK</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">BROWNPAK <small>0.7</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
    <li><a href="../blockdata/nitbd.html">Block Data</a></li>
    
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../blockdata/nitbd.html">Block Data</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>cell_list_m.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 2.3% of total for source files.">195 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/cell_list_m.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">cell_list_m.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/cell_list_m.html">cell_list_m</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/cell_list_m.f90.html#src">cell_list_m.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~cell_list_m.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilecell_list_mf90EfferentGraph" width="443pt" height="147pt"
 viewBox="0.00 0.00 443.00 147.38" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~cell_list_m.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 143.3838)">
<title>sourcefile~~cell_list_m.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-143.3838 439,-143.3838 439,4 -4,4"/>
<!-- sourcefile~cell_list_m.f90 -->
<g id="sourcefile~~cell_list_m.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~cell_list_m.f90</title>
<polygon fill="none" stroke="#000000" points="435,-62.7211 356,-62.7211 356,-38.7211 435,-38.7211 435,-62.7211"/>
<text text-anchor="middle" x="395.5" y="-48.3211" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">cell_list_m.f90</text>
</g>
<!-- sourcefile~simbox_m.f90 -->
<g id="sourcefile~~cell_list_m.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~simbox_m.f90</title>
<g id="a_sourcefile~~cell_list_m.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/simbox_m.f90.html" xlink:title="simbox_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="320,-123.7211 242,-123.7211 242,-99.7211 320,-99.7211 320,-123.7211"/>
<text text-anchor="middle" x="281" y="-109.3211" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">simbox_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~cell_list_m.f90&#45;&gt;sourcefile~simbox_m.f90 -->
<g id="sourcefile~~cell_list_m.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~cell_list_m.f90&#45;&gt;sourcefile~simbox_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M372.8785,-62.7727C355.6279,-71.963 331.6583,-84.7328 312.5269,-94.9251"/>
<polygon fill="#ff0000" stroke="#ff0000" points="310.7545,-91.9036 303.5745,-99.6945 314.0459,-98.0815 310.7545,-91.9036"/>
</g>
<!-- sourcefile~vector_m.f90 -->
<g id="sourcefile~~cell_list_m.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~vector_m.f90</title>
<g id="a_sourcefile~~cell_list_m.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/vector_m.f90.html" xlink:title="vector_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="317.5,-62.7211 244.5,-62.7211 244.5,-38.7211 317.5,-38.7211 317.5,-62.7211"/>
<text text-anchor="middle" x="281" y="-48.3211" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">vector_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~cell_list_m.f90&#45;&gt;sourcefile~vector_m.f90 -->
<g id="sourcefile~~cell_list_m.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~cell_list_m.f90&#45;&gt;sourcefile~vector_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M355.7748,-50.7211C346.7644,-50.7211 337.1131,-50.7211 327.839,-50.7211"/>
<polygon fill="#ff0000" stroke="#ff0000" points="327.5828,-47.2212 317.5827,-50.7211 327.5827,-54.2212 327.5828,-47.2212"/>
</g>
<!-- sourcefile~constants_m.f90 -->
<g id="sourcefile~~cell_list_m.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~constants_m.f90</title>
<g id="a_sourcefile~~cell_list_m.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/constants_m.f90.html" xlink:title="constants_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="90,-83.7211 0,-83.7211 0,-59.7211 90,-59.7211 90,-83.7211"/>
<text text-anchor="middle" x="45" y="-69.3211" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">constants_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~cell_list_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~cell_list_m.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~cell_list_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M368.3832,-38.5927C318.9637,-18.2465 211.4557,17.8578 126,-10.7211 101.4044,-18.9466 78.2924,-37.9061 63.1018,-52.5215"/>
<polygon fill="#ff0000" stroke="#ff0000" points="60.524,-50.1491 55.9142,-59.6885 65.4667,-55.106 60.524,-50.1491"/>
</g>
<!-- sourcefile~simbox_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~cell_list_m.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~simbox_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M250.5279,-123.7794C218.7087,-134.5581 167.7208,-146.6737 126,-132.7211 101.4044,-124.4956 78.2924,-105.536 63.1018,-90.9207"/>
<polygon fill="#ff0000" stroke="#ff0000" points="65.4667,-88.3362 55.9142,-83.7536 60.524,-93.293 65.4667,-88.3362"/>
</g>
<!-- sourcefile~random_m.f90 -->
<g id="sourcefile~~cell_list_m.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~random_m.f90</title>
<g id="a_sourcefile~~cell_list_m.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/random_m.f90.html" xlink:title="random_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="206,-123.7211 126,-123.7211 126,-99.7211 206,-99.7211 206,-123.7211"/>
<text text-anchor="middle" x="166" y="-109.3211" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">random_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simbox_m.f90&#45;&gt;sourcefile~random_m.f90 -->
<g id="sourcefile~~cell_list_m.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~simbox_m.f90&#45;&gt;sourcefile~random_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M241.7452,-111.7211C233.6036,-111.7211 224.9176,-111.7211 216.4394,-111.7211"/>
<polygon fill="#ff0000" stroke="#ff0000" points="216.2517,-108.2212 206.2517,-111.7211 216.2517,-115.2212 216.2517,-108.2212"/>
</g>
<!-- sourcefile~vector_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~cell_list_m.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~vector_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M244.3839,-53.9793C205.8278,-57.4101 144.6697,-62.8522 100.2464,-66.8051"/>
<polygon fill="#00ff00" stroke="#00ff00" points="99.8389,-63.3274 90.1885,-67.7001 100.4594,-70.2999 99.8389,-63.3274"/>
</g>
<!-- sourcefile~qsort_m.f90 -->
<g id="sourcefile~~cell_list_m.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~qsort_m.f90</title>
<g id="a_sourcefile~~cell_list_m.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/qsort_m.f90.html" xlink:title="qsort_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="200,-43.7211 132,-43.7211 132,-19.7211 200,-19.7211 200,-43.7211"/>
<text text-anchor="middle" x="166" y="-29.3211" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">qsort_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~vector_m.f90&#45;&gt;sourcefile~qsort_m.f90 -->
<g id="sourcefile~~cell_list_m.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~vector_m.f90&#45;&gt;sourcefile~qsort_m.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M244.2971,-44.6571C233.4264,-42.8611 221.4096,-40.8757 210.1212,-39.0107"/>
<polygon fill="#00ff00" stroke="#00ff00" points="210.4496,-35.5175 200.0128,-37.3406 209.3085,-42.4239 210.4496,-35.5175"/>
</g>
<!-- sourcefile~random_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~cell_list_m.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~random_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M129.696,-99.7198C117.6031,-95.7221 103.9661,-91.214 91.2248,-87.002"/>
<polygon fill="#ff0000" stroke="#ff0000" points="92.2898,-83.6678 81.6966,-83.8522 90.0927,-90.3141 92.2898,-83.6678"/>
</g>
<!-- sourcefile~qsort_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~cell_list_m.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~qsort_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M131.9728,-42.9698C119.2608,-47.1721 104.6065,-52.0164 90.9935,-56.5166"/>
<polygon fill="#00ffff" stroke="#00ffff" points="89.7039,-53.2566 81.3078,-59.7185 91.9011,-59.9028 89.7039,-53.2566"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~cell_list_m.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilecell_list_mf90AfferentGraph" width="641pt" height="51pt"
 viewBox="0.00 0.00 641.00 51.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~cell_list_m.f90~~AfferentGraph" class="graph" transform="scale(.9846 .9846) rotate(0) translate(4 48)">
<title>sourcefile~~cell_list_m.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-48 647,-48 647,4 -4,4"/>
<!-- sourcefile~cell_list_m.f90 -->
<g id="sourcefile~~cell_list_m.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~cell_list_m.f90</title>
<polygon fill="none" stroke="#000000" points="79,-44 0,-44 0,-20 79,-20 79,-44"/>
<text text-anchor="middle" x="39.5" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">cell_list_m.f90</text>
</g>
<!-- sourcefile~pairtab_m.fpp -->
<g id="sourcefile~~cell_list_m.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~pairtab_m.fpp</title>
<g id="a_sourcefile~~cell_list_m.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/pairtab_m.fpp.html" xlink:title="pairtab_m.fpp">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="192,-44 115,-44 115,-20 192,-20 192,-44"/>
<text text-anchor="middle" x="153.5" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pairtab_m.fpp</text>
</a>
</g>
</g>
<!-- sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~cell_list_m.f90 -->
<g id="sourcefile~~cell_list_m.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~cell_list_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M114.9048,-32C106.7306,-32 97.9907,-32 89.4641,-32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="89.2217,-28.5001 79.2216,-32 89.2216,-35.5001 89.2217,-28.5001"/>
</g>
<!-- sourcefile~interaction_m.f90 -->
<g id="sourcefile~~cell_list_m.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~interaction_m.f90</title>
<g id="a_sourcefile~~cell_list_m.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/interaction_m.f90.html" xlink:title="interaction_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="321,-44 228,-44 228,-20 321,-20 321,-44"/>
<text text-anchor="middle" x="274.5" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">interaction_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~interaction_m.f90&#45;&gt;sourcefile~pairtab_m.fpp -->
<g id="sourcefile~~cell_list_m.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~interaction_m.f90&#45;&gt;sourcefile~pairtab_m.fpp</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M227.7182,-32C219.3971,-32 210.7105,-32 202.334,-32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="202.3157,-28.5001 192.3157,-32 202.3157,-35.5001 202.3157,-28.5001"/>
</g>
<!-- sourcefile~setup_m.f90 -->
<g id="sourcefile~~cell_list_m.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~setup_m.f90</title>
<g id="a_sourcefile~~cell_list_m.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/setup_m.f90.html" xlink:title="setup_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="553,-44 483,-44 483,-20 553,-20 553,-44"/>
<text text-anchor="middle" x="518" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">setup_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~setup_m.f90&#45;&gt;sourcefile~interaction_m.f90 -->
<g id="sourcefile~~cell_list_m.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~setup_m.f90&#45;&gt;sourcefile~interaction_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M482.9715,-32.5912C471.5076,-32.7586 458.7109,-32.9175 447,-33 407.001,-33.2817 396.9993,-33.2424 357,-33 348.6609,-32.9495 339.848,-32.8702 331.2079,-32.7779"/>
<polygon fill="#ff0000" stroke="#ff0000" points="331.2225,-29.2779 321.1835,-32.6644 331.1432,-36.2775 331.2225,-29.2779"/>
</g>
<!-- sourcefile~bd_solver_m.f90 -->
<g id="sourcefile~~cell_list_m.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~bd_solver_m.f90</title>
<g id="a_sourcefile~~cell_list_m.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/bd_solver_m.f90.html" xlink:title="bd_solver_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447,-24 357,-24 357,0 447,0 447,-24"/>
<text text-anchor="middle" x="402" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">bd_solver_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~setup_m.f90&#45;&gt;sourcefile~bd_solver_m.f90 -->
<g id="sourcefile~~cell_list_m.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~setup_m.f90&#45;&gt;sourcefile~bd_solver_m.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M482.8814,-25.9451C474.8294,-24.5568 466.0767,-23.0477 457.4017,-21.552"/>
<polygon fill="#00ffff" stroke="#00ffff" points="457.7496,-18.0604 447.3003,-19.8104 456.5602,-24.9586 457.7496,-18.0604"/>
</g>
<!-- sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~interaction_m.f90 -->
<g id="sourcefile~~cell_list_m.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~interaction_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M356.6893,-19.1076C348.5474,-20.3847 339.9666,-21.7307 331.5436,-23.052"/>
<polygon fill="#ff0000" stroke="#ff0000" points="330.7247,-19.6376 321.3879,-24.645 331.8095,-26.553 330.7247,-19.6376"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~cell_list_m.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~cell_list_m.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="643,-44 589,-44 589,-20 643,-20 643,-44"/>
<text text-anchor="middle" x="616" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~setup_m.f90 -->
<g id="sourcefile~~cell_list_m.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~setup_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M588.9616,-32C580.9804,-32 572.0189,-32 563.2209,-32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="563.0365,-28.5001 553.0365,-32 563.0364,-35.5001 563.0365,-28.5001"/>
</g>
</g>
</svg>
</div><script>var pansourcefilecell_list_mf90AfferentGraph = svgPanZoom('#sourcefilecell_list_mf90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/cell_list_m.html">cell_list_m</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/cell_list_m.f90.html#src">cell_list_m.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">module </span><span class="n">cell_list_m</span>
<a name="ln-2"></a>    <span class="c">!! Sorts atoms using a cell list.</span>
<a name="ln-3"></a>    <span class="c">!!</span>
<a name="ln-4"></a>    <span class="c">!! The algorithm to build the cell list partially follows the techniques in Watanabe et</span>
<a name="ln-5"></a>    <span class="c">!! al, 2011, “Efficient Implementations of Molecular Dynamics Simulations for</span>
<a name="ln-6"></a>    <span class="c">!! Lennard-Jones Systems,” Prog. Theor. Phys. 126, 203–235.</span>
<a name="ln-7"></a>    <span class="c">!!</span>
<a name="ln-8"></a>    <span class="c">!! The pairlist is not explicitly built, rather the cells are directly</span>
<a name="ln-9"></a>    <span class="c">!! looped over during force calculation.</span>
<a name="ln-10"></a>
<a name="ln-11"></a><span class="k">use </span><span class="n">constants_m</span>
<a name="ln-12"></a><span class="k">use </span><span class="n">vector_m</span>
<a name="ln-13"></a><span class="k">use </span><span class="n">simbox_m</span>
<a name="ln-14"></a>
<a name="ln-15"></a><span class="k">implicit none</span>
<a name="ln-16"></a>
<a name="ln-17"></a><span class="k">private</span>
<a name="ln-18"></a>
<a name="ln-19"></a><span class="k">public</span> <span class="kd">::</span> <span class="n">cl_init</span><span class="p">,</span> <span class="n">cl_delete</span><span class="p">,</span> <span class="n">cl_print</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-20"></a>          <span class="n">cl_set_cell_size</span><span class="p">,</span> <span class="n">cl_build</span><span class="p">,</span> <span class="n">cl_build_cell_nbrs</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-21"></a>          <span class="n">cl_get_num_cells</span><span class="p">,</span> <span class="n">cl_get_contents</span><span class="p">,</span> <span class="n">cl_get_nbr_cells</span> 
<a name="ln-22"></a>
<a name="ln-23"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">cell_size</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-24"></a>    <span class="c">!! Cell size along *x*, *y*, &amp; *z*.</span>
<a name="ln-25"></a><span class="kt">integer</span><span class="p">,</span>  <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">nc_max</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-26"></a>    <span class="c">!! Maximum number of cells along *x*, *y*, &amp; *z*.</span>
<a name="ln-27"></a><span class="kt">integer</span><span class="p">,</span>  <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">nc</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-28"></a>    <span class="c">!! Number of cells along *x*, *y*, &amp; *z*.</span>
<a name="ln-29"></a><span class="kt">integer</span>  <span class="kd">::</span> <span class="n">nct_max</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-30"></a>    <span class="c">!! Maximum total number of cells.</span>
<a name="ln-31"></a><span class="kt">integer</span>  <span class="kd">::</span> <span class="n">nct</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-32"></a>    <span class="c">!! Total of cells.</span>
<a name="ln-33"></a><span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">cells</span>
<a name="ln-34"></a>    <span class="c">!! *(na_max,)* array. Listing atoms in each cell.</span>
<a name="ln-35"></a><span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">cells_pos</span>
<a name="ln-36"></a>    <span class="c">!! *(0:nct_max,)* index array. Note: 0-based indexing.</span>
<a name="ln-37"></a><span class="k">type</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cell_nbrs</span>
<a name="ln-38"></a>    <span class="c">!! Lists neighbor cells for each cell.</span>
<a name="ln-39"></a><span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">cell_nbrs_pos</span>
<a name="ln-40"></a>    <span class="c">!! *(0:nct_max,)* index array. Note: 0-based indexing.</span>
<a name="ln-41"></a><span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">host_cells</span>
<a name="ln-42"></a>    <span class="c">!! *(na_max,)* array. *host_cells(i)* stores the linear index of the cell</span>
<a name="ln-43"></a>    <span class="c">!! containing atom *i*. *na_max* is the total number of atoms under consideration.</span>
<a name="ln-44"></a><span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">cell_pop</span>
<a name="ln-45"></a>    <span class="c">!! *(0:nct_max-1,)* array storing population of each cell. Note: 0-based indexing.</span>
<a name="ln-46"></a><span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">13</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">d</span> <span class="o">=</span> <span class="nb">reshape</span><span class="p">(</span> <span class="p">[</span>           <span class="p">&amp;</span>
<a name="ln-47"></a>                <span class="p">&amp;</span>                            <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-48"></a>                <span class="p">&amp;</span>    <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>   <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-49"></a>                <span class="p">&amp;</span>    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>   <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-50"></a>                <span class="p">&amp;</span>   <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-51"></a>                <span class="p">&amp;</span>   <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">13</span><span class="p">]</span> <span class="p">)</span>
<a name="ln-52"></a>
<a name="ln-53"></a><span class="k">contains</span>
<a name="ln-54"></a>
<a name="ln-55"></a><span class="c">!******************************************************************************</span>
<a name="ln-56"></a>
<a name="ln-57"></a><span class="k">subroutine </span><span class="n">cl_init</span><span class="p">(</span><span class="n">na_max</span><span class="p">,</span> <span class="n">cs_min</span><span class="p">,</span> <span class="n">simbox</span><span class="p">)</span>
<a name="ln-58"></a>    <span class="c">!! Initializes a cell list.</span>
<a name="ln-59"></a>
<a name="ln-60"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">na_max</span>
<a name="ln-61"></a>        <span class="c">!! Maximum number of atoms to be handled.</span>
<a name="ln-62"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cs_min</span>
<a name="ln-63"></a>        <span class="c">!! Minimum size (i.e. length) of a cell.</span>
<a name="ln-64"></a>    <span class="k">type</span><span class="p">(</span><span class="n">smbx_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">simbox</span>
<a name="ln-65"></a>        <span class="c">!! Simulation box</span>
<a name="ln-66"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">nelem</span>
<a name="ln-67"></a>    
<a name="ln-68"></a>    <span class="c">!The following defines an upper bound on the number of cells</span>
<a name="ln-69"></a>    <span class="n">nc_max</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">ceiling</span><span class="p">(</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">cs_min</span> <span class="p">)</span>
<a name="ln-70"></a>    <span class="n">nc_max</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="nb">ceiling</span><span class="p">(</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">cs_min</span> <span class="p">)</span>
<a name="ln-71"></a>    <span class="n">nc_max</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">ceiling</span><span class="p">(</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">cs_min</span> <span class="p">)</span>
<a name="ln-72"></a>
<a name="ln-73"></a>    <span class="n">nct_max</span> <span class="o">=</span> <span class="nb">product</span><span class="p">(</span><span class="n">nc_max</span><span class="p">)</span>
<a name="ln-74"></a>
<a name="ln-75"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">na_max</span><span class="p">))</span>
<a name="ln-76"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">cells_pos</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nct_max</span><span class="p">))</span>
<a name="ln-77"></a>
<a name="ln-78"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">host_cells</span><span class="p">(</span><span class="n">na_max</span><span class="p">))</span>
<a name="ln-79"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">cell_pop</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nct_max</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-80"></a>
<a name="ln-81"></a>    <span class="c">!Provisional allocation with nelem (arbitrary) elements,</span>
<a name="ln-82"></a>    <span class="c">!will expand/contract later.</span>
<a name="ln-83"></a>    <span class="n">nelem</span> <span class="o">=</span> <span class="mi">8</span>
<a name="ln-84"></a>    <span class="k">call </span><span class="n">ivector_init</span><span class="p">(</span><span class="n">cell_nbrs</span><span class="p">,</span> <span class="n">nelem</span><span class="p">)</span>
<a name="ln-85"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nelem</span><span class="p">))</span>
<a name="ln-86"></a>
<a name="ln-87"></a>    <span class="k">end subroutine</span>
<a name="ln-88"></a>
<a name="ln-89"></a><span class="c">!******************************************************************************</span>
<a name="ln-90"></a>
<a name="ln-91"></a><span class="k">subroutine </span><span class="n">cl_set_cell_size</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">simbox</span><span class="p">)</span>
<a name="ln-92"></a>    <span class="c">!! Sets the cell size. The actual cell size may be slightly larger.</span>
<a name="ln-93"></a>
<a name="ln-94"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cs</span>
<a name="ln-95"></a>    <span class="k">type</span><span class="p">(</span><span class="n">smbx_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">simbox</span>
<a name="ln-96"></a>
<a name="ln-97"></a>    <span class="n">nc</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">floor</span><span class="p">(</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">cs</span> <span class="p">)</span>
<a name="ln-98"></a>    <span class="n">nc</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="nb">floor</span><span class="p">(</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">cs</span> <span class="p">)</span>
<a name="ln-99"></a>    <span class="n">nc</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">floor</span><span class="p">(</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">cs</span> <span class="p">)</span>
<a name="ln-100"></a>
<a name="ln-101"></a>    <span class="n">nct</span> <span class="o">=</span> <span class="nb">product</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span>
<a name="ln-102"></a>
<a name="ln-103"></a>    <span class="n">cell_size</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">nc</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-104"></a>    <span class="n">cell_size</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">nc</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-105"></a>    <span class="n">cell_size</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">nc</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-106"></a>
<a name="ln-107"></a>    <span class="k">end subroutine</span>
<a name="ln-108"></a>
<a name="ln-109"></a><span class="c">!******************************************************************************</span>
<a name="ln-110"></a>
<a name="ln-111"></a><span class="k">subroutine </span><span class="n">cl_build_cell_nbrs</span><span class="p">()</span>
<a name="ln-112"></a>    <span class="c">!! Makes a table of neighboring cells.</span>
<a name="ln-113"></a>
<a name="ln-114"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">j</span>
<a name="ln-115"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ncx</span><span class="p">,</span> <span class="n">ncy</span><span class="p">,</span> <span class="n">ncz</span>
<a name="ln-116"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">icx</span><span class="p">,</span> <span class="n">icy</span><span class="p">,</span> <span class="n">icz</span><span class="p">,</span> <span class="n">ic</span>
<a name="ln-117"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">jcx</span><span class="p">,</span> <span class="n">jcy</span><span class="p">,</span> <span class="n">jcz</span><span class="p">,</span> <span class="n">jc</span>
<a name="ln-118"></a>
<a name="ln-119"></a>    <span class="k">if</span> <span class="p">(</span> <span class="n">size</span><span class="p">(</span><span class="n">cell_nbrs_pos</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">nct</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-120"></a><span class="k">        deallocate</span><span class="p">(</span><span class="n">cell_nbrs_pos</span><span class="p">)</span>
<a name="ln-121"></a>        <span class="k">allocate</span><span class="p">(</span><span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nct</span><span class="p">))</span>
<a name="ln-122"></a>    <span class="k">end if</span>
<a name="ln-123"></a>
<a name="ln-124"></a><span class="k">    </span><span class="n">ncx</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">ncy</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">ncz</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-125"></a>
<a name="ln-126"></a>    <span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-127"></a>
<a name="ln-128"></a>    <span class="k">do </span><span class="n">icz</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncz</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-129"></a>        <span class="k">do </span><span class="n">icy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncy</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-130"></a>            <span class="k">do </span><span class="n">icx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-131"></a>                <span class="n">ic</span> <span class="o">=</span> <span class="n">icz</span><span class="o">*</span><span class="n">ncx</span><span class="o">*</span><span class="n">ncy</span> <span class="o">+</span> <span class="n">icy</span><span class="o">*</span><span class="n">ncx</span> <span class="o">+</span> <span class="n">icx</span>
<a name="ln-132"></a>                <span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-133"></a>                <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span>
<a name="ln-134"></a>                    <span class="n">jcx</span> <span class="o">=</span> <span class="nb">modulo</span><span class="p">(</span> <span class="n">icx</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">),</span> <span class="n">ncx</span> <span class="p">)</span>
<a name="ln-135"></a>                    <span class="n">jcy</span> <span class="o">=</span> <span class="nb">modulo</span><span class="p">(</span> <span class="n">icy</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="p">),</span> <span class="n">ncy</span> <span class="p">)</span>
<a name="ln-136"></a>                    <span class="n">jcz</span> <span class="o">=</span> <span class="nb">modulo</span><span class="p">(</span> <span class="n">icz</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">j</span><span class="p">),</span> <span class="n">ncz</span> <span class="p">)</span>
<a name="ln-137"></a>                    <span class="n">jc</span> <span class="o">=</span> <span class="n">jcz</span><span class="o">*</span><span class="n">ncx</span><span class="o">*</span><span class="n">ncy</span> <span class="o">+</span> <span class="n">jcy</span><span class="o">*</span><span class="n">ncx</span> <span class="o">+</span> <span class="n">jcx</span>
<a name="ln-138"></a>                    <span class="k">call </span><span class="n">cell_nbrs</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="n">jc</span><span class="p">)</span>
<a name="ln-139"></a>                    <span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-140"></a>                <span class="k">end do</span>
<a name="ln-141"></a><span class="k">            end do</span>
<a name="ln-142"></a><span class="k">        end do</span>
<a name="ln-143"></a><span class="k">    end do</span>
<a name="ln-144"></a>
<a name="ln-145"></a><span class="k">    call </span><span class="n">cell_nbrs</span><span class="p">%</span><span class="n">shrink_to_fit</span><span class="p">()</span>
<a name="ln-146"></a>
<a name="ln-147"></a>    <span class="k">end subroutine</span>
<a name="ln-148"></a>
<a name="ln-149"></a><span class="c">!******************************************************************************</span>
<a name="ln-150"></a>
<a name="ln-151"></a><span class="k">subroutine </span><span class="n">cl_delete</span><span class="p">()</span>
<a name="ln-152"></a>    <span class="c">!! Deallocates memory allocated in `cl_init`.</span>
<a name="ln-153"></a>
<a name="ln-154"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">cells</span><span class="p">))</span>         <span class="k">deallocate</span><span class="p">(</span><span class="n">cells</span><span class="p">)</span>
<a name="ln-155"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">cells_pos</span><span class="p">))</span>     <span class="k">deallocate</span><span class="p">(</span><span class="n">cells_pos</span><span class="p">)</span>
<a name="ln-156"></a>
<a name="ln-157"></a>    <span class="k">call </span><span class="n">cell_nbrs</span><span class="p">%</span><span class="n">delete</span><span class="p">()</span>
<a name="ln-158"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">cell_nbrs_pos</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">cell_nbrs_pos</span><span class="p">)</span>
<a name="ln-159"></a>
<a name="ln-160"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">host_cells</span><span class="p">))</span>    <span class="k">deallocate</span><span class="p">(</span><span class="n">host_cells</span><span class="p">)</span>
<a name="ln-161"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">cell_pop</span><span class="p">))</span>      <span class="k">deallocate</span><span class="p">(</span><span class="n">cell_pop</span><span class="p">)</span>
<a name="ln-162"></a>
<a name="ln-163"></a>    <span class="n">cell_size</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-164"></a>    <span class="n">nc_max</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">nc</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-165"></a>    <span class="n">nct_max</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">nct</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-166"></a>
<a name="ln-167"></a>    <span class="k">end subroutine</span>
<a name="ln-168"></a>
<a name="ln-169"></a><span class="c">!******************************************************************************</span>
<a name="ln-170"></a>
<a name="ln-171"></a><span class="k">subroutine </span><span class="n">cl_build</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
<a name="ln-172"></a>    <span class="c">!! Sorts atoms into cells for calculating short-range interations</span>
<a name="ln-173"></a>
<a name="ln-174"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">coords</span>
<a name="ln-175"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ri</span>
<a name="ln-176"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">na</span><span class="p">,</span> <span class="n">iatm</span><span class="p">,</span> <span class="n">j</span>
<a name="ln-177"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ncx</span><span class="p">,</span> <span class="n">ncy</span><span class="p">,</span> <span class="n">ncz</span>
<a name="ln-178"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">icx</span><span class="p">,</span> <span class="n">icy</span><span class="p">,</span> <span class="n">icz</span><span class="p">,</span> <span class="n">ic</span>
<a name="ln-179"></a>
<a name="ln-180"></a>    <span class="n">cells</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-181"></a>    <span class="n">host_cells</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-182"></a>    <span class="n">cell_pop</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-183"></a>    <span class="n">ncx</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">ncy</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">ncz</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-184"></a>    <span class="n">na</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-185"></a>
<a name="ln-186"></a>    <span class="c">!Loop over particles and put into cells</span>
<a name="ln-187"></a>    <span class="k">do </span><span class="n">iatm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na</span>
<a name="ln-188"></a>        <span class="n">ri</span> <span class="o">=</span> <span class="n">coords</span><span class="p">(:,</span><span class="n">iatm</span><span class="p">)</span>
<a name="ln-189"></a>        <span class="n">icx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">ri</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">cell_size</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-190"></a>        <span class="n">icy</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">cell_size</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-191"></a>        <span class="n">icz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">ri</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">cell_size</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-192"></a>
<a name="ln-193"></a>        <span class="k">if</span> <span class="p">((</span><span class="n">icx</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">icy</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">icz</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-194"></a><span class="k">            print</span><span class="o">*</span><span class="p">,</span> <span class="n">ri</span>
<a name="ln-195"></a>            <span class="k">stop</span>
<a name="ln-196"></a><span class="k">        end if</span>
<a name="ln-197"></a>
<a name="ln-198"></a>        <span class="c">!If atoms are exactly on the box edge</span>
<a name="ln-199"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">icx</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">ncx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="n">icx</span> <span class="o">=</span> <span class="n">ncx</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-200"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">icy</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">ncy</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="n">icy</span> <span class="o">=</span> <span class="n">ncy</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-201"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">icz</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">ncz</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="n">icz</span> <span class="o">=</span> <span class="n">ncz</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-202"></a>
<a name="ln-203"></a>        <span class="n">ic</span> <span class="o">=</span> <span class="n">icz</span><span class="o">*</span><span class="n">ncx</span><span class="o">*</span><span class="n">ncy</span> <span class="o">+</span> <span class="n">icy</span><span class="o">*</span><span class="n">ncx</span> <span class="o">+</span> <span class="n">icx</span>
<a name="ln-204"></a>        <span class="n">host_cells</span><span class="p">(</span><span class="n">iatm</span><span class="p">)</span> <span class="o">=</span> <span class="n">ic</span>
<a name="ln-205"></a>        <span class="n">cell_pop</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">cell_pop</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-206"></a>    <span class="k">end do</span>
<a name="ln-207"></a>
<a name="ln-208"></a>    <span class="c">!Loop over all cells to set up pointers</span>
<a name="ln-209"></a>    <span class="n">cells_pos</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-210"></a>    <span class="k">do </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">nct</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-211"></a>        <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">+</span> <span class="n">cell_pop</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-212"></a>    <span class="k">end do</span>
<a name="ln-213"></a>
<a name="ln-214"></a>    <span class="c">!Loop over all atoms</span>
<a name="ln-215"></a>    <span class="k">do </span><span class="n">iatm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na</span>
<a name="ln-216"></a>        <span class="n">ic</span> <span class="o">=</span> <span class="n">host_cells</span><span class="p">(</span><span class="n">iatm</span><span class="p">)</span>
<a name="ln-217"></a>        <span class="n">j</span> <span class="o">=</span> <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-218"></a>        <span class="n">cells</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">iatm</span>
<a name="ln-219"></a>        <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-220"></a>    <span class="k">end do</span>
<a name="ln-221"></a>
<a name="ln-222"></a>    <span class="c">!Loop over all cells to set up pointers</span>
<a name="ln-223"></a>    <span class="n">cells_pos</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-224"></a>    <span class="k">do </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">nct</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-225"></a>        <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">+</span> <span class="n">cell_pop</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-226"></a>    <span class="k">end do</span>
<a name="ln-227"></a>
<a name="ln-228"></a><span class="k">    end subroutine</span>
<a name="ln-229"></a>
<a name="ln-230"></a><span class="c">!******************************************************************************</span>
<a name="ln-231"></a>
<a name="ln-232"></a><span class="k">function </span><span class="n">cl_get_num_cells</span><span class="p">()</span> <span class="k">result</span> <span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a name="ln-233"></a>    <span class="c">!! Returns the total number of cells</span>
<a name="ln-234"></a>
<a name="ln-235"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-236"></a>
<a name="ln-237"></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">nct</span>
<a name="ln-238"></a>
<a name="ln-239"></a>    <span class="k">end function</span>
<a name="ln-240"></a>
<a name="ln-241"></a><span class="c">!******************************************************************************</span>
<a name="ln-242"></a>
<a name="ln-243"></a><span class="k">subroutine </span><span class="n">cl_get_contents</span><span class="p">(</span><span class="n">ic</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>
<a name="ln-244"></a>    <span class="c">!! Returns a pointer to the entries of cell with linear index *ic*.</span>
<a name="ln-245"></a>
<a name="ln-246"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ic</span>
<a name="ln-247"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-248"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ibeg</span><span class="p">,</span> <span class="n">iend</span>
<a name="ln-249"></a>
<a name="ln-250"></a>    <span class="n">res</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-251"></a>    <span class="n">ibeg</span> <span class="o">=</span> <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="p">);</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-252"></a>    <span class="n">res</span> <span class="o">=&gt;</span> <span class="n">cells</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span>
<a name="ln-253"></a>
<a name="ln-254"></a>    <span class="k">end subroutine</span>
<a name="ln-255"></a>
<a name="ln-256"></a><span class="c">!******************************************************************************</span>
<a name="ln-257"></a>
<a name="ln-258"></a><span class="k">subroutine </span><span class="n">cl_get_nbr_cells</span><span class="p">(</span><span class="n">ic</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>
<a name="ln-259"></a>    <span class="c">!! Returns a pointer to the neighbor cells of cell with linear index *ic*.</span>
<a name="ln-260"></a>
<a name="ln-261"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ic</span>
<a name="ln-262"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-263"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ibeg</span><span class="p">,</span> <span class="n">iend</span>
<a name="ln-264"></a>
<a name="ln-265"></a>    <span class="n">res</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-266"></a>    <span class="n">ibeg</span> <span class="o">=</span> <span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="n">ic</span><span class="p">);</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-267"></a>    <span class="k">call </span><span class="n">cell_nbrs</span><span class="p">%</span><span class="n">get_data</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">ibeg</span><span class="p">,</span> <span class="n">iend</span><span class="p">)</span>
<a name="ln-268"></a>
<a name="ln-269"></a>    <span class="k">end subroutine</span>
<a name="ln-270"></a>
<a name="ln-271"></a><span class="c">!********************************************************************************</span>
<a name="ln-272"></a>
<a name="ln-273"></a><span class="k">subroutine </span><span class="n">cl_print</span><span class="p">()</span>
<a name="ln-274"></a>    <span class="c">!! Prints a cell list</span>
<a name="ln-275"></a>
<a name="ln-276"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">aic</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-277"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">nbrc</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-278"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ncx</span><span class="p">,</span> <span class="n">ncy</span><span class="p">,</span> <span class="n">ncz</span>
<a name="ln-279"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">icx</span><span class="p">,</span> <span class="n">icy</span><span class="p">,</span> <span class="n">icz</span><span class="p">,</span> <span class="n">ic</span>
<a name="ln-280"></a>
<a name="ln-281"></a>    <span class="n">ncx</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">ncy</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">ncz</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-282"></a>
<a name="ln-283"></a>    <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(&quot;ncx: &quot;, i0, &quot; ncy: &quot;, i0, &quot; ncz: &quot;, i0)&#39;</span><span class="p">)</span> <span class="n">ncx</span><span class="p">,</span> <span class="n">ncy</span><span class="p">,</span> <span class="n">ncz</span>
<a name="ln-284"></a>    <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(&quot;lcx: &quot;, g0.6, &quot; lcy: &quot;, g0.6, &quot; lcz: &quot;, g0.6)&#39;</span><span class="p">)</span> <span class="n">cell_size</span>
<a name="ln-285"></a>    <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;CELL CONTENTS&#39;</span>
<a name="ln-286"></a>    <span class="k">do </span><span class="n">icz</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncz</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-287"></a>        <span class="k">do </span><span class="n">icy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncy</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-288"></a>            <span class="k">do </span><span class="n">icx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-289"></a>                <span class="n">ic</span> <span class="o">=</span> <span class="n">icz</span><span class="o">*</span><span class="n">ncx</span><span class="o">*</span><span class="n">ncy</span> <span class="o">+</span> <span class="n">icy</span><span class="o">*</span><span class="n">ncx</span> <span class="o">+</span> <span class="n">icx</span>
<a name="ln-290"></a>                <span class="k">call </span><span class="n">cl_get_contents</span><span class="p">(</span><span class="n">ic</span><span class="p">,</span> <span class="n">aic</span><span class="p">)</span>
<a name="ln-291"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">size</span><span class="p">(</span><span class="n">aic</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-292"></a><span class="k">                    write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(&quot;(&quot;,i0,&quot;,&quot;,i0,&quot;,&quot;,i0,&quot;)[&quot;,i0,&quot;] &quot;)&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">icx</span><span class="p">,</span> <span class="n">icy</span><span class="p">,</span> <span class="n">icz</span><span class="p">,</span> <span class="n">ic</span>
<a name="ln-293"></a>                    <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">size</span><span class="p">(</span><span class="n">aic</span><span class="p">),</span> <span class="n">aic</span>
<a name="ln-294"></a>                <span class="k">end if</span>
<a name="ln-295"></a><span class="k">            end do</span>
<a name="ln-296"></a><span class="k">        end do</span>
<a name="ln-297"></a><span class="k">    end do</span>
<a name="ln-298"></a>
<a name="ln-299"></a><span class="k">    write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>
<a name="ln-300"></a>    <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;NBR CELLS&#39;</span>
<a name="ln-301"></a>    <span class="k">do </span><span class="n">icz</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncz</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-302"></a>        <span class="k">do </span><span class="n">icy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncy</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-303"></a>            <span class="k">do </span><span class="n">icx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-304"></a>                <span class="n">ic</span> <span class="o">=</span> <span class="n">icz</span><span class="o">*</span><span class="n">ncx</span><span class="o">*</span><span class="n">ncy</span> <span class="o">+</span> <span class="n">icy</span><span class="o">*</span><span class="n">ncx</span> <span class="o">+</span> <span class="n">icx</span>
<a name="ln-305"></a>                <span class="k">call </span><span class="n">cl_get_nbr_cells</span><span class="p">(</span><span class="n">ic</span><span class="p">,</span> <span class="n">nbrc</span><span class="p">)</span>
<a name="ln-306"></a>                <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(&quot;(&quot;,i0,&quot;,&quot;,i0,&quot;,&quot;,i0,&quot;)[&quot;,i0,&quot;] &quot;)&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">icx</span><span class="p">,</span> <span class="n">icy</span><span class="p">,</span> <span class="n">icz</span><span class="p">,</span> <span class="n">ic</span>
<a name="ln-307"></a>                <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">size</span><span class="p">(</span><span class="n">nbrc</span><span class="p">),</span> <span class="n">nbrc</span>
<a name="ln-308"></a>            <span class="k">end do</span>
<a name="ln-309"></a><span class="k">        end do</span>
<a name="ln-310"></a><span class="k">    end do</span>
<a name="ln-311"></a>
<a name="ln-312"></a><span class="k">    end subroutine</span>
<a name="ln-313"></a>
<a name="ln-314"></a><span class="c">!********************************************************************************</span>
<a name="ln-315"></a>
<a name="ln-316"></a><span class="k">end module </span><span class="n">cell_list_m</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> BROWNPAK was developed by Sarit Dutta</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>