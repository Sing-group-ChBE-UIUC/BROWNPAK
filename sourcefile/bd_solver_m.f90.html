<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for BROWNPAK">
   
    <meta name="author" content="Sarit Dutta" >
    <link rel="icon" href="../favicon.png">

    <title>bd_solver_m.f90 &ndash; BROWNPAK</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">BROWNPAK <small>0.7</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
    <li><a href="../blockdata/nitbd.html">Block Data</a></li>
    
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../blockdata/nitbd.html">Block Data</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>bd_solver_m.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 4.2% of total for source files.">357 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/bd_solver_m.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">bd_solver_m.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/bd_solver_m.html">bd_solver_m</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/bd_solver_m.f90.html#src">bd_solver_m.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~bd_solver_m.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilebd_solver_mf90EfferentGraph" width="641pt" height="605pt"
 viewBox="0.00 0.00 641.00 605.46" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph" class="graph" transform="scale(.6574 .6574) rotate(0) translate(4 916.9448)">
<title>sourcefile~~bd_solver_m.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-916.9448 971,-916.9448 971,4 -4,4"/>
<!-- sourcefile~bd_solver_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~bd_solver_m.f90</title>
<polygon fill="none" stroke="#000000" points="967,-446 877,-446 877,-422 967,-422 967,-446"/>
<text text-anchor="middle" x="922" y="-431.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">bd_solver_m.f90</text>
</g>
<!-- sourcefile~config_io_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~config_io_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/config_io_m.f90.html" xlink:title="config_io_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="582,-626 495,-626 495,-602 582,-602 582,-626"/>
<text text-anchor="middle" x="538.5" y="-611.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">config_io_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~config_io_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~config_io_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M794.5,-774C694.0946,-820.4588 685.2565,-687.7336 588,-635 585.0867,-633.4204 582.0295,-631.875 578.9244,-630.3848"/>
<polygon fill="#ff0000" stroke="#ff0000" points="580.1106,-627.0786 569.561,-626.1005 577.198,-633.444 580.1106,-627.0786"/>
</g>
<!-- sourcefile~brown_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~brown_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/brown_m.f90.html" xlink:title="brown_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="448.5,-864 375.5,-864 375.5,-840 448.5,-840 448.5,-864"/>
<text text-anchor="middle" x="412" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">brown_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~brown_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~brown_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M538.5,-892C504.2926,-894.6876 467.0612,-880.7026 441.9084,-868.5388"/>
<polygon fill="#ff0000" stroke="#ff0000" points="443.3977,-865.3702 432.8912,-864.0046 440.253,-871.624 443.3977,-865.3702"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M794.5,-774C736.3586,-797.3137 600.949,-887.0934 538.5,-892"/>
</g>
<!-- sourcefile~logger_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~logger_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/logger_m.f90.html" xlink:title="logger_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="332,-864 258,-864 258,-840 332,-840 332,-864"/>
<text text-anchor="middle" x="295" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">logger_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~logger_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~logger_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M412,-892C382.6156,-889.5066 351.0762,-878.1707 328.1562,-868.2005"/>
<polygon fill="#ff0000" stroke="#ff0000" points="329.4488,-864.9443 318.8925,-864.0409 326.5814,-871.3301 329.4488,-864.9443"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M538.5,-892C482.6545,-898.4978 468.0209,-896.7536 412,-892"/>
</g>
<!-- sourcefile~atmcfg_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~atmcfg_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/atmcfg_m.f90.html" xlink:title="atmcfg_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="450,-194 374,-194 374,-170 450,-170 450,-194"/>
<text text-anchor="middle" x="412" y="-179.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">atmcfg_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~atmcfg_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~atmcfg_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M794.5,-212C702.0539,-137.5685 657.1215,-139.9079 538.5,-136"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M918.7083,-421.9149C907.8582,-384.4489 869.555,-269.3331 794.5,-212"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M538.5,-136C502.7062,-134.0252 464.3868,-150.9345 439.4213,-164.8053"/>
<polygon fill="#ff0000" stroke="#ff0000" points="437.4543,-161.8993 430.5399,-169.9269 440.9512,-167.9632 437.4543,-161.8993"/>
</g>
<!-- sourcefile~control_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~control_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/control_m.f90.html" xlink:title="control_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="450,-274 374,-274 374,-250 450,-250 450,-274"/>
<text text-anchor="middle" x="412" y="-259.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">control_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~control_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~control_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M538.5,-258C512.7469,-261.0682 483.8499,-262.1574 460.1828,-262.4403"/>
<polygon fill="#ff0000" stroke="#ff0000" points="460.0198,-258.9414 450.0465,-262.5167 460.0727,-265.9412 460.0198,-258.9414"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M794.5,-212C703.9365,-140.1556 653.2882,-244.3243 538.5,-258"/>
</g>
<!-- sourcefile~stats_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~stats_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/stats_m.f90.html" xlink:title="stats_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="572,-348 505,-348 505,-324 572,-324 572,-348"/>
<text text-anchor="middle" x="538.5" y="-333.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">stats_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~stats_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~stats_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M794.5,-774C651.6636,-836.5403 805.6288,-557.6884 712,-433 679.4566,-389.6609 621.5446,-362.9905 581.6383,-348.8479"/>
<polygon fill="#ff0000" stroke="#ff0000" points="582.7532,-345.5302 572.1587,-345.6028 580.4861,-352.153 582.7532,-345.5302"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M919.7488,-446.0573C908.8001,-503.0771 859.0085,-744.1511 794.5,-774"/>
</g>
<!-- sourcefile~trajectory_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~trajectory_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/trajectory_m.f90.html" xlink:title="trajectory_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="712,-902 624,-902 624,-878 712,-878 712,-902"/>
<text text-anchor="middle" x="668" y="-887.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">trajectory_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~trajectory_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~trajectory_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M794.5,-774C744.7931,-795.7639 754.1496,-829.826 712,-864 708.2352,-867.0525 704.0736,-869.986 699.8562,-872.7125"/>
<polygon fill="#ff0000" stroke="#ff0000" points="697.9336,-869.7856 691.2297,-877.9898 701.5866,-875.7569 697.9336,-869.7856"/>
</g>
<!-- sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~constants_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/constants_m.f90.html" xlink:title="constants_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="90,-656 0,-656 0,-632 90,-632 90,-656"/>
<text text-anchor="middle" x="45" y="-641.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">constants_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M295,-892C219.4654,-889.2598 185.1794,-920.0189 126,-873 92.4774,-846.3658 61.1732,-717.9081 49.6589,-665.9146"/>
<polygon fill="#ff0000" stroke="#ff0000" points="53.0572,-665.0703 47.5086,-656.0445 46.2176,-666.5604 53.0572,-665.0703"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M412,-892C360.1862,-887.6034 346.9041,-895.1561 295,-892"/>
</g>
<!-- sourcefile~interaction_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~interaction_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node10"><a xlink:href=".././sourcefile/interaction_m.f90.html" xlink:title="interaction_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="841,-446 748,-446 748,-422 841,-422 841,-446"/>
<text text-anchor="middle" x="794.5" y="-431.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">interaction_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~interaction_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~interaction_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M876.6893,-434C868.5474,-434 859.9666,-434 851.5436,-434"/>
<polygon fill="#ff0000" stroke="#ff0000" points="851.3879,-430.5001 841.3879,-434 851.3879,-437.5001 851.3879,-430.5001"/>
</g>
<!-- sourcefile~config_io_m.f90&#45;&gt;sourcefile~atmcfg_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~config_io_m.f90&#45;&gt;sourcefile~atmcfg_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M524.5545,-601.9649C512.892,-591.0044 496.9277,-573.7133 489,-555 428.5179,-412.233 534.6382,-339.8169 453,-208 451.3774,-205.3801 449.3819,-202.9781 447.1533,-200.7854"/>
<polygon fill="#ff0000" stroke="#ff0000" points="448.864,-197.6693 438.8802,-194.1233 444.4736,-203.1213 448.864,-197.6693"/>
</g>
<!-- sourcefile~config_io_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~config_io_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M501.4393,-626.0376C496.9147,-628.5288 492.6196,-631.4915 489,-635 461.5845,-661.5738 480.9915,-687.0336 453,-713 439.2615,-725.7446 313.2418,-776.2906 295,-772"/>
</g>
<!-- sourcefile~strings_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~strings_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node16"><a xlink:href=".././sourcefile/strings_m.f90.html" xlink:title="strings_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="333,-702 257,-702 257,-678 333,-678 333,-702"/>
<text text-anchor="middle" x="295" y="-687.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">strings_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~config_io_m.f90&#45;&gt;sourcefile~strings_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~config_io_m.f90&#45;&gt;sourcefile~strings_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M494.6827,-614.5693C459.9913,-616.3509 410.9045,-621.8809 371,-638 352.7001,-645.3921 351.2789,-652.8408 335,-664 331.1295,-666.6532 327.013,-669.4055 322.949,-672.0831"/>
<polygon fill="#ff0000" stroke="#ff0000" points="320.7141,-669.3621 314.2518,-677.7579 324.5394,-675.2246 320.7141,-669.3621"/>
</g>
<!-- sourcefile~simbox_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~simbox_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node20"><a xlink:href=".././sourcefile/simbox_m.f90.html" xlink:title="simbox_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="451,-548 373,-548 373,-524 451,-524 451,-548"/>
<text text-anchor="middle" x="412" y="-533.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">simbox_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~config_io_m.f90&#45;&gt;sourcefile~simbox_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~config_io_m.f90&#45;&gt;sourcefile~simbox_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M513.9459,-601.977C505.8637,-597.7901 496.9222,-592.907 489,-588 472.2214,-577.6073 469.3413,-573.0677 453,-562 448.9393,-559.2497 444.6064,-556.4065 440.3347,-553.6546"/>
<polygon fill="#ff0000" stroke="#ff0000" points="442.0745,-550.6131 431.7596,-548.1933 438.3142,-556.5173 442.0745,-550.6131"/>
</g>
<!-- sourcefile~brown_m.f90&#45;&gt;sourcefile~logger_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~brown_m.f90&#45;&gt;sourcefile~logger_m.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M375.3015,-852C364.9412,-852 353.5164,-852 342.6143,-852"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="342.374,-848.5001 332.3739,-852 342.3739,-855.5001 342.374,-848.5001"/>
</g>
<!-- sourcefile~brown_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~brown_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M392.2608,-839.7764C385.4724,-835.4951 377.8569,-830.6055 371,-826 336.6027,-802.8967 335.3353,-781.4871 295,-772"/>
</g>
<!-- sourcefile~brown_m.f90&#45;&gt;sourcefile~strings_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~brown_m.f90&#45;&gt;sourcefile~strings_m.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M402.4715,-839.797C393.6527,-828.1727 380.5077,-809.9776 371,-793 351.5523,-758.2727 362.1457,-740.1086 335,-711 334.0973,-710.032 333.1398,-709.1004 332.1387,-708.2046"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="333.914,-705.1642 323.794,-702.0277 329.7492,-710.7905 333.914,-705.1642"/>
</g>
<!-- sourcefile~random_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~random_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node18"><a xlink:href=".././sourcefile/random_m.f90.html" xlink:title="random_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="335,-744 255,-744 255,-720 335,-720 335,-744"/>
<text text-anchor="middle" x="295" y="-729.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">random_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~brown_m.f90&#45;&gt;sourcefile~random_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~brown_m.f90&#45;&gt;sourcefile~random_m.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M403.8022,-839.7119C390.7473,-820.7237 363.7565,-783.757 335,-758 331.8073,-755.1403 328.2708,-752.3743 324.66,-749.7809"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="326.4716,-746.781 316.2267,-744.0804 322.5515,-752.5803 326.4716,-746.781"/>
</g>
<!-- sourcefile~timestamp_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~timestamp_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node22"><a xlink:href=".././sourcefile/timestamp_m.f90.html" xlink:title="timestamp_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="219,-864 126,-864 126,-840 219,-840 219,-864"/>
<text text-anchor="middle" x="172.5" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">timestamp_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~logger_m.f90&#45;&gt;sourcefile~timestamp_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~logger_m.f90&#45;&gt;sourcefile~timestamp_m.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M257.9135,-852C248.8195,-852 238.8791,-852 229.0978,-852"/>
<polygon fill="#aaff00" stroke="#aaff00" points="229.0044,-848.5001 219.0044,-852 229.0044,-855.5001 229.0044,-848.5001"/>
</g>
<!-- sourcefile~atmcfg_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~atmcfg_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M389.7823,-194.252C383.4113,-198.2405 376.6627,-202.9525 371,-208 330.895,-243.7478 347.7636,-291.8848 295,-302"/>
</g>
<!-- sourcefile~control_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~control_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M383.7596,-274.1567C360.432,-283.5837 326.2026,-296.0182 295,-302"/>
</g>
<!-- sourcefile~control_m.f90&#45;&gt;sourcefile~strings_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~control_m.f90&#45;&gt;sourcefile~strings_m.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M400.8482,-274.0603C391.1711,-285.3014 377.6938,-302.9949 371,-321 317.5857,-464.674 415.0527,-533.2832 335,-664 333.4184,-666.5825 331.4727,-668.9577 329.2991,-671.1321"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="326.7349,-668.7089 321.2291,-677.7609 331.1781,-674.1181 326.7349,-668.7089"/>
</g>
<!-- sourcefile~stats_m.f90&#45;&gt;sourcefile~atmcfg_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~stats_m.f90&#45;&gt;sourcefile~atmcfg_m.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M506.9135,-323.9324C500.3171,-320.257 493.8903,-315.6526 489,-310 457.5464,-273.6437 482.9463,-245.6076 453,-208 450.7801,-205.2121 448.175,-202.6359 445.3727,-200.2775"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="447.2411,-197.3074 437.1082,-194.2128 443.0996,-202.9508 447.2411,-197.3074"/>
</g>
<!-- sourcefile~stats_m.f90&#45;&gt;sourcefile~control_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~stats_m.f90&#45;&gt;sourcefile~control_m.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M514.6393,-323.92C506.4413,-319.6503 497.253,-314.7312 489,-310 479.487,-304.5464 457.5485,-290.8287 439.5125,-279.4482"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="441.3666,-276.4796 431.0434,-274.0956 437.6267,-282.3968 441.3666,-276.4796"/>
</g>
<!-- sourcefile~stats_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~stats_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M412,-302C361.0545,-291.581 346.07,-292.2094 295,-302"/>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M504.9403,-325.7832C479.5983,-318.3612 443.8605,-308.5158 412,-302"/>
</g>
<!-- sourcefile~stats_m.f90&#45;&gt;sourcefile~strings_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~stats_m.f90&#45;&gt;sourcefile~strings_m.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M528.5114,-348.0172C512.8302,-366.7514 481.2995,-403.8929 453,-434 417.915,-471.3261 396.1998,-470.3999 371,-515 337.4862,-574.3145 374.3483,-608.3844 335,-664 333.0387,-666.7722 330.6796,-669.3233 328.1005,-671.653"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="325.6716,-669.1057 319.8806,-677.9779 329.9404,-674.6535 325.6716,-669.1057"/>
</g>
<!-- sourcefile~stats_m.f90&#45;&gt;sourcefile~simbox_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~stats_m.f90&#45;&gt;sourcefile~simbox_m.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M530.9857,-348.0288C516.1438,-371.7705 481.9917,-426.3175 453,-472 443.8722,-486.3828 433.5243,-502.5345 425.5079,-515.0137"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="422.3548,-513.4462 419.891,-523.7506 428.2429,-517.2316 422.3548,-513.4462"/>
</g>
<!-- sourcefile~trajectory_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~trajectory_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M623.8032,-900.4579C612.2212,-902.7524 599.6989,-904.8416 588,-906 492.0249,-915.5034 467.0447,-914.7724 371,-906 336.7963,-902.8759 329.2349,-894.7617 295,-892"/>
</g>
<!-- sourcefile~interaction_m.f90&#45;&gt;sourcefile~atmcfg_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~interaction_m.f90&#45;&gt;sourcefile~atmcfg_m.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M668,-250C607.292,-203.1568 615.138,-138.5248 538.5,-136"/>
</g>
<!-- sourcefile~interaction_m.f90&#45;&gt;sourcefile~control_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~interaction_m.f90&#45;&gt;sourcefile~control_m.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M668,-250C622.3458,-214.7725 595.7603,-251.1781 538.5,-258"/>
</g>
<!-- sourcefile~interaction_m.f90&#45;&gt;sourcefile~stats_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~interaction_m.f90&#45;&gt;sourcefile~stats_m.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M668,-250C648.1051,-234.6488 588.6309,-287.1367 557.6859,-316.8919"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="555.1987,-314.4286 550.4746,-323.9119 560.0815,-319.4444 555.1987,-314.4286"/>
</g>
<!-- sourcefile~interaction_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~interaction_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M538.5,-812C430.2874,-829.8364 401.7808,-797.0192 295,-772"/>
</g>
<!-- sourcefile~table_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~table_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node11"><a xlink:href=".././sourcefile/table_m.f90.html" xlink:title="table_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="445.5,-354 378.5,-354 378.5,-330 445.5,-330 445.5,-354"/>
<text text-anchor="middle" x="412" y="-339.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">table_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~interaction_m.f90&#45;&gt;sourcefile~table_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~interaction_m.f90&#45;&gt;sourcefile~table_m.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M747.8539,-433.1911C684.7901,-431.6129 575.9135,-427.0385 538.5,-414"/>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M538.5,-414C515.6467,-405.3106 510.4042,-401.8169 489,-390 483.9846,-387.2311 459.8051,-372.1093 439.8611,-359.5679"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="441.6887,-356.5827 431.3611,-354.2181 437.96,-362.507 441.6887,-356.5827"/>
</g>
<!-- sourcefile~pairtab_m.fpp -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~pairtab_m.fpp</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node12"><a xlink:href=".././sourcefile/pairtab_m.fpp.html" xlink:title="pairtab_m.fpp">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="706.5,-466 629.5,-466 629.5,-442 706.5,-442 706.5,-466"/>
<text text-anchor="middle" x="668" y="-451.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pairtab_m.fpp</text>
</a>
</g>
</g>
<!-- sourcefile~interaction_m.f90&#45;&gt;sourcefile~pairtab_m.fpp -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~interaction_m.f90&#45;&gt;sourcefile~pairtab_m.fpp</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M747.7555,-441.3904C737.6206,-442.9928 726.8778,-444.6913 716.6707,-446.305"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="716.0153,-442.8651 706.6846,-447.8839 717.1085,-449.7792 716.0153,-442.8651"/>
</g>
<!-- sourcefile~ia_vdw_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~ia_vdw_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node13"><a xlink:href=".././sourcefile/ia_vdw_m.f90.html" xlink:title="ia_vdw_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="577,-230 500,-230 500,-206 577,-206 577,-230"/>
<text text-anchor="middle" x="538.5" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ia_vdw_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~interaction_m.f90&#45;&gt;sourcefile~ia_vdw_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~interaction_m.f90&#45;&gt;sourcefile~ia_vdw_m.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M668,-250C645.0152,-232.2646 613.488,-224.2254 587.2962,-220.639"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="587.5242,-217.1415 577.1803,-219.4339 586.6961,-224.0923 587.5242,-217.1415"/>
</g>
<!-- sourcefile~ia_bond_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~ia_bond_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node14"><a xlink:href=".././sourcefile/ia_bond_m.f90.html" xlink:title="ia_bond_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453,-784 371,-784 371,-760 453,-760 453,-784"/>
<text text-anchor="middle" x="412" y="-769.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ia_bond_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~interaction_m.f90&#45;&gt;sourcefile~ia_bond_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~interaction_m.f90&#45;&gt;sourcefile~ia_bond_m.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M538.5,-812C506.6732,-809.4996 472.2286,-797.9816 447.3302,-787.9434"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="448.5257,-784.6502 437.9479,-784.0487 445.8419,-791.1152 448.5257,-784.6502"/>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M792.596,-446.2017C781.5157,-512.5282 719.445,-826.2157 538.5,-812"/>
</g>
<!-- sourcefile~ia_dihedral_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~ia_dihedral_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node15"><a xlink:href=".././sourcefile/ia_dihedral_m.f90.html" xlink:title="ia_dihedral_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="586.5,-188 490.5,-188 490.5,-164 586.5,-164 586.5,-188"/>
<text text-anchor="middle" x="538.5" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ia_dihedral_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~interaction_m.f90&#45;&gt;sourcefile~ia_dihedral_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~interaction_m.f90&#45;&gt;sourcefile~ia_dihedral_m.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M668,-250C634.2332,-223.945 625.5681,-217.1916 588,-197 584.9473,-195.3593 581.739,-193.7528 578.4844,-192.2051"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="579.8323,-188.9732 569.2805,-188.0195 576.9345,-195.3453 579.8323,-188.9732"/>
</g>
<!-- sourcefile~ia_external_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~ia_external_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node17"><a xlink:href=".././sourcefile/ia_external_m.f90.html" xlink:title="ia_external_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="586.5,-108 490.5,-108 490.5,-84 586.5,-84 586.5,-108"/>
<text text-anchor="middle" x="538.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ia_external_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~interaction_m.f90&#45;&gt;sourcefile~ia_external_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~interaction_m.f90&#45;&gt;sourcefile~ia_external_m.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M789.3532,-421.7452C775.029,-389.0695 731.5306,-299.0212 668,-250"/>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M668,-250C641.2485,-229.3581 641.8989,-216.6593 624,-188 606.3004,-159.6598 611.8115,-145.4405 588,-122 584.7606,-118.8111 581.05,-115.9188 577.149,-113.3214"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="578.7942,-110.2273 568.4139,-108.1055 575.2054,-116.2374 578.7942,-110.2273"/>
</g>
<!-- sourcefile~ia_angle_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~ia_angle_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node19"><a xlink:href=".././sourcefile/ia_angle_m.f90.html" xlink:title="ia_angle_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="580.5,-66 496.5,-66 496.5,-42 580.5,-42 580.5,-66"/>
<text text-anchor="middle" x="538.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ia_angle_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~interaction_m.f90&#45;&gt;sourcefile~ia_angle_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~interaction_m.f90&#45;&gt;sourcefile~ia_angle_m.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M668,-174C636.1578,-127.2424 633.1649,-109.0637 588,-75 586.153,-73.607 584.1998,-72.2869 582.1782,-71.0387"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="583.4483,-67.7444 572.9943,-66.0227 580.0929,-73.8878 583.4483,-67.7444"/>
</g>
<!-- sourcefile~interaction_m.f90&#45;&gt;sourcefile~simbox_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~interaction_m.f90&#45;&gt;sourcefile~simbox_m.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M781.9597,-446.1313C746.9123,-478.774 643.5996,-566.5224 538.5,-574"/>
</g>
<!-- sourcefile~ia_tether_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~ia_tether_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node21"><a xlink:href=".././sourcefile/ia_tether_m.f90.html" xlink:title="ia_tether_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="581,-24 496,-24 496,0 581,0 581,-24"/>
<text text-anchor="middle" x="538.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ia_tether_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~interaction_m.f90&#45;&gt;sourcefile~ia_tether_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~interaction_m.f90&#45;&gt;sourcefile~ia_tether_m.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M668,-174C627.4441,-114.4472 641.7878,-80.9393 588,-33 586.5365,-31.6957 584.9801,-30.464 583.3557,-29.3019"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="585.1409,-26.291 574.7845,-24.0561 581.4868,-32.2616 585.1409,-26.291"/>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M790.543,-421.9702C779.9444,-390.4206 749.1811,-303.1009 712,-236 695.6231,-206.4445 687.0194,-201.9283 668,-174"/>
</g>
<!-- sourcefile~table_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~table_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M394.5806,-329.9073C372.0823,-315.7332 331.4734,-295.0077 295,-302"/>
</g>
<!-- sourcefile~vector_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~vector_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node26"><a xlink:href=".././sourcefile/vector_m.f90.html" xlink:title="vector_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="331.5,-394 258.5,-394 258.5,-370 331.5,-370 331.5,-394"/>
<text text-anchor="middle" x="295" y="-379.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">vector_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~table_m.f90&#45;&gt;sourcefile~vector_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~table_m.f90&#45;&gt;sourcefile~vector_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M378.4725,-353.4624C366.4191,-357.5832 352.6245,-362.2993 339.7678,-366.6948"/>
<polygon fill="#ff0000" stroke="#ff0000" points="338.4934,-363.4315 330.1633,-369.9783 340.7579,-370.0551 338.4934,-363.4315"/>
</g>
<!-- sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~atmcfg_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~atmcfg_m.f90</title>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M662.9686,-441.8298C652.0295,-416.3348 624.1335,-356.268 588,-315 551.4589,-273.2665 532.0338,-274.0005 489,-239 472.6193,-225.6771 469.9608,-220.5762 453,-208 449.2424,-205.2138 445.187,-202.4136 441.1396,-199.7365"/>
<polygon fill="#ff7f00" stroke="#ff7f00" points="442.7152,-196.5886 432.4106,-194.1257 438.9302,-202.4771 442.7152,-196.5886"/>
</g>
<!-- sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M652.01,-441.9167C636.2456,-430.3191 611.2124,-412.7339 588,-400 545.9417,-376.9276 528.6578,-383.9906 489,-357 470.2939,-344.2689 471.5507,-333.9565 453,-321 436.5346,-309.5 431.6765,-306.0241 412,-302"/>
</g>
<!-- sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~table_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~table_m.f90</title>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M629.2323,-442.8146C603.3789,-435.1622 568.7193,-424.5313 538.5,-414"/>
</g>
<!-- sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~simbox_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~simbox_m.f90</title>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M538.5,-574C505.0341,-576.381 468.5019,-563.6284 443.3393,-552.2627"/>
<polygon fill="#ff7f00" stroke="#ff7f00" points="444.8217,-549.0922 434.2823,-548.0091 441.8459,-555.4282 444.8217,-549.0922"/>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M661.8614,-466.2928C646.0719,-495.9961 600.8708,-569.5624 538.5,-574"/>
</g>
<!-- sourcefile~cell_list_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~cell_list_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node23"><a xlink:href=".././sourcefile/cell_list_m.f90.html" xlink:title="cell_list_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="578,-466 499,-466 499,-442 578,-442 578,-466"/>
<text text-anchor="middle" x="538.5" y="-451.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">cell_list_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~cell_list_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~cell_list_m.f90</title>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M629.4964,-454C616.6633,-454 602.1744,-454 588.5935,-454"/>
<polygon fill="#ff7f00" stroke="#ff7f00" points="588.4276,-450.5001 578.4275,-454 588.4275,-457.5001 588.4276,-450.5001"/>
</g>
<!-- sourcefile~connectivity_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~connectivity_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node24"><a xlink:href=".././sourcefile/connectivity_m.f90.html" xlink:title="connectivity_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="588,-546 489,-546 489,-522 588,-522 588,-546"/>
<text text-anchor="middle" x="538.5" y="-531.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">connectivity_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~connectivity_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~connectivity_m.f90</title>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M651.1872,-466.143C635.2372,-477.4707 610.4386,-494.5894 588,-508 582.8222,-511.0946 577.2415,-514.2187 571.7586,-517.1758"/>
<polygon fill="#ff7f00" stroke="#ff7f00" points="569.9157,-514.191 562.7119,-521.9599 573.1881,-520.3791 569.9157,-514.191"/>
</g>
<!-- sourcefile~aabbtree_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~aabbtree_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node25"><a xlink:href=".././sourcefile/aabbtree_m.f90.html" xlink:title="aabbtree_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="581.5,-668 495.5,-668 495.5,-644 581.5,-644 581.5,-668"/>
<text text-anchor="middle" x="538.5" y="-653.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">aabbtree_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~aabbtree_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~aabbtree_m.f90</title>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M665.8066,-466.3325C659.4959,-498.3965 638.417,-585.3308 588,-635 586.8986,-636.0851 585.7325,-637.1177 584.5147,-638.1"/>
<polygon fill="#ff7f00" stroke="#ff7f00" points="582.2364,-635.4128 575.8648,-643.8777 586.1245,-641.2337 582.2364,-635.4128"/>
</g>
<!-- sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~vector_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~vector_m.f90</title>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M634.8629,-466.0466C598.3134,-477.4774 538.1648,-490.7556 489,-475 448.9504,-462.1655 449.3701,-439.2917 412,-420"/>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M412,-420C389.6303,-409.0406 363.3573,-400.1795 341.3813,-393.7797"/>
<polygon fill="#ff7f00" stroke="#ff7f00" points="342.1914,-390.3715 331.616,-391.0138 340.2837,-397.1066 342.1914,-390.3715"/>
</g>
<!-- sourcefile~ia_vdw_m.f90&#45;&gt;sourcefile~atmcfg_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~ia_vdw_m.f90&#45;&gt;sourcefile~atmcfg_m.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M499.8585,-207.0032C487.3521,-203.4441 473.3249,-199.4521 460.213,-195.7207"/>
<polygon fill="#ffff00" stroke="#ffff00" points="460.981,-192.3004 450.4049,-192.9295 459.065,-199.033 460.981,-192.3004"/>
</g>
<!-- sourcefile~ia_vdw_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~ia_vdw_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M499.9027,-212.2366C474.0335,-210.0224 439.7565,-210.3488 412,-222"/>
</g>
<!-- sourcefile~ia_bond_m.f90&#45;&gt;sourcefile~logger_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~ia_bond_m.f90&#45;&gt;sourcefile~logger_m.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M394.2302,-784.1503C374.7037,-797.5018 343.158,-819.0715 320.8839,-834.3016"/>
<polygon fill="#7fff00" stroke="#7fff00" points="318.833,-831.464 312.5537,-839.9975 322.784,-837.2423 318.833,-831.464"/>
</g>
<!-- sourcefile~ia_bond_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~ia_bond_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M370.86,-776.5668C348.1904,-777.9496 319.7162,-777.8134 295,-772"/>
</g>
<!-- sourcefile~ia_bond_m.f90&#45;&gt;sourcefile~strings_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~ia_bond_m.f90&#45;&gt;sourcefile~strings_m.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M398.398,-759.9369C383.4525,-746.996 358.4458,-726.2509 335,-711 333.0769,-709.7491 331.071,-708.5098 329.0265,-707.296"/>
<polygon fill="#7fff00" stroke="#7fff00" points="330.3809,-704.0417 319.9511,-702.1788 326.9428,-710.1392 330.3809,-704.0417"/>
</g>
<!-- sourcefile~ia_dihedral_m.f90&#45;&gt;sourcefile~atmcfg_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~ia_dihedral_m.f90&#45;&gt;sourcefile~atmcfg_m.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M490.3149,-178.2855C480.4689,-178.7525 470.1058,-179.244 460.2573,-179.7111"/>
<polygon fill="#00ff00" stroke="#00ff00" points="460.0466,-176.2171 450.2236,-180.187 460.3783,-183.2092 460.0466,-176.2171"/>
</g>
<!-- sourcefile~ia_dihedral_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~ia_dihedral_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M502.426,-188.0696C476.9209,-196.8568 442.0586,-209.3824 412,-222"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M412,-222C393.4816,-229.7734 388.0676,-230.4145 371,-241 334.1923,-263.8286 337.5376,-293.8452 295,-302"/>
</g>
<!-- sourcefile~strings_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~strings_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#00ff7f" stroke-dasharray="5,2" d="M264.7957,-702.0599C239.8474,-710.3805 203.6097,-718.6762 172.5,-711"/>
</g>
<!-- sourcefile~ia_external_m.f90&#45;&gt;sourcefile~atmcfg_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~ia_external_m.f90&#45;&gt;sourcefile~atmcfg_m.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M513.3329,-108.1167C505.3791,-112.2355 496.6683,-117.0546 489,-122 469.4123,-134.6324 448.6473,-151.0088 433.6233,-163.4605"/>
<polygon fill="#00ffff" stroke="#00ffff" points="431.3262,-160.8191 425.9112,-169.9256 435.8232,-166.1835 431.3262,-160.8191"/>
</g>
<!-- sourcefile~ia_external_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~ia_external_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M498.7561,-83.9825C471.3684,-78.3191 435.7636,-76.49 412,-96"/>
</g>
<!-- sourcefile~random_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~random_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#007fff" stroke-dasharray="5,2" d="M254.9777,-726.6298C230.898,-723.0303 199.7341,-717.7199 172.5,-711"/>
</g>
<!-- sourcefile~ia_angle_m.f90&#45;&gt;sourcefile~atmcfg_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~ia_angle_m.f90&#45;&gt;sourcefile~atmcfg_m.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M503.3201,-66.0601C498.2517,-68.5933 493.3029,-71.562 489,-75 459.1417,-98.8565 435.4728,-137.119 422.6236,-160.8418"/>
<polygon fill="#0000ff" stroke="#0000ff" points="419.499,-159.2639 417.9409,-169.7436 425.6941,-162.5229 419.499,-159.2639"/>
</g>
<!-- sourcefile~ia_angle_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~ia_angle_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M496.3195,-60.0557C469.7524,-65.6598 436.0555,-76.2504 412,-96"/>
</g>
<!-- sourcefile~simbox_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~simbox_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M402.6809,-548.0717C384.3926,-571.0036 341.5123,-621.1457 295,-650"/>
</g>
<!-- sourcefile~simbox_m.f90&#45;&gt;sourcefile~random_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~simbox_m.f90&#45;&gt;sourcefile~random_m.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M407.2333,-548.0598C392.3567,-585.5109 347.0601,-698.0784 335,-711 334.0969,-711.9676 333.1391,-712.8989 332.1376,-713.7944"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="329.7484,-711.2083 323.7915,-719.9699 333.9121,-716.8354 329.7484,-711.2083"/>
</g>
<!-- sourcefile~ia_tether_m.f90&#45;&gt;sourcefile~atmcfg_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~ia_tether_m.f90&#45;&gt;sourcefile~atmcfg_m.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M501.4554,-24.0543C496.9284,-26.5429 492.6283,-29.5004 489,-33 461.8092,-59.2263 470.3609,-76.4477 453,-110 443.9767,-127.4388 432.9193,-146.7508 424.5625,-160.9804"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="421.345,-159.5452 419.2666,-169.9342 427.37,-163.1088 421.345,-159.5452"/>
</g>
<!-- sourcefile~ia_tether_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~ia_tether_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M172.5,-302C111.4089,-331.4476 63.3412,-550.747 49.2279,-621.8302"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="45.7402,-621.4286 47.2575,-631.9143 52.6103,-622.7711 45.7402,-621.4286"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M506.4128,-24.0311C500.4726,-26.697 494.4333,-29.7174 489,-33 451.1538,-55.8655 446.1749,-67.9423 412,-96"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M295,-302C241.5293,-312.2508 221.5441,-278.3594 172.5,-302"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M412,-96C385.6014,-117.6733 388.2242,-131.5052 371,-161 335.1,-222.4755 364.917,-288.5963 295,-302"/>
</g>
<!-- sourcefile~cell_list_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~cell_list_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M412,-382C393.6899,-373.7477 388.0676,-373.5855 371,-363 334.1923,-340.1714 337.5376,-293.8452 295,-302"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M514.6633,-441.8781C506.4671,-437.605 497.2739,-432.6945 489,-428 454.3282,-408.3276 448.3433,-398.3798 412,-382"/>
</g>
<!-- sourcefile~cell_list_m.f90&#45;&gt;sourcefile~simbox_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~cell_list_m.f90&#45;&gt;sourcefile~simbox_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M519.8345,-466.0994C498.5335,-479.9071 463.5061,-502.6126 439.1764,-518.3837"/>
<polygon fill="#ff0000" stroke="#ff0000" points="437.2296,-515.4746 430.7421,-523.851 441.0372,-521.3485 437.2296,-515.4746"/>
</g>
<!-- sourcefile~cell_list_m.f90&#45;&gt;sourcefile~vector_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~cell_list_m.f90&#45;&gt;sourcefile~vector_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M412,-382C390.338,-372.237 364.044,-371.3961 341.8738,-373.362"/>
<polygon fill="#ff0000" stroke="#ff0000" points="341.2428,-369.9102 331.6856,-374.483 342.0084,-376.8682 341.2428,-369.9102"/>
</g>
<!-- sourcefile~connectivity_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~connectivity_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M172.5,-711C134.2289,-701.5567 94.7446,-678.3377 70.0532,-661.8896"/>
<polygon fill="#7fff00" stroke="#7fff00" points="71.8916,-658.9071 61.6553,-656.1742 67.9531,-664.6941 71.8916,-658.9071"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M512.6787,-521.9772C477.9621,-507.7329 415.4674,-489.0038 371,-515 311.5581,-549.7504 353.5102,-613.7027 295,-650"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M295,-650C278.1619,-660.19 272.6602,-660.3124 255,-669 218.0806,-687.1618 212.4466,-720.8568 172.5,-711"/>
</g>
<!-- sourcefile~connectivity_m.f90&#45;&gt;sourcefile~table_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~connectivity_m.f90&#45;&gt;sourcefile~table_m.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M525.9858,-521.9169C514.9418,-510.6605 499.0754,-492.9573 489,-475 464.4485,-431.2421 483.9649,-407.4805 453,-368 450.8007,-365.1959 448.2095,-362.6088 445.4157,-360.2435"/>
<polygon fill="#7fff00" stroke="#7fff00" points="447.2919,-357.2785 437.1636,-354.169 443.1421,-362.9159 447.2919,-357.2785"/>
</g>
<!-- sourcefile~connectivity_m.f90&#45;&gt;sourcefile~vector_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~connectivity_m.f90&#45;&gt;sourcefile~vector_m.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M511.1918,-521.9391C503.6523,-518.0153 495.7072,-513.2899 489,-508 448.1944,-475.8171 458.1793,-443.8393 412,-420"/>
</g>
<!-- sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M495.4373,-652.6743C470.9579,-651.2758 439.7447,-650.3188 412,-652"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M412,-652C360.0876,-655.1456 339.1943,-622.5837 295,-650"/>
</g>
<!-- sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~strings_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~strings_m.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M412,-652C383.0876,-653.7519 351.9713,-664.3131 329.1011,-673.8578"/>
<polygon fill="#00ffff" stroke="#00ffff" points="327.6291,-670.681 319.835,-677.8575 330.4033,-677.1078 327.6291,-670.681"/>
</g>
<!-- sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~vector_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~vector_m.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M504.6537,-643.9567C467.1345,-629.0012 407.1556,-600.0815 371,-557 331.634,-510.0931 309.4897,-439.6684 300.2236,-404.1566"/>
<polygon fill="#00ffff" stroke="#00ffff" points="303.5844,-403.1693 297.7566,-394.3213 296.7948,-404.8724 303.5844,-403.1693"/>
</g>
<!-- sourcefile~aabb_m.fpp -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~aabb_m.fpp</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node27"><a xlink:href=".././sourcefile/aabb_m.fpp.html" xlink:title="aabb_m.fpp">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="446,-704 378,-704 378,-680 446,-680 446,-704"/>
<text text-anchor="middle" x="412" y="-689.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">aabb_m.fpp</text>
</a>
</g>
</g>
<!-- sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~aabb_m.fpp -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~aabb_m.fpp</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M496.0254,-668.0876C483.0989,-671.7663 468.8701,-675.8156 455.8544,-679.5197"/>
<polygon fill="#00ffff" stroke="#00ffff" points="454.8394,-676.1695 446.1793,-682.2731 456.7555,-682.9022 454.8394,-676.1695"/>
</g>
<!-- sourcefile~vector_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~vector_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M287.1173,-369.849C268.2701,-342.4104 218.7202,-279.7206 172.5,-302"/>
</g>
<!-- sourcefile~qsort_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~qsort_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~EfferentGraph_node28"><a xlink:href=".././sourcefile/qsort_m.f90.html" xlink:title="qsort_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="206.5,-481 138.5,-481 138.5,-457 206.5,-457 206.5,-481"/>
<text text-anchor="middle" x="172.5" y="-466.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">qsort_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~vector_m.f90&#45;&gt;sourcefile~qsort_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~vector_m.f90&#45;&gt;sourcefile~qsort_m.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M277.9669,-394.097C257.2398,-408.8174 222.0476,-433.8111 198.0645,-450.844"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="195.9098,-448.0814 189.7833,-456.7253 199.963,-453.7885 195.9098,-448.0814"/>
</g>
<!-- sourcefile~aabb_m.fpp&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~aabb_m.fpp&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M295,-772C235.7945,-758.0745 231.5501,-725.5705 172.5,-711"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M390.9952,-704.1604C384.3986,-708.2815 377.2188,-713.091 371,-718 338.4762,-743.6737 335.3353,-781.4871 295,-772"/>
</g>
<!-- sourcefile~aabb_m.fpp&#45;&gt;sourcefile~strings_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~aabb_m.fpp&#45;&gt;sourcefile~strings_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M377.8442,-691.4161C366.9933,-691.2307 354.7823,-691.0219 343.1372,-690.8229"/>
<polygon fill="#ff0000" stroke="#ff0000" points="343.1561,-687.3228 333.0977,-690.6512 343.0364,-694.3217 343.1561,-687.3228"/>
</g>
<!-- sourcefile~qsort_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~qsort_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M163.7364,-481.0285C142.2639,-510.5006 86.8271,-586.5902 59.9929,-623.4216"/>
<polygon fill="#00ffff" stroke="#00ffff" points="56.8847,-621.744 53.8249,-631.8874 62.5424,-625.866 56.8847,-621.744"/>
</g>
</g>
</svg>
</div><script>var pansourcefilebd_solver_mf90EfferentGraph = svgPanZoom('#sourcefilebd_solver_mf90EfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~bd_solver_m.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilebd_solver_mf90AfferentGraph" width="294pt" height="32pt"
 viewBox="0.00 0.00 294.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~bd_solver_m.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>sourcefile~~bd_solver_m.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 290,-28 290,4 -4,4"/>
<!-- sourcefile~bd_solver_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~bd_solver_m.f90</title>
<polygon fill="none" stroke="#000000" points="90,-24 0,-24 0,0 90,0 90,-24"/>
<text text-anchor="middle" x="45" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">bd_solver_m.f90</text>
</g>
<!-- sourcefile~setup_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~setup_m.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/setup_m.f90.html" xlink:title="setup_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="196,-24 126,-24 126,0 196,0 196,-24"/>
<text text-anchor="middle" x="161" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">setup_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~setup_m.f90&#45;&gt;sourcefile~bd_solver_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~setup_m.f90&#45;&gt;sourcefile~bd_solver_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M125.8814,-12C117.8294,-12 109.0767,-12 100.4017,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="100.3003,-8.5001 90.3003,-12 100.3002,-15.5001 100.3003,-8.5001"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~bd_solver_m.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="286,-24 232,-24 232,0 286,0 286,-24"/>
<text text-anchor="middle" x="259" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~setup_m.f90 -->
<g id="sourcefile~~bd_solver_m.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~setup_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M231.9616,-12C223.9804,-12 215.0189,-12 206.2209,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="206.0365,-8.5001 196.0365,-12 206.0364,-15.5001 206.0365,-8.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/bd_solver_m.html">bd_solver_m</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/bd_solver_m.f90.html#src">bd_solver_m.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">module </span><span class="n">bd_solver_m</span>
<a name="ln-2"></a>    <span class="c">!! Routines implementing Brownian Dynamics (BD) solver.</span>
<a name="ln-3"></a>
<a name="ln-4"></a><span class="k">use </span><span class="nb">iso_c_binding</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="nb">c_loc</span><span class="p">,</span> <span class="kt">c_ptr</span><span class="p">,</span> <span class="nb">c_f_pointer</span>
<a name="ln-5"></a><span class="k">use </span><span class="n">mkl_blas</span>
<a name="ln-6"></a><span class="c">!use mkl_rci</span>
<a name="ln-7"></a>
<a name="ln-8"></a><span class="k">use </span><span class="n">constants_m</span>
<a name="ln-9"></a><span class="k">use </span><span class="n">logger_m</span>
<a name="ln-10"></a><span class="k">use </span><span class="n">control_m</span>
<a name="ln-11"></a><span class="k">use </span><span class="n">atmcfg_m</span>
<a name="ln-12"></a><span class="k">use </span><span class="n">interaction_m</span>
<a name="ln-13"></a><span class="k">use </span><span class="n">brown_m</span>
<a name="ln-14"></a><span class="k">use </span><span class="n">stats_m</span>
<a name="ln-15"></a><span class="k">use </span><span class="n">config_io_m</span>
<a name="ln-16"></a><span class="k">use </span><span class="n">trajectory_m</span>
<a name="ln-17"></a>
<a name="ln-18"></a><span class="k">implicit none</span>
<a name="ln-19"></a>
<a name="ln-20"></a><span class="k">private</span>
<a name="ln-21"></a><span class="k">public</span> <span class="kd">::</span> <span class="n">bds_init</span><span class="p">,</span> <span class="n">bds_run</span><span class="p">,</span> <span class="n">bds_finish</span><span class="p">,</span> <span class="n">se_fval</span><span class="p">,</span> <span class="n">se_jacv</span>
<a name="ln-22"></a>
<a name="ln-23"></a><span class="kt">logical</span>  <span class="kd">::</span> <span class="n">lhdia</span><span class="p">,</span> <span class="n">write_traj</span>
<a name="ln-24"></a><span class="kt">integer</span>  <span class="kd">::</span> <span class="n">lanc_mxitr</span><span class="p">,</span> <span class="n">nlmxitr</span><span class="p">,</span> <span class="n">kdmax</span><span class="p">,</span> <span class="n">nts_mobsam</span>
<a name="ln-25"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tim_stp</span><span class="p">,</span> <span class="n">lanc_tol</span><span class="p">,</span> <span class="n">ftol</span><span class="p">,</span> <span class="n">stptol</span>
<a name="ln-26"></a><span class="kt">integer</span><span class="p">(</span><span class="n">ip_long</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nts</span><span class="p">,</span> <span class="n">nts_sim</span><span class="p">,</span> <span class="n">nts_dump</span><span class="p">,</span> <span class="n">nts_samp</span><span class="p">,</span> <span class="n">nts_log</span>
<a name="ln-27"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mob_fctr</span><span class="p">,</span> <span class="n">bdintg</span>
<a name="ln-28"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">fn_revive</span>
<a name="ln-29"></a>
<a name="ln-30"></a><span class="k">type</span><span class="p">(</span><span class="n">smbx_t</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">psmbx</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-31"></a><span class="k">type</span><span class="p">(</span><span class="n">atmcfg_t</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">patc</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-32"></a>
<a name="ln-33"></a><span class="kt">integer</span>  <span class="kd">::</span> <span class="n">cntr_mobsam</span>
<a name="ln-34"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sqrt_two_dt</span>
<a name="ln-35"></a>
<a name="ln-36"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:</span>  <span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">drift</span>
<a name="ln-37"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">diffusion</span>
<a name="ln-38"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">mob</span>
<a name="ln-39"></a>
<a name="ln-40"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">crd0</span>
<a name="ln-41"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sol</span>
<a name="ln-42"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">nitsol_rwork</span>
<a name="ln-43"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">pvcrd</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-44"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">pvfrc</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-45"></a>
<a name="ln-46"></a><span class="k">contains</span>
<a name="ln-47"></a> 
<a name="ln-48"></a><span class="c">!*******************************************************************************</span>
<a name="ln-49"></a> 
<a name="ln-50"></a><span class="k">subroutine </span><span class="n">bds_init</span><span class="p">(</span><span class="n">cpar</span><span class="p">,</span> <span class="n">num_atoms</span><span class="p">,</span> <span class="n">job_tag</span><span class="p">,</span> <span class="n">ierr</span><span class="p">)</span>
<a name="ln-51"></a>    <span class="c">!! Initializes the BD solver.</span>
<a name="ln-52"></a>
<a name="ln-53"></a>    <span class="k">type</span><span class="p">(</span><span class="n">ctrlpar_t</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cpar</span>
<a name="ln-54"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">num_atoms</span>
<a name="ln-55"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">job_tag</span>
<a name="ln-56"></a>    <span class="kt">integer</span><span class="p">,</span>         <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-57"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">lrwrk</span>
<a name="ln-58"></a>
<a name="ln-59"></a>    <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-60"></a>
<a name="ln-61"></a>    <span class="n">lhdia</span> <span class="o">=</span> <span class="n">cpar</span><span class="p">%</span><span class="n">lhdia</span><span class="p">;</span>       <span class="n">write_traj</span> <span class="o">=</span> <span class="n">cpar</span><span class="p">%</span><span class="n">write_traj</span>
<a name="ln-62"></a>    <span class="n">nts_sim</span> <span class="o">=</span> <span class="n">cpar</span><span class="p">%</span><span class="n">nts_sim</span><span class="p">;</span>   <span class="n">nts_dump</span> <span class="o">=</span> <span class="n">cpar</span><span class="p">%</span><span class="n">nts_dump</span>
<a name="ln-63"></a>    <span class="n">nts_samp</span> <span class="o">=</span> <span class="n">cpar</span><span class="p">%</span><span class="n">nts_samp</span><span class="p">;</span> <span class="n">nts_log</span> <span class="o">=</span> <span class="n">cpar</span><span class="p">%</span><span class="n">nts_log</span>
<a name="ln-64"></a>    <span class="n">mob_fctr</span> <span class="o">=</span> <span class="n">cpar</span><span class="p">%</span><span class="n">mob_fctr</span><span class="p">;</span> <span class="n">bdintg</span> <span class="o">=</span> <span class="n">cpar</span><span class="p">%</span><span class="n">bdintg</span>
<a name="ln-65"></a>    <span class="n">nts_mobsam</span> <span class="o">=</span> <span class="n">cpar</span><span class="p">%</span><span class="n">nts_mobsam</span>
<a name="ln-66"></a>    <span class="n">tim_stp</span> <span class="o">=</span> <span class="n">cpar</span><span class="p">%</span><span class="n">tim_stp</span>
<a name="ln-67"></a>
<a name="ln-68"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">mob_fctr</span> <span class="o">==</span> <span class="s1">&#39;LANC&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-69"></a><span class="k">        </span><span class="n">lanc_mxitr</span> <span class="o">=</span> <span class="n">cpar</span><span class="p">%</span><span class="n">lanc_mxitr</span>
<a name="ln-70"></a>        <span class="n">lanc_tol</span> <span class="o">=</span> <span class="n">cpar</span><span class="p">%</span><span class="n">lanc_tol</span>
<a name="ln-71"></a>    <span class="k">end if</span>
<a name="ln-72"></a>
<a name="ln-73"></a><span class="k">    if</span> <span class="p">(</span><span class="n">bdintg</span> <span class="o">==</span> <span class="s1">&#39;SE&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-74"></a><span class="k">        </span><span class="n">nlmxitr</span> <span class="o">=</span> <span class="n">cpar</span><span class="p">%</span><span class="n">se_nlmxitr</span><span class="p">;</span> <span class="n">kdmax</span> <span class="o">=</span> <span class="n">cpar</span><span class="p">%</span><span class="n">se_kdmax</span>
<a name="ln-75"></a>        <span class="n">ftol</span> <span class="o">=</span> <span class="n">cpar</span><span class="p">%</span><span class="n">se_tol</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">stptol</span> <span class="o">=</span> <span class="n">cpar</span><span class="p">%</span><span class="n">se_tol</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-76"></a>    <span class="k">end if</span>
<a name="ln-77"></a>
<a name="ln-78"></a><span class="k">    </span><span class="n">fn_revive</span> <span class="o">=</span> <span class="n">cpar</span><span class="p">%</span><span class="n">fn_revive</span><span class="o">//</span><span class="n">job_tag</span>
<a name="ln-79"></a>    <span class="n">sqrt_two_dt</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="mf">2.0_rp</span><span class="o">*</span><span class="n">tim_stp</span><span class="p">)</span>
<a name="ln-80"></a>
<a name="ln-81"></a>    <span class="c">!Allocate memory for BD drift-diffusion SDE</span>
<a name="ln-82"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">drift</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">num_atoms</span><span class="p">))</span>
<a name="ln-83"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">lhdia</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-84"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">mob</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">num_atoms</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">num_atoms</span><span class="p">))</span>
<a name="ln-85"></a>        <span class="k">allocate</span><span class="p">(</span><span class="n">diffusion</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">num_atoms</span><span class="p">,</span><span class="n">nts_mobsam</span><span class="p">))</span>
<a name="ln-86"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">mob_fctr</span> <span class="o">==</span> <span class="s1">&#39;CHOL&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-87"></a><span class="k">            call </span><span class="n">brn_init</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">num_atoms</span><span class="p">,</span> <span class="n">nts_mobsam</span><span class="p">,</span> <span class="n">mob_fctr</span><span class="p">)</span>
<a name="ln-88"></a>        <span class="k">else if</span> <span class="p">(</span><span class="n">mob_fctr</span> <span class="o">==</span> <span class="s1">&#39;LANC&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-89"></a><span class="k">            call </span><span class="n">brn_init</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">num_atoms</span><span class="p">,</span> <span class="n">nts_mobsam</span><span class="p">,</span> <span class="n">mob_fctr</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-90"></a>                        <span class="n">lanc_mxitr</span><span class="p">,</span> <span class="n">lanc_tol</span><span class="p">)</span>
<a name="ln-91"></a>        <span class="k">end if</span>
<a name="ln-92"></a><span class="k">        </span><span class="n">cntr_mobsam</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-93"></a>    <span class="k">else</span>
<a name="ln-94"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">diffusion</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">num_atoms</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-95"></a>    <span class="k">end if</span>
<a name="ln-96"></a>
<a name="ln-97"></a><span class="k">    if</span> <span class="p">(</span><span class="n">bdintg</span> <span class="o">==</span> <span class="s1">&#39;SE&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-98"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">crd0</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">num_atoms</span><span class="p">))</span>
<a name="ln-99"></a>        <span class="k">allocate</span><span class="p">(</span><span class="n">sol</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">num_atoms</span><span class="p">))</span>
<a name="ln-100"></a>        <span class="n">lrwrk</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">num_atoms</span><span class="o">*</span><span class="p">(</span><span class="n">kdmax</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="n">kdmax</span><span class="o">*</span><span class="p">(</span><span class="n">kdmax</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-101"></a>        <span class="k">allocate</span><span class="p">(</span><span class="n">nitsol_rwork</span><span class="p">(</span><span class="n">lrwrk</span><span class="p">))</span>
<a name="ln-102"></a>    <span class="k">end if</span>
<a name="ln-103"></a>
<a name="ln-104"></a><span class="k">    end subroutine</span>
<a name="ln-105"></a>
<a name="ln-106"></a><span class="c">!******************************************************************************</span>
<a name="ln-107"></a>
<a name="ln-108"></a><span class="k">subroutine </span><span class="n">bds_finish</span><span class="p">()</span>
<a name="ln-109"></a>    <span class="c">!! Clears up memory allocated in [[bds_init]].</span>
<a name="ln-110"></a>
<a name="ln-111"></a>    <span class="k">call </span><span class="n">brn_finish</span><span class="p">()</span>
<a name="ln-112"></a>
<a name="ln-113"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">mob</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">mob</span><span class="p">)</span>
<a name="ln-114"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">drift</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">drift</span><span class="p">)</span>
<a name="ln-115"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">diffusion</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">diffusion</span><span class="p">)</span>
<a name="ln-116"></a>
<a name="ln-117"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">crd0</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">crd0</span><span class="p">)</span>
<a name="ln-118"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">sol</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span>
<a name="ln-119"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">nitsol_rwork</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">nitsol_rwork</span><span class="p">)</span>
<a name="ln-120"></a>
<a name="ln-121"></a>    <span class="n">pvcrd</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">();</span> <span class="n">pvfrc</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-122"></a>    <span class="n">psmbx</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">();</span> <span class="n">patc</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-123"></a>
<a name="ln-124"></a>    <span class="k">end subroutine</span>
<a name="ln-125"></a>
<a name="ln-126"></a><span class="c">!******************************************************************************</span>
<a name="ln-127"></a>
<a name="ln-128"></a><span class="k">subroutine </span><span class="n">bds_run</span><span class="p">(</span><span class="n">nts_beg</span><span class="p">,</span> <span class="n">simbox</span><span class="p">,</span> <span class="n">atc</span><span class="p">,</span> <span class="n">ierr</span><span class="p">)</span>
<a name="ln-129"></a>    <span class="c">!! Driver for BD integrator.</span>
<a name="ln-130"></a>    <span class="c">!!</span>
<a name="ln-131"></a>    <span class="c">!! Repeatedly calls [[integrate_em]] or [[integrate_se]] to update atom</span>
<a name="ln-132"></a>    <span class="c">!! positions.</span>
<a name="ln-133"></a>
<a name="ln-134"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ip_long</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nts_beg</span>
<a name="ln-135"></a>    <span class="k">type</span><span class="p">(</span><span class="n">smbx_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">simbox</span>
<a name="ln-136"></a>    <span class="k">type</span><span class="p">(</span><span class="n">atmcfg_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">atc</span>
<a name="ln-137"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-138"></a>        <span class="c">!! Error flag</span>
<a name="ln-139"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ip_long</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nts</span>
<a name="ln-140"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">com</span>
<a name="ln-141"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">loc</span>
<a name="ln-142"></a><span class="nb">    </span><span class="kt">logical</span> <span class="kd">::</span> <span class="n">limud</span>
<a name="ln-143"></a>
<a name="ln-144"></a>    <span class="n">nts</span> <span class="o">=</span> <span class="n">nts_beg</span><span class="p">;</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-145"></a>
<a name="ln-146"></a>    <span class="c">!Assign pointers</span>
<a name="ln-147"></a>    <span class="n">psmbx</span> <span class="o">=&gt;</span> <span class="n">simbox</span><span class="p">;</span> <span class="n">patc</span> <span class="o">=&gt;</span> <span class="n">atc</span>
<a name="ln-148"></a>    <span class="nb">loc</span> <span class="o">=</span> <span class="nb">c_loc</span><span class="p">(</span><span class="n">patc</span><span class="p">%</span><span class="n">coordinates</span><span class="p">)</span>
<a name="ln-149"></a>    <span class="k">call </span><span class="nb">c_f_pointer</span><span class="p">(</span><span class="nb">loc</span><span class="p">,</span> <span class="n">pvcrd</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">patc</span><span class="p">%</span><span class="n">num_atoms</span><span class="p">])</span>
<a name="ln-150"></a>    <span class="nb">loc</span> <span class="o">=</span> <span class="nb">c_loc</span><span class="p">(</span><span class="n">patc</span><span class="p">%</span><span class="n">forces</span><span class="p">)</span>
<a name="ln-151"></a>    <span class="k">call </span><span class="nb">c_f_pointer</span><span class="p">(</span><span class="nb">loc</span><span class="p">,</span> <span class="n">pvfrc</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">patc</span><span class="p">%</span><span class="n">num_atoms</span><span class="p">])</span>
<a name="ln-152"></a>
<a name="ln-153"></a>    <span class="c">!Is this an isolated untethered molecule in an unbounded domain?</span>
<a name="ln-154"></a>    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">patc</span><span class="p">%</span><span class="n">num_tethers</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">psmbx</span><span class="p">%</span><span class="n">imcon</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-155"></a><span class="k">        </span><span class="n">limud</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-156"></a>    <span class="k">else</span>
<a name="ln-157"></a><span class="k">        </span><span class="n">limud</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-158"></a>    <span class="k">end if</span>
<a name="ln-159"></a>
<a name="ln-160"></a>    <span class="c">!For isolated untethered molecule, ensure c.o.m. is at the origin.</span>
<a name="ln-161"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">limud</span><span class="p">)</span> <span class="k">call </span><span class="n">psmbx</span><span class="p">%</span><span class="n">to_origin</span><span class="p">(</span><span class="n">atc</span><span class="p">%</span><span class="n">coordinates</span><span class="p">)</span>
<a name="ln-162"></a>
<a name="ln-163"></a>    <span class="c">!Log &amp; dump starting configuration</span>
<a name="ln-164"></a>    <span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">log_msg</span><span class="p">(</span><span class="s1">&#39;nts = &#39;</span><span class="o">//</span><span class="n">str_from_num</span><span class="p">(</span><span class="n">nts</span><span class="p">))</span>
<a name="ln-165"></a>    <span class="k">call </span><span class="n">write_dump</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span> <span class="n">psmbx</span><span class="p">,</span> <span class="n">patc</span><span class="p">,</span> <span class="n">fn_revive</span><span class="p">)</span>
<a name="ln-166"></a>
<a name="ln-167"></a>    <span class="k">do </span>
<a name="ln-168"></a><span class="k">        if</span> <span class="p">(</span><span class="n">nts</span> <span class="o">&gt;</span> <span class="n">nts_sim</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-169"></a><span class="k">        if</span> <span class="p">(</span><span class="n">bdintg</span><span class="o">==</span><span class="s1">&#39;EM&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-170"></a><span class="k">            call </span><span class="n">integrate_em</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-171"></a>        <span class="k">else if</span> <span class="p">(</span><span class="n">bdintg</span><span class="o">==</span><span class="s1">&#39;SE&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-172"></a><span class="k">            call </span><span class="n">integrate_se</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-173"></a>        <span class="k">end if</span>
<a name="ln-174"></a><span class="k">        if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-175"></a>
<a name="ln-176"></a><span class="k">        </span><span class="n">nts</span> <span class="o">=</span> <span class="n">nts</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-177"></a>
<a name="ln-178"></a>        <span class="c">!Apply boundary conditions: For isolated untethered molecule,</span>
<a name="ln-179"></a>        <span class="c">!update molecule_com &amp; bring c.o.m. to the center of the box.</span>
<a name="ln-180"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">limud</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-181"></a><span class="k">            call </span><span class="n">psmbx</span><span class="p">%</span><span class="n">to_origin</span><span class="p">(</span><span class="n">patc</span><span class="p">%</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">com</span><span class="p">)</span>
<a name="ln-182"></a>            <span class="n">patc</span><span class="p">%</span><span class="n">molecule_com</span> <span class="o">=</span> <span class="n">patc</span><span class="p">%</span><span class="n">molecule_com</span> <span class="o">+</span> <span class="n">com</span>
<a name="ln-183"></a>        <span class="k">end if</span>
<a name="ln-184"></a>
<a name="ln-185"></a>        <span class="c">!For PBC, wrap atom positions</span>
<a name="ln-186"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">psmbx</span><span class="p">%</span><span class="n">imcon</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">psmbx</span><span class="p">%</span><span class="n">wrap_all</span><span class="p">(</span><span class="n">patc</span><span class="p">%</span><span class="n">coordinates</span><span class="p">)</span>
<a name="ln-187"></a>
<a name="ln-188"></a>        <span class="c">!Accumulate statistics</span>
<a name="ln-189"></a>        <span class="k">call </span><span class="n">stats_accumulate</span><span class="p">(</span><span class="n">psmbx</span><span class="p">,</span> <span class="n">patc</span><span class="p">)</span>
<a name="ln-190"></a>
<a name="ln-191"></a>        <span class="c">!Logging</span>
<a name="ln-192"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span><span class="n">nts_log</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-193"></a><span class="k">            call </span><span class="n">logger</span><span class="p">%</span><span class="n">log_msg</span><span class="p">(</span><span class="s1">&#39;nts = &#39;</span><span class="o">//</span><span class="n">str_from_num</span><span class="p">(</span><span class="n">nts</span><span class="p">))</span>
<a name="ln-194"></a>        <span class="k">end if</span>
<a name="ln-195"></a>
<a name="ln-196"></a>        <span class="c">!Dump revive file</span>
<a name="ln-197"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span><span class="n">nts_dump</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-198"></a><span class="k">            call </span><span class="n">write_dump</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span> <span class="n">psmbx</span><span class="p">,</span> <span class="n">patc</span><span class="p">,</span> <span class="n">fn_revive</span><span class="p">)</span>
<a name="ln-199"></a>        <span class="k">end if</span>
<a name="ln-200"></a>
<a name="ln-201"></a><span class="k">        if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span><span class="n">nts_samp</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-202"></a>            <span class="c">!Write stats</span>
<a name="ln-203"></a>            <span class="k">call </span><span class="n">stats_write</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span> <span class="n">psmbx</span><span class="p">,</span> <span class="n">atc</span><span class="p">)</span>
<a name="ln-204"></a>            <span class="c">!Write traj</span>
<a name="ln-205"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">write_traj</span><span class="p">)</span> <span class="k">call </span><span class="n">traj</span><span class="p">%</span><span class="n">append_frame</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span> <span class="n">patc</span><span class="p">%</span><span class="n">coordinates</span><span class="p">)</span>
<a name="ln-206"></a>        <span class="k">end if</span>
<a name="ln-207"></a><span class="k">    end do</span>
<a name="ln-208"></a>
<a name="ln-209"></a>    <span class="c">!Dump the final configuration</span>
<a name="ln-210"></a>    <span class="k">call </span><span class="n">write_dump</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span> <span class="n">psmbx</span><span class="p">,</span> <span class="n">patc</span><span class="p">,</span> <span class="n">fn_revive</span><span class="p">)</span>
<a name="ln-211"></a>
<a name="ln-212"></a>    <span class="k">end subroutine</span>
<a name="ln-213"></a>
<a name="ln-214"></a><span class="c">!******************************************************************************</span>
<a name="ln-215"></a>
<a name="ln-216"></a><span class="k">subroutine </span><span class="n">integrate_em</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-217"></a>    <span class="c">!! Performs one step of BD integration using explicit Euler-Maruyama scheme.</span>
<a name="ln-218"></a>
<a name="ln-219"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-220"></a>
<a name="ln-221"></a>    <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-222"></a>    <span class="c">!Calculate the diffusion term</span>
<a name="ln-223"></a>    <span class="k">call </span><span class="n">calc_diffusion</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-224"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-225"></a>
<a name="ln-226"></a>    <span class="c">!Calculate the drift term</span>
<a name="ln-227"></a>    <span class="k">call </span><span class="n">calc_drift</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-228"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-229"></a>
<a name="ln-230"></a>    <span class="c">!Update positions</span>
<a name="ln-231"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">lhdia</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-232"></a><span class="k">        </span><span class="n">pvcrd</span> <span class="o">=</span> <span class="n">pvcrd</span> <span class="o">+</span> <span class="n">drift</span> <span class="o">+</span> <span class="n">diffusion</span><span class="p">(:,</span><span class="n">cntr_mobsam</span><span class="p">)</span>
<a name="ln-233"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">cntr_mobsam</span> <span class="o">==</span> <span class="n">nts_mobsam</span><span class="p">)</span> <span class="n">cntr_mobsam</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-234"></a>    <span class="k">else</span>
<a name="ln-235"></a><span class="k">        </span><span class="n">pvcrd</span> <span class="o">=</span> <span class="n">pvcrd</span> <span class="o">+</span> <span class="n">drift</span> <span class="o">+</span> <span class="n">diffusion</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-236"></a>    <span class="k">end if</span>
<a name="ln-237"></a>
<a name="ln-238"></a><span class="k">    end subroutine</span>
<a name="ln-239"></a>
<a name="ln-240"></a><span class="c">!******************************************************************************</span>
<a name="ln-241"></a>
<a name="ln-242"></a><span class="k">subroutine </span><span class="n">integrate_se</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-243"></a>    <span class="c">!! Performs one step of BD integration using semi-implicit Euler scheme.</span>
<a name="ln-244"></a>
<a name="ln-245"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-246"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rpar</span> <span class="c">!Dummy arg, 0-dim array</span>
<a name="ln-247"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ipar</span> <span class="c">!Dummy arg, 0-dim array</span>
<a name="ln-248"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="kd">::</span> <span class="n">input</span>
<a name="ln-249"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="kd">::</span> <span class="n">info</span>
<a name="ln-250"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span>
<a name="ln-251"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span> <span class="kd">::</span> <span class="n">msg</span>
<a name="ln-252"></a>    <span class="c">!integer :: iplvl, ipunit</span>
<a name="ln-253"></a>    <span class="c">!common /nitprint/ iplvl, ipunit</span>
<a name="ln-254"></a>    <span class="k">external </span><span class="n">nitsol</span>
<a name="ln-255"></a>
<a name="ln-256"></a>    <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">patc</span><span class="p">%</span><span class="n">num_atoms</span>
<a name="ln-257"></a>    <span class="n">rpar</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">ipar</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-258"></a>    <span class="n">input</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-259"></a>    <span class="n">input</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">nlmxitr</span><span class="p">;</span> <span class="n">input</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">kdmax</span><span class="p">;</span> <span class="n">input</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-260"></a>    <span class="n">input</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-261"></a>    <span class="c">!iplvl = 0; ipunit = logger%fu</span>
<a name="ln-262"></a>
<a name="ln-263"></a>    <span class="c">!Calculate the diffusion term</span>
<a name="ln-264"></a>    <span class="k">call </span><span class="n">calc_diffusion</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-265"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-266"></a>
<a name="ln-267"></a>    <span class="c">!Evaluate the nonlinear function arising out of discretizing the SDE in</span>
<a name="ln-268"></a>    <span class="c">!semi-implicit form</span>
<a name="ln-269"></a>    <span class="n">crd0</span> <span class="o">=</span> <span class="n">pvcrd</span> <span class="c">!Coordinates at the end of last time step</span>
<a name="ln-270"></a>    <span class="n">sol</span> <span class="o">=</span> <span class="n">pvcrd</span>  <span class="c">!Initial guess</span>
<a name="ln-271"></a>
<a name="ln-272"></a>    <span class="k">call </span><span class="n">nitsol</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">sol</span><span class="p">,</span> <span class="n">se_fval</span><span class="p">,</span> <span class="n">se_jacv</span><span class="p">,</span> <span class="n">ftol</span><span class="p">,</span> <span class="n">stptol</span><span class="p">,</span> <span class="n">input</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-273"></a>        <span class="n">info</span><span class="p">,</span> <span class="n">nitsol_rwork</span><span class="p">,</span> <span class="n">rpar</span><span class="p">,</span> <span class="n">ipar</span><span class="p">,</span> <span class="n">ierr</span><span class="p">,</span> <span class="n">ddot</span><span class="p">,</span> <span class="n">dnrm2</span><span class="p">)</span>
<a name="ln-274"></a>
<a name="ln-275"></a>    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-276"></a>    <span class="k">select case</span> <span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-277"></a>    <span class="k">case</span><span class="p">(:</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-278"></a>        <span class="k">write</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span><span class="s1">&#39;(a,i0,a)&#39;</span><span class="p">)</span> <span class="s1">&#39;illegal value in input(&#39;</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ierr</span><span class="p">),</span> <span class="s1">&#39;)&#39;</span>
<a name="ln-279"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-280"></a>        <span class="k">write</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s1">&#39;max nonlinear iterations reached&#39;</span>
<a name="ln-281"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-282"></a>        <span class="k">write</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s1">&#39;failed to evaluate nonlinear function&#39;</span>
<a name="ln-283"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-284"></a>        <span class="k">write</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s1">&#39;failed to evaluate J*v&#39;</span>
<a name="ln-285"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-286"></a>        <span class="k">write</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s1">&#39;failed to evaluate P^{-1}*v&#39;</span>
<a name="ln-287"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-288"></a>        <span class="k">write</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s1">&#39;insufficient initial norm reduction&#39;</span>
<a name="ln-289"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-290"></a>        <span class="k">write</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s1">&#39;failed to reach an acceptable step by backtracking&#39;</span>
<a name="ln-291"></a>    <span class="k">end select</span>
<a name="ln-292"></a><span class="k">    if</span> <span class="p">(</span><span class="nb">len_trim</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-293"></a><span class="k">        call </span><span class="n">logger</span><span class="p">%</span><span class="n">log_msg</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a name="ln-294"></a>        <span class="k">return</span>
<a name="ln-295"></a><span class="k">    end if</span>
<a name="ln-296"></a>    <span class="c">!Comment out for verbose output from nitsol.</span>
<a name="ln-297"></a>    <span class="c">!write(msg, &#39;(4(a,i0))&#39;) &#39;nfe = &#39;, info(1), &#39;, nli = &#39;, info(4), &amp;</span>
<a name="ln-298"></a>    <span class="c">!    &#39;, nni = &#39;, info(5), &#39;, nbktrk = &#39;, info(6)</span>
<a name="ln-299"></a>    <span class="c">!call logger%log_msg(msg)</span>
<a name="ln-300"></a>
<a name="ln-301"></a>    <span class="n">pvcrd</span> <span class="o">=</span> <span class="n">sol</span>
<a name="ln-302"></a>
<a name="ln-303"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">lhdia</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-304"></a><span class="k">        if</span> <span class="p">(</span><span class="n">cntr_mobsam</span> <span class="o">==</span> <span class="n">nts_mobsam</span><span class="p">)</span> <span class="n">cntr_mobsam</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-305"></a>    <span class="k">end if</span>
<a name="ln-306"></a>
<a name="ln-307"></a><span class="k">    end subroutine</span>
<a name="ln-308"></a>
<a name="ln-309"></a><span class="c">!******************************************************************************</span>
<a name="ln-310"></a>
<a name="ln-311"></a><span class="k">subroutine </span><span class="n">se_fval</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">xcur</span><span class="p">,</span> <span class="n">fcur</span><span class="p">,</span> <span class="n">rpar</span><span class="p">,</span> <span class="n">ipar</span><span class="p">,</span> <span class="n">ierr</span><span class="p">)</span>
<a name="ln-312"></a>    <span class="c">!! Calculates the nonlinear function.</span>
<a name="ln-313"></a>
<a name="ln-314"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">n</span>
<a name="ln-315"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xcur</span>
<a name="ln-316"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fcur</span>
<a name="ln-317"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rpar</span>
<a name="ln-318"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ipar</span>
<a name="ln-319"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-320"></a>
<a name="ln-321"></a>    <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">fcur</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">pvcrd</span> <span class="o">=</span> <span class="n">xcur</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">)</span>
<a name="ln-322"></a>
<a name="ln-323"></a>    <span class="k">call </span><span class="n">calc_drift</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-324"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-325"></a>
<a name="ln-326"></a><span class="k">    if</span> <span class="p">(</span><span class="n">lhdia</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-327"></a><span class="k">        </span><span class="n">fcur</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">pvcrd</span> <span class="o">-</span> <span class="n">drift</span> <span class="o">-</span> <span class="n">crd0</span> <span class="o">-</span> <span class="n">diffusion</span><span class="p">(:,</span><span class="n">cntr_mobsam</span><span class="p">)</span>
<a name="ln-328"></a>    <span class="k">else</span>
<a name="ln-329"></a><span class="k">        </span><span class="n">fcur</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">pvcrd</span> <span class="o">-</span> <span class="n">drift</span> <span class="o">-</span> <span class="n">crd0</span> <span class="o">-</span> <span class="n">diffusion</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-330"></a>    <span class="k">end if</span>
<a name="ln-331"></a>
<a name="ln-332"></a><span class="k">    end subroutine</span>
<a name="ln-333"></a>
<a name="ln-334"></a><span class="c">!******************************************************************************</span>
<a name="ln-335"></a>
<a name="ln-336"></a><span class="k">subroutine </span><span class="n">se_jacv</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">xcur</span><span class="p">,</span> <span class="n">fcur</span><span class="p">,</span> <span class="n">ijob</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">rpar</span><span class="p">,</span> <span class="n">ipar</span><span class="p">,</span> <span class="n">ierr</span><span class="p">)</span>
<a name="ln-337"></a>    <span class="c">!! Calculates jacobian times vector product. This is a dummy subroutine.</span>
<a name="ln-338"></a>
<a name="ln-339"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">n</span>
<a name="ln-340"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xcur</span>
<a name="ln-341"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fcur</span>
<a name="ln-342"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ijob</span>
<a name="ln-343"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">v</span>
<a name="ln-344"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">z</span>
<a name="ln-345"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rpar</span>
<a name="ln-346"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ipar</span>
<a name="ln-347"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-348"></a>
<a name="ln-349"></a>    <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-350"></a>
<a name="ln-351"></a>    <span class="k">end subroutine</span>
<a name="ln-352"></a>
<a name="ln-353"></a><span class="c">!******************************************************************************</span>
<a name="ln-354"></a>
<a name="ln-355"></a><span class="k">subroutine </span><span class="n">calc_diffusion</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-356"></a>    <span class="c">!! Calculates the diffusion term of the SDE. Updates module variables</span>
<a name="ln-357"></a>    <span class="c">!!`diffusion` and `cntr_mobsam`.</span>
<a name="ln-358"></a>
<a name="ln-359"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-360"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">j</span><span class="p">,</span> <span class="n">f</span>
<a name="ln-361"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lconv</span>
<a name="ln-362"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span> <span class="kd">::</span> <span class="n">msg</span>
<a name="ln-363"></a>
<a name="ln-364"></a>    <span class="n">diffusion</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-365"></a>
<a name="ln-366"></a>    <span class="c">!Early return for no HI</span>
<a name="ln-367"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lhdia</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-368"></a>        <span class="c">!Calculate standard Gaussian vectors</span>
<a name="ln-369"></a>        <span class="k">call </span><span class="n">brn_calc_dw</span><span class="p">(</span><span class="n">diffusion</span><span class="p">)</span>
<a name="ln-370"></a>        <span class="n">diffusion</span> <span class="o">=</span> <span class="n">sqrt_two_dt</span><span class="o">*</span><span class="n">diffusion</span>
<a name="ln-371"></a>        <span class="k">return</span>
<a name="ln-372"></a><span class="k">    end if</span>
<a name="ln-373"></a>
<a name="ln-374"></a>    <span class="c">!Diffusion term with HI</span>
<a name="ln-375"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">cntr_mobsam</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-376"></a>        <span class="c">!Calculate the mobility matrix</span>
<a name="ln-377"></a>        <span class="k">call </span><span class="n">calc_rpy_tensor</span><span class="p">(</span><span class="n">patc</span><span class="p">%</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">mob</span><span class="p">)</span>
<a name="ln-378"></a>        <span class="c">!Calculate standard Gaussian vectors</span>
<a name="ln-379"></a>        <span class="k">call </span><span class="n">brn_calc_dw</span><span class="p">(</span><span class="n">diffusion</span><span class="p">)</span>
<a name="ln-380"></a>        <span class="c">!Calculate the Brownian vectors</span>
<a name="ln-381"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">mob_fctr</span> <span class="o">==</span> <span class="s1">&#39;CHOL&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-382"></a><span class="k">            call </span><span class="n">brn_calc_bdw</span><span class="p">(</span><span class="n">mob</span><span class="p">,</span> <span class="n">diffusion</span><span class="p">,</span> <span class="n">ierr</span><span class="p">)</span>
<a name="ln-383"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-384"></a>            <span class="c">!Cholesky decomposition overwrites the upper triangular part of mob</span>
<a name="ln-385"></a>            <span class="c">!with the factorization result U. Putting the diagonal elements</span>
<a name="ln-386"></a>            <span class="c">!back to unity (for RPY) as U is no longer needed. The lower</span>
<a name="ln-387"></a>            <span class="c">!triangular part of mob will be used in calculating drift.</span>
<a name="ln-388"></a>            <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">mob</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-389"></a>                <span class="n">mob</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0_rp</span>
<a name="ln-390"></a>            <span class="k">end do</span>
<a name="ln-391"></a><span class="k">        else if</span> <span class="p">(</span><span class="n">mob_fctr</span> <span class="o">==</span> <span class="s1">&#39;LANC&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-392"></a><span class="k">            call </span><span class="n">brn_calc_bdw</span><span class="p">(</span><span class="n">mob</span><span class="p">,</span> <span class="n">diffusion</span><span class="p">,</span> <span class="n">ierr</span><span class="p">,</span> <span class="n">lconv</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<a name="ln-393"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-394"></a><span class="k">            if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lconv</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-395"></a><span class="k">                write</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span><span class="s1">&#39;(a,i0)&#39;</span><span class="p">)</span> <span class="s1">&#39;&lt;brn_calc_bdw&gt; not converged. nts = &#39;</span><span class="p">,</span> <span class="n">nts</span>
<a name="ln-396"></a>                <span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">log_msg</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a name="ln-397"></a>            <span class="k">end if</span>
<a name="ln-398"></a><span class="k">        end if</span>
<a name="ln-399"></a><span class="k">        </span><span class="n">diffusion</span> <span class="o">=</span> <span class="n">sqrt_two_dt</span><span class="o">*</span><span class="n">diffusion</span>
<a name="ln-400"></a>    <span class="k">end if</span>
<a name="ln-401"></a><span class="k">    </span><span class="n">cntr_mobsam</span> <span class="o">=</span> <span class="n">cntr_mobsam</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-402"></a>
<a name="ln-403"></a>    <span class="k">end subroutine</span>
<a name="ln-404"></a>
<a name="ln-405"></a><span class="c">!******************************************************************************</span>
<a name="ln-406"></a>
<a name="ln-407"></a><span class="k">subroutine </span><span class="n">calc_drift</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-408"></a>    <span class="c">!! Calculates the drift term of the SDE.</span>
<a name="ln-409"></a>
<a name="ln-410"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-411"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-412"></a>
<a name="ln-413"></a>    <span class="n">drift</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-414"></a>    
<a name="ln-415"></a>    <span class="c">!Update forces</span>
<a name="ln-416"></a>    <span class="k">call </span><span class="n">ia_calc_forces</span><span class="p">(</span><span class="n">psmbx</span><span class="p">,</span> <span class="n">patc</span><span class="p">,</span> <span class="n">ierr</span><span class="p">)</span>
<a name="ln-417"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-418"></a>
<a name="ln-419"></a>    <span class="c">!Calculate ambient flow velocity at the atom locations.</span>
<a name="ln-420"></a>    <span class="k">select case</span><span class="p">(</span><span class="n">patc</span><span class="p">%</span><span class="n">flow_style</span><span class="p">)</span>
<a name="ln-421"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-422"></a>        <span class="c">!Steady simple shear: Flow along x, gradient along y</span>
<a name="ln-423"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">patc</span><span class="p">%</span><span class="n">num_atoms</span>
<a name="ln-424"></a>            <span class="n">drift</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">patc</span><span class="p">%</span><span class="n">flow_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">patc</span><span class="p">%</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-425"></a>        <span class="k">end do</span>
<a name="ln-426"></a><span class="k">    case</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-427"></a>        <span class="c">!Steady planar extension in x-y plane</span>
<a name="ln-428"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">patc</span><span class="p">%</span><span class="n">num_atoms</span>
<a name="ln-429"></a>            <span class="n">drift</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span>  <span class="n">patc</span><span class="p">%</span><span class="n">flow_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">patc</span><span class="p">%</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-430"></a>            <span class="n">drift</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">patc</span><span class="p">%</span><span class="n">flow_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">patc</span><span class="p">%</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-431"></a>        <span class="k">end do</span>
<a name="ln-432"></a><span class="k">    case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-433"></a>        <span class="c">!Steady uniaxial extension along x</span>
<a name="ln-434"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">patc</span><span class="p">%</span><span class="n">num_atoms</span>
<a name="ln-435"></a>            <span class="n">drift</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span>  <span class="n">patc</span><span class="p">%</span><span class="n">flow_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">patc</span><span class="p">%</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-436"></a>            <span class="n">drift</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5_rp</span><span class="o">*</span><span class="n">patc</span><span class="p">%</span><span class="n">flow_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">patc</span><span class="p">%</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-437"></a>            <span class="n">drift</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>   <span class="o">=</span> <span class="o">-</span><span class="mf">0.5_rp</span><span class="o">*</span><span class="n">patc</span><span class="p">%</span><span class="n">flow_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">patc</span><span class="p">%</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-438"></a>        <span class="k">end do</span>
<a name="ln-439"></a><span class="k">    case </span><span class="n">default</span>
<a name="ln-440"></a>        <span class="k">continue</span>
<a name="ln-441"></a><span class="k">    end select</span>
<a name="ln-442"></a>
<a name="ln-443"></a>    <span class="c">!drift &lt;- mob * forces + drift. Only the lower triangular part of</span>
<a name="ln-444"></a>    <span class="c">!mob is accessed.</span>
<a name="ln-445"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">lhdia</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-446"></a><span class="k">        call </span><span class="n">dsymv</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">patc</span><span class="p">%</span><span class="n">num_atoms</span><span class="p">,</span> <span class="mf">1.0_rp</span><span class="p">,</span> <span class="n">mob</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">patc</span><span class="p">%</span><span class="n">num_atoms</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-447"></a>                    <span class="n">pvfrc</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.0_rp</span><span class="p">,</span> <span class="n">drift</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-448"></a>    <span class="k">else</span>
<a name="ln-449"></a><span class="k">        </span><span class="n">drift</span> <span class="o">=</span> <span class="n">drift</span> <span class="o">+</span> <span class="n">pvfrc</span>
<a name="ln-450"></a>    <span class="k">end if</span>
<a name="ln-451"></a>
<a name="ln-452"></a><span class="k">    </span><span class="n">drift</span> <span class="o">=</span> <span class="n">tim_stp</span> <span class="o">*</span> <span class="n">drift</span>
<a name="ln-453"></a>
<a name="ln-454"></a>    <span class="k">end subroutine</span>
<a name="ln-455"></a>
<a name="ln-456"></a><span class="c">!******************************************************************************</span>
<a name="ln-457"></a>
<a name="ln-458"></a><span class="k">subroutine </span><span class="n">calc_rpy_tensor</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">mob</span><span class="p">)</span>
<a name="ln-459"></a>    <span class="c">!! Calculates the RPY approximation to the mobility tensor.</span>
<a name="ln-460"></a>
<a name="ln-461"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">coordinates</span>
<a name="ln-462"></a>        <span class="c">!! (3, num_atoms*) matrix; stores the atom positions.</span>
<a name="ln-463"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mob</span>
<a name="ln-464"></a>        <span class="c">!! (3*num_atoms*, 3*num_atoms*) matrix; stores the mobility tensor.</span>
<a name="ln-465"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ri</span><span class="p">,</span> <span class="n">rj</span><span class="p">,</span> <span class="n">rij</span>
<a name="ln-466"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">matrpy</span>
<a name="ln-467"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rijm</span><span class="p">,</span> <span class="n">irijm</span><span class="p">,</span> <span class="n">irijm2</span>
<a name="ln-468"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">consij</span>
<a name="ln-469"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-470"></a>
<a name="ln-471"></a>    <span class="n">num_atoms</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-472"></a>    <span class="n">mob</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-473"></a>
<a name="ln-474"></a>    <span class="c">!Calculate the RPY tensor (in strictly upper triangular form)</span>
<a name="ln-475"></a>    <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-476"></a>        <span class="n">rj</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">j</span><span class="p">)</span>
<a name="ln-477"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-478"></a>            <span class="n">ri</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-479"></a>            <span class="n">rij</span> <span class="o">=</span> <span class="n">rj</span> <span class="o">-</span> <span class="n">ri</span>
<a name="ln-480"></a>            <span class="n">rijm</span> <span class="o">=</span> <span class="nb">norm2</span><span class="p">(</span><span class="n">rij</span><span class="p">)</span>
<a name="ln-481"></a>            <span class="n">irijm</span> <span class="o">=</span> <span class="mf">1.0_rp</span><span class="o">/</span><span class="n">rijm</span>
<a name="ln-482"></a>            <span class="n">irijm2</span> <span class="o">=</span> <span class="n">irijm</span><span class="o">*</span><span class="n">irijm</span>
<a name="ln-483"></a>
<a name="ln-484"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">rijm</span> <span class="o">&gt;=</span> <span class="mf">2.0_rp</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-485"></a><span class="k">              </span><span class="n">C1</span> <span class="o">=</span>  <span class="mf">1.0_rp</span> <span class="o">+</span> <span class="p">(</span><span class="mf">2.0_rp</span><span class="o">/</span><span class="mf">3.0_rp</span><span class="p">)</span><span class="o">*</span><span class="n">irijm2</span>
<a name="ln-486"></a>              <span class="n">C2</span> <span class="o">=</span>  <span class="mf">1.0_rp</span> <span class="o">-</span> <span class="mf">2.0_rp</span><span class="o">*</span><span class="n">irijm2</span>
<a name="ln-487"></a>              <span class="n">consij</span> <span class="o">=</span> <span class="mf">0.75_rp</span><span class="o">*</span><span class="n">irijm</span>
<a name="ln-488"></a>            <span class="k">else</span>
<a name="ln-489"></a><span class="k">              </span><span class="n">C1</span> <span class="o">=</span> <span class="mf">1.0_rp</span> <span class="o">-</span> <span class="mf">9.0_rp</span><span class="o">*</span><span class="n">rijm</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="mf">2.0_rp</span><span class="p">)</span>
<a name="ln-490"></a>              <span class="n">C2</span> <span class="o">=</span> <span class="mf">3.0_rp</span><span class="o">*</span><span class="n">rijm</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="mf">2.0_rp</span><span class="p">)</span>
<a name="ln-491"></a>              <span class="n">consij</span> <span class="o">=</span> <span class="mf">1.0_rp</span>
<a name="ln-492"></a>            <span class="k">end if</span>
<a name="ln-493"></a>
<a name="ln-494"></a><span class="k">            </span><span class="n">matrpy</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">consij</span><span class="o">*</span><span class="p">(</span> <span class="n">C1</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">irijm2</span> <span class="p">)</span>
<a name="ln-495"></a>            <span class="n">matrpy</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">consij</span><span class="o">*</span><span class="p">(</span>      <span class="n">C2</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">irijm2</span> <span class="p">)</span>
<a name="ln-496"></a>            <span class="n">matrpy</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">consij</span><span class="o">*</span><span class="p">(</span>      <span class="n">C2</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">irijm2</span> <span class="p">)</span>
<a name="ln-497"></a>
<a name="ln-498"></a>            <span class="n">matrpy</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">consij</span><span class="o">*</span><span class="p">(</span>      <span class="n">C2</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">irijm2</span> <span class="p">)</span>
<a name="ln-499"></a>            <span class="n">matrpy</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">consij</span><span class="o">*</span><span class="p">(</span> <span class="n">C1</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">irijm2</span> <span class="p">)</span>
<a name="ln-500"></a>            <span class="n">matrpy</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">consij</span><span class="o">*</span><span class="p">(</span>      <span class="n">C2</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">irijm2</span> <span class="p">)</span>
<a name="ln-501"></a>
<a name="ln-502"></a>            <span class="n">matrpy</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">consij</span><span class="o">*</span><span class="p">(</span>      <span class="n">C2</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">irijm2</span> <span class="p">)</span>
<a name="ln-503"></a>            <span class="n">matrpy</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">consij</span><span class="o">*</span><span class="p">(</span>      <span class="n">C2</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">irijm2</span> <span class="p">)</span>
<a name="ln-504"></a>            <span class="n">matrpy</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">consij</span><span class="o">*</span><span class="p">(</span> <span class="n">C1</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">irijm2</span> <span class="p">)</span>
<a name="ln-505"></a>
<a name="ln-506"></a>            <span class="n">mob</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">j</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">matrpy</span>
<a name="ln-507"></a>        <span class="k">end do</span>
<a name="ln-508"></a><span class="k">    end do</span>
<a name="ln-509"></a>   
<a name="ln-510"></a>    <span class="c">!Copy strictly upper triangular part to strictly lower triangular part.</span>
<a name="ln-511"></a>    <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">num_atoms</span>
<a name="ln-512"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-513"></a>            <span class="n">mob</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">mob</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
<a name="ln-514"></a>        <span class="k">end do</span>
<a name="ln-515"></a><span class="k">    end do</span>
<a name="ln-516"></a>
<a name="ln-517"></a>    <span class="c">!Put one on the diagonal.</span>
<a name="ln-518"></a>    <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">num_atoms</span>
<a name="ln-519"></a>       <span class="n">mob</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0_rp</span>
<a name="ln-520"></a>    <span class="k">end do</span>
<a name="ln-521"></a>
<a name="ln-522"></a><span class="k">    end subroutine</span>
<a name="ln-523"></a>
<a name="ln-524"></a><span class="c">!******************************************************************************</span>
<a name="ln-525"></a>
<a name="ln-526"></a><span class="k">end module </span><span class="n">bd_solver_m</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> BROWNPAK was developed by Sarit Dutta</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>