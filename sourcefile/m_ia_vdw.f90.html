<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for BROWNPAK">
   
    <meta name="author" content="Sarit Dutta" >
    <link rel="icon" href="../favicon.png">

    <title>m_ia_vdw.f90 &ndash; BROWNPAK</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">BROWNPAK <small>0.2</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>m_ia_vdw.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 4.9% of total for source files.">300 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/m_ia_vdw.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">m_ia_vdw.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_ia_vdw.html">m_ia_vdw</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_ia_vdw.f90.html#src">m_ia_vdw.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_ia_vdw.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilem_ia_vdwf90EfferentGraph" width="601pt" height="227pt"
 viewBox="0.00 0.00 601.00 226.68" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_ia_vdw.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 222.6793)">
<title>sourcefile~~m_ia_vdw.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-222.6793 597,-222.6793 597,4 -4,4"/>
<!-- sourcefile~m_ia_vdw.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~m_ia_vdw.f90</title>
<polygon fill="none" stroke="#000000" points="593,-105 516,-105 516,-81 593,-81 593,-105"/>
<text text-anchor="middle" x="554.5" y="-90.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_ia_vdw.f90</text>
</g>
<!-- sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~m_globals.f90</title>
<g id="a_sourcefile~~m_ia_vdw.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/m_globals.f90.html" xlink:title="m_globals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480,-105 402,-105 402,-81 480,-81 480,-105"/>
<text text-anchor="middle" x="441" y="-90.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_globals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M515.7572,-93C507.6305,-93 498.9542,-93 490.4964,-93"/>
<polygon fill="#ff0000" stroke="#ff0000" points="490.3398,-89.5001 480.3397,-93 490.3397,-96.5001 490.3398,-89.5001"/>
</g>
<!-- sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~m_logger.f90</title>
<g id="a_sourcefile~~m_ia_vdw.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/m_logger.f90.html" xlink:title="m_logger.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="219.5,-24 145.5,-24 145.5,0 219.5,0 219.5,-24"/>
<text text-anchor="middle" x="182.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_logger.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_logger.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M525.3622,-80.9746C488.8039,-66.4239 423.8741,-42.3453 366,-30 320.3577,-20.2639 267.187,-15.7793 229.8661,-13.7224"/>
<polygon fill="#ff0000" stroke="#ff0000" points="229.9458,-10.222 219.7794,-13.2043 229.5867,-17.2128 229.9458,-10.222"/>
</g>
<!-- sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~m_precision.f90</title>
<g id="a_sourcefile~~m_ia_vdw.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/m_precision.f90.html" xlink:title="m_precision.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="87,-145 0,-145 0,-121 87,-121 87,-145"/>
<text text-anchor="middle" x="43.5" y="-130.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_precision.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M322,-213C233.3584,-219.0325 205.6779,-226.5283 123,-194 99.6423,-184.8103 77.3607,-166.6029 62.3616,-152.4617"/>
<polygon fill="#ff0000" stroke="#ff0000" points="64.4211,-149.5814 54.8175,-145.1068 59.5346,-154.5936 64.4211,-149.5814"/>
</g>
<!-- sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~m_constants_math.f90</title>
<g id="a_sourcefile~~m_ia_vdw.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/m_constants_math.f90.html" xlink:title="m_constants_math.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="242,-185 123,-185 123,-161 242,-161 242,-185"/>
<text text-anchor="middle" x="182.5" y="-170.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_constants_math.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M542.5152,-105.2413C509.9177,-137.1018 415.7892,-219.689 322,-213"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M322,-213C303.1255,-214.2845 258.3896,-200.2969 224.6294,-188.513"/>
<polygon fill="#ff0000" stroke="#ff0000" points="225.5829,-185.1379 214.9881,-185.1046 223.2497,-191.7376 225.5829,-185.1379"/>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M402.7575,-105.0586C391.0586,-108.3806 378.0877,-111.6992 366,-114 285.4545,-129.3312 264.2838,-127.1672 182.5,-133"/>
</g>
<!-- sourcefile~m_trajectory.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~m_trajectory.f90</title>
<g id="a_sourcefile~~m_ia_vdw.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/m_trajectory.f90.html" xlink:title="m_trajectory.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-63 278,-63 278,-39 366,-39 366,-63"/>
<text text-anchor="middle" x="322" y="-48.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_trajectory.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_trajectory.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_trajectory.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M406.8994,-80.9645C394.0776,-76.4392 379.3187,-71.2301 365.7399,-66.4376"/>
<polygon fill="#ff0000" stroke="#ff0000" points="366.7004,-63.0651 356.1056,-63.0373 364.3706,-69.666 366.7004,-63.0651"/>
</g>
<!-- sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~m_simbox.f90</title>
<g id="a_sourcefile~~m_ia_vdw.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/m_simbox.f90.html" xlink:title="m_simbox.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="361,-105 283,-105 283,-81 361,-81 361,-105"/>
<text text-anchor="middle" x="322" y="-90.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_simbox.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_simbox.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M401.7052,-93C392.058,-93 381.6067,-93 371.5462,-93"/>
<polygon fill="#ff0000" stroke="#ff0000" points="371.2536,-89.5001 361.2536,-93 371.2536,-96.5001 371.2536,-89.5001"/>
</g>
<!-- sourcefile~m_constants_math.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~m_constants_math.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M140.7954,-160.9987C126.495,-156.8835 110.3148,-152.2273 95.3125,-147.9101"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="96.2335,-144.5331 85.6556,-145.1311 94.2976,-151.2601 96.2335,-144.5331"/>
</g>
<!-- sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_logger.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M279.0071,-38.9805C263.3613,-34.6064 245.5983,-29.6404 229.6141,-25.1717"/>
<polygon fill="#ff0000" stroke="#ff0000" points="230.4995,-21.7851 219.9264,-22.4633 228.6148,-28.5266 230.4995,-21.7851"/>
</g>
<!-- sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M277.6683,-48.9121C236.2188,-48.5047 173.3329,-51.9076 123,-72 99.6883,-81.3058 77.4009,-99.4984 62.3879,-113.6047"/>
<polygon fill="#ff0000" stroke="#ff0000" points="59.5712,-111.4612 54.8355,-120.9387 64.4479,-116.483 59.5712,-111.4612"/>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M182.5,-133C154.4683,-134.9992 123.1759,-135.1795 97.3901,-134.7821"/>
<polygon fill="#00ffff" stroke="#00ffff" points="97.1325,-131.2767 87.0684,-134.5882 97.0009,-138.2755 97.1325,-131.2767"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M293.2504,-105.0569C265.4842,-115.779 221.9555,-130.186 182.5,-133"/>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M306.0038,-105.072C290.2348,-116.6613 265.1983,-134.2404 242,-147 235.8281,-150.3947 229.1244,-153.6812 222.5161,-156.71"/>
<polygon fill="#00ffff" stroke="#00ffff" points="220.695,-153.6891 212.9756,-160.9459 223.5356,-160.0868 220.695,-153.6891"/>
</g>
<!-- sourcefile~m_ran_num.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~m_ran_num.f90</title>
<g id="a_sourcefile~~m_ia_vdw.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/m_ran_num.f90.html" xlink:title="m_ran_num.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="225.5,-105 139.5,-105 139.5,-81 225.5,-81 225.5,-105"/>
<text text-anchor="middle" x="182.5" y="-90.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ran_num.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_ran_num.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_ran_num.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M282.7702,-93C268.2268,-93 251.4782,-93 235.8858,-93"/>
<polygon fill="#00ffff" stroke="#00ffff" points="235.8412,-89.5001 225.8412,-93 235.8412,-96.5001 235.8412,-89.5001"/>
</g>
<!-- sourcefile~m_ran_num.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~m_ran_num.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M140.7954,-105.0013C126.495,-109.1165 110.3148,-113.7727 95.3125,-118.0899"/>
<polygon fill="#ff0000" stroke="#ff0000" points="94.2976,-114.7399 85.6556,-120.8689 96.2335,-121.4669 94.2976,-114.7399"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_ia_vdw.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilem_ia_vdwf90AfferentGraph" width="536pt" height="192pt"
 viewBox="0.00 0.00 536.00 192.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_ia_vdw.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 188)">
<title>sourcefile~~m_ia_vdw.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-188 532,-188 532,4 -4,4"/>
<!-- sourcefile~m_ia_vdw.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~m_ia_vdw.f90</title>
<polygon fill="none" stroke="#000000" points="77,-104 0,-104 0,-80 77,-80 77,-104"/>
<text text-anchor="middle" x="38.5" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_ia_vdw.f90</text>
</g>
<!-- sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~m_interaction.f90</title>
<g id="a_sourcefile~~m_ia_vdw.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/m_interaction.f90.html" xlink:title="m_interaction.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="206,-104 113,-104 113,-80 206,-80 206,-104"/>
<text text-anchor="middle" x="159.5" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_interaction.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_vdw.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_vdw.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M112.7182,-92C104.3971,-92 95.7105,-92 87.334,-92"/>
<polygon fill="#ff0000" stroke="#ff0000" points="87.3157,-88.5001 77.3157,-92 87.3157,-95.5001 87.3157,-88.5001"/>
</g>
<!-- sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~m_mpcd.f90</title>
<g id="a_sourcefile~~m_ia_vdw.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/m_mpcd.f90.html" xlink:title="m_mpcd.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="322,-184 252,-184 252,-160 322,-160 322,-184"/>
<text text-anchor="middle" x="287" y="-169.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_mpcd.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M265.3399,-159.8099C257.8897,-155.5314 249.5302,-150.6349 242,-146 222.9345,-134.2651 201.8177,-120.427 185.7213,-109.6973"/>
<polygon fill="#ff0000" stroke="#ff0000" points="187.5977,-106.7416 177.3402,-104.0892 183.7048,-112.5593 187.5977,-106.7416"/>
</g>
<!-- sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~m_bd_solver.f90</title>
<g id="a_sourcefile~~m_ia_vdw.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/m_bd_solver.f90.html" xlink:title="m_bd_solver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="332,-104 242,-104 242,-80 332,-80 332,-104"/>
<text text-anchor="middle" x="287" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_bd_solver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M241.6893,-92C233.5474,-92 224.9666,-92 216.5436,-92"/>
<polygon fill="#ff0000" stroke="#ff0000" points="216.3879,-88.5001 206.3879,-92 216.3879,-95.5001 216.3879,-88.5001"/>
</g>
<!-- sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~m_setup.f90</title>
<g id="a_sourcefile~~m_ia_vdw.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/m_setup.f90.html" xlink:title="m_setup.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="438,-144 368,-144 368,-120 438,-120 438,-144"/>
<text text-anchor="middle" x="403" y="-129.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_setup.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M367.9394,-129.204C335.1899,-126.2759 285.0324,-120.9801 242,-113 232.401,-111.2199 222.263,-108.9603 212.5031,-106.5872"/>
<polygon fill="#ff0000" stroke="#ff0000" points="213.058,-103.1183 202.5077,-104.0884 211.3602,-109.9093 213.058,-103.1183"/>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_mpcd.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M368.1962,-144.0013C356.7166,-147.9598 343.7856,-152.4187 331.6742,-156.5951"/>
<polygon fill="#ff0000" stroke="#ff0000" points="330.4929,-153.3001 322.1802,-159.8689 332.7749,-159.9177 330.4929,-153.3001"/>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_bd_solver.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M368.1962,-119.9987C356.7166,-116.0402 343.7856,-111.5813 331.6742,-107.4049"/>
<polygon fill="#cbff00" stroke="#cbff00" points="332.7749,-104.0823 322.1802,-104.1311 330.4929,-110.6999 332.7749,-104.0823"/>
</g>
<!-- sourcefile~m_kmc.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~m_kmc.f90</title>
<g id="a_sourcefile~~m_ia_vdw.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/m_kmc.f90.html" xlink:title="m_kmc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="319,-24 255,-24 255,0 319,0 319,-24"/>
<text text-anchor="middle" x="287" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_kmc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_kmc.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~m_kmc.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M265.3399,-24.1901C257.8897,-28.4686 249.5302,-33.3651 242,-38 222.9345,-49.7349 201.8177,-63.573 185.7213,-74.3027"/>
<polygon fill="#ff0000" stroke="#ff0000" points="183.7048,-71.4407 177.3402,-79.9108 187.5977,-77.2584 183.7048,-71.4407"/>
</g>
<!-- sourcefile~m_relax.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~m_relax.f90</title>
<g id="a_sourcefile~~m_ia_vdw.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/m_relax.f90.html" xlink:title="m_relax.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436.5,-64 369.5,-64 369.5,-40 436.5,-40 436.5,-64"/>
<text text-anchor="middle" x="403" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_relax.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_relax.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~m_relax.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M369.1943,-54.6842C336.4813,-57.5883 285.5858,-62.9173 242,-71 232.401,-72.7801 222.263,-75.0397 212.5031,-77.4128"/>
<polygon fill="#ff0000" stroke="#ff0000" points="211.3602,-74.0907 202.5077,-79.9116 213.058,-80.8817 211.3602,-74.0907"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~m_ia_vdw.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="528,-124 474,-124 474,-100 528,-100 528,-124"/>
<text text-anchor="middle" x="501" y="-109.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_mpcd.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M486.506,-124.1882C474.3584,-133.6927 456.1357,-146.3583 438,-153 404.0435,-165.4356 363.2358,-170.0051 332.608,-171.5649"/>
<polygon fill="#ff0000" stroke="#ff0000" points="332.0721,-168.0842 322.2271,-171.9991 332.3646,-175.0781 332.0721,-168.0842"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_bd_solver.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M473.8968,-109.467C440.9597,-106.3888 384.556,-101.1174 342.3063,-97.1688"/>
<polygon fill="#cbff00" stroke="#cbff00" points="342.4476,-93.6669 332.1653,-96.2211 341.7962,-100.6365 342.4476,-93.6669"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M473.9616,-117.518C465.8936,-119.1646 456.824,-121.0155 447.9341,-122.8298"/>
<polygon fill="#00ff66" stroke="#00ff66" points="447.1346,-119.4207 438.0365,-124.8497 448.5344,-126.2793 447.1346,-119.4207"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_relax.f90 -->
<g id="sourcefile~~m_ia_vdw.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_relax.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M481.1682,-99.8581C466.9552,-91.1562 447.5942,-79.3026 431.697,-69.5696"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="433.1584,-66.3604 422.8023,-64.1238 429.5032,-72.3304 433.1584,-66.3604"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_ia_vdw.html">m_ia_vdw</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_ia_vdw.f90.html#src">m_ia_vdw.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">module </span><span class="n">m_ia_vdw</span>
<a name="ln-2"></a><span class="c">!! Routines to evaulate pairwise potentials and their derivative.</span>
<a name="ln-3"></a><span class="c">!!</span>
<a name="ln-4"></a><span class="c">!! The following styles are available:</span>
<a name="ln-5"></a><span class="c">!!</span>
<a name="ln-6"></a><span class="c">!! * Style 1. 12-6 LJ (cut &amp; shifted). See [[vdw_lj_set]].</span>
<a name="ln-7"></a><span class="c">!! * Style 2. Gaussian (cut &amp; shifted). See [[vdw_gaussian_set]].</span>
<a name="ln-8"></a><span class="c">!! * Style 3. Cosine. See [[vdw_cosine_set]].</span>
<a name="ln-9"></a><span class="c">!! * Style 4. Screened Coulomb + LJ (cut &amp; shifted). See [[vdw_lj_coul_debye_set]].</span>
<a name="ln-10"></a><span class="c">!! * Style 5. Coulomb + LJ (cut &amp; shifted) See [[vdw_lj_coul_set]].</span>
<a name="ln-11"></a>
<a name="ln-12"></a><span class="k">use </span><span class="n">m_precision</span>
<a name="ln-13"></a><span class="k">use </span><span class="n">m_constants_math</span>
<a name="ln-14"></a><span class="k">use </span><span class="n">m_globals</span>
<a name="ln-15"></a><span class="k">use </span><span class="n">m_logger</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">logger_init</span><span class="p">,</span> <span class="n">logger</span> <span class="o">=&gt;</span> <span class="n">master_logger</span>
<a name="ln-16"></a>
<a name="ln-17"></a><span class="k">implicit none</span>
<a name="ln-18"></a>
<a name="ln-19"></a><span class="k">private</span>
<a name="ln-20"></a>
<a name="ln-21"></a><span class="k">public</span> <span class="kd">::</span> <span class="n">ia_vdw_setup</span><span class="p">,</span> <span class="n">ia_get_vdw_force</span>
<a name="ln-22"></a>
<a name="ln-23"></a><span class="k">contains</span>
<a name="ln-24"></a>
<a name="ln-25"></a><span class="c">!******************************************************************************</span>
<a name="ln-26"></a>
<a name="ln-27"></a><span class="k">subroutine </span><span class="n">ia_vdw_setup</span><span class="p">()</span>
<a name="ln-28"></a>    <span class="c">!! Sets up parameters for vdw potentials </span>
<a name="ln-29"></a>
<a name="ln-30"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-31"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">sty</span>
<a name="ln-32"></a>
<a name="ln-33"></a>    <span class="c">!Set vdw interactions</span>
<a name="ln-34"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_vdw_types</span>
<a name="ln-35"></a>        <span class="n">sty</span> <span class="o">=</span> <span class="n">vdw_styles</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-36"></a>
<a name="ln-37"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">sty</span><span class="p">)</span>
<a name="ln-38"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-39"></a>            <span class="k">call </span><span class="n">vdw_lj_set</span><span class="p">(</span><span class="n">vdw_params</span><span class="p">(:,</span><span class="n">i</span><span class="p">))</span>
<a name="ln-40"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-41"></a>            <span class="k">call </span><span class="n">vdw_gaussian_set</span><span class="p">(</span><span class="n">vdw_params</span><span class="p">(:,</span><span class="n">i</span><span class="p">))</span>
<a name="ln-42"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-43"></a>            <span class="k">call </span><span class="n">vdw_cosine_set</span><span class="p">(</span><span class="n">vdw_params</span><span class="p">(:,</span><span class="n">i</span><span class="p">))</span>
<a name="ln-44"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-45"></a>            <span class="k">call </span><span class="n">vdw_lj_coul_debye_set</span><span class="p">(</span><span class="n">vdw_params</span><span class="p">(:,</span><span class="n">i</span><span class="p">))</span>
<a name="ln-46"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-47"></a>            <span class="k">call </span><span class="n">vdw_lj_coul_set</span><span class="p">(</span><span class="n">vdw_params</span><span class="p">(:,</span><span class="n">i</span><span class="p">))</span>
<a name="ln-48"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-49"></a>            <span class="k">continue</span>
<a name="ln-50"></a><span class="k">        end select</span>
<a name="ln-51"></a><span class="k">    end do</span>
<a name="ln-52"></a>
<a name="ln-53"></a><span class="k">    end subroutine</span>
<a name="ln-54"></a>
<a name="ln-55"></a><span class="c">!******************************************************************************</span>
<a name="ln-56"></a>
<a name="ln-57"></a><span class="k">subroutine </span><span class="n">ia_get_vdw_force</span><span class="p">(</span><span class="n">rij_mag</span><span class="p">,</span> <span class="n">qi</span><span class="p">,</span> <span class="n">qj</span><span class="p">,</span> <span class="n">typ</span><span class="p">,</span> <span class="n">enrg</span><span class="p">,</span> <span class="n">frc</span><span class="p">,</span> <span class="n">ierr</span><span class="p">)</span>
<a name="ln-58"></a>    <span class="c">!! Calculates the energy &amp; its derivative due to a single interacting pair of atoms.</span>
<a name="ln-59"></a>
<a name="ln-60"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rij_mag</span>
<a name="ln-61"></a>        <span class="c">!! Distance between two atoms</span>
<a name="ln-62"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">qi</span>
<a name="ln-63"></a>        <span class="c">!! Charge on atom i</span>
<a name="ln-64"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">qj</span>
<a name="ln-65"></a>        <span class="c">!! Charge on atom j</span>
<a name="ln-66"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">typ</span>
<a name="ln-67"></a>        <span class="c">!! Type of vdw interaction</span>
<a name="ln-68"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">enrg</span>
<a name="ln-69"></a>        <span class="c">!! Energy</span>
<a name="ln-70"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">frc</span>
<a name="ln-71"></a>        <span class="c">!! Derivative of the potential. This is the magnitude of force due to</span>
<a name="ln-72"></a>        <span class="c">!! this potential.</span>
<a name="ln-73"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-74"></a>        <span class="c">!! Error flag</span>
<a name="ln-75"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">styl</span>
<a name="ln-76"></a>
<a name="ln-77"></a>    <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">enrg</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">frc</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-78"></a>
<a name="ln-79"></a>    <span class="n">styl</span> <span class="o">=</span> <span class="n">vdw_styles</span><span class="p">(</span><span class="n">typ</span><span class="p">)</span>
<a name="ln-80"></a>    <span class="k">select case</span><span class="p">(</span><span class="n">styl</span><span class="p">)</span>
<a name="ln-81"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-82"></a>        <span class="k">call </span><span class="n">vdw_lj</span><span class="p">(</span><span class="n">rij_mag</span><span class="p">,</span> <span class="n">vdw_params</span><span class="p">(:,</span><span class="n">typ</span><span class="p">),</span> <span class="n">enrg</span><span class="p">,</span> <span class="n">frc</span><span class="p">)</span>
<a name="ln-83"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-84"></a>        <span class="k">call </span><span class="n">vdw_gaussian</span><span class="p">(</span><span class="n">rij_mag</span><span class="p">,</span> <span class="n">vdw_params</span><span class="p">(:,</span><span class="n">typ</span><span class="p">),</span> <span class="n">enrg</span><span class="p">,</span> <span class="n">frc</span><span class="p">)</span>
<a name="ln-85"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-86"></a>        <span class="k">call </span><span class="n">vdw_cosine</span><span class="p">(</span><span class="n">rij_mag</span><span class="p">,</span> <span class="n">vdw_params</span><span class="p">(:,</span><span class="n">typ</span><span class="p">),</span> <span class="n">enrg</span><span class="p">,</span> <span class="n">frc</span><span class="p">)</span>
<a name="ln-87"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-88"></a>        <span class="k">call </span><span class="n">vdw_lj_coul_debye</span><span class="p">(</span><span class="n">rij_mag</span><span class="p">,</span> <span class="n">qi</span><span class="o">*</span><span class="n">qj</span><span class="p">,</span> <span class="n">vdw_params</span><span class="p">(:,</span><span class="n">typ</span><span class="p">),</span> <span class="n">enrg</span><span class="p">,</span> <span class="n">frc</span><span class="p">)</span>
<a name="ln-89"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-90"></a>        <span class="k">call </span><span class="n">vdw_lj_coul</span><span class="p">(</span><span class="n">rij_mag</span><span class="p">,</span> <span class="n">qi</span><span class="o">*</span><span class="n">qj</span><span class="p">,</span> <span class="n">vdw_params</span><span class="p">(:,</span><span class="n">typ</span><span class="p">),</span> <span class="n">enrg</span><span class="p">,</span> <span class="n">frc</span><span class="p">)</span>
<a name="ln-91"></a>    <span class="k">case </span><span class="n">default</span>
<a name="ln-92"></a>        <span class="k">continue</span>
<a name="ln-93"></a><span class="k">    end select</span>
<a name="ln-94"></a>
<a name="ln-95"></a><span class="k">    end subroutine</span>
<a name="ln-96"></a>
<a name="ln-97"></a><span class="c">!******************************************************************************</span>
<a name="ln-98"></a>
<a name="ln-99"></a><span class="k">subroutine </span><span class="n">vdw_lj_set</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">rcut</span><span class="p">)</span>
<a name="ln-100"></a>    <span class="c">!! Setter for 12-6 LJ (cut &amp; shifted) interaction.</span>
<a name="ln-101"></a>    <span class="c">!!</span>
<a name="ln-102"></a>    <span class="c">!!```</span>
<a name="ln-103"></a>    <span class="c">!!   V = 4*eps*[(r/sigma)^12 - (r/sigma)^6]  </span>
<a name="ln-104"></a>    <span class="c">!!   U = V - V(rcut), r &lt; rcut  </span>
<a name="ln-105"></a>    <span class="c">!!       0, r &gt;= rcut  </span>
<a name="ln-106"></a>    <span class="c">!!```</span>
<a name="ln-107"></a>    <span class="c">!! User-set parameters:</span>
<a name="ln-108"></a>    <span class="c">!!</span>
<a name="ln-109"></a>    <span class="c">!! * params(1) = `eps`</span>
<a name="ln-110"></a>    <span class="c">!! * params(2) = `sigma`</span>
<a name="ln-111"></a>    <span class="c">!! * params(3) = `rcut`</span>
<a name="ln-112"></a>    <span class="c">!!</span>
<a name="ln-113"></a>    <span class="c">!! Internally stored parameters:</span>
<a name="ln-114"></a>    <span class="c">!!</span>
<a name="ln-115"></a>    <span class="c">!! * params(4) = `V(rcut)`</span>
<a name="ln-116"></a>
<a name="ln-117"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">params</span>
<a name="ln-118"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">eps</span>
<a name="ln-119"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">sigma</span>
<a name="ln-120"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">rcut</span>
<a name="ln-121"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">eps_</span><span class="p">,</span> <span class="n">sigma_</span><span class="p">,</span> <span class="n">rcut_</span>
<a name="ln-122"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pot_rcut</span>
<a name="ln-123"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sir</span><span class="p">,</span> <span class="n">sir2</span><span class="p">,</span> <span class="n">sir6</span><span class="p">,</span> <span class="n">sir12</span>
<a name="ln-124"></a>
<a name="ln-125"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">eps</span><span class="p">))</span> <span class="n">params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">eps</span>
<a name="ln-126"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">sigma</span><span class="p">))</span> <span class="n">params</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">sigma</span>
<a name="ln-127"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">rcut</span><span class="p">))</span> <span class="n">params</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">rcut</span>
<a name="ln-128"></a>
<a name="ln-129"></a>    <span class="n">eps_</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">sigma_</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">rcut_</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-130"></a>
<a name="ln-131"></a>    <span class="n">sir</span> <span class="o">=</span> <span class="n">sigma_</span><span class="o">/</span><span class="n">rcut_</span>
<a name="ln-132"></a>    <span class="n">sir2</span> <span class="o">=</span> <span class="n">sir</span><span class="o">*</span><span class="n">sir</span><span class="p">;</span> <span class="n">sir6</span> <span class="o">=</span> <span class="n">sir2</span><span class="o">*</span><span class="n">sir2</span><span class="o">*</span><span class="n">sir2</span><span class="p">;</span> <span class="n">sir12</span> <span class="o">=</span> <span class="n">sir6</span><span class="o">*</span><span class="n">sir6</span>
<a name="ln-133"></a>    <span class="n">pot_rcut</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">eps_</span><span class="o">*</span><span class="p">(</span><span class="n">sir12</span> <span class="o">-</span> <span class="n">sir6</span><span class="p">)</span>
<a name="ln-134"></a>
<a name="ln-135"></a>    <span class="n">params</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">pot_rcut</span>
<a name="ln-136"></a>
<a name="ln-137"></a>    <span class="k">end subroutine</span>
<a name="ln-138"></a>
<a name="ln-139"></a><span class="c">!******************************************************************************</span>
<a name="ln-140"></a>
<a name="ln-141"></a><span class="k">pure subroutine </span><span class="n">vdw_lj</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">enrg</span><span class="p">,</span> <span class="n">frc</span><span class="p">)</span>
<a name="ln-142"></a>    <span class="c">!! Evaluates the potential and its derivative for LJ interaction. See</span>
<a name="ln-143"></a>    <span class="c">!! [[vdw_lj_set]].</span>
<a name="ln-144"></a>
<a name="ln-145"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">r</span>
<a name="ln-146"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">params</span>
<a name="ln-147"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">enrg</span>
<a name="ln-148"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">frc</span>
<a name="ln-149"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">eps</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">rcut</span>
<a name="ln-150"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pot_rcut</span>
<a name="ln-151"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sir</span><span class="p">,</span> <span class="n">sir2</span><span class="p">,</span> <span class="n">sir6</span><span class="p">,</span> <span class="n">sir12</span>
<a name="ln-152"></a>
<a name="ln-153"></a>    <span class="n">enrg</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">frc</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-154"></a>
<a name="ln-155"></a>    <span class="n">eps</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">rcut</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-156"></a>    <span class="n">pot_rcut</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-157"></a>
<a name="ln-158"></a>    <span class="k">if</span> <span class="p">(</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">rcut</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-159"></a><span class="k">        </span><span class="n">sir</span> <span class="o">=</span> <span class="n">sigma</span><span class="o">/</span><span class="n">r</span>
<a name="ln-160"></a>        <span class="n">sir2</span> <span class="o">=</span> <span class="n">sir</span><span class="o">*</span><span class="n">sir</span><span class="p">;</span> <span class="n">sir6</span> <span class="o">=</span> <span class="n">sir2</span><span class="o">*</span><span class="n">sir2</span><span class="o">*</span><span class="n">sir2</span><span class="p">;</span> <span class="n">sir12</span> <span class="o">=</span> <span class="n">sir6</span><span class="o">*</span><span class="n">sir6</span>
<a name="ln-161"></a>        <span class="n">enrg</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">eps</span><span class="o">*</span><span class="p">(</span><span class="n">sir12</span> <span class="o">-</span> <span class="n">sir6</span><span class="p">)</span> <span class="o">-</span> <span class="n">pot_rcut</span>
<a name="ln-162"></a>        <span class="n">frc</span> <span class="o">=</span> <span class="o">-</span><span class="mi">24</span><span class="o">*</span><span class="n">eps</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sir12</span> <span class="o">-</span> <span class="n">sir6</span><span class="p">)</span><span class="o">/</span><span class="n">r</span>
<a name="ln-163"></a>    <span class="k">end if</span>
<a name="ln-164"></a>
<a name="ln-165"></a><span class="k">    end subroutine</span>
<a name="ln-166"></a>
<a name="ln-167"></a><span class="c">!******************************************************************************</span>
<a name="ln-168"></a>
<a name="ln-169"></a><span class="k">subroutine </span><span class="n">vdw_gaussian_set</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">rcut</span><span class="p">)</span>
<a name="ln-170"></a>    <span class="c">!! Setter for gaussian interaction.</span>
<a name="ln-171"></a>    <span class="c">!!</span>
<a name="ln-172"></a>    <span class="c">!!```</span>
<a name="ln-173"></a>    <span class="c">!!   V = A*exp(-B*r^2)  </span>
<a name="ln-174"></a>    <span class="c">!!   U = V - V(rcut), r &lt; rcut  </span>
<a name="ln-175"></a>    <span class="c">!!   0, r &gt;= rcut  </span>
<a name="ln-176"></a>    <span class="c">!!```</span>
<a name="ln-177"></a>    <span class="c">!! User-set parameters:</span>
<a name="ln-178"></a>    <span class="c">!!</span>
<a name="ln-179"></a>    <span class="c">!! * params(1) = `A`</span>
<a name="ln-180"></a>    <span class="c">!! * params(2) = `B`</span>
<a name="ln-181"></a>    <span class="c">!! * params(3) = `rcut`</span>
<a name="ln-182"></a>    <span class="c">!!</span>
<a name="ln-183"></a>    <span class="c">!! Internally stored parameters:</span>
<a name="ln-184"></a>    <span class="c">!!</span>
<a name="ln-185"></a>    <span class="c">!! * params(4) = `V(rcut)`</span>
<a name="ln-186"></a>
<a name="ln-187"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">params</span>
<a name="ln-188"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">A</span>
<a name="ln-189"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">B</span>
<a name="ln-190"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">rcut</span>
<a name="ln-191"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pot_rcut</span>
<a name="ln-192"></a>
<a name="ln-193"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">A</span><span class="p">))</span> <span class="n">params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span>
<a name="ln-194"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">B</span><span class="p">))</span> <span class="n">params</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">B</span>
<a name="ln-195"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">rcut</span><span class="p">))</span> <span class="n">params</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">rcut</span>
<a name="ln-196"></a>
<a name="ln-197"></a>    <span class="n">pot_rcut</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">params</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-198"></a>    <span class="n">params</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">pot_rcut</span>
<a name="ln-199"></a>
<a name="ln-200"></a>    <span class="k">end subroutine</span>
<a name="ln-201"></a>
<a name="ln-202"></a><span class="c">!******************************************************************************</span>
<a name="ln-203"></a>
<a name="ln-204"></a><span class="k">pure subroutine </span><span class="n">vdw_gaussian</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">enrg</span><span class="p">,</span> <span class="n">frc</span><span class="p">)</span>
<a name="ln-205"></a>    <span class="c">!! Calculates energy &amp; its derivative for gaussian interaction. See</span>
<a name="ln-206"></a>    <span class="c">!! [[vdw_gaussian_set]].</span>
<a name="ln-207"></a>
<a name="ln-208"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">r</span>
<a name="ln-209"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">params</span>
<a name="ln-210"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">enrg</span>
<a name="ln-211"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">frc</span>
<a name="ln-212"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">rcut</span><span class="p">,</span> <span class="n">pot_rcut</span>
<a name="ln-213"></a>
<a name="ln-214"></a>    <span class="n">enrg</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">frc</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-215"></a>    <span class="n">A</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">B</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">rcut</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">pot_rcut</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-216"></a>
<a name="ln-217"></a>    <span class="k">if</span> <span class="p">(</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">rcut</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-218"></a><span class="k">        </span><span class="n">enrg</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span><span class="o">*</span><span class="n">r</span><span class="o">*</span><span class="n">r</span><span class="p">)</span> <span class="o">-</span> <span class="n">pot_rcut</span>
<a name="ln-219"></a>        <span class="n">frc</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="n">B</span><span class="o">*</span><span class="n">r</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span><span class="o">*</span><span class="n">r</span><span class="o">*</span><span class="n">r</span><span class="p">)</span>
<a name="ln-220"></a>    <span class="k">end if</span>
<a name="ln-221"></a>
<a name="ln-222"></a><span class="k">    end subroutine</span>
<a name="ln-223"></a>
<a name="ln-224"></a><span class="c">!******************************************************************************</span>
<a name="ln-225"></a>
<a name="ln-226"></a><span class="k">subroutine </span><span class="n">vdw_cosine_set</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">rcut</span><span class="p">)</span>
<a name="ln-227"></a>    <span class="c">!! Setter for cosine interaction.</span>
<a name="ln-228"></a>    <span class="c">!!</span>
<a name="ln-229"></a>    <span class="c">!!```</span>
<a name="ln-230"></a>    <span class="c">!!   U = A*cos(pi*r/rcut)</span>
<a name="ln-231"></a>    <span class="c">!!```</span>
<a name="ln-232"></a>    <span class="c">!!</span>
<a name="ln-233"></a>    <span class="c">!! User-set parameters:</span>
<a name="ln-234"></a>    <span class="c">!!</span>
<a name="ln-235"></a>    <span class="c">!! * params(1) = `A`</span>
<a name="ln-236"></a>    <span class="c">!! * params(2) = `rcut`</span>
<a name="ln-237"></a>    <span class="c">!!</span>
<a name="ln-238"></a>    <span class="c">!! Internally stored parameters:</span>
<a name="ln-239"></a>    <span class="c">!!</span>
<a name="ln-240"></a>    <span class="c">!! * params(3) = `pi/rcut`</span>
<a name="ln-241"></a>    <span class="c">!! * params(4) = `pi*A/rcut`</span>
<a name="ln-242"></a>
<a name="ln-243"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">params</span>
<a name="ln-244"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">A</span>
<a name="ln-245"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">rcut</span>
<a name="ln-246"></a>
<a name="ln-247"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">A</span><span class="p">))</span> <span class="n">params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span>
<a name="ln-248"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">rcut</span><span class="p">))</span> <span class="n">params</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">rcut</span>
<a name="ln-249"></a>
<a name="ln-250"></a>    <span class="n">params</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">math_pi</span><span class="o">/</span><span class="n">params</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-251"></a>    <span class="n">params</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-252"></a>
<a name="ln-253"></a>    <span class="k">end subroutine</span>
<a name="ln-254"></a>
<a name="ln-255"></a><span class="c">!******************************************************************************</span>
<a name="ln-256"></a>
<a name="ln-257"></a><span class="k">pure subroutine </span><span class="n">vdw_cosine</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">enrg</span><span class="p">,</span> <span class="n">frc</span><span class="p">)</span>
<a name="ln-258"></a>    <span class="c">!! Evaluates the potential and its derivative for  cosine interaction.</span>
<a name="ln-259"></a>    <span class="c">!! See [[vdw_cosine_set]].</span>
<a name="ln-260"></a>
<a name="ln-261"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">r</span>
<a name="ln-262"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">params</span>
<a name="ln-263"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">enrg</span>
<a name="ln-264"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">frc</span>
<a name="ln-265"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A</span><span class="p">,</span> <span class="n">rcut</span>
<a name="ln-266"></a>
<a name="ln-267"></a>    <span class="n">enrg</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">frc</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-268"></a>    <span class="n">A</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">rcut</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-269"></a>
<a name="ln-270"></a>    <span class="k">if</span> <span class="p">(</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">rcut</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-271"></a><span class="k">        </span><span class="n">enrg</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span> <span class="mf">1.0_rp</span> <span class="o">+</span> <span class="nb">cos</span><span class="p">(</span><span class="n">params</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-272"></a>        <span class="n">frc</span> <span class="o">=</span> <span class="o">-</span><span class="n">params</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="n">params</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">)</span>
<a name="ln-273"></a>    <span class="k">end if</span>
<a name="ln-274"></a>
<a name="ln-275"></a><span class="k">    end subroutine</span>
<a name="ln-276"></a>
<a name="ln-277"></a><span class="c">!******************************************************************************</span>
<a name="ln-278"></a>
<a name="ln-279"></a><span class="k">subroutine </span><span class="n">vdw_lj_coul_debye_set</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">rcut</span><span class="p">,</span> <span class="n">rcut_coul</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">kappa</span><span class="p">)</span>
<a name="ln-280"></a>    <span class="c">!! Setter for 12-6 LJ with screened Coulombic interaction.</span>
<a name="ln-281"></a>    <span class="c">!!</span>
<a name="ln-282"></a>    <span class="c">!!```</span>
<a name="ln-283"></a>    <span class="c">!! V = 4*eps*[(r/sigma)^12 - (r/sigma)^6]</span>
<a name="ln-284"></a>    <span class="c">!! W = C*qi*qj*exp(-kappa*r)/r</span>
<a name="ln-285"></a>    <span class="c">!! if rcut_coul &gt; 0:</span>
<a name="ln-286"></a>    <span class="c">!!     U = V - V(rcut) + W - W(rcut_coul), r &lt; rcut</span>
<a name="ln-287"></a>    <span class="c">!!         W - W(rcut_coul), rcut &lt;= r &lt; rcut_coul</span>
<a name="ln-288"></a>    <span class="c">!!         0, r &gt;= rcut_coul</span>
<a name="ln-289"></a>    <span class="c">!! if rcut_coul &lt;= 0:</span>
<a name="ln-290"></a>    <span class="c">!!     U = V - V(rcut) + W, r &lt; rcut</span>
<a name="ln-291"></a>    <span class="c">!!         W, r &gt;= rcut</span>
<a name="ln-292"></a>    <span class="c">!!```</span>
<a name="ln-293"></a>    <span class="c">!!</span>
<a name="ln-294"></a>    <span class="c">!!- The LJ potential `V` is cut &amp; shifted at `r = rcut`.  </span>
<a name="ln-295"></a>    <span class="c">!!- If `rcut_coul &gt; 0`, the screened Coulombic potential `W` is cut &amp; shifted</span>
<a name="ln-296"></a>    <span class="c">!! at `r = rcut_coul`.  </span>
<a name="ln-297"></a>    <span class="c">!!- If `rcut_coul &lt;= 0`, no cutoff is applied on `W`.  </span>
<a name="ln-298"></a>    <span class="c">!!- `rcut_coul` must be &gt;= `rcut`.  </span>
<a name="ln-299"></a>    <span class="c">!!</span>
<a name="ln-300"></a>    <span class="c">!! User-set parameters:</span>
<a name="ln-301"></a>    <span class="c">!!</span>
<a name="ln-302"></a>    <span class="c">!! * params(1) = `eps`</span>
<a name="ln-303"></a>    <span class="c">!! * params(2) = `sigma`</span>
<a name="ln-304"></a>    <span class="c">!! * params(3) = `rcut`</span>
<a name="ln-305"></a>    <span class="c">!! * params(4) = `rcut_coul`</span>
<a name="ln-306"></a>    <span class="c">!! * params(5) = `C`</span>
<a name="ln-307"></a>    <span class="c">!! * params(6) = `kappa`</span>
<a name="ln-308"></a>    <span class="c">!!</span>
<a name="ln-309"></a>    <span class="c">!! Internally stored parameters:</span>
<a name="ln-310"></a>    <span class="c">!!</span>
<a name="ln-311"></a>    <span class="c">!! * params(7) = `V(rcut)`</span>
<a name="ln-312"></a>    <span class="c">!! * params(8) = `C*exp(-kappa*rcut_coul)/rcut_coul`</span>
<a name="ln-313"></a>
<a name="ln-314"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">params</span>
<a name="ln-315"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">eps</span>
<a name="ln-316"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">sigma</span>
<a name="ln-317"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">rcut</span>
<a name="ln-318"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">rcut_coul</span>
<a name="ln-319"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">C</span>
<a name="ln-320"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">kappa</span>
<a name="ln-321"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">eps_</span><span class="p">,</span> <span class="n">sigma_</span><span class="p">,</span> <span class="n">rcut_</span><span class="p">,</span> <span class="n">rcut_coul_</span><span class="p">,</span> <span class="n">C_</span><span class="p">,</span> <span class="n">kappa_</span>
<a name="ln-322"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pot_rcut</span><span class="p">,</span> <span class="n">pot_rcut_coul</span>
<a name="ln-323"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sir</span><span class="p">,</span> <span class="n">sir2</span><span class="p">,</span> <span class="n">sir6</span><span class="p">,</span> <span class="n">sir12</span>
<a name="ln-324"></a>
<a name="ln-325"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">eps</span><span class="p">))</span> <span class="n">params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">eps</span>
<a name="ln-326"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">sigma</span><span class="p">))</span> <span class="n">params</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">sigma</span>
<a name="ln-327"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">rcut</span><span class="p">))</span> <span class="n">params</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">rcut</span>
<a name="ln-328"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">rcut_coul</span><span class="p">))</span> <span class="n">params</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">rcut_coul</span>
<a name="ln-329"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">C</span><span class="p">))</span> <span class="n">params</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">C</span>
<a name="ln-330"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">kappa</span><span class="p">))</span> <span class="n">params</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">kappa</span>
<a name="ln-331"></a>
<a name="ln-332"></a>    <span class="n">eps_</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">sigma_</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">rcut_</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-333"></a>    <span class="n">rcut_coul_</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span> <span class="n">C_</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="n">kappa_</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-334"></a>
<a name="ln-335"></a>    <span class="n">sir</span> <span class="o">=</span> <span class="n">sigma_</span><span class="o">/</span><span class="n">rcut_</span>
<a name="ln-336"></a>    <span class="n">sir2</span> <span class="o">=</span> <span class="n">sir</span><span class="o">*</span><span class="n">sir</span><span class="p">;</span> <span class="n">sir6</span> <span class="o">=</span> <span class="n">sir2</span><span class="o">*</span><span class="n">sir2</span><span class="o">*</span><span class="n">sir2</span><span class="p">;</span> <span class="n">sir12</span> <span class="o">=</span> <span class="n">sir6</span><span class="o">*</span><span class="n">sir6</span>
<a name="ln-337"></a>    <span class="n">pot_rcut</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">eps_</span><span class="o">*</span><span class="p">(</span><span class="n">sir12</span> <span class="o">-</span> <span class="n">sir6</span><span class="p">)</span>
<a name="ln-338"></a>
<a name="ln-339"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">rcut_coul_</span> <span class="o">&gt;</span> <span class="mf">0.0_rp</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-340"></a><span class="k">        </span><span class="n">pot_rcut_coul</span> <span class="o">=</span> <span class="n">C_</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">kappa_</span><span class="o">*</span><span class="n">rcut_coul_</span><span class="p">)</span><span class="o">/</span><span class="n">rcut_coul_</span>
<a name="ln-341"></a>    <span class="k">else</span>
<a name="ln-342"></a><span class="k">        </span><span class="n">pot_rcut_coul</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-343"></a>    <span class="k">end if</span>
<a name="ln-344"></a>
<a name="ln-345"></a><span class="k">    </span><span class="n">params</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">pot_rcut</span>
<a name="ln-346"></a>    <span class="n">params</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="n">pot_rcut_coul</span>
<a name="ln-347"></a>
<a name="ln-348"></a>    <span class="k">end subroutine</span>
<a name="ln-349"></a>
<a name="ln-350"></a><span class="c">!******************************************************************************</span>
<a name="ln-351"></a>
<a name="ln-352"></a><span class="k">pure subroutine </span><span class="n">vdw_lj_coul_debye</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">qiqj</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">enrg</span><span class="p">,</span> <span class="n">frc</span><span class="p">)</span>
<a name="ln-353"></a>    <span class="c">!!Evaluates the potential and its derivative for screened Coulombic interaction</span>
<a name="ln-354"></a>    <span class="c">!!combined with 12-6 LJ (cut &amp; shifted). See [[vdw_lj_coul_debye_set]].</span>
<a name="ln-355"></a>
<a name="ln-356"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">r</span>
<a name="ln-357"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">qiqj</span>
<a name="ln-358"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">params</span>
<a name="ln-359"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">enrg</span>
<a name="ln-360"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">frc</span>
<a name="ln-361"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">eps</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">rcut</span><span class="p">,</span> <span class="n">rcut_coul</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">kappa</span>
<a name="ln-362"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pot_rcut</span><span class="p">,</span> <span class="n">pot_rcut_coul</span>
<a name="ln-363"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sir</span><span class="p">,</span> <span class="n">sir2</span><span class="p">,</span> <span class="n">sir6</span><span class="p">,</span> <span class="n">sir12</span><span class="p">,</span> <span class="n">ekr</span>
<a name="ln-364"></a>
<a name="ln-365"></a>    <span class="n">enrg</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">frc</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-366"></a>
<a name="ln-367"></a>    <span class="n">eps</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">rcut</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-368"></a>    <span class="n">rcut_coul</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span> <span class="n">C</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="n">kappa</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-369"></a>    <span class="n">pot_rcut</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">7</span><span class="p">);</span> <span class="n">pot_rcut_coul</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-370"></a>
<a name="ln-371"></a>    <span class="n">ekr</span> <span class="o">=</span> <span class="n">C</span><span class="o">*</span><span class="n">qiqj</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">kappa</span><span class="o">*</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="n">r</span>
<a name="ln-372"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">rcut_coul</span> <span class="o">&gt;</span> <span class="mf">0.0_rp</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-373"></a>        <span class="c">!Coulombic cutoff at rcut_coul</span>
<a name="ln-374"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">rcut_coul</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-375"></a><span class="k">            </span><span class="n">enrg</span> <span class="o">=</span> <span class="n">ekr</span> <span class="o">-</span> <span class="n">qiqj</span><span class="o">*</span><span class="n">pot_rcut_coul</span>
<a name="ln-376"></a>            <span class="n">frc</span> <span class="o">=</span> <span class="o">-</span><span class="n">ekr</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">kappa</span><span class="o">*</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="n">r</span>
<a name="ln-377"></a>        <span class="k">end if</span>
<a name="ln-378"></a><span class="k">    else</span>
<a name="ln-379"></a>        <span class="c">!No Coulombic cutoff</span>
<a name="ln-380"></a>        <span class="n">enrg</span> <span class="o">=</span> <span class="n">ekr</span>
<a name="ln-381"></a>        <span class="n">frc</span> <span class="o">=</span> <span class="o">-</span><span class="n">ekr</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">kappa</span><span class="o">*</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="n">r</span>
<a name="ln-382"></a>    <span class="k">end if</span>
<a name="ln-383"></a>
<a name="ln-384"></a><span class="k">    if</span> <span class="p">(</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">rcut</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-385"></a><span class="k">        </span><span class="n">sir</span> <span class="o">=</span> <span class="n">sigma</span><span class="o">/</span><span class="n">r</span>
<a name="ln-386"></a>        <span class="n">sir2</span> <span class="o">=</span> <span class="n">sir</span><span class="o">*</span><span class="n">sir</span><span class="p">;</span> <span class="n">sir6</span> <span class="o">=</span> <span class="n">sir2</span><span class="o">*</span><span class="n">sir2</span><span class="o">*</span><span class="n">sir2</span><span class="p">;</span> <span class="n">sir12</span> <span class="o">=</span> <span class="n">sir6</span><span class="o">*</span><span class="n">sir6</span>
<a name="ln-387"></a>        <span class="n">enrg</span> <span class="o">=</span> <span class="n">enrg</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">eps</span><span class="o">*</span><span class="p">(</span><span class="n">sir12</span> <span class="o">-</span> <span class="n">sir6</span><span class="p">)</span> <span class="o">-</span> <span class="n">pot_rcut</span>
<a name="ln-388"></a>        <span class="n">frc</span> <span class="o">=</span> <span class="n">frc</span> <span class="o">-</span> <span class="mi">24</span><span class="o">*</span><span class="n">eps</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sir12</span> <span class="o">-</span> <span class="n">sir6</span><span class="p">)</span><span class="o">/</span><span class="n">r</span>
<a name="ln-389"></a>    <span class="k">end if</span>
<a name="ln-390"></a>
<a name="ln-391"></a><span class="k">    end subroutine</span>
<a name="ln-392"></a>
<a name="ln-393"></a><span class="c">!******************************************************************************</span>
<a name="ln-394"></a>
<a name="ln-395"></a><span class="k">subroutine </span><span class="n">vdw_lj_coul_set</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">rcut</span><span class="p">,</span> <span class="n">rcut_coul</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
<a name="ln-396"></a>    <span class="c">!! Setter for 12-6 LJ with Coulombic interaction.</span>
<a name="ln-397"></a>    <span class="c">!!</span>
<a name="ln-398"></a>    <span class="c">!!```</span>
<a name="ln-399"></a>    <span class="c">!! V = 4*eps*[(r/sigma)^12 - (r/sigma)^6]</span>
<a name="ln-400"></a>    <span class="c">!! W = C*qi*qj/r</span>
<a name="ln-401"></a>    <span class="c">!! if rcut_coul &gt; 0:</span>
<a name="ln-402"></a>    <span class="c">!!     U = V - V(rcut) + W - W(rcut_coul), r &lt; rcut</span>
<a name="ln-403"></a>    <span class="c">!!         W - W(rcut_coul), rcut &lt;= r &lt; rcut_coul</span>
<a name="ln-404"></a>    <span class="c">!!         0, r &gt;= rcut_coul</span>
<a name="ln-405"></a>    <span class="c">!! if rcut_coul &lt;= 0:</span>
<a name="ln-406"></a>    <span class="c">!!     U = V - V(rcut) + W, r &lt; rcut</span>
<a name="ln-407"></a>    <span class="c">!!         W, r &gt;= rcut</span>
<a name="ln-408"></a>    <span class="c">!!```</span>
<a name="ln-409"></a>    <span class="c">!! - The LJ potential `V` is cut &amp; shifted at `r = rcut`.</span>
<a name="ln-410"></a>    <span class="c">!! - If `rcut_coul &gt; 0`, the Coulombic potential `W` is cut &amp; shifted at `r = rcut_coul`.</span>
<a name="ln-411"></a>    <span class="c">!! - If `rcut_coul &lt;= 0`, no cutoff is applied on `W`.</span>
<a name="ln-412"></a>    <span class="c">!! - `rcut_coul` must be &gt;= `rcut`.</span>
<a name="ln-413"></a>    <span class="c">!!</span>
<a name="ln-414"></a>    <span class="c">!! User-set parameters:</span>
<a name="ln-415"></a>    <span class="c">!!</span>
<a name="ln-416"></a>    <span class="c">!! * params(1) = `eps`</span>
<a name="ln-417"></a>    <span class="c">!! * params(2) = `sigma`</span>
<a name="ln-418"></a>    <span class="c">!! * params(3) = `rcut`</span>
<a name="ln-419"></a>    <span class="c">!! * params(4) = `rcut_coul`</span>
<a name="ln-420"></a>    <span class="c">!! * params(5) = `C`</span>
<a name="ln-421"></a>    <span class="c">!!</span>
<a name="ln-422"></a>    <span class="c">!! Internally stored parameters:</span>
<a name="ln-423"></a>    <span class="c">!!</span>
<a name="ln-424"></a>    <span class="c">!! * params(6) = `V(rcut)`</span>
<a name="ln-425"></a>    <span class="c">!! * params(7) = `V(rcut)`</span>
<a name="ln-426"></a>    <span class="c">!! * params(8) = `C/rcut_coul`</span>
<a name="ln-427"></a>
<a name="ln-428"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">params</span>
<a name="ln-429"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">eps</span>
<a name="ln-430"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">sigma</span>
<a name="ln-431"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">rcut</span>
<a name="ln-432"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">rcut_coul</span>
<a name="ln-433"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">C</span>
<a name="ln-434"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">eps_</span><span class="p">,</span> <span class="n">sigma_</span><span class="p">,</span> <span class="n">rcut_</span><span class="p">,</span> <span class="n">rcut_coul_</span><span class="p">,</span> <span class="n">C_</span>
<a name="ln-435"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pot_rcut</span><span class="p">,</span> <span class="n">pot_rcut_coul</span>
<a name="ln-436"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sir</span><span class="p">,</span> <span class="n">sir2</span><span class="p">,</span> <span class="n">sir6</span><span class="p">,</span> <span class="n">sir12</span>
<a name="ln-437"></a>
<a name="ln-438"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">eps</span><span class="p">))</span> <span class="n">params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">eps</span>
<a name="ln-439"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">sigma</span><span class="p">))</span> <span class="n">params</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">sigma</span>
<a name="ln-440"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">rcut</span><span class="p">))</span> <span class="n">params</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">rcut</span>
<a name="ln-441"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">rcut_coul</span><span class="p">))</span> <span class="n">params</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">rcut_coul</span>
<a name="ln-442"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">C</span><span class="p">))</span> <span class="n">params</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">C</span>
<a name="ln-443"></a>
<a name="ln-444"></a>    <span class="n">eps_</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">sigma_</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">rcut_</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-445"></a>    <span class="n">rcut_coul_</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span> <span class="n">C_</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-446"></a>
<a name="ln-447"></a>    <span class="n">sir</span> <span class="o">=</span> <span class="n">sigma_</span><span class="o">/</span><span class="n">rcut_</span>
<a name="ln-448"></a>    <span class="n">sir2</span> <span class="o">=</span> <span class="n">sir</span><span class="o">*</span><span class="n">sir</span><span class="p">;</span> <span class="n">sir6</span> <span class="o">=</span> <span class="n">sir2</span><span class="o">*</span><span class="n">sir2</span><span class="o">*</span><span class="n">sir2</span><span class="p">;</span> <span class="n">sir12</span> <span class="o">=</span> <span class="n">sir6</span><span class="o">*</span><span class="n">sir6</span>
<a name="ln-449"></a>    <span class="n">pot_rcut</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">eps_</span><span class="o">*</span><span class="p">(</span><span class="n">sir12</span> <span class="o">-</span> <span class="n">sir6</span><span class="p">)</span>
<a name="ln-450"></a>
<a name="ln-451"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">rcut_coul_</span> <span class="o">&gt;</span> <span class="mf">0.0_rp</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-452"></a><span class="k">        </span><span class="n">pot_rcut_coul</span> <span class="o">=</span> <span class="n">C_</span><span class="o">/</span><span class="n">rcut_coul_</span>
<a name="ln-453"></a>    <span class="k">else</span>
<a name="ln-454"></a><span class="k">        </span><span class="n">pot_rcut_coul</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-455"></a>    <span class="k">end if</span>
<a name="ln-456"></a>
<a name="ln-457"></a><span class="k">    </span><span class="n">params</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">pot_rcut</span>
<a name="ln-458"></a>    <span class="n">params</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="n">pot_rcut_coul</span>
<a name="ln-459"></a>
<a name="ln-460"></a>    <span class="k">end subroutine</span>
<a name="ln-461"></a>
<a name="ln-462"></a><span class="c">!******************************************************************************</span>
<a name="ln-463"></a>
<a name="ln-464"></a><span class="k">pure subroutine </span><span class="n">vdw_lj_coul</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">qiqj</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">enrg</span><span class="p">,</span> <span class="n">frc</span><span class="p">)</span>
<a name="ln-465"></a>    <span class="c">!! Evaluates the potential and its derivative for Coulombic interaction</span>
<a name="ln-466"></a>    <span class="c">!! combined with 12-6 LJ (cut &amp; shifted). See [[vdw_lj_coul_set]].</span>
<a name="ln-467"></a>
<a name="ln-468"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">r</span>
<a name="ln-469"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">qiqj</span>
<a name="ln-470"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">params</span>
<a name="ln-471"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">enrg</span>
<a name="ln-472"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">frc</span>
<a name="ln-473"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">eps</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">rcut</span><span class="p">,</span> <span class="n">rcut_coul</span><span class="p">,</span> <span class="n">C</span>
<a name="ln-474"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pot_rcut</span><span class="p">,</span> <span class="n">pot_rcut_coul</span>
<a name="ln-475"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sir</span><span class="p">,</span> <span class="n">sir2</span><span class="p">,</span> <span class="n">sir6</span><span class="p">,</span> <span class="n">sir12</span><span class="p">,</span> <span class="n">ekr</span>
<a name="ln-476"></a>
<a name="ln-477"></a>    <span class="n">enrg</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">frc</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-478"></a>
<a name="ln-479"></a>    <span class="n">eps</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">rcut</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-480"></a>    <span class="n">rcut_coul</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span> <span class="n">C</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-481"></a>    <span class="n">pot_rcut</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span> <span class="n">pot_rcut_coul</span> <span class="o">=</span> <span class="n">params</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-482"></a>
<a name="ln-483"></a>    <span class="n">ekr</span> <span class="o">=</span> <span class="n">C</span><span class="o">*</span><span class="n">qiqj</span><span class="o">/</span><span class="n">r</span>
<a name="ln-484"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">rcut_coul</span> <span class="o">&gt;</span> <span class="mf">0.0_rp</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-485"></a>        <span class="c">!Coulombic cutoff at rcut_coul</span>
<a name="ln-486"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">rcut_coul</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-487"></a><span class="k">            </span><span class="n">enrg</span> <span class="o">=</span> <span class="n">ekr</span> <span class="o">-</span> <span class="n">qiqj</span><span class="o">*</span><span class="n">pot_rcut_coul</span>
<a name="ln-488"></a>            <span class="n">frc</span> <span class="o">=</span> <span class="o">-</span><span class="n">ekr</span><span class="o">/</span><span class="n">r</span>
<a name="ln-489"></a>        <span class="k">end if</span>
<a name="ln-490"></a><span class="k">    else</span>
<a name="ln-491"></a>        <span class="c">!No Coulombic cutoff</span>
<a name="ln-492"></a>        <span class="n">enrg</span> <span class="o">=</span> <span class="n">ekr</span>
<a name="ln-493"></a>        <span class="n">frc</span> <span class="o">=</span> <span class="o">-</span><span class="n">ekr</span><span class="o">/</span><span class="n">r</span>
<a name="ln-494"></a>    <span class="k">end if</span>
<a name="ln-495"></a>
<a name="ln-496"></a><span class="k">    if</span> <span class="p">(</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">rcut</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-497"></a><span class="k">        </span><span class="n">sir</span> <span class="o">=</span> <span class="n">sigma</span><span class="o">/</span><span class="n">r</span>
<a name="ln-498"></a>        <span class="n">sir2</span> <span class="o">=</span> <span class="n">sir</span><span class="o">*</span><span class="n">sir</span><span class="p">;</span> <span class="n">sir6</span> <span class="o">=</span> <span class="n">sir2</span><span class="o">*</span><span class="n">sir2</span><span class="o">*</span><span class="n">sir2</span><span class="p">;</span> <span class="n">sir12</span> <span class="o">=</span> <span class="n">sir6</span><span class="o">*</span><span class="n">sir6</span>
<a name="ln-499"></a>        <span class="n">enrg</span> <span class="o">=</span> <span class="n">enrg</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">eps</span><span class="o">*</span><span class="p">(</span><span class="n">sir12</span> <span class="o">-</span> <span class="n">sir6</span><span class="p">)</span> <span class="o">-</span> <span class="n">pot_rcut</span>
<a name="ln-500"></a>        <span class="n">frc</span> <span class="o">=</span> <span class="n">frc</span> <span class="o">-</span> <span class="mi">24</span><span class="o">*</span><span class="n">eps</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sir12</span> <span class="o">-</span> <span class="n">sir6</span><span class="p">)</span><span class="o">/</span><span class="n">r</span>
<a name="ln-501"></a>    <span class="k">end if</span>
<a name="ln-502"></a>
<a name="ln-503"></a><span class="k">    end subroutine</span>
<a name="ln-504"></a>
<a name="ln-505"></a><span class="c">!******************************************************************************</span>
<a name="ln-506"></a>
<a name="ln-507"></a><span class="k">end module </span><span class="n">m_ia_vdw</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> BROWNPAK was developed by Sarit Dutta</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>