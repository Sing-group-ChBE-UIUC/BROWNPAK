<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for BROWNPAK">
   
    <meta name="author" content="Sarit Dutta" >
    <link rel="icon" href="../favicon.png">

    <title>m_stats_io.f90 &ndash; BROWNPAK</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">BROWNPAK <small>0.2</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>m_stats_io.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 5.8% of total for source files.">355 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/m_stats_io.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">m_stats_io.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_stats_io.html">m_stats_io</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_stats_io.f90.html#src">m_stats_io.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_stats_io.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilem_stats_iof90EfferentGraph" width="605pt" height="245pt"
 viewBox="0.00 0.00 605.00 244.70" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_stats_io.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 240.7034)">
<title>sourcefile~~m_stats_io.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-240.7034 601,-240.7034 601,4 -4,4"/>
<!-- sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_stats_io.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~m_stats_io.f90</title>
<polygon fill="none" stroke="#000000" points="597,-186.7694 516,-186.7694 516,-162.7694 597,-162.7694 597,-186.7694"/>
<text text-anchor="middle" x="556.5" y="-172.3694" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_stats_io.f90</text>
</g>
<!-- sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_stats_io.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~m_constants_math.f90</title>
<g id="a_sourcefile~~m_stats_io.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/m_constants_math.f90.html" xlink:title="m_constants_math.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="242,-168.7694 123,-168.7694 123,-144.7694 242,-144.7694 242,-168.7694"/>
<text text-anchor="middle" x="182.5" y="-154.3694" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_constants_math.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_stats_io.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M515.7635,-172.8089C452.5294,-169.7655 329.9726,-163.8671 252.4017,-160.1337"/>
<polygon fill="#ff0000" stroke="#ff0000" points="252.3915,-156.6292 242.2348,-159.6444 252.055,-163.6212 252.3915,-156.6292"/>
</g>
<!-- sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_stats_io.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~m_precision.f90</title>
<g id="a_sourcefile~~m_stats_io.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/m_precision.f90.html" xlink:title="m_precision.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="87,-126.7694 0,-126.7694 0,-102.7694 87,-102.7694 87,-126.7694"/>
<text text-anchor="middle" x="43.5" y="-112.3694" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_precision.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_stats_io.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M538.4968,-186.9186C523.512,-196.4006 501.2664,-209.0548 480,-215.7694 412.5539,-237.0649 392.7041,-236.6137 322,-234.7694"/>
</g>
<!-- sourcefile~m_strings.f90 -->
<g id="sourcefile~~m_stats_io.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~m_strings.f90</title>
<g id="a_sourcefile~~m_stats_io.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/m_strings.f90.html" xlink:title="m_strings.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="479,-206.7694 403,-206.7694 403,-182.7694 479,-182.7694 479,-206.7694"/>
<text text-anchor="middle" x="441" y="-192.3694" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_strings.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_strings.f90 -->
<g id="sourcefile~~m_stats_io.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_strings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M515.779,-181.8207C507.0963,-183.3242 497.8497,-184.9253 488.9255,-186.4707"/>
<polygon fill="#ff0000" stroke="#ff0000" points="488.2902,-183.0285 479.034,-188.1835 489.4846,-189.9258 488.2902,-183.0285"/>
</g>
<!-- sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_stats_io.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~m_globals.f90</title>
<g id="a_sourcefile~~m_stats_io.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/m_globals.f90.html" xlink:title="m_globals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480,-106.7694 402,-106.7694 402,-82.7694 480,-82.7694 480,-106.7694"/>
<text text-anchor="middle" x="441" y="-92.3694" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_globals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_stats_io.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M538.958,-162.6192C519.6818,-149.2677 488.5406,-127.698 466.5521,-112.4679"/>
<polygon fill="#ff0000" stroke="#ff0000" points="468.5422,-109.5887 458.3286,-106.7719 464.5564,-115.3432 468.5422,-109.5887"/>
</g>
<!-- sourcefile~m_constants_math.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_stats_io.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~m_constants_math.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M142.6682,-144.7339C127.2553,-140.0768 109.4459,-134.6955 93.2089,-129.7894"/>
<polygon fill="#ff0000" stroke="#ff0000" points="93.9226,-126.3488 83.3376,-126.8067 91.8978,-133.0496 93.9226,-126.3488"/>
</g>
<!-- sourcefile~m_strings.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_stats_io.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~m_strings.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M416.6741,-206.8122C393.1322,-217.524 356.1006,-231.9238 322,-234.7694"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M322,-234.7694C230.3176,-242.4202 204.8351,-219.8076 123,-177.7694 100.6634,-166.2953 78.5447,-148.0573 63.3312,-134.1505"/>
<polygon fill="#00ffff" stroke="#00ffff" points="65.3237,-131.2213 55.6321,-126.9405 60.5389,-136.3306 65.3237,-131.2213"/>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_stats_io.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M182.5,-74.7694C147.4707,-77.1868 109.2386,-88.8969 81.7531,-99.0272"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="80.2514,-95.8532 72.1389,-102.6678 82.7303,-102.3996 80.2514,-95.8532"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M401.6,-88.135C350.927,-80.4267 260.187,-69.4083 182.5,-74.7694"/>
</g>
<!-- sourcefile~m_trajectory.f90 -->
<g id="sourcefile~~m_stats_io.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~m_trajectory.f90</title>
<g id="a_sourcefile~~m_stats_io.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/m_trajectory.f90.html" xlink:title="m_trajectory.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-46.7694 278,-46.7694 278,-22.7694 366,-22.7694 366,-46.7694"/>
<text text-anchor="middle" x="322" y="-32.3694" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_trajectory.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_trajectory.f90 -->
<g id="sourcefile~~m_stats_io.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_trajectory.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M416.9186,-82.6275C399.1759,-73.6817 374.8269,-61.4049 355.2328,-51.5255"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="356.5506,-48.2702 346.0456,-46.8933 353.3991,-54.5207 356.5506,-48.2702"/>
</g>
<!-- sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_stats_io.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~m_simbox.f90</title>
<g id="a_sourcefile~~m_stats_io.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/m_simbox.f90.html" xlink:title="m_simbox.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="361,-126.7694 283,-126.7694 283,-102.7694 361,-102.7694 361,-126.7694"/>
<text text-anchor="middle" x="322" y="-112.3694" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_simbox.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_stats_io.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_simbox.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M401.7052,-101.3736C391.9564,-103.0121 381.3866,-104.7885 371.2286,-106.4957"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="370.5352,-103.0631 361.2536,-108.1722 371.6954,-109.9663 370.5352,-103.0631"/>
</g>
<!-- sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_stats_io.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M293.6663,-22.7145C253.5257,-7.5811 178.7848,13.3138 123,-13.7694 89.1245,-30.2158 65.3649,-68.8663 53.1044,-93.3016"/>
<polygon fill="#ff0000" stroke="#ff0000" points="49.863,-91.9665 48.6951,-102.4967 56.1749,-94.9932 49.863,-91.9665"/>
</g>
<!-- sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_stats_io.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~m_logger.f90</title>
<g id="a_sourcefile~~m_stats_io.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/m_logger.f90.html" xlink:title="m_logger.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="219.5,-46.7694 145.5,-46.7694 145.5,-22.7694 219.5,-22.7694 219.5,-46.7694"/>
<text text-anchor="middle" x="182.5" y="-32.3694" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_logger.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_stats_io.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_logger.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M277.8613,-34.7694C262.6851,-34.7694 245.6303,-34.7694 230.1848,-34.7694"/>
<polygon fill="#ff0000" stroke="#ff0000" points="229.7918,-31.2695 219.7918,-34.7694 229.7917,-38.2695 229.7918,-31.2695"/>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_stats_io.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M282.7702,-126.5806C267.0066,-131.3266 248.6524,-136.8526 231.9878,-141.8699"/>
<polygon fill="#00ffff" stroke="#00ffff" points="230.97,-138.5211 222.4036,-144.7555 232.9881,-145.2239 230.97,-138.5211"/>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_stats_io.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M298.3615,-102.5769C271.0505,-89.7774 224.4753,-71.8728 182.5,-74.7694"/>
</g>
<!-- sourcefile~m_ran_num.f90 -->
<g id="sourcefile~~m_stats_io.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~m_ran_num.f90</title>
<g id="a_sourcefile~~m_stats_io.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/m_ran_num.f90.html" xlink:title="m_ran_num.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="225.5,-126.7694 139.5,-126.7694 139.5,-102.7694 225.5,-102.7694 225.5,-126.7694"/>
<text text-anchor="middle" x="182.5" y="-112.3694" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ran_num.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_ran_num.f90 -->
<g id="sourcefile~~m_stats_io.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_ran_num.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M282.7702,-114.7694C268.2268,-114.7694 251.4782,-114.7694 235.8858,-114.7694"/>
<polygon fill="#00ffff" stroke="#00ffff" points="235.8412,-111.2695 225.8412,-114.7694 235.8412,-118.2695 235.8412,-111.2695"/>
</g>
<!-- sourcefile~m_ran_num.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_stats_io.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~m_ran_num.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M139.2815,-114.7694C126.0721,-114.7694 111.3772,-114.7694 97.543,-114.7694"/>
<polygon fill="#ff0000" stroke="#ff0000" points="97.1706,-111.2695 87.1705,-114.7694 97.1705,-118.2695 97.1706,-111.2695"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_stats_io.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilem_stats_iof90AfferentGraph" width="411pt" height="152pt"
 viewBox="0.00 0.00 411.00 152.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_stats_io.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 148)">
<title>sourcefile~~m_stats_io.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-148 407,-148 407,4 -4,4"/>
<!-- sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_stats_io.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~m_stats_io.f90</title>
<polygon fill="none" stroke="#000000" points="81,-84 0,-84 0,-60 81,-60 81,-84"/>
<text text-anchor="middle" x="40.5" y="-69.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_stats_io.f90</text>
</g>
<!-- sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_stats_io.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~m_mpcd.f90</title>
<g id="a_sourcefile~~m_stats_io.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/m_mpcd.f90.html" xlink:title="m_mpcd.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="197,-144 127,-144 127,-120 197,-120 197,-144"/>
<text text-anchor="middle" x="162" y="-129.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_mpcd.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_stats_io.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_stats_io.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M137.4127,-119.8581C119.2149,-110.8716 94.2106,-98.5237 74.1585,-88.6215"/>
<polygon fill="#ff0000" stroke="#ff0000" points="75.5668,-85.4135 65.0508,-84.1238 72.4673,-91.6899 75.5668,-85.4135"/>
</g>
<!-- sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_stats_io.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~m_setup.f90</title>
<g id="a_sourcefile~~m_stats_io.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/m_setup.f90.html" xlink:title="m_setup.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="313,-104 243,-104 243,-80 313,-80 313,-104"/>
<text text-anchor="middle" x="278" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_setup.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_stats_io.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_stats_io.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M242.9561,-89.0489C202.8895,-85.6749 136.9558,-80.1226 91.2675,-76.2752"/>
<polygon fill="#ff0000" stroke="#ff0000" points="91.5271,-72.7847 81.2686,-75.4331 90.9396,-79.76 91.5271,-72.7847"/>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_stats_io.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_mpcd.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M243.1962,-104.0013C231.7166,-107.9598 218.7856,-112.4187 206.6742,-116.5951"/>
<polygon fill="#ff0000" stroke="#ff0000" points="205.4929,-113.3001 197.1802,-119.8689 207.7749,-119.9177 205.4929,-113.3001"/>
</g>
<!-- sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_stats_io.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~m_bd_solver.f90</title>
<g id="a_sourcefile~~m_stats_io.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/m_bd_solver.f90.html" xlink:title="m_bd_solver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="207,-64 117,-64 117,-40 207,-40 207,-64"/>
<text text-anchor="middle" x="162" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_bd_solver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_stats_io.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_bd_solver.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M243.1962,-79.9987C231.7166,-76.0402 218.7856,-71.5813 206.6742,-67.4049"/>
<polygon fill="#00ffff" stroke="#00ffff" points="207.7749,-64.0823 197.1802,-64.1311 205.4929,-70.6999 207.7749,-64.0823"/>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_stats_io.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_stats_io.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M116.7579,-59.4473C108.5077,-60.8053 99.8485,-62.2307 91.4464,-63.6138"/>
<polygon fill="#ff0000" stroke="#ff0000" points="90.6685,-60.1946 81.3698,-65.2725 91.8055,-67.1017 90.6685,-60.1946"/>
</g>
<!-- sourcefile~m_relax.f90 -->
<g id="sourcefile~~m_stats_io.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~m_relax.f90</title>
<g id="a_sourcefile~~m_stats_io.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/m_relax.f90.html" xlink:title="m_relax.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="311.5,-24 244.5,-24 244.5,0 311.5,0 311.5,-24"/>
<text text-anchor="middle" x="278" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_relax.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_relax.f90&#45;&gt;sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_stats_io.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~m_relax.f90&#45;&gt;sourcefile~m_stats_io.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M244.2463,-12.3442C211.132,-13.5213 159.5551,-17.6153 117,-31 99.5488,-36.4889 81.4445,-45.9928 67.2314,-54.4691"/>
<polygon fill="#ff0000" stroke="#ff0000" points="65.1845,-51.6189 58.4992,-59.8382 68.851,-57.5818 65.1845,-51.6189"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~m_stats_io.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~m_stats_io.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="403,-84 349,-84 349,-60 403,-60 403,-84"/>
<text text-anchor="middle" x="376" y="-69.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_stats_io.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_mpcd.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M361.506,-84.1882C349.3584,-93.6927 331.1357,-106.3583 313,-113 279.0435,-125.4356 238.2358,-130.0051 207.608,-131.5649"/>
<polygon fill="#ff0000" stroke="#ff0000" points="207.0721,-128.0842 197.2271,-131.9991 207.3646,-135.0781 207.0721,-128.0842"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_stats_io.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M348.9616,-77.518C340.8936,-79.1646 331.824,-81.0155 322.9341,-82.8298"/>
<polygon fill="#7fff00" stroke="#7fff00" points="322.1346,-79.4207 313.0365,-84.8497 323.5344,-86.2793 322.1346,-79.4207"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_stats_io.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_bd_solver.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M348.8968,-69.467C315.9597,-66.3888 259.556,-61.1174 217.3063,-57.1688"/>
<polygon fill="#00ffff" stroke="#00ffff" points="217.4476,-53.6669 207.1653,-56.2211 216.7962,-60.6365 217.4476,-53.6669"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_relax.f90 -->
<g id="sourcefile~~m_stats_io.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_relax.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M356.1682,-59.8581C341.9552,-51.1562 322.5942,-39.3026 306.697,-29.5696"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="308.1584,-26.3604 297.8023,-24.1238 304.5032,-32.3304 308.1584,-26.3604"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_stats_io.html">m_stats_io</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_stats_io.f90.html#src">m_stats_io.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">module </span><span class="n">m_stats_io</span>
<a name="ln-2"></a>    <span class="c">!! Computes and writes properties calculated during simulation.</span>
<a name="ln-3"></a>
<a name="ln-4"></a><span class="k">use </span><span class="n">m_precision</span>
<a name="ln-5"></a><span class="k">use </span><span class="n">m_constants_math</span>
<a name="ln-6"></a><span class="k">use </span><span class="n">m_strings</span>
<a name="ln-7"></a><span class="k">use </span><span class="n">m_globals</span>
<a name="ln-8"></a>
<a name="ln-9"></a><span class="k">implicit none</span>
<a name="ln-10"></a>
<a name="ln-11"></a><span class="k">private</span>
<a name="ln-12"></a>
<a name="ln-13"></a><span class="k">public</span> <span class="kd">::</span> <span class="n">stats_init</span><span class="p">,</span> <span class="n">stats_finish</span><span class="p">,</span> <span class="n">stats_write</span>
<a name="ln-14"></a>
<a name="ln-15"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">fu_stats</span>
<a name="ln-16"></a>    <span class="c">!! Unit number of file `fn_stats`.</span>
<a name="ln-17"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">span</span>
<a name="ln-18"></a>    <span class="c">!! Span of a chain molecule. For multiple molecules this is averaged.</span>
<a name="ln-19"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">reedsq</span>
<a name="ln-20"></a>    <span class="c">!! Mean squared end-to-end distance of a linear chain molecule.</span>
<a name="ln-21"></a>    <span class="c">!! For multiple molecules this is averaged. Not defined for rings.</span>
<a name="ln-22"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rgsq</span>
<a name="ln-23"></a>    <span class="c">!! Mean squared gyration radius of a chain/ring molecule.</span>
<a name="ln-24"></a>    <span class="c">!! For multiple molecules this is averaged.</span>
<a name="ln-25"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">reev</span>
<a name="ln-26"></a>    <span class="c">!! End-to-end vector. Not defined for rings.</span>
<a name="ln-27"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">asph</span>
<a name="ln-28"></a>    <span class="c">!! Asphericity of the entire molecule</span>
<a name="ln-29"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">prol</span>
<a name="ln-30"></a>    <span class="c">!! Prolateness of the entire molecule</span>
<a name="ln-31"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rgsq_bbone</span>
<a name="ln-32"></a>    <span class="c">!! Mean squared gyration radius of the backbone of a branched</span>
<a name="ln-33"></a>    <span class="c">!! chain/ring molecule.</span>
<a name="ln-34"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rgsq_sc</span>
<a name="ln-35"></a>    <span class="c">!! Mean squared gyration radius of the side chains of a branched</span>
<a name="ln-36"></a>    <span class="c">!! chain/ring molecule.</span>
<a name="ln-37"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">reedsq_sc</span>
<a name="ln-38"></a>    <span class="c">!! Mean squared end-to-end distance of the side chains of a branched</span>
<a name="ln-39"></a>    <span class="c">!! chain/ring molecule.</span>
<a name="ln-40"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">asph_sc</span>
<a name="ln-41"></a>    <span class="c">!! Mean asphericity of the side chains of a branched chain/ring molecule.</span>
<a name="ln-42"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">prol_sc</span>
<a name="ln-43"></a>    <span class="c">!! Mean prolateness of the side chains of a branched chain/ring molecule.</span>
<a name="ln-44"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">molbuf</span>
<a name="ln-45"></a>    <span class="c">!! Buffer for the largest molecule in the system</span>
<a name="ln-46"></a>
<a name="ln-47"></a><span class="k">contains</span>
<a name="ln-48"></a>
<a name="ln-49"></a><span class="c">!******************************************************************************</span>
<a name="ln-50"></a>
<a name="ln-51"></a><span class="k">subroutine </span><span class="n">stats_init</span><span class="p">()</span>
<a name="ln-52"></a>    <span class="c">!! Set up for stats collection</span>
<a name="ln-53"></a>
<a name="ln-54"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lexists</span>
<a name="ln-55"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span>
<a name="ln-56"></a>
<a name="ln-57"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">lrevive</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-58"></a>        <span class="c">!Restarting simulation</span>
<a name="ln-59"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">leql</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-60"></a>            <span class="c">!Equilibration</span>
<a name="ln-61"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">write_eql_stats</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-62"></a>                <span class="c">!Check if file exists</span>
<a name="ln-63"></a>                <span class="k">inquire</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="n">fn_stats</span><span class="o">//</span><span class="s1">&#39;.eq&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="n">exist</span><span class="o">=</span><span class="n">lexists</span><span class="p">)</span>
<a name="ln-64"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">lexists</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-65"></a>                    <span class="c">!Open existing file for appending equilibration statistics</span>
<a name="ln-66"></a>                    <span class="k">open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">fu_stats</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">fn_stats</span><span class="o">//</span><span class="s1">&#39;.eq&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-67"></a>                        <span class="n">action</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;append&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;old&#39;</span><span class="p">)</span>
<a name="ln-68"></a>                <span class="k">else</span>
<a name="ln-69"></a>                    <span class="c">!Open new file for writing equilibration statistics</span>
<a name="ln-70"></a>                    <span class="k">open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">fu_stats</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">fn_stats</span><span class="o">//</span><span class="s1">&#39;.eq&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-71"></a>                        <span class="n">action</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;new&#39;</span><span class="p">)</span>
<a name="ln-72"></a>                    <span class="c">!Write header</span>
<a name="ln-73"></a>                    <span class="k">call </span><span class="n">stats_write_hdr</span><span class="p">()</span>
<a name="ln-74"></a>                <span class="k">end if</span>
<a name="ln-75"></a><span class="k">            end if</span>
<a name="ln-76"></a><span class="k">        else</span>
<a name="ln-77"></a>            <span class="c">!Production (or relaxation)</span>
<a name="ln-78"></a>            <span class="c">!Check if file exists</span>
<a name="ln-79"></a>            <span class="k">inquire</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="n">fn_stats</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="n">exist</span><span class="o">=</span><span class="n">lexists</span><span class="p">)</span>
<a name="ln-80"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">lexists</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-81"></a>                <span class="c">!Open existing file for appending statistics</span>
<a name="ln-82"></a>                <span class="k">open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">fu_stats</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">fn_stats</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-83"></a>                    <span class="n">action</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;append&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;old&#39;</span><span class="p">)</span>
<a name="ln-84"></a>            <span class="k">else</span>
<a name="ln-85"></a>                <span class="c">!Open new file for writing statistics</span>
<a name="ln-86"></a>                <span class="k">open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">fu_stats</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">fn_stats</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-87"></a>                    <span class="n">action</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;new&#39;</span><span class="p">)</span>
<a name="ln-88"></a>                <span class="c">!Write header</span>
<a name="ln-89"></a>                <span class="k">call </span><span class="n">stats_write_hdr</span><span class="p">()</span>
<a name="ln-90"></a>            <span class="k">end if</span>
<a name="ln-91"></a><span class="k">        end if</span>
<a name="ln-92"></a><span class="k">    else</span>
<a name="ln-93"></a>        <span class="c">!New simulation</span>
<a name="ln-94"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">leql</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-95"></a>            <span class="c">!Open file for writing equilibration statistics</span>
<a name="ln-96"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">write_eql_stats</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-97"></a><span class="k">                open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">fu_stats</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">fn_stats</span><span class="o">//</span><span class="s1">&#39;.eq&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-98"></a>                    <span class="n">action</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">)</span>
<a name="ln-99"></a>            <span class="k">end if</span>
<a name="ln-100"></a><span class="k">        else</span>
<a name="ln-101"></a>            <span class="c">!Open file for writing production (or relaxation) statistics</span>
<a name="ln-102"></a>            <span class="k">open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">fu_stats</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">fn_stats</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-103"></a>                <span class="n">action</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">)</span>
<a name="ln-104"></a>        <span class="k">end if</span>
<a name="ln-105"></a>        <span class="c">!Write header</span>
<a name="ln-106"></a>        <span class="k">call </span><span class="n">stats_write_hdr</span><span class="p">()</span>
<a name="ln-107"></a>    <span class="k">end if</span>
<a name="ln-108"></a>
<a name="ln-109"></a>    <span class="c">!Allocate space for unwrapping molecule under PBC</span>
<a name="ln-110"></a>    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">imcon</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">num_molecules</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-111"></a><span class="k">        </span><span class="n">n</span> <span class="o">=</span> <span class="nb">maxval</span><span class="p">(</span><span class="n">molecules</span><span class="p">(</span><span class="mi">2</span><span class="p">,:))</span>
<a name="ln-112"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">allocate</span><span class="p">(</span> <span class="n">molbuf</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">n</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-113"></a>    <span class="k">end if</span>
<a name="ln-114"></a>
<a name="ln-115"></a><span class="k">    end subroutine</span>
<a name="ln-116"></a>
<a name="ln-117"></a><span class="c">!******************************************************************************</span>
<a name="ln-118"></a>
<a name="ln-119"></a><span class="k">subroutine </span><span class="n">stats_finish</span><span class="p">()</span>
<a name="ln-120"></a>    <span class="c">!! Closes any files opened in `stats_init`.</span>
<a name="ln-121"></a>
<a name="ln-122"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">fu</span>
<a name="ln-123"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lopened</span>
<a name="ln-124"></a>
<a name="ln-125"></a>    <span class="k">inquire</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="n">fn_stats</span><span class="o">//</span><span class="s1">&#39;.eq&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="n">number</span><span class="o">=</span><span class="n">fu</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-126"></a>        <span class="n">opened</span><span class="o">=</span><span class="n">lopened</span><span class="p">)</span>
<a name="ln-127"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">lopened</span><span class="p">)</span> <span class="k">close</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span>
<a name="ln-128"></a>
<a name="ln-129"></a>    <span class="k">inquire</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="n">fn_stats</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="n">number</span><span class="o">=</span><span class="n">fu</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-130"></a>        <span class="n">opened</span><span class="o">=</span><span class="n">lopened</span><span class="p">)</span>
<a name="ln-131"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">lopened</span><span class="p">)</span> <span class="k">close</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span>
<a name="ln-132"></a>
<a name="ln-133"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">molbuf</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">molbuf</span><span class="p">)</span>
<a name="ln-134"></a>
<a name="ln-135"></a>    <span class="k">end subroutine</span>
<a name="ln-136"></a>
<a name="ln-137"></a><span class="c">!******************************************************************************</span>
<a name="ln-138"></a>
<a name="ln-139"></a><span class="k">subroutine </span><span class="n">stats_write_hdr</span><span class="p">()</span>
<a name="ln-140"></a>    <span class="c">!! Driver for writing header of file `fn_stats`. This is called only after</span>
<a name="ln-141"></a>    <span class="c">!! appropriate files have been opened.</span>
<a name="ln-142"></a>
<a name="ln-143"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(a12)&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="s1">&#39;nts&#39;</span>
<a name="ln-144"></a>
<a name="ln-145"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_bonds</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-146"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(*(2x,a16))&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-147"></a>            <span class="s1">&#39;bndlen_avg&#39;</span><span class="p">,</span> <span class="s1">&#39;bndlen_min&#39;</span><span class="p">,</span> <span class="s1">&#39;bndlen_max&#39;</span><span class="p">,</span> <span class="s1">&#39;energy_bond&#39;</span>
<a name="ln-148"></a>    <span class="k">end if</span>
<a name="ln-149"></a>
<a name="ln-150"></a><span class="k">    if</span> <span class="p">(</span><span class="n">num_angles</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-151"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(2x,a16)&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="s1">&#39;energy_angle&#39;</span>
<a name="ln-152"></a>    <span class="k">end if</span>
<a name="ln-153"></a>
<a name="ln-154"></a><span class="k">    if</span> <span class="p">(</span><span class="n">num_dihedrals</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-155"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(2x,a16)&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="s1">&#39;energy_dihedral&#39;</span>
<a name="ln-156"></a>    <span class="k">end if</span>
<a name="ln-157"></a>
<a name="ln-158"></a><span class="k">    if</span> <span class="p">(</span><span class="n">lvdw</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-159"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(2x,a16)&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="s1">&#39;energy_vdw&#39;</span>
<a name="ln-160"></a>    <span class="k">end if</span>
<a name="ln-161"></a>
<a name="ln-162"></a><span class="k">    if</span> <span class="p">(</span><span class="n">num_tethers</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-163"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(2x,a16)&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="s1">&#39;energy_tether&#39;</span>
<a name="ln-164"></a>    <span class="k">end if</span>
<a name="ln-165"></a>
<a name="ln-166"></a><span class="k">    if</span> <span class="p">(</span><span class="n">num_externals</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-167"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(2x,a16)&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="s1">&#39;energy_external&#39;</span>
<a name="ln-168"></a>    <span class="k">end if</span>
<a name="ln-169"></a>
<a name="ln-170"></a><span class="k">    if</span> <span class="p">(</span><span class="n">sim_style</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-171"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(2x,a16)&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="s1">&#39;energy_kin&#39;</span>
<a name="ln-172"></a>    <span class="k">end if</span>
<a name="ln-173"></a>
<a name="ln-174"></a><span class="k">    write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(2x,a16)&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="s1">&#39;energy_tot&#39;</span>
<a name="ln-175"></a>
<a name="ln-176"></a>    <span class="c">!No further properties will be calculated for structure relaxation</span>
<a name="ln-177"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">sim_style</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-178"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<a name="ln-179"></a>        <span class="k">return</span>
<a name="ln-180"></a><span class="k">    end if</span>
<a name="ln-181"></a>
<a name="ln-182"></a>    <span class="c">!Stress (written only during production run)</span>
<a name="ln-183"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">leql</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-184"></a><span class="k">        if</span> <span class="p">(</span><span class="n">num_atoms</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-185"></a><span class="k">            write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(*(2x,a16))&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="s1">&#39;sxx&#39;</span><span class="p">,</span> <span class="s1">&#39;syx&#39;</span><span class="p">,</span> <span class="s1">&#39;szx&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-186"></a>                <span class="s1">&#39;sxy&#39;</span><span class="p">,</span> <span class="s1">&#39;syy&#39;</span><span class="p">,</span> <span class="s1">&#39;szy&#39;</span><span class="p">,</span> <span class="s1">&#39;sxz&#39;</span><span class="p">,</span> <span class="s1">&#39;syz&#39;</span><span class="p">,</span> <span class="s1">&#39;szz&#39;</span>
<a name="ln-187"></a>        <span class="k">end if</span>
<a name="ln-188"></a><span class="k">        if</span> <span class="p">(</span><span class="n">sim_style</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-189"></a><span class="k">            write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(*(2x,a16))&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="s1">&#39;slv_sxx&#39;</span><span class="p">,</span> <span class="s1">&#39;slv_syx&#39;</span><span class="p">,</span> <span class="s1">&#39;slv_szx&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-190"></a>                <span class="s1">&#39;slv_sxy&#39;</span><span class="p">,</span> <span class="s1">&#39;slv_syy&#39;</span><span class="p">,</span> <span class="s1">&#39;slv_szy&#39;</span><span class="p">,</span> <span class="s1">&#39;slv_sxz&#39;</span><span class="p">,</span> <span class="s1">&#39;slv_syz&#39;</span><span class="p">,</span> <span class="s1">&#39;slv_szz&#39;</span>
<a name="ln-191"></a>        <span class="k">end if</span>
<a name="ln-192"></a><span class="k">    end if</span>
<a name="ln-193"></a>
<a name="ln-194"></a>    <span class="c">!Structural properties: Size (for multiple molecules these will be</span>
<a name="ln-195"></a>    <span class="c">!averaged quantities)</span>
<a name="ln-196"></a>    <span class="k">if</span> <span class="p">(</span> <span class="n">num_bonds</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-197"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(*(2x,a16))&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="s1">&#39;reedsq&#39;</span><span class="p">,</span> <span class="s1">&#39;rgsq&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-198"></a>            <span class="s1">&#39;spanx&#39;</span><span class="p">,</span> <span class="s1">&#39;spany&#39;</span><span class="p">,</span> <span class="s1">&#39;spanz&#39;</span>
<a name="ln-199"></a>    <span class="k">end if</span>
<a name="ln-200"></a>
<a name="ln-201"></a>    <span class="c">!Further structural properties (for single molecule)</span>
<a name="ln-202"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">leql</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-203"></a><span class="k">        if</span> <span class="p">(</span> <span class="p">(</span><span class="n">imcon</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">num_bonds</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-204"></a><span class="k">            write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(*(2x,a16))&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="s1">&#39;reevx&#39;</span><span class="p">,</span> <span class="s1">&#39;reevy&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-205"></a>                <span class="s1">&#39;reevz&#39;</span><span class="p">,</span> <span class="s1">&#39;asph&#39;</span><span class="p">,</span> <span class="s1">&#39;prol&#39;</span>
<a name="ln-206"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">num_branches</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-207"></a><span class="k">                write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(*(2x,a16))&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="s1">&#39;rgsq_bbone&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-208"></a>                    <span class="s1">&#39;rgsq_sc&#39;</span><span class="p">,</span> <span class="s1">&#39;reedsq_sc&#39;</span><span class="p">,</span> <span class="s1">&#39;asph_sc&#39;</span><span class="p">,</span> <span class="s1">&#39;prol_sc&#39;</span>
<a name="ln-209"></a>            <span class="k">end if</span>
<a name="ln-210"></a><span class="k">            if</span> <span class="p">(</span><span class="n">flow_style</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-211"></a><span class="k">                write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(*(2x,a16))&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="s1">&#39;comx&#39;</span><span class="p">,</span> <span class="s1">&#39;comy&#39;</span><span class="p">,</span> <span class="s1">&#39;comz&#39;</span>
<a name="ln-212"></a>            <span class="k">end if</span>
<a name="ln-213"></a><span class="k">        end if</span>
<a name="ln-214"></a><span class="k">    end if</span>
<a name="ln-215"></a>
<a name="ln-216"></a><span class="k">    write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<a name="ln-217"></a>
<a name="ln-218"></a>    <span class="k">end subroutine</span>
<a name="ln-219"></a>
<a name="ln-220"></a><span class="c">!******************************************************************************</span>
<a name="ln-221"></a>
<a name="ln-222"></a><span class="k">subroutine </span><span class="n">stats_write</span><span class="p">()</span>
<a name="ln-223"></a>    <span class="c">!! Writing statistics</span>
<a name="ln-224"></a>
<a name="ln-225"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(i12)&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">nts</span>
<a name="ln-226"></a>
<a name="ln-227"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_bonds</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-228"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(*(2x,es16.7))&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-229"></a>            <span class="n">bndlen</span><span class="p">,</span> <span class="n">bndlen_min</span><span class="p">,</span> <span class="n">bndlen_max</span><span class="p">,</span> <span class="n">energy_bond</span>
<a name="ln-230"></a>    <span class="k">end if</span>
<a name="ln-231"></a>
<a name="ln-232"></a><span class="k">    if</span> <span class="p">(</span><span class="n">num_angles</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-233"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(2x,es16.7)&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">energy_angle</span>
<a name="ln-234"></a>    <span class="k">end if</span>
<a name="ln-235"></a>
<a name="ln-236"></a><span class="k">    if</span> <span class="p">(</span><span class="n">num_dihedrals</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-237"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(2x,es16.7)&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">energy_dihedral</span>
<a name="ln-238"></a>    <span class="k">end if</span>
<a name="ln-239"></a>
<a name="ln-240"></a><span class="k">    if</span> <span class="p">(</span><span class="n">lvdw</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-241"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(2x,es16.7)&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">energy_vdw</span>
<a name="ln-242"></a>    <span class="k">end if</span>
<a name="ln-243"></a>
<a name="ln-244"></a><span class="k">    if</span> <span class="p">(</span><span class="n">num_tethers</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-245"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(2x,es16.7)&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">energy_tether</span>
<a name="ln-246"></a>    <span class="k">end if</span>
<a name="ln-247"></a>
<a name="ln-248"></a><span class="k">    if</span> <span class="p">(</span><span class="n">num_externals</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-249"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(2x,es16.7)&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">energy_external</span>
<a name="ln-250"></a>    <span class="k">end if</span>
<a name="ln-251"></a>
<a name="ln-252"></a><span class="k">    if</span> <span class="p">(</span><span class="n">sim_style</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-253"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(2x,es16.7)&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">energy_kin</span>
<a name="ln-254"></a>    <span class="k">end if</span>
<a name="ln-255"></a>
<a name="ln-256"></a><span class="k">    write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(2x,es16.7)&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">energy_tot</span>
<a name="ln-257"></a>
<a name="ln-258"></a>    <span class="c">!No further properties will be calculated for structure relaxation</span>
<a name="ln-259"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">sim_style</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-260"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<a name="ln-261"></a>        <span class="k">return</span>
<a name="ln-262"></a><span class="k">    end if</span>
<a name="ln-263"></a>
<a name="ln-264"></a>    <span class="c">!Stress (calculated only during production run)</span>
<a name="ln-265"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">leql</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-266"></a><span class="k">        if</span> <span class="p">(</span><span class="n">num_atoms</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-267"></a><span class="k">            write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(*(2x,es16.7))&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">stress</span>
<a name="ln-268"></a>        <span class="k">end if</span>
<a name="ln-269"></a><span class="k">        if</span> <span class="p">(</span><span class="n">sim_style</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-270"></a><span class="k">            write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(*(2x,es16.7))&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">stress_slvnt</span>
<a name="ln-271"></a>        <span class="k">end if</span>
<a name="ln-272"></a><span class="k">    end if</span>
<a name="ln-273"></a>
<a name="ln-274"></a>    <span class="c">!Structural properties: Size (for multiple molecules these will be</span>
<a name="ln-275"></a>    <span class="c">!averaged quantities)</span>
<a name="ln-276"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">imcon</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-277"></a><span class="k">        call </span><span class="n">stats_compute_ic0</span><span class="p">()</span>
<a name="ln-278"></a>    <span class="k">else</span>
<a name="ln-279"></a><span class="k">        call </span><span class="n">stats_compute_ic1</span><span class="p">()</span>
<a name="ln-280"></a>    <span class="k">end if</span>
<a name="ln-281"></a>
<a name="ln-282"></a><span class="k">    if</span> <span class="p">(</span> <span class="n">num_bonds</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-283"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(*(2x,es16.7))&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">reedsq</span><span class="p">,</span> <span class="n">rgsq</span><span class="p">,</span> <span class="n">span</span>
<a name="ln-284"></a>    <span class="k">end if</span>
<a name="ln-285"></a>
<a name="ln-286"></a>    <span class="c">!Further structural properties (for single molecule in unbounded domain)</span>
<a name="ln-287"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">leql</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-288"></a><span class="k">        if</span> <span class="p">(</span> <span class="p">(</span><span class="n">imcon</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">num_bonds</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-289"></a><span class="k">            write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(*(2x,es16.7))&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">reev</span><span class="p">,</span> <span class="n">asph</span><span class="p">,</span> <span class="n">prol</span>
<a name="ln-290"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">num_branches</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-291"></a><span class="k">                write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(*(2x,es16.7))&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">rgsq_bbone</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-292"></a>                    <span class="n">rgsq_sc</span><span class="p">,</span> <span class="n">reedsq_sc</span><span class="p">,</span> <span class="n">asph_sc</span><span class="p">,</span> <span class="n">prol_sc</span>
<a name="ln-293"></a>            <span class="k">end if</span>
<a name="ln-294"></a><span class="k">            if</span> <span class="p">(</span><span class="n">flow_style</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-295"></a><span class="k">                write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="s1">&#39;(*(2x,es16.7))&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">molecule_com</span>
<a name="ln-296"></a>            <span class="k">end if</span>
<a name="ln-297"></a><span class="k">        end if</span>
<a name="ln-298"></a><span class="k">    end if</span>
<a name="ln-299"></a>
<a name="ln-300"></a><span class="k">    write</span><span class="p">(</span><span class="n">fu_stats</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<a name="ln-301"></a>
<a name="ln-302"></a>    <span class="k">end subroutine</span>
<a name="ln-303"></a>
<a name="ln-304"></a><span class="c">!******************************************************************************</span>
<a name="ln-305"></a>
<a name="ln-306"></a><span class="k">subroutine </span><span class="n">stats_compute_ic1</span><span class="p">()</span>
<a name="ln-307"></a>    <span class="c">!! Computes statistics for a possibly multiple chains in a periodic domain.</span>
<a name="ln-308"></a>
<a name="ln-309"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">com</span>
<a name="ln-310"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rgsq_im</span>
<a name="ln-311"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">natm</span><span class="p">,</span> <span class="n">nmol</span>
<a name="ln-312"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">imol</span><span class="p">,</span> <span class="n">ibeg</span>
<a name="ln-313"></a>
<a name="ln-314"></a>    <span class="n">rgsq</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">reedsq</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">span</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-315"></a>
<a name="ln-316"></a>    <span class="k">do </span><span class="n">imol</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_molecules</span>
<a name="ln-317"></a>        <span class="n">natm</span> <span class="o">=</span> <span class="n">molecules</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">imol</span><span class="p">)</span>
<a name="ln-318"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">natm</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-319"></a><span class="k">            </span><span class="n">molbuf</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-320"></a>            <span class="n">ibeg</span> <span class="o">=</span> <span class="n">molecules</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">imol</span><span class="p">)</span>
<a name="ln-321"></a>            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">natm</span>
<a name="ln-322"></a>                <span class="n">molbuf</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">ibeg</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-323"></a>            <span class="k">end do</span>
<a name="ln-324"></a><span class="k">            do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">natm</span>
<a name="ln-325"></a>                <span class="n">molbuf</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">molbuf</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">molbuf</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-326"></a>                <span class="k">call </span><span class="n">simbox</span><span class="p">%</span><span class="n">get_image</span><span class="p">(</span><span class="n">molbuf</span><span class="p">(:,</span><span class="n">i</span><span class="p">))</span>
<a name="ln-327"></a>            <span class="k">end do</span>
<a name="ln-328"></a><span class="k">            </span><span class="n">span</span> <span class="o">=</span> <span class="n">span</span> <span class="o">+</span> <span class="nb">maxval</span><span class="p">(</span><span class="n">molbuf</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">natm</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="nb">minval</span><span class="p">(</span><span class="n">molbuf</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">natm</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-329"></a>            <span class="n">reev</span> <span class="o">=</span> <span class="n">molbuf</span><span class="p">(:,</span><span class="n">natm</span><span class="p">)</span>
<a name="ln-330"></a>            <span class="n">reedsq</span> <span class="o">=</span> <span class="n">reedsq</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">reev</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-331"></a>            <span class="n">rgsq_im</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-332"></a>            <span class="n">com</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">molbuf</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">natm</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">natm</span>
<a name="ln-333"></a>            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">natm</span>
<a name="ln-334"></a>                <span class="n">rgsq_im</span> <span class="o">=</span> <span class="n">rgsq_im</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">((</span><span class="n">molbuf</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">com</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-335"></a>            <span class="k">end do</span>
<a name="ln-336"></a><span class="k">            </span><span class="n">rgsq</span> <span class="o">=</span> <span class="n">rgsq</span> <span class="o">+</span> <span class="n">rgsq_im</span><span class="o">/</span><span class="n">natm</span>
<a name="ln-337"></a>        <span class="k">end if</span>
<a name="ln-338"></a><span class="k">    end do</span>
<a name="ln-339"></a><span class="k">    </span><span class="n">nmol</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="n">molecules</span><span class="p">(</span><span class="mi">2</span><span class="p">,:)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-340"></a>    <span class="n">span</span> <span class="o">=</span> <span class="n">span</span><span class="o">/</span><span class="n">nmol</span><span class="p">;</span> <span class="n">reedsq</span> <span class="o">=</span> <span class="n">reedsq</span><span class="o">/</span><span class="n">nmol</span><span class="p">;</span> <span class="n">rgsq</span> <span class="o">=</span> <span class="n">rgsq</span><span class="o">/</span><span class="n">nmol</span>
<a name="ln-341"></a>
<a name="ln-342"></a>    <span class="k">end subroutine</span>
<a name="ln-343"></a>
<a name="ln-344"></a><span class="c">!******************************************************************************</span>
<a name="ln-345"></a>
<a name="ln-346"></a><span class="k">subroutine </span><span class="n">stats_compute_ic0</span><span class="p">()</span>
<a name="ln-347"></a>    <span class="c">!! Computes statistics for a single chain in unbounded domain.</span>
<a name="ln-348"></a>
<a name="ln-349"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">gt_ev</span><span class="p">,</span> <span class="n">gt_ev_sc</span><span class="p">,</span> <span class="n">gt_ev_isc</span>
<a name="ln-350"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S</span>
<a name="ln-351"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ri</span>
<a name="ln-352"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">com</span><span class="p">,</span> <span class="n">com_bbone</span><span class="p">,</span> <span class="n">com_sc</span>
<a name="ln-353"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">r_tp</span>
<a name="ln-354"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rgsq_isc</span><span class="p">,</span> <span class="n">asph_isc</span><span class="p">,</span> <span class="n">prol_isc</span>
<a name="ln-355"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n_sc</span>
<a name="ln-356"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">na_bbone</span> 
<a name="ln-357"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">na_sc</span>
<a name="ln-358"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ibr</span><span class="p">,</span> <span class="n">ia_beg</span><span class="p">,</span> <span class="n">ia_end</span>
<a name="ln-359"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-360"></a>
<a name="ln-361"></a>    <span class="c">!Number of backbone atoms</span>
<a name="ln-362"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_branches</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-363"></a><span class="k">        </span><span class="n">na_bbone</span> <span class="o">=</span> <span class="n">num_atoms</span>
<a name="ln-364"></a>        <span class="n">n_sc</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!Number of side chains</span>
<a name="ln-365"></a>    <span class="k">else</span>
<a name="ln-366"></a><span class="k">        </span><span class="n">na_bbone</span> <span class="o">=</span> <span class="n">branches</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-367"></a>        <span class="n">n_sc</span> <span class="o">=</span> <span class="n">num_branches</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c">!Number of side chains</span>
<a name="ln-368"></a>    <span class="k">end if</span>
<a name="ln-369"></a>
<a name="ln-370"></a>    <span class="c">!Zero out</span>
<a name="ln-371"></a>    <span class="n">span</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">rgsq</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">reedsq</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-372"></a>    <span class="n">asph</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">prol</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-373"></a>    <span class="n">rgsq_bbone</span> <span class="o">=</span> <span class="mf">0.0_rp</span> 
<a name="ln-374"></a>    <span class="n">rgsq_sc</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">reedsq_sc</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">asph_sc</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">prol_sc</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-375"></a>    <span class="n">gt_ev</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span>
<a name="ln-376"></a>    <span class="n">gt_ev_sc</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span>
<a name="ln-377"></a>
<a name="ln-378"></a>    <span class="n">S</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">reev</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-379"></a>
<a name="ln-380"></a>    <span class="n">span</span> <span class="o">=</span> <span class="nb">maxval</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="nb">minval</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-381"></a>    <span class="n">reev</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">na_bbone</span><span class="p">)</span> <span class="o">-</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-382"></a>    <span class="n">reedsq</span> <span class="o">=</span> <span class="n">reev</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">reev</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">reev</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">reev</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">reev</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">reev</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-383"></a>
<a name="ln-384"></a>    <span class="n">com</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">num_atoms</span>
<a name="ln-385"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-386"></a>        <span class="n">ri</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">com</span>
<a name="ln-387"></a>        <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ri</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ri</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-388"></a>        <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">ri</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-389"></a>        <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">ri</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ri</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-390"></a>        <span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-391"></a>        <span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ri</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-392"></a>        <span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">ri</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">ri</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-393"></a>    <span class="k">end do</span>
<a name="ln-394"></a><span class="k">    </span><span class="n">S</span> <span class="o">=</span> <span class="n">S</span><span class="o">/</span><span class="n">num_atoms</span>
<a name="ln-395"></a>    <span class="n">rgsq</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-396"></a>
<a name="ln-397"></a>    <span class="c">!Do not compute any more stuff suring equilibration</span>
<a name="ln-398"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">leql</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-399"></a>
<a name="ln-400"></a><span class="k">    call </span><span class="n">dsyevc3</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">gt_ev</span><span class="p">)</span>
<a name="ln-401"></a>    <span class="k">call </span><span class="n">calc_shape</span><span class="p">(</span><span class="n">gt_ev</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">gt_ev</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">gt_ev</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">asph</span><span class="p">,</span> <span class="n">prol</span><span class="p">)</span> 
<a name="ln-402"></a>
<a name="ln-403"></a>    <span class="n">com_bbone</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">coordinates</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">na_bbone</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">na_bbone</span>
<a name="ln-404"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na_bbone</span>
<a name="ln-405"></a>        <span class="n">rgsq_bbone</span> <span class="o">=</span> <span class="n">rgsq_bbone</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">((</span><span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="n">com_bbone</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-406"></a>    <span class="k">end do</span>
<a name="ln-407"></a><span class="k">    </span><span class="n">rgsq_bbone</span> <span class="o">=</span> <span class="n">rgsq_bbone</span><span class="o">/</span><span class="n">na_bbone</span>
<a name="ln-408"></a>
<a name="ln-409"></a>    <span class="k">do </span><span class="n">ibr</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">num_branches</span>
<a name="ln-410"></a>        <span class="n">ia_beg</span> <span class="o">=</span> <span class="n">branches</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">ibr</span><span class="p">)</span>
<a name="ln-411"></a>        <span class="n">ia_end</span> <span class="o">=</span> <span class="n">ia_beg</span> <span class="o">+</span> <span class="n">branches</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">ibr</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-412"></a>        <span class="n">r_tp</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">branches</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ibr</span><span class="p">))</span>
<a name="ln-413"></a>
<a name="ln-414"></a>        <span class="c">!Add end-to-end distance squared of this side chain</span>
<a name="ln-415"></a>        <span class="n">reedsq_sc</span> <span class="o">=</span> <span class="n">reedsq_sc</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">((</span><span class="n">coordinates</span><span class="p">(:,</span><span class="n">ia_end</span><span class="p">)</span> <span class="o">-</span> <span class="n">r_tp</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-416"></a>
<a name="ln-417"></a>        <span class="c">!Number of side chain atoms. Adding 1 for the tether point</span>
<a name="ln-418"></a>        <span class="n">na_sc</span> <span class="o">=</span> <span class="n">branches</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">ibr</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-419"></a>
<a name="ln-420"></a>        <span class="c">!Get side chain c.o.m.</span>
<a name="ln-421"></a>        <span class="n">com_sc</span> <span class="o">=</span> <span class="n">r_tp</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">coordinates</span><span class="p">(:,</span><span class="n">ia_beg</span><span class="p">:</span><span class="n">ia_end</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-422"></a>        <span class="n">com_sc</span> <span class="o">=</span> <span class="n">com_sc</span><span class="o">/</span><span class="n">na_sc</span>
<a name="ln-423"></a>
<a name="ln-424"></a>        <span class="c">!Get radius of gyration squared of this side chain</span>
<a name="ln-425"></a>        <span class="n">S</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-426"></a>        <span class="n">ri</span> <span class="o">=</span> <span class="n">r_tp</span> <span class="o">-</span> <span class="n">com_sc</span>
<a name="ln-427"></a>        <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ri</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ri</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-428"></a>        <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">ri</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-429"></a>        <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">ri</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ri</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-430"></a>        <span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-431"></a>        <span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ri</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-432"></a>        <span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">ri</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">ri</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-433"></a>
<a name="ln-434"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ia_beg</span><span class="p">,</span> <span class="n">ia_end</span>
<a name="ln-435"></a>            <span class="n">ri</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">com_sc</span>
<a name="ln-436"></a>            <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ri</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ri</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-437"></a>            <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">ri</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-438"></a>            <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">ri</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ri</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-439"></a>            <span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-440"></a>            <span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ri</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-441"></a>            <span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">ri</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">ri</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-442"></a>        <span class="k">end do</span>
<a name="ln-443"></a><span class="k">        </span><span class="n">S</span> <span class="o">=</span> <span class="n">S</span><span class="o">/</span><span class="n">na_sc</span>
<a name="ln-444"></a>        <span class="n">rgsq_isc</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-445"></a>
<a name="ln-446"></a>        <span class="k">call </span><span class="n">dsyevc3</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">gt_ev_isc</span><span class="p">)</span>
<a name="ln-447"></a>        <span class="c">!Note: gt_ev(2) and gt_ev(3) are flipped so that the three eigen values are</span>
<a name="ln-448"></a>        <span class="c">!in descending order</span>
<a name="ln-449"></a>        <span class="k">call </span><span class="n">calc_shape</span><span class="p">(</span><span class="n">gt_ev_isc</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">gt_ev_isc</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">gt_ev_isc</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-450"></a>            <span class="n">asph_isc</span><span class="p">,</span> <span class="n">prol_isc</span><span class="p">)</span> 
<a name="ln-451"></a>        <span class="c">!Add radius of gyration, etc. of this side chain</span>
<a name="ln-452"></a>        <span class="n">rgsq_sc</span> <span class="o">=</span> <span class="n">rgsq_sc</span> <span class="o">+</span> <span class="n">rgsq_isc</span>
<a name="ln-453"></a>        <span class="n">gt_ev_sc</span> <span class="o">=</span> <span class="n">gt_ev_sc</span> <span class="o">+</span> <span class="n">gt_ev_isc</span>
<a name="ln-454"></a>        <span class="n">asph_sc</span> <span class="o">=</span> <span class="n">asph_sc</span> <span class="o">+</span> <span class="n">asph_isc</span>
<a name="ln-455"></a>        <span class="n">prol_sc</span> <span class="o">=</span> <span class="n">prol_sc</span> <span class="o">+</span> <span class="n">prol_isc</span>
<a name="ln-456"></a>    <span class="k">end do</span>
<a name="ln-457"></a>
<a name="ln-458"></a><span class="k">    if</span> <span class="p">(</span><span class="n">n_sc</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-459"></a><span class="k">        </span><span class="n">rgsq_sc</span> <span class="o">=</span> <span class="n">rgsq_sc</span><span class="o">/</span><span class="n">n_sc</span>
<a name="ln-460"></a>        <span class="n">reedsq_sc</span> <span class="o">=</span> <span class="n">reedsq_sc</span><span class="o">/</span><span class="n">n_sc</span>
<a name="ln-461"></a>        <span class="n">gt_ev_sc</span> <span class="o">=</span> <span class="n">gt_ev_sc</span><span class="o">/</span><span class="n">n_sc</span>
<a name="ln-462"></a>        <span class="n">asph_sc</span> <span class="o">=</span> <span class="n">asph_sc</span><span class="o">/</span><span class="n">n_sc</span>
<a name="ln-463"></a>        <span class="n">prol_sc</span> <span class="o">=</span> <span class="n">prol_sc</span><span class="o">/</span><span class="n">n_sc</span>
<a name="ln-464"></a>    <span class="k">end if</span>
<a name="ln-465"></a>
<a name="ln-466"></a><span class="k">    end subroutine</span>
<a name="ln-467"></a>
<a name="ln-468"></a><span class="c">!******************************************************************************</span>
<a name="ln-469"></a>
<a name="ln-470"></a><span class="k">subroutine </span><span class="n">calc_shape</span><span class="p">(</span><span class="n">ev1</span><span class="p">,</span> <span class="n">ev2</span><span class="p">,</span> <span class="n">ev3</span><span class="p">,</span> <span class="n">asph</span><span class="p">,</span> <span class="n">prol</span><span class="p">)</span>
<a name="ln-471"></a>    <span class="c">!! Given three eigen values of the gyration tensor, calculates asphericity</span>
<a name="ln-472"></a>    <span class="c">!! and prolateness. Note that ev1 &gt;= ev2 &gt;= ev3.</span>
<a name="ln-473"></a>
<a name="ln-474"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ev1</span>
<a name="ln-475"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ev2</span>
<a name="ln-476"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ev3</span>
<a name="ln-477"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">asph</span>
<a name="ln-478"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">prol</span>
<a name="ln-479"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rgsq</span>
<a name="ln-480"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ev_av</span><span class="p">,</span> <span class="n">ev1mav</span><span class="p">,</span> <span class="n">ev2mav</span><span class="p">,</span> <span class="n">ev3mav</span><span class="p">,</span> <span class="n">evmav_sumsq</span>
<a name="ln-481"></a>
<a name="ln-482"></a>    <span class="n">rgsq</span> <span class="o">=</span> <span class="n">ev1</span> <span class="o">+</span> <span class="n">ev2</span> <span class="o">+</span> <span class="n">ev3</span>
<a name="ln-483"></a>    <span class="n">ev_av</span> <span class="o">=</span> <span class="n">rgsq</span><span class="o">*</span><span class="n">math_third</span>
<a name="ln-484"></a>    <span class="n">ev1mav</span> <span class="o">=</span> <span class="n">ev1</span> <span class="o">-</span> <span class="n">ev_av</span>
<a name="ln-485"></a>    <span class="n">ev2mav</span> <span class="o">=</span> <span class="n">ev2</span> <span class="o">-</span> <span class="n">ev_av</span>
<a name="ln-486"></a>    <span class="n">ev3mav</span> <span class="o">=</span> <span class="n">ev3</span> <span class="o">-</span> <span class="n">ev_av</span>
<a name="ln-487"></a>    <span class="n">evmav_sumsq</span> <span class="o">=</span> <span class="n">ev1mav</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ev2mav</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ev3mav</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-488"></a>
<a name="ln-489"></a>    <span class="n">asph</span> <span class="o">=</span> <span class="mf">1.5_rp</span><span class="o">*</span><span class="n">evmav_sumsq</span><span class="o">/</span><span class="p">(</span><span class="n">rgsq</span><span class="o">*</span><span class="n">rgsq</span><span class="p">)</span>
<a name="ln-490"></a>    <span class="n">prol</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">ev1mav</span><span class="o">*</span><span class="n">ev2mav</span><span class="o">*</span><span class="n">ev3mav</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">math_third</span><span class="p">)</span><span class="o">*</span><span class="n">evmav_sumsq</span><span class="p">)</span><span class="o">**</span><span class="mf">1.5</span>
<a name="ln-491"></a>
<a name="ln-492"></a>    <span class="k">end subroutine</span>
<a name="ln-493"></a>
<a name="ln-494"></a><span class="c">!******************************************************************************</span>
<a name="ln-495"></a>
<a name="ln-496"></a><span class="k">subroutine </span><span class="n">dsyevc3</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<a name="ln-497"></a>
<a name="ln-498"></a>    <span class="c">!! Calculates the eigenvalues of a symmetric 3x3 matrix A using Cardano&#39;s</span>
<a name="ln-499"></a>    <span class="c">!! analytical algorithm.</span>
<a name="ln-500"></a>    <span class="c">!! Only the diagonal and upper triangular parts of A are accessed. The access</span>
<a name="ln-501"></a>    <span class="c">!! is read-only.</span>
<a name="ln-502"></a>    <span class="c">!!</span>
<a name="ln-503"></a>    <span class="c">!! Copyright (C) 2006  Joachim Kopp</span>
<a name="ln-504"></a>    <span class="c">! ----------------------------------------------------------------------------</span>
<a name="ln-505"></a>    <span class="c">! Parameters:</span>
<a name="ln-506"></a>    <span class="c">!   A: The symmetric input matrix</span>
<a name="ln-507"></a>    <span class="c">!   W: Storage buffer for eigenvalues</span>
<a name="ln-508"></a>    <span class="c">! ----------------------------------------------------------------------------</span>
<a name="ln-509"></a>    <span class="c">! .. Arguments ..</span>
<a name="ln-510"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">RP</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A</span>
<a name="ln-511"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">RP</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">W</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-512"></a>
<a name="ln-513"></a>     <span class="c">!.. Local Variables ..</span>
<a name="ln-514"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">RP</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">M</span><span class="p">,</span> <span class="n">C1</span><span class="p">,</span> <span class="n">C0</span>
<a name="ln-515"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">RP</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">DE</span><span class="p">,</span> <span class="n">DD</span><span class="p">,</span> <span class="n">EE</span><span class="p">,</span> <span class="n">FF</span>
<a name="ln-516"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">RP</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">P</span><span class="p">,</span> <span class="n">SQRTP</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">PHI</span>
<a name="ln-517"></a>  
<a name="ln-518"></a>     <span class="c">!Determine coefficients of characteristic poynomial. We write</span>
<a name="ln-519"></a>     <span class="c">!      | A   D   F  |</span>
<a name="ln-520"></a>     <span class="c">! A =  | D*  B   E  |</span>
<a name="ln-521"></a>     <span class="c">!      | F*  E*  C  |</span>
<a name="ln-522"></a>
<a name="ln-523"></a>      <span class="n">DE</span>    <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-524"></a>      <span class="n">DD</span>    <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-525"></a>      <span class="n">EE</span>    <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-526"></a>      <span class="n">FF</span>    <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-527"></a>      <span class="n">M</span>     <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-528"></a>      <span class="n">C1</span>    <span class="o">=</span> <span class="p">(</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-529"></a>               <span class="o">-</span> <span class="p">(</span><span class="n">DD</span> <span class="o">+</span> <span class="n">EE</span> <span class="o">+</span> <span class="n">FF</span><span class="p">)</span>
<a name="ln-530"></a>      <span class="n">C0</span>    <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">DD</span> <span class="o">+</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">EE</span> <span class="o">+</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">FF</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-531"></a>               <span class="o">-</span> <span class="mf">2.0_RP</span> <span class="o">*</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">DE</span>
<a name="ln-532"></a>
<a name="ln-533"></a>      <span class="n">P</span>     <span class="o">=</span> <span class="n">M</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">3.0_RP</span> <span class="o">*</span> <span class="n">C1</span>
<a name="ln-534"></a>      <span class="n">Q</span>     <span class="o">=</span> <span class="n">M</span><span class="o">*</span><span class="p">(</span><span class="n">P</span> <span class="o">-</span> <span class="p">(</span><span class="mf">3.0_RP</span><span class="o">/</span><span class="mf">2.0_RP</span><span class="p">)</span><span class="o">*</span><span class="n">C1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="mf">7.0_RP</span><span class="o">/</span><span class="mf">2.0_RP</span><span class="p">)</span><span class="o">*</span><span class="n">C0</span>
<a name="ln-535"></a>      <span class="n">SQRTP</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">P</span><span class="p">))</span>
<a name="ln-536"></a>
<a name="ln-537"></a>      <span class="n">PHI</span>   <span class="o">=</span> <span class="mi">2</span><span class="mf">7.0_RP</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">0.25_RP</span> <span class="o">*</span> <span class="n">C1</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">P</span> <span class="o">-</span> <span class="n">C1</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-538"></a>                <span class="o">+</span> <span class="n">C0</span> <span class="o">*</span> <span class="p">(</span><span class="n">Q</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="mf">7.0_RP</span><span class="o">/</span><span class="mf">4.0_RP</span><span class="p">)</span><span class="o">*</span><span class="n">C0</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-539"></a>      <span class="n">PHI</span>   <span class="o">=</span> <span class="p">(</span><span class="mf">1.0_RP</span><span class="o">/</span><span class="mf">3.0_RP</span><span class="p">)</span> <span class="o">*</span> <span class="n">ATAN2</span><span class="p">(</span><span class="nb">SQRT</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">PHI</span><span class="p">)),</span> <span class="n">Q</span><span class="p">)</span>
<a name="ln-540"></a>
<a name="ln-541"></a>      <span class="n">C</span>     <span class="o">=</span> <span class="n">SQRTP</span> <span class="o">*</span> <span class="nb">COS</span><span class="p">(</span><span class="n">PHI</span><span class="p">)</span>
<a name="ln-542"></a>      <span class="n">S</span>     <span class="o">=</span> <span class="p">(</span><span class="mf">1.0_RP</span><span class="o">/</span><span class="n">MATH_SQRT3</span><span class="p">)</span> <span class="o">*</span> <span class="n">SQRTP</span> <span class="o">*</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">PHI</span><span class="p">)</span>
<a name="ln-543"></a>
<a name="ln-544"></a>      <span class="n">W</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0_RP</span><span class="o">/</span><span class="mf">3.0_RP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">M</span> <span class="o">-</span> <span class="n">C</span><span class="p">)</span>
<a name="ln-545"></a>      <span class="n">W</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">S</span>
<a name="ln-546"></a>      <span class="n">W</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">C</span>
<a name="ln-547"></a>      <span class="n">W</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">S</span>
<a name="ln-548"></a>
<a name="ln-549"></a>      <span class="k">END SUBROUTINE</span>
<a name="ln-550"></a>
<a name="ln-551"></a><span class="c">!******************************************************************************</span>
<a name="ln-552"></a>
<a name="ln-553"></a><span class="k">end module </span><span class="n">m_stats_io</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> BROWNPAK was developed by Sarit Dutta</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>