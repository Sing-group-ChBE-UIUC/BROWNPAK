<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for BROWNPAK">
   
    <meta name="author" content="Sarit Dutta" >
    <link rel="icon" href="../favicon.png">

    <title>m_bd_solver.f90 &ndash; BROWNPAK</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">BROWNPAK <small>0.2</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>m_bd_solver.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 5.1% of total for source files.">312 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/m_bd_solver.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">m_bd_solver.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_bd_solver.html">m_bd_solver</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_bd_solver.f90.html#src">m_bd_solver.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_bd_solver.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilem_bd_solverf90EfferentGraph" width="641pt" height="537pt"
 viewBox="0.00 0.00 641.00 537.07" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph" class="graph" transform="scale(.7301 .7301) rotate(0) translate(4 731.6491)">
<title>sourcefile~~m_bd_solver.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-731.6491 874,-731.6491 874,4 -4,4"/>
<!-- sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~m_bd_solver.f90</title>
<polygon fill="none" stroke="#000000" points="870,-267.8668 780,-267.8668 780,-243.8668 870,-243.8668 870,-267.8668"/>
<text text-anchor="middle" x="825" y="-253.4668" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_bd_solver.f90</text>
</g>
<!-- sourcefile~m_strings.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~m_strings.f90</title>
<g id="a_sourcefile~~m_bd_solver.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/m_strings.f90.html" xlink:title="m_strings.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="479,-657.8668 403,-657.8668 403,-633.8668 479,-633.8668 479,-657.8668"/>
<text text-anchor="middle" x="441" y="-643.4668" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_strings.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_strings.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_strings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M565.5,-624.8668C541.5318,-635.1062 512.97,-640.3641 489.2524,-643.0592"/>
<polygon fill="#ff0000" stroke="#ff0000" points="488.6662,-639.6007 479.0719,-644.0951 489.3749,-646.5647 488.6662,-639.6007"/>
</g>
<!-- sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~m_globals.f90</title>
<g id="a_sourcefile~~m_bd_solver.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/m_globals.f90.html" xlink:title="m_globals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480,-311.8668 402,-311.8668 402,-287.8668 480,-287.8668 480,-311.8668"/>
<text text-anchor="middle" x="441" y="-297.4668" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_globals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M697.5,-439.8668C667.4988,-474.561 654.8369,-400.5995 615,-377.8668 573.6368,-354.2632 559.3781,-356.5235 516,-336.8668 501.9529,-330.5014 486.6509,-323.0485 473.5536,-316.5063"/>
<polygon fill="#ff0000" stroke="#ff0000" points="474.9624,-313.2972 464.4558,-311.9321 471.8179,-319.5512 474.9624,-313.2972"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M817.7768,-268.1371C799.5395,-298.6691 749.3788,-379.9137 697.5,-439.8668"/>
</g>
<!-- sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~m_stats_io.f90</title>
<g id="a_sourcefile~~m_bd_solver.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/m_stats_io.f90.html" xlink:title="m_stats_io.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="606,-676.8668 525,-676.8668 525,-652.8668 606,-652.8668 606,-676.8668"/>
<text text-anchor="middle" x="565.5" y="-662.4668" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_stats_io.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_stats_io.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M697.5,-439.8668C634.8745,-512.2886 679.5644,-568.1681 615,-638.8668 612.128,-642.0117 608.7864,-644.8423 605.2206,-647.374"/>
<polygon fill="#ff0000" stroke="#ff0000" points="603.241,-644.4837 596.609,-652.746 606.946,-650.4229 603.241,-644.4837"/>
</g>
<!-- sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~m_config_io.f90</title>
<g id="a_sourcefile~~m_bd_solver.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/m_config_io.f90.html" xlink:title="m_config_io.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="609,-596.8668 522,-596.8668 522,-572.8668 609,-572.8668 609,-596.8668"/>
<text text-anchor="middle" x="565.5" y="-582.4668" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_config_io.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_config_io.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M697.5,-439.8668C659.1361,-484.2319 655.8826,-500.8113 615,-542.8668 607.0226,-551.0731 597.5854,-559.3775 589.1017,-566.411"/>
<polygon fill="#ff0000" stroke="#ff0000" points="586.8914,-563.6972 581.3387,-572.7204 591.3064,-569.1293 586.8914,-563.6972"/>
</g>
<!-- sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~m_interaction.f90</title>
<g id="a_sourcefile~~m_bd_solver.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/m_interaction.f90.html" xlink:title="m_interaction.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="744,-267.8668 651,-267.8668 651,-243.8668 744,-243.8668 744,-267.8668"/>
<text text-anchor="middle" x="697.5" y="-253.4668" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_interaction.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M779.6893,-255.8668C771.5474,-255.8668 762.9666,-255.8668 754.5436,-255.8668"/>
<polygon fill="#ff0000" stroke="#ff0000" points="754.3879,-252.3669 744.3879,-255.8668 754.3879,-259.3669 754.3879,-252.3669"/>
</g>
<!-- sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~m_constants_math.f90</title>
<g id="a_sourcefile~~m_bd_solver.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/m_constants_math.f90.html" xlink:title="m_constants_math.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="242,-383.8668 123,-383.8668 123,-359.8668 242,-359.8668 242,-383.8668"/>
<text text-anchor="middle" x="182.5" y="-369.4668" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_constants_math.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M697.5,-439.8668C659.1115,-484.2301 620.399,-419.1817 565.5,-439.8668"/>
</g>
<!-- sourcefile~m_ran_num.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~m_ran_num.f90</title>
<g id="a_sourcefile~~m_bd_solver.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/m_ran_num.f90.html" xlink:title="m_ran_num.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="225.5,-284.8668 139.5,-284.8668 139.5,-260.8668 225.5,-260.8668 225.5,-284.8668"/>
<text text-anchor="middle" x="182.5" y="-270.4668" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ran_num.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_ran_num.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_ran_num.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M819.444,-243.6928C799.3277,-201.3066 725.6075,-60.0083 615,-8.8668 575.0624,9.5991 559.9894,-7.9026 516,-8.8668 465.2968,-9.9782 450.2349,1.7999 402,-13.8668 339.1601,-34.2772 318.6612,-43.789 278,-95.8668 248.4147,-133.759 265.2576,-155.7931 242,-197.8668 230.7748,-218.1735 214.0985,-238.6359 201.2544,-253.0455"/>
<polygon fill="#ff0000" stroke="#ff0000" points="198.3524,-251.034 194.205,-260.7833 203.527,-255.7482 198.3524,-251.034"/>
</g>
<!-- sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~m_logger.f90</title>
<g id="a_sourcefile~~m_bd_solver.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/m_logger.f90.html" xlink:title="m_logger.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="219.5,-503.8668 145.5,-503.8668 145.5,-479.8668 219.5,-479.8668 219.5,-503.8668"/>
<text text-anchor="middle" x="182.5" y="-489.4668" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_logger.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_logger.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M697.5,-439.8668C643.5901,-502.1671 675.9495,-550.4343 615,-605.8668 597.5667,-621.7221 587.1703,-615.6091 565.5,-624.8668"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M565.5,-624.8668C528.0427,-640.8688 518.2964,-605.7412 480,-591.8668 432.8445,-574.7829 299.6671,-530.5579 228.5705,-507.0608"/>
<polygon fill="#ff0000" stroke="#ff0000" points="229.5591,-503.7014 218.9659,-503.8878 227.3632,-510.348 229.5591,-503.7014"/>
</g>
<!-- sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~m_precision.f90</title>
<g id="a_sourcefile~~m_bd_solver.f90~~EfferentGraph_node10"><a xlink:href=".././sourcefile/m_precision.f90.html" xlink:title="m_precision.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="87,-304.8668 0,-304.8668 0,-280.8668 87,-280.8668 87,-304.8668"/>
<text text-anchor="middle" x="43.5" y="-290.4668" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_precision.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M697.5,-439.8668C622.0417,-527.0693 705.0096,-613.7801 615,-685.8668 513.3571,-767.2704 450.2931,-708.1986 322,-685.8668"/>
</g>
<!-- sourcefile~m_strings.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~m_strings.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M416.6715,-657.8783C393.1277,-668.5675 356.0947,-682.9516 322,-685.8668"/>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M401.8984,-297.1012C378.6917,-295.6581 348.6835,-294.1367 322,-293.8668"/>
</g>
<!-- sourcefile~m_trajectory.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~m_trajectory.f90</title>
<g id="a_sourcefile~~m_bd_solver.f90~~EfferentGraph_node12"><a xlink:href=".././sourcefile/m_trajectory.f90.html" xlink:title="m_trajectory.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-425.8668 278,-425.8668 278,-401.8668 366,-401.8668 366,-425.8668"/>
<text text-anchor="middle" x="322" y="-411.4668" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_trajectory.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_trajectory.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_trajectory.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M418.8812,-311.917C412.9315,-315.8406 406.8176,-320.5686 402,-325.8668 379.2582,-350.8774 390.4669,-369.5412 366,-392.8668 364.8896,-393.9254 363.7159,-394.9394 362.4933,-395.9098"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="360.2273,-393.2152 353.871,-401.6915 364.1258,-399.0291 360.2273,-393.2152"/>
</g>
<!-- sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~m_simbox.f90</title>
<g id="a_sourcefile~~m_bd_solver.f90~~EfferentGraph_node16"><a xlink:href=".././sourcefile/m_simbox.f90.html" xlink:title="m_simbox.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="361,-383.8668 283,-383.8668 283,-359.8668 361,-359.8668 361,-383.8668"/>
<text text-anchor="middle" x="322" y="-369.4668" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_simbox.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_simbox.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M421.6288,-311.8684C406.516,-321.2024 384.9749,-334.4427 366,-345.8668 361.2491,-348.7272 356.1953,-351.7406 351.2698,-354.6619"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="349.4616,-351.6649 342.6354,-359.7676 353.0246,-357.6903 349.4616,-351.6649"/>
</g>
<!-- sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_strings.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_strings.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M524.734,-658.6455C513.435,-656.9212 501.0596,-655.0325 489.3719,-653.2489"/>
<polygon fill="#aaff00" stroke="#aaff00" points="489.7358,-649.764 479.3222,-651.7152 488.6797,-656.6838 489.7358,-649.764"/>
</g>
<!-- sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M531.7374,-652.7664C525.66,-649.166 519.9962,-644.6008 516,-638.8668 445.5209,-537.7383 520.9593,-480.1278 480,-363.8668 474.5564,-348.4153 465.0337,-332.6817 456.761,-320.681"/>
<polygon fill="#aaff00" stroke="#aaff00" points="459.4304,-318.3968 450.7668,-312.2982 453.7364,-322.4684 459.4304,-318.3968"/>
</g>
<!-- sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M529.8736,-676.8803C505.0107,-683.7908 471.0335,-690.3012 441,-685.8668"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M441,-685.8668C365.9453,-674.7851 234.7485,-461.0532 194.5496,-392.6985"/>
<polygon fill="#aaff00" stroke="#aaff00" points="197.5649,-390.9213 189.4966,-384.0545 191.5217,-394.454 197.5649,-390.9213"/>
</g>
<!-- sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M441,-685.8668C388.5898,-678.7669 374.1054,-694.9367 322,-685.8668"/>
</g>
<!-- sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_strings.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_strings.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M540.9028,-596.9185C521.9751,-606.1923 495.6081,-619.1111 474.7144,-629.3481"/>
<polygon fill="#00ff00" stroke="#00ff00" points="472.9862,-626.2973 465.5461,-633.8402 476.0661,-632.5833 472.9862,-626.2973"/>
</g>
<!-- sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M545.7505,-572.8377C535.3175,-565.4645 523.2135,-555.0989 516,-542.8668 474.779,-472.9675 509.5621,-439.4391 480,-363.8668 473.9564,-348.4171 464.2588,-332.4815 456.0461,-320.3763"/>
<polygon fill="#00ff00" stroke="#00ff00" points="458.7416,-318.1237 450.1403,-311.9375 453.0066,-322.1373 458.7416,-318.1237"/>
</g>
<!-- sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M521.7626,-585.362C496.8085,-587.2771 465.6835,-592.5271 441,-605.8668"/>
</g>
<!-- sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_simbox.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M546.8745,-572.7861C536.5409,-565.2592 524.1659,-554.7592 516,-542.8668 488.5501,-502.8905 513.0659,-475.3386 480,-439.8668 464.1649,-422.8795 409.2515,-401.4338 368.5883,-387.2173"/>
<polygon fill="#00ff00" stroke="#00ff00" points="369.7055,-383.9003 359.1107,-383.9435 367.42,-390.5167 369.7055,-383.9003"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M650.7522,-263.8859C605.3457,-271.675 536.6662,-283.4562 490.3842,-291.3954"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="489.5517,-287.9871 480.2874,-293.1275 490.7352,-294.8863 489.5517,-287.9871"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M694.5906,-267.9653C686.8164,-297.8301 662.823,-375.8172 615,-419.8668 597.5474,-435.9423 587.7041,-431.5007 565.5,-439.8668"/>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M565.5,-439.8668C513.3939,-459.4996 496.3725,-459.7304 441,-453.8668"/>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M441,-453.8668C388.4052,-448.2973 374.8669,-455.3932 322,-453.8668"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M441,-183.8668C388.1579,-186.0911 374.2585,-175.7255 322,-183.8668"/>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M693.828,-243.6825C685.1421,-217.3193 660.5645,-155.388 615,-130.8668 576.2545,-110.0153 557.9349,-117.5451 516,-130.8668 477.0994,-143.2246 481.7802,-182.1502 441,-183.8668"/>
</g>
<!-- sourcefile~m_ia_vdw.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~m_ia_vdw.f90</title>
<g id="a_sourcefile~~m_bd_solver.f90~~EfferentGraph_node11"><a xlink:href=".././sourcefile/m_ia_vdw.f90.html" xlink:title="m_ia_vdw.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="604,-491.8668 527,-491.8668 527,-467.8668 604,-467.8668 604,-491.8668"/>
<text text-anchor="middle" x="565.5" y="-477.4668" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_vdw.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_vdw.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_vdw.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M695.4009,-268.1118C689.0697,-301.7247 667.2847,-396.717 615,-453.8668 612.1252,-457.0092 608.7818,-459.8381 605.2148,-462.3688"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="603.2354,-459.4783 596.6017,-467.7394 606.9392,-465.4182 603.2354,-459.4783"/>
</g>
<!-- sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~m_cell_list.f90</title>
<g id="a_sourcefile~~m_bd_solver.f90~~EfferentGraph_node13"><a xlink:href=".././sourcefile/m_cell_list.f90.html" xlink:title="m_cell_list.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="605,-163.8668 526,-163.8668 526,-139.8668 605,-139.8668 605,-163.8668"/>
<text text-anchor="middle" x="565.5" y="-149.4668" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_cell_list.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_cell_list.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M688.0126,-243.6831C673.7713,-226.0684 645.2897,-193.3598 615,-172.8668 612.7578,-171.3498 610.3883,-169.907 607.9493,-168.5411"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="609.4141,-165.3593 598.9153,-163.936 606.235,-171.5958 609.4141,-165.3593"/>
</g>
<!-- sourcefile~m_ia_angle.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~m_ia_angle.f90</title>
<g id="a_sourcefile~~m_bd_solver.f90~~EfferentGraph_node14"><a xlink:href=".././sourcefile/m_ia_angle.f90.html" xlink:title="m_ia_angle.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="607.5,-205.8668 523.5,-205.8668 523.5,-181.8668 607.5,-181.8668 607.5,-205.8668"/>
<text text-anchor="middle" x="565.5" y="-191.4668" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_angle.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_angle.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_angle.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M674.2102,-243.8259C657.7832,-235.4482 635.1966,-224.1594 615,-214.8668 611.4289,-213.2237 607.6933,-211.553 603.9439,-209.9082"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="605.2494,-206.6595 594.6815,-205.9034 602.4713,-213.0846 605.2494,-206.6595"/>
</g>
<!-- sourcefile~m_ia_external.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~m_ia_external.f90</title>
<g id="a_sourcefile~~m_bd_solver.f90~~EfferentGraph_node15"><a xlink:href=".././sourcefile/m_ia_external.f90.html" xlink:title="m_ia_external.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="613.5,-327.8668 517.5,-327.8668 517.5,-303.8668 613.5,-303.8668 613.5,-327.8668"/>
<text text-anchor="middle" x="565.5" y="-313.4668" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_external.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_external.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_external.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M670.7878,-268.0087C650.8386,-277.0766 623.3599,-289.5668 601.4771,-299.5136"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="599.8278,-296.4186 592.1724,-303.743 602.7244,-302.7912 599.8278,-296.4186"/>
</g>
<!-- sourcefile~m_connectivity.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~m_connectivity.f90</title>
<g id="a_sourcefile~~m_bd_solver.f90~~EfferentGraph_node17"><a xlink:href=".././sourcefile/m_connectivity.f90.html" xlink:title="m_connectivity.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="615,-83.8668 516,-83.8668 516,-59.8668 615,-59.8668 615,-83.8668"/>
<text text-anchor="middle" x="565.5" y="-69.4668" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_connectivity.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_connectivity.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_connectivity.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M693.929,-243.6494C684.9904,-214.9103 659.1464,-142.1208 615,-97.8668 611.7897,-94.6486 608.0975,-91.7379 604.2072,-89.1297"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="605.8611,-86.0404 595.4844,-83.9014 602.2623,-92.0445 605.8611,-86.0404"/>
</g>
<!-- sourcefile~m_verlet.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~m_verlet.f90</title>
<g id="a_sourcefile~~m_bd_solver.f90~~EfferentGraph_node18"><a xlink:href=".././sourcefile/m_verlet.f90.html" xlink:title="m_verlet.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="600.5,-41.8668 530.5,-41.8668 530.5,-17.8668 600.5,-17.8668 600.5,-41.8668"/>
<text text-anchor="middle" x="565.5" y="-27.4668" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_verlet.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_verlet.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_verlet.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M695.8582,-243.4607C690.6114,-208.5145 671.1664,-108.0889 615,-50.8668 613.3529,-49.1888 611.5508,-47.6377 609.6401,-46.2048"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="611.0514,-42.9609 600.7112,-40.652 607.3547,-48.9052 611.0514,-42.9609"/>
</g>
<!-- sourcefile~m_ia_bond.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~m_ia_bond.f90</title>
<g id="a_sourcefile~~m_bd_solver.f90~~EfferentGraph_node19"><a xlink:href=".././sourcefile/m_ia_bond.f90.html" xlink:title="m_ia_bond.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="606.5,-533.8668 524.5,-533.8668 524.5,-509.8668 606.5,-509.8668 606.5,-533.8668"/>
<text text-anchor="middle" x="565.5" y="-519.4668" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_bond.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_bond.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_bond.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M694.0597,-267.9648C680.6464,-314.835 631.7753,-482.758 615,-500.8668 614.1079,-501.8299 613.1644,-502.7505 612.1779,-503.6304"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="609.9632,-500.9127 603.911,-509.6088 614.0652,-506.5849 609.9632,-500.9127"/>
</g>
<!-- sourcefile~m_ia_tether.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~m_ia_tether.f90</title>
<g id="a_sourcefile~~m_bd_solver.f90~~EfferentGraph_node20"><a xlink:href=".././sourcefile/m_ia_tether.f90.html" xlink:title="m_ia_tether.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="608,-410.8668 523,-410.8668 523,-386.8668 608,-386.8668 608,-410.8668"/>
<text text-anchor="middle" x="565.5" y="-396.4668" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_tether.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_tether.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_tether.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M686.2458,-268.0589C663.353,-292.8594 611.1936,-349.3654 583.5198,-379.3454"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="580.9368,-376.9835 576.7258,-386.7056 586.0804,-381.7315 580.9368,-376.9835"/>
</g>
<!-- sourcefile~m_ia_dihedral.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~m_ia_dihedral.f90</title>
<g id="a_sourcefile~~m_bd_solver.f90~~EfferentGraph_node21"><a xlink:href=".././sourcefile/m_ia_dihedral.f90.html" xlink:title="m_ia_dihedral.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="613.5,-247.8668 517.5,-247.8668 517.5,-223.8668 613.5,-223.8668 613.5,-247.8668"/>
<text text-anchor="middle" x="565.5" y="-233.4668" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_dihedral.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_dihedral.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_dihedral.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M650.9617,-248.8156C642.2251,-247.4918 632.9889,-246.0924 623.9444,-244.722"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="624.2627,-241.2304 613.8512,-243.1928 623.214,-248.1514 624.2627,-241.2304"/>
</g>
<!-- sourcefile~m_constants_math.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~m_constants_math.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M161.0859,-359.6962C137.652,-346.3777 99.9123,-324.9285 73.5274,-309.9327"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="75.1338,-306.82 64.7104,-304.9216 71.6749,-312.9057 75.1338,-306.82"/>
</g>
<!-- sourcefile~m_ran_num.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~m_ran_num.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M139.2815,-279.0853C125.9425,-281.0046 111.0889,-283.1418 97.1364,-285.1494"/>
<polygon fill="#0000ff" stroke="#0000ff" points="96.5701,-281.6947 87.1705,-286.5833 97.5671,-288.6233 96.5701,-281.6947"/>
</g>
<!-- sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M554.7741,-467.832C544.4029,-455.9773 528.47,-437.1798 516,-419.8668 509.4004,-410.7041 473.5974,-352.81 453.941,-320.9051"/>
<polygon fill="#ff0000" stroke="#ff0000" points="456.859,-318.9688 448.6356,-312.2885 450.8983,-322.6389 456.859,-318.9688"/>
</g>
<!-- sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M526.8449,-469.7032C502.4236,-463.8045 470.0945,-456.9478 441,-453.8668"/>
</g>
<!-- sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_logger.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M322,-491.8668C291.3966,-489.6842 256.9205,-489.6617 229.8988,-490.196"/>
<polygon fill="#ff0000" stroke="#ff0000" points="229.4752,-486.7047 219.5586,-490.4344 229.6366,-493.7029 229.4752,-486.7047"/>
</g>
<!-- sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M322,-491.8668C272.7328,-488.3531 161.3945,-423.9387 123,-392.8668 94.7902,-370.0372 70.1638,-335.5386 56.0644,-313.6142"/>
<polygon fill="#ff0000" stroke="#ff0000" points="58.9716,-311.6623 50.6866,-305.0585 53.0451,-315.3875 58.9716,-311.6623"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M526.9999,-485.5953C478.8971,-491.8725 394.1276,-500.0335 322,-491.8668"/>
</g>
<!-- sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_logger.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M300.5088,-425.8834C277.1274,-438.9569 239.5551,-459.965 213.0984,-474.758"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="211.2656,-471.7728 204.2454,-479.7081 214.6818,-477.8826 211.2656,-471.7728"/>
</g>
<!-- sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M292.1317,-401.7075C287.2004,-399.121 282.3002,-396.1613 278,-392.8668 258.4836,-377.915 260.56,-366.9904 242,-350.8668 218.3126,-330.289 213.0227,-320.1404 182.5,-312.8668"/>
</g>
<!-- sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M529.2253,-163.9339C524.4748,-166.4365 519.9079,-169.3945 516,-172.8668 491.8924,-194.287 496.3923,-208.0947 480,-235.8668 471.4619,-250.3321 461.6176,-266.4831 453.9555,-278.9413"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="450.8492,-277.3104 448.5794,-287.6593 456.8075,-280.9847 450.8492,-277.3104"/>
</g>
<!-- sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M533.8136,-163.9305C508.9788,-172.4205 473.3312,-182.5059 441,-183.8668"/>
</g>
<!-- sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~m_vector.f90</title>
<g id="a_sourcefile~~m_bd_solver.f90~~EfferentGraph_node22"><a xlink:href=".././sourcefile/m_vector.f90.html" xlink:title="m_vector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="358.5,-128.8668 285.5,-128.8668 285.5,-104.8668 358.5,-104.8668 358.5,-128.8668"/>
<text text-anchor="middle" x="322" y="-114.4668" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_vector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_vector.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M525.8356,-146.1656C482.862,-139.9887 414.3496,-130.1409 368.78,-123.5908"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="369.2516,-120.1227 358.8553,-122.1643 368.2556,-127.0515 369.2516,-120.1227"/>
</g>
<!-- sourcefile~m_ia_angle.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~m_ia_angle.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M531.3931,-205.9378C526.0197,-208.5059 520.6953,-211.4826 516,-214.8668 491.0535,-232.8473 468.6189,-260.5449 454.9237,-279.3991"/>
<polygon fill="#5cff00" stroke="#5cff00" points="452.0257,-277.4352 449.0992,-287.6178 457.7369,-281.4826 452.0257,-277.4352"/>
</g>
<!-- sourcefile~m_ia_angle.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~m_ia_angle.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M523.4053,-199.4635C498.7182,-203.6849 467.3105,-210.7075 441,-221.8668"/>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M441,-221.8668C394.3106,-241.6696 408.0113,-279.4573 366,-307.8668 331.2558,-331.3621 286.985,-347.1304 250.6325,-357.1358"/>
<polygon fill="#5cff00" stroke="#5cff00" points="249.3662,-353.8509 240.6037,-359.8066 251.1677,-360.6152 249.3662,-353.8509"/>
</g>
<!-- sourcefile~m_ia_angle.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~m_ia_angle.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M523.4801,-187.9259C499.3701,-185.1607 468.5146,-182.7086 441,-183.8668"/>
</g>
<!-- sourcefile~m_ia_external.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~m_ia_external.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M517.365,-309.6808C508.4162,-308.5307 499.0565,-307.3279 490.0797,-306.1742"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="490.5142,-302.7014 480.1497,-304.8981 489.6219,-309.6443 490.5142,-302.7014"/>
</g>
<!-- sourcefile~m_ia_external.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~m_ia_external.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M322,-453.8668C273.0864,-452.8315 226.1645,-415.2565 201.1609,-391.3355"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="203.4155,-388.6432 193.8383,-384.1124 198.4997,-393.6267 203.4155,-388.6432"/>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M517.4397,-319.806C482.0658,-324.9327 434.6451,-336.7286 402,-363.8668 374.7932,-386.4841 391.7765,-410.632 366,-434.8668 350.481,-449.4576 343.2961,-454.3176 322,-453.8668"/>
</g>
<!-- sourcefile~m_ia_external.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~m_ia_external.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M544.1691,-303.7131C527.3448,-294.8613 502.9651,-283.6228 480,-278.8668 446.0536,-271.8367 436.5179,-275.6587 402,-278.8668 365.9801,-282.2145 358.1733,-294.2327 322,-293.8668"/>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M322,-293.8668C259.4648,-291.7078 243.368,-327.3718 182.5,-312.8668"/>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M182.5,-312.8668C154.6537,-306.231 123.1108,-301.475 97.12,-298.2704"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="97.4286,-294.7825 87.0848,-297.0755 96.6008,-301.7334 97.4286,-294.7825"/>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M282.7702,-371.8668C273.1823,-371.8668 262.6358,-371.8668 252.0942,-371.8668"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="252.0202,-368.3669 242.0201,-371.8668 252.0201,-375.3669 252.0202,-368.3669"/>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_ran_num.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_ran_num.f90</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M311.0803,-359.6789C296.5369,-344.0035 269.4402,-316.6814 242,-298.8668 236.6017,-295.3621 230.6518,-292.1275 224.6648,-289.2167"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="225.8486,-285.909 215.3002,-284.9171 222.9277,-292.2705 225.8486,-285.909"/>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M299.5947,-359.6252C272.6774,-345.5813 225.7294,-323.1684 182.5,-312.8668"/>
</g>
<!-- sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M553.0103,-83.9637C541.9828,-95.2295 526.127,-112.9386 516,-130.8668 491.7368,-173.8212 500.959,-191.207 480,-235.8668 472.9519,-250.885 463.2504,-266.8189 455.2868,-279.0311"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="452.2328,-277.3029 449.6085,-287.5676 458.0612,-281.1798 452.2328,-277.3029"/>
</g>
<!-- sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M441,-107.8668C381.2797,-127.1452 384.0069,-174.2068 322,-183.8668"/>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M322,-183.8668C260.739,-193.4106 238.3183,-156.8795 182.5,-183.8668"/>
</g>
<!-- sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_vector.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M521.5102,-83.874C497.5907,-90.5817 467.5509,-99.2959 441,-107.8668"/>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M441,-107.8668C417.9363,-115.3121 391.104,-117.8324 368.7626,-118.3742"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="368.4768,-114.8772 358.5186,-118.4943 368.559,-121.8767 368.4768,-114.8772"/>
</g>
<!-- sourcefile~m_table.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~m_table.f90</title>
<g id="a_sourcefile~~m_bd_solver.f90~~EfferentGraph_node23"><a xlink:href=".././sourcefile/m_table.f90.html" xlink:title="m_table.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="474.5,-79.8668 407.5,-79.8668 407.5,-55.8668 474.5,-55.8668 474.5,-79.8668"/>
<text text-anchor="middle" x="441" y="-65.4668" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_table.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_table.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_table.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M515.9366,-70.2744C505.6696,-69.9446 494.9218,-69.5992 484.8754,-69.2765"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="484.8167,-65.7729 474.7094,-68.9499 484.5919,-72.7693 484.8167,-65.7729"/>
</g>
<!-- sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M530.3316,-39.6192C524.8907,-42.4776 519.8196,-46.152 516,-50.8668 463.2722,-115.9534 510.2701,-157.763 480,-235.8668 474.0049,-251.3355 464.3075,-267.2711 456.0828,-279.3716"/>
<polygon fill="#002eff" stroke="#002eff" points="453.0436,-277.6095 450.166,-287.8061 458.7742,-281.6295 453.0436,-277.6095"/>
</g>
<!-- sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M441,-27.8668C324.8977,-41.7944 273.3489,-3.2448 182.5,-76.8668"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M182.5,-76.8668C157.383,-95.2751 143.4448,-90.3777 123,-113.8668 81.5253,-161.5173 58.3788,-234.2778 48.8014,-270.6081"/>
<polygon fill="#002eff" stroke="#002eff" points="45.3217,-270.092 46.2595,-280.6453 52.1074,-271.8106 45.3217,-270.092"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M530.3308,-25.7356C505.2359,-23.6519 470.7947,-22.5558 441,-27.8668"/>
</g>
<!-- sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_vector.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M441,-27.8668C396.548,-33.1992 357.6787,-72.2003 337.2503,-96.7726"/>
<polygon fill="#002eff" stroke="#002eff" points="334.349,-94.7956 330.8146,-104.7835 339.8062,-99.1796 334.349,-94.7956"/>
</g>
<!-- sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_table.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_table.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M530.4885,-40.5531C516.2109,-44.9109 499.5519,-49.9955 484.5047,-54.5883"/>
<polygon fill="#002eff" stroke="#002eff" points="483.433,-51.2559 474.8904,-57.5228 485.4766,-57.951 483.433,-51.2559"/>
</g>
<!-- sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_strings.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_strings.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M548.8085,-534.0053C538.6555,-541.8583 525.8013,-552.675 516,-563.8668 496.5065,-586.1258 500.7469,-598.7713 480,-619.8668 477.1916,-622.7224 474.0215,-625.441 470.7326,-627.9698"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="468.589,-625.199 462.4507,-633.8345 472.6344,-630.9117 468.589,-625.199"/>
</g>
<!-- sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M526.8599,-509.8139C522.8033,-507.3486 519.054,-504.3966 516,-500.8668 474.8075,-453.2577 504.6393,-421.8009 480,-363.8668 473.5072,-348.6004 463.8079,-332.6655 455.7065,-320.5149"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="458.4388,-318.3101 449.9025,-312.0346 452.6622,-322.2637 458.4388,-318.3101"/>
</g>
<!-- sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M535.0435,-509.8446C528.6646,-507.0779 522.0429,-504.0168 516,-500.8668 481.117,-482.6836 480.119,-458.0093 441,-453.8668"/>
</g>
<!-- sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_logger.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M524.4651,-520.744C468.6002,-518.9507 365.5385,-514.701 278,-505.8668 262.2863,-504.281 245.1985,-501.9653 229.8783,-499.672"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="230.0076,-496.1511 219.593,-498.0972 228.9481,-503.0704 230.0076,-496.1511"/>
</g>
<!-- sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M441,-605.8668C424.0377,-615.0338 418.4132,-614.7496 402,-624.8668 363.9376,-648.3287 366.55,-682.0576 322,-685.8668"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M322,-685.8668C138.8099,-701.5304 64.8586,-400.4104 47.6308,-315.0855"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="51.0428,-314.2961 45.6879,-305.1541 44.173,-315.6401 51.0428,-314.2961"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M549.6294,-534.071C526.5692,-551.4498 482.0603,-583.6766 441,-605.8668"/>
</g>
<!-- sourcefile~m_ia_tether.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~m_ia_tether.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M539.2273,-386.853C531.4706,-382.8401 523.1493,-378.055 516,-372.8668 494.335,-357.1446 472.7677,-335.3426 458.3603,-319.665"/>
<polygon fill="#e700ff" stroke="#e700ff" points="460.8172,-317.1634 451.5163,-312.0895 455.623,-321.856 460.8172,-317.1634"/>
</g>
<!-- sourcefile~m_ia_tether.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~m_ia_tether.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M441,-377.8668C399.3431,-373.6724 402.15,-413.7465 366,-434.8668 347.608,-445.6122 343.2961,-454.3176 322,-453.8668"/>
</g>
<!-- sourcefile~m_ia_tether.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~m_ia_tether.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M522.7645,-390.2078C498.8267,-385.7235 468.3711,-380.6228 441,-377.8668"/>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M441,-377.8668C376.5877,-371.3812 386.6995,-296.1005 322,-293.8668"/>
</g>
<!-- sourcefile~m_ia_dihedral.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~m_ia_dihedral.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M542.0825,-247.9047C522.8159,-257.8089 495.2861,-271.9607 473.8205,-282.9952"/>
<polygon fill="#ff008b" stroke="#ff008b" points="472.0293,-279.9806 464.7358,-287.6653 475.2297,-286.2062 472.0293,-279.9806"/>
</g>
<!-- sourcefile~m_ia_dihedral.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~m_ia_dihedral.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M533.8071,-223.8622C507.8666,-215.9855 470.7359,-209.2547 441,-221.8668"/>
</g>
<!-- sourcefile~m_ia_dihedral.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~m_ia_dihedral.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M537.0014,-223.7904C500.6502,-208.4111 442.2872,-183.8126 441,-183.8668"/>
</g>
<!-- sourcefile~m_vector.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~m_vector.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M297.5331,-128.9024C281.7167,-136.6559 260.6731,-146.9221 242,-155.8668 215.6418,-168.4928 208.8123,-171.1453 182.5,-183.8668"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M182.5,-183.8668C134.6671,-206.9933 87.9146,-248.7398 62.6877,-273.312"/>
<polygon fill="#ff0000" stroke="#ff0000" points="59.9269,-271.1199 55.2794,-280.6411 64.85,-276.0962 59.9269,-271.1199"/>
</g>
<!-- sourcefile~m_qsort.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~m_qsort.f90</title>
<g id="a_sourcefile~~m_bd_solver.f90~~EfferentGraph_node24"><a xlink:href=".././sourcefile/m_qsort.f90.html" xlink:title="m_qsort.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="216.5,-146.8668 148.5,-146.8668 148.5,-122.8668 216.5,-122.8668 216.5,-146.8668"/>
<text text-anchor="middle" x="182.5" y="-132.4668" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_qsort.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_vector.f90&#45;&gt;sourcefile~m_qsort.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~m_vector.f90&#45;&gt;sourcefile~m_qsort.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M285.348,-121.5961C267.3664,-123.9163 245.5643,-126.7295 226.6694,-129.1675"/>
<polygon fill="#ff0000" stroke="#ff0000" points="225.9839,-125.7269 216.514,-130.4779 226.8797,-132.6693 225.9839,-125.7269"/>
</g>
<!-- sourcefile~m_table.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~m_table.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M407.4081,-58.1194C354.0963,-44.8342 249.3251,-27.8904 182.5,-76.8668"/>
</g>
<!-- sourcefile~m_table.f90&#45;&gt;sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~m_table.f90&#45;&gt;sourcefile~m_vector.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M411.5843,-79.9792C396.28,-86.2809 377.3721,-94.0665 360.8773,-100.8585"/>
<polygon fill="#00ffff" stroke="#00ffff" points="359.4039,-97.68 351.4898,-104.724 362.0692,-104.1528 359.4039,-97.68"/>
</g>
<!-- sourcefile~m_qsort.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~m_qsort.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M156.0998,-146.9718C145.0638,-152.8574 132.6023,-160.6603 123,-169.8668 91.4279,-200.1377 66.3893,-245.2658 53.3596,-271.6156"/>
<polygon fill="#ff0000" stroke="#ff0000" points="50.1578,-270.1973 48.9652,-280.7248 56.4625,-273.2388 50.1578,-270.1973"/>
</g>
</g>
</svg>
</div><script>var pansourcefilem_bd_solverf90EfferentGraph = svgPanZoom('#sourcefilem_bd_solverf90EfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_bd_solver.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilem_bd_solverf90AfferentGraph" width="294pt" height="52pt"
 viewBox="0.00 0.00 294.00 52.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_bd_solver.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 48)">
<title>sourcefile~~m_bd_solver.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-48 290,-48 290,4 -4,4"/>
<!-- sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~m_bd_solver.f90</title>
<polygon fill="none" stroke="#000000" points="90,-44 0,-44 0,-20 90,-20 90,-44"/>
<text text-anchor="middle" x="45" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_bd_solver.f90</text>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~m_bd_solver.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="286,-44 232,-44 232,-20 286,-20 286,-44"/>
<text text-anchor="middle" x="259" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_bd_solver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M231.7124,-32.5275C220.6304,-32.7172 207.7042,-32.9071 196,-33 164.8899,-33.2469 157.1105,-33.192 126,-33 117.8015,-32.9494 109.1366,-32.87 100.6427,-32.7775"/>
<polygon fill="#ff0000" stroke="#ff0000" points="100.4496,-29.2751 90.4098,-32.6593 100.3687,-36.2747 100.4496,-29.2751"/>
</g>
<!-- sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~m_setup.f90</title>
<g id="a_sourcefile~~m_bd_solver.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/m_setup.f90.html" xlink:title="m_setup.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="196,-24 126,-24 126,0 196,0 196,-24"/>
<text text-anchor="middle" x="161" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_setup.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M231.9616,-26.482C223.8936,-24.8354 214.824,-22.9845 205.9341,-21.1702"/>
<polygon fill="#00ffff" stroke="#00ffff" points="206.5344,-17.7207 196.0365,-19.1503 205.1346,-24.5793 206.5344,-17.7207"/>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_bd_solver.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_bd_solver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M125.8814,-18.0549C117.8294,-19.4432 109.0767,-20.9523 100.4017,-22.448"/>
<polygon fill="#ff0000" stroke="#ff0000" points="99.5602,-19.0414 90.3003,-24.1896 100.7496,-25.9396 99.5602,-19.0414"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_bd_solver.html">m_bd_solver</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_bd_solver.f90.html#src">m_bd_solver.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">module </span><span class="n">m_bd_solver</span>
<a name="ln-2"></a>    <span class="c">!! Routines implementing Brownian Dynamics (BD) solver.</span>
<a name="ln-3"></a>
<a name="ln-4"></a><span class="k">use </span><span class="nb">iso_c_binding</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="nb">c_loc</span><span class="p">,</span> <span class="kt">c_ptr</span><span class="p">,</span> <span class="nb">c_f_pointer</span>
<a name="ln-5"></a>
<a name="ln-6"></a><span class="k">use </span><span class="n">blas95</span>
<a name="ln-7"></a><span class="k">use </span><span class="n">lapack95</span>
<a name="ln-8"></a><span class="k">use </span><span class="n">f95_precision</span>
<a name="ln-9"></a>
<a name="ln-10"></a><span class="k">use </span><span class="n">m_precision</span>
<a name="ln-11"></a><span class="k">use </span><span class="n">m_constants_math</span>
<a name="ln-12"></a><span class="k">use </span><span class="n">m_strings</span>
<a name="ln-13"></a><span class="k">use </span><span class="n">m_ran_num</span>
<a name="ln-14"></a><span class="k">use </span><span class="n">m_globals</span>
<a name="ln-15"></a><span class="k">use </span><span class="n">m_interaction</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">ia_calc_forces</span>
<a name="ln-16"></a><span class="k">use </span><span class="n">m_stats_io</span>
<a name="ln-17"></a><span class="k">use </span><span class="n">m_config_io</span>
<a name="ln-18"></a><span class="k">use </span><span class="n">m_logger</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">logger</span> <span class="o">=&gt;</span> <span class="n">master_logger</span>
<a name="ln-19"></a>
<a name="ln-20"></a><span class="k">implicit none</span>
<a name="ln-21"></a>
<a name="ln-22"></a><span class="k">private</span>
<a name="ln-23"></a>
<a name="ln-24"></a><span class="k">public</span> <span class="kd">::</span> <span class="n">bds_init</span><span class="p">,</span> <span class="n">bds_run</span><span class="p">,</span> <span class="n">bds_finish</span>
<a name="ln-25"></a>
<a name="ln-26"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span>   <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">drift</span>
<a name="ln-27"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span>   <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">diffusion</span>
<a name="ln-28"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">mobility</span>
<a name="ln-29"></a>
<a name="ln-30"></a><span class="k">contains</span>
<a name="ln-31"></a> 
<a name="ln-32"></a><span class="c">!*******************************************************************************</span>
<a name="ln-33"></a> 
<a name="ln-34"></a><span class="k">subroutine </span><span class="n">bds_init</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-35"></a>    <span class="c">!! Initializes the BD solver.</span>
<a name="ln-36"></a>
<a name="ln-37"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-38"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lexists</span>
<a name="ln-39"></a>
<a name="ln-40"></a>    <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-41"></a>
<a name="ln-42"></a>    <span class="c">!Allocate memory for BD integration</span>
<a name="ln-43"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">drift</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">num_atoms</span><span class="p">))</span>
<a name="ln-44"></a>    <span class="n">drift</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-45"></a>
<a name="ln-46"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">diffusion</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">num_atoms</span><span class="p">))</span>
<a name="ln-47"></a>    <span class="n">diffusion</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-48"></a>
<a name="ln-49"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">lhdia</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-50"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">mobility</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">num_atoms</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">num_atoms</span><span class="p">))</span>
<a name="ln-51"></a>        <span class="n">mobility</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-52"></a>    <span class="k">end if</span>
<a name="ln-53"></a>
<a name="ln-54"></a>    <span class="c">!Opening trajectory file</span>
<a name="ln-55"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">write_traj</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-56"></a><span class="k">        if</span> <span class="p">(</span> <span class="n">lrevive</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-57"></a>            <span class="c">!Append (write) to existing (new) trajectory file</span>
<a name="ln-58"></a>            <span class="c">!Check if trajectory file exists</span>
<a name="ln-59"></a>            <span class="k">inquire</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="n">fn_traj</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="n">exist</span><span class="o">=</span><span class="n">lexists</span><span class="p">)</span>
<a name="ln-60"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">lexists</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-61"></a>                <span class="c">!Open existing file for appending</span>
<a name="ln-62"></a>                <span class="k">call </span><span class="n">traj</span><span class="p">%</span><span class="k">open</span><span class="p">(</span><span class="n">fn_traj</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="s1">&#39;rw&#39;</span><span class="p">,</span> <span class="n">ierr</span><span class="p">)</span>
<a name="ln-63"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-64"></a><span class="k">            else</span>
<a name="ln-65"></a>                <span class="c">!Create new trajectory file</span>
<a name="ln-66"></a>                <span class="k">call </span><span class="n">traj</span><span class="p">%</span><span class="n">create</span><span class="p">(</span><span class="n">fn_traj</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="n">num_atoms</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">traj_frmcmp</span><span class="p">)</span>
<a name="ln-67"></a>            <span class="k">end if</span>
<a name="ln-68"></a><span class="k">        else</span>
<a name="ln-69"></a>            <span class="c">!Create new trajectory file</span>
<a name="ln-70"></a>            <span class="k">call </span><span class="n">traj</span><span class="p">%</span><span class="n">create</span><span class="p">(</span><span class="n">fn_traj</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)),</span> <span class="n">num_atoms</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">traj_frmcmp</span><span class="p">)</span>
<a name="ln-71"></a>        <span class="k">end if</span>
<a name="ln-72"></a><span class="k">    end if</span>
<a name="ln-73"></a>
<a name="ln-74"></a><span class="k">    end subroutine</span>
<a name="ln-75"></a>
<a name="ln-76"></a><span class="c">!******************************************************************************</span>
<a name="ln-77"></a>
<a name="ln-78"></a><span class="k">subroutine </span><span class="n">bds_finish</span><span class="p">()</span>
<a name="ln-79"></a>    <span class="c">!! Clears up memory allocated in [[bds_init]].</span>
<a name="ln-80"></a>
<a name="ln-81"></a>    <span class="k">call </span><span class="n">traj</span><span class="p">%</span><span class="k">close</span><span class="p">()</span>
<a name="ln-82"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">drift</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">drift</span><span class="p">)</span>
<a name="ln-83"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">diffusion</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">diffusion</span><span class="p">)</span>
<a name="ln-84"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">mobility</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">mobility</span><span class="p">)</span>
<a name="ln-85"></a>
<a name="ln-86"></a>    <span class="k">end subroutine</span>
<a name="ln-87"></a>
<a name="ln-88"></a><span class="c">!******************************************************************************</span>
<a name="ln-89"></a>
<a name="ln-90"></a><span class="k">subroutine </span><span class="n">bds_run</span><span class="p">()</span>
<a name="ln-91"></a>    <span class="c">!! Driver for BD integrator.</span>
<a name="ln-92"></a>    <span class="c">!!</span>
<a name="ln-93"></a>    <span class="c">!! Repeatedly calls [[bds_integrate_fd]] or [[bds_integrate_hi]] to update</span>
<a name="ln-94"></a>    <span class="c">!! atom positions.</span>
<a name="ln-95"></a>
<a name="ln-96"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">com</span>
<a name="ln-97"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">flow_style_</span>
<a name="ln-98"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-99"></a>
<a name="ln-100"></a>    <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-101"></a>
<a name="ln-102"></a>    <span class="c">!For isolated untethered molecule, ensure c.o.m. is at the center of the</span>
<a name="ln-103"></a>    <span class="c">!box.</span>
<a name="ln-104"></a>    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">num_tethers</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">imcon</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-105"></a><span class="k">        call </span><span class="n">simbox</span><span class="p">%</span><span class="n">to_center</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
<a name="ln-106"></a>    <span class="k">end if</span>
<a name="ln-107"></a>
<a name="ln-108"></a>    <span class="c">!Log &amp; dump starting configuration</span>
<a name="ln-109"></a>    <span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;bds_run&#39;</span><span class="p">,</span> <span class="s1">&#39; nts: &#39;</span><span class="o">//</span><span class="n">str_from_num</span><span class="p">(</span><span class="n">nts</span><span class="p">))</span>
<a name="ln-110"></a>    <span class="k">call </span><span class="n">write_dump</span><span class="p">(</span><span class="n">fn_revive</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)))</span>
<a name="ln-111"></a>
<a name="ln-112"></a>    <span class="c">!Equilibration run. This is done under free-draining condition.</span>
<a name="ln-113"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">leql</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-114"></a>        <span class="c">!Turn off flow during equilibration</span>
<a name="ln-115"></a>        <span class="n">flow_style_</span> <span class="o">=</span> <span class="n">flow_style</span>
<a name="ln-116"></a>        <span class="n">flow_style</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-117"></a>
<a name="ln-118"></a>        <span class="k">do while</span> <span class="p">(</span><span class="n">nts</span> <span class="o">&lt;</span> <span class="n">nts_eql</span><span class="p">)</span>
<a name="ln-119"></a>            <span class="k">call </span><span class="n">bds_integrate_fd</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-120"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-121"></a><span class="k">            </span><span class="n">nts</span> <span class="o">=</span> <span class="n">nts</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-122"></a>
<a name="ln-123"></a>            <span class="c">!Apply boundary conditions: For isolated untethered molecule,</span>
<a name="ln-124"></a>            <span class="c">!bring c.o.m. to the origin. No need to update molecule_com during</span>
<a name="ln-125"></a>            <span class="c">!equilibration.</span>
<a name="ln-126"></a>            <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">num_tethers</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">imcon</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-127"></a><span class="k">                call </span><span class="n">simbox</span><span class="p">%</span><span class="n">to_center</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
<a name="ln-128"></a>            <span class="k">end if</span>
<a name="ln-129"></a>
<a name="ln-130"></a>            <span class="c">!For PBC, wrap atom positions</span>
<a name="ln-131"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">imcon</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">simbox</span><span class="p">%</span><span class="n">wrap_all</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
<a name="ln-132"></a>
<a name="ln-133"></a>            <span class="c">!Logging</span>
<a name="ln-134"></a>            <span class="k">if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span><span class="n">nts_log</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-135"></a><span class="k">                call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;bds_run&#39;</span><span class="p">,</span> <span class="s1">&#39; nts: &#39;</span><span class="o">//</span><span class="n">str_from_num</span><span class="p">(</span><span class="n">nts</span><span class="p">))</span>
<a name="ln-136"></a>            <span class="k">end if</span>
<a name="ln-137"></a>
<a name="ln-138"></a>            <span class="c">!Dump revive file</span>
<a name="ln-139"></a>            <span class="k">if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span><span class="n">nts_dump</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-140"></a><span class="k">                call </span><span class="n">write_dump</span><span class="p">(</span><span class="n">fn_revive</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)))</span>
<a name="ln-141"></a>            <span class="k">end if</span>
<a name="ln-142"></a>
<a name="ln-143"></a>            <span class="c">!Equilibration stats</span>
<a name="ln-144"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">write_eql_stats</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-145"></a><span class="k">                if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span><span class="n">nts_eql_samp</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">stats_write</span><span class="p">()</span>
<a name="ln-146"></a>            <span class="k">end if</span>
<a name="ln-147"></a><span class="k">        end do</span>
<a name="ln-148"></a><span class="k">        call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;finish_equil_run&#39;</span><span class="p">,</span> <span class="s1">&#39;Equilibration completed&#39;</span><span class="p">)</span>
<a name="ln-149"></a>        <span class="k">call </span><span class="n">stats_finish</span><span class="p">()</span>
<a name="ln-150"></a>        <span class="k">call </span><span class="n">write_dump</span><span class="p">(</span><span class="n">fn_revive</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)))</span>
<a name="ln-151"></a>        <span class="n">leql</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-152"></a>        <span class="n">nts</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-153"></a>        <span class="c">!Turn flow back on</span>
<a name="ln-154"></a>        <span class="n">flow_style</span> <span class="o">=</span> <span class="n">flow_style_</span>
<a name="ln-155"></a>        <span class="c">!If continue on to production run, create new stats file.</span>
<a name="ln-156"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">nts_sim</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">stats_init</span><span class="p">()</span>
<a name="ln-157"></a>    <span class="k">end if</span>
<a name="ln-158"></a>
<a name="ln-159"></a>    <span class="c">!Production run.</span>
<a name="ln-160"></a>    <span class="k">do while</span> <span class="p">(</span><span class="n">nts</span> <span class="o">&lt;</span> <span class="n">nts_sim</span><span class="p">)</span>
<a name="ln-161"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">lhdia</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-162"></a><span class="k">            call </span><span class="n">bds_integrate_hi</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-163"></a>        <span class="k">else</span>
<a name="ln-164"></a><span class="k">            call </span><span class="n">bds_integrate_fd</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-165"></a>        <span class="k">end if</span>
<a name="ln-166"></a><span class="k">        if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-167"></a><span class="k">        </span><span class="n">nts</span> <span class="o">=</span> <span class="n">nts</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-168"></a>
<a name="ln-169"></a>        <span class="c">!Apply boundary conditions: For isolated untethered molecule,</span>
<a name="ln-170"></a>        <span class="c">!update molecule_com &amp; bring c.o.m. to the center of the box.</span>
<a name="ln-171"></a>        <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">num_tethers</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">imcon</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-172"></a><span class="k">            call </span><span class="n">simbox</span><span class="p">%</span><span class="n">to_center</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">com</span><span class="p">)</span>
<a name="ln-173"></a>            <span class="n">molecule_com</span> <span class="o">=</span> <span class="n">molecule_com</span> <span class="o">+</span> <span class="n">com</span>
<a name="ln-174"></a>        <span class="k">end if</span>
<a name="ln-175"></a>
<a name="ln-176"></a>        <span class="c">!For PBC, wrap atom positions</span>
<a name="ln-177"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">imcon</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">simbox</span><span class="p">%</span><span class="n">wrap_all</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
<a name="ln-178"></a>
<a name="ln-179"></a>        <span class="c">!Logging</span>
<a name="ln-180"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span><span class="n">nts_log</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-181"></a><span class="k">            call </span><span class="n">logger</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;bds_run&#39;</span><span class="p">,</span> <span class="s1">&#39; nts: &#39;</span><span class="o">//</span><span class="n">str_from_num</span><span class="p">(</span><span class="n">nts</span><span class="p">))</span>
<a name="ln-182"></a>        <span class="k">end if</span>
<a name="ln-183"></a>
<a name="ln-184"></a>        <span class="c">!Dump revive file</span>
<a name="ln-185"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span><span class="n">nts_dump</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-186"></a><span class="k">            call </span><span class="n">write_dump</span><span class="p">(</span><span class="n">fn_revive</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)))</span>
<a name="ln-187"></a>        <span class="k">end if</span>
<a name="ln-188"></a>
<a name="ln-189"></a><span class="k">        if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span><span class="n">nts_samp</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-190"></a>            <span class="c">!Write stats</span>
<a name="ln-191"></a>            <span class="k">call </span><span class="n">stats_write</span><span class="p">()</span>
<a name="ln-192"></a>            <span class="c">!Write traj</span>
<a name="ln-193"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">write_traj</span><span class="p">)</span> <span class="k">call </span><span class="n">traj</span><span class="p">%</span><span class="n">append_frame</span><span class="p">(</span><span class="n">nts</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-194"></a>                <span class="n">velocities</span><span class="p">,</span> <span class="n">forces</span><span class="p">,</span> <span class="n">charge</span><span class="p">)</span>
<a name="ln-195"></a>        <span class="k">end if</span>
<a name="ln-196"></a><span class="k">    end do</span>
<a name="ln-197"></a>    <span class="c">!Dump the final configuration</span>
<a name="ln-198"></a>    <span class="k">call </span><span class="n">write_dump</span><span class="p">(</span><span class="n">fn_revive</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">job_tag</span><span class="p">)))</span>
<a name="ln-199"></a>
<a name="ln-200"></a>    <span class="k">end subroutine</span>
<a name="ln-201"></a>
<a name="ln-202"></a><span class="c">!******************************************************************************</span>
<a name="ln-203"></a>
<a name="ln-204"></a><span class="k">subroutine </span><span class="n">bds_integrate_fd</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-205"></a>    <span class="c">!! Performs one step of free-draining BD integeration.</span>
<a name="ln-206"></a>
<a name="ln-207"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-208"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">fptr_forces</span>
<a name="ln-209"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cptr_forces</span>
<a name="ln-210"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sqrt_two_dt</span>
<a name="ln-211"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">nb</span>
<a name="ln-212"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-213"></a>
<a name="ln-214"></a>    <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-215"></a>    <span class="n">drift</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">diffusion</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-216"></a>    <span class="n">sqrt_two_dt</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">tim_stp</span><span class="p">)</span>
<a name="ln-217"></a>    <span class="n">nb</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-218"></a>
<a name="ln-219"></a>    <span class="c">!Update forces</span>
<a name="ln-220"></a>    <span class="k">call </span><span class="n">ia_calc_forces</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-221"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-222"></a>
<a name="ln-223"></a>    <span class="c">!Calculate ambient flow velocity at the atom locations and store it in</span>
<a name="ln-224"></a>    <span class="c">!module variable `drift`.</span>
<a name="ln-225"></a>    <span class="k">call </span><span class="n">calc_ambient_velocity</span><span class="p">()</span>
<a name="ln-226"></a>
<a name="ln-227"></a>    <span class="c">!Calculate mobility matrix, take its dot product with force, &amp; add to drift.</span>
<a name="ln-228"></a>    <span class="c">!Using MKL routine &#39;symv&#39; here.</span>
<a name="ln-229"></a>
<a name="ln-230"></a>    <span class="n">cptr_forces</span> <span class="o">=</span> <span class="nb">c_loc</span><span class="p">(</span><span class="n">forces</span><span class="p">)</span>
<a name="ln-231"></a>    <span class="k">call </span><span class="nb">c_f_pointer</span><span class="p">(</span><span class="n">cptr_forces</span><span class="p">,</span> <span class="n">fptr_forces</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">nb</span><span class="p">])</span>
<a name="ln-232"></a>
<a name="ln-233"></a>    <span class="c">!No hydrodynamic interaction </span>
<a name="ln-234"></a>    <span class="n">drift</span> <span class="o">=</span> <span class="n">drift</span> <span class="o">+</span> <span class="n">fptr_forces</span>
<a name="ln-235"></a>
<a name="ln-236"></a>    <span class="c">!Calculate random force &amp; store it in module variable diffusion.</span>
<a name="ln-237"></a>    <span class="k">call </span><span class="n">get_rv_gaussian</span><span class="p">(</span><span class="mf">0.0_rp</span><span class="p">,</span> <span class="mf">1.0_rp</span><span class="p">,</span> <span class="n">diffusion</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">)</span> 
<a name="ln-238"></a>
<a name="ln-239"></a>    <span class="c">!Update positions</span>
<a name="ln-240"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nb</span>
<a name="ln-241"></a>        <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">tim_stp</span><span class="o">*</span><span class="n">drift</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-242"></a>           <span class="o">+</span> <span class="n">sqrt_two_dt</span><span class="o">*</span><span class="n">diffusion</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<a name="ln-243"></a>    <span class="k">end do</span>
<a name="ln-244"></a>
<a name="ln-245"></a><span class="k">    end subroutine</span>
<a name="ln-246"></a>
<a name="ln-247"></a><span class="c">!******************************************************************************</span>
<a name="ln-248"></a>
<a name="ln-249"></a><span class="k">subroutine </span><span class="n">bds_integrate_hi</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-250"></a>    <span class="c">!! Performs one step of BD integeration including HI.</span>
<a name="ln-251"></a>
<a name="ln-252"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-253"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">fptr_forces</span>
<a name="ln-254"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cptr_forces</span>
<a name="ln-255"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sqrt_two_dt</span>
<a name="ln-256"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">nb</span><span class="p">,</span> <span class="n">info</span>
<a name="ln-257"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-258"></a>
<a name="ln-259"></a>    <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-260"></a>    <span class="n">drift</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">diffusion</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-261"></a>    <span class="n">sqrt_two_dt</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">tim_stp</span><span class="p">)</span>
<a name="ln-262"></a>    <span class="n">nb</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-263"></a>
<a name="ln-264"></a>    <span class="c">!Update forces</span>
<a name="ln-265"></a>    <span class="k">call </span><span class="n">ia_calc_forces</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-266"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-267"></a>
<a name="ln-268"></a>    <span class="c">!Calculate ambient flow velocity at the atom locations and store it in</span>
<a name="ln-269"></a>    <span class="c">!module variable `drift`.</span>
<a name="ln-270"></a>    <span class="k">call </span><span class="n">calc_ambient_velocity</span><span class="p">()</span>
<a name="ln-271"></a>
<a name="ln-272"></a>    <span class="c">!Calculate mobility matrix, take its dot product with force, &amp; add to drift.</span>
<a name="ln-273"></a>    <span class="c">!Using MKL routine &#39;symv&#39; here.</span>
<a name="ln-274"></a>
<a name="ln-275"></a>    <span class="n">cptr_forces</span> <span class="o">=</span> <span class="nb">c_loc</span><span class="p">(</span><span class="n">forces</span><span class="p">)</span>
<a name="ln-276"></a>    <span class="k">call </span><span class="nb">c_f_pointer</span><span class="p">(</span><span class="n">cptr_forces</span><span class="p">,</span> <span class="n">fptr_forces</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">nb</span><span class="p">])</span>
<a name="ln-277"></a>
<a name="ln-278"></a>    <span class="c">!With hydrodynamic interaction </span>
<a name="ln-279"></a>    <span class="k">call </span><span class="n">calc_rpy_tensor</span><span class="p">()</span>
<a name="ln-280"></a>
<a name="ln-281"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">flow_style</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-282"></a><span class="k">        call </span><span class="n">symv</span><span class="p">(</span><span class="n">mobility</span><span class="p">,</span> <span class="n">fptr_forces</span><span class="p">,</span> <span class="n">drift</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">)</span>
<a name="ln-283"></a>    <span class="k">else</span>
<a name="ln-284"></a><span class="k">        call </span><span class="n">symv</span><span class="p">(</span><span class="n">mobility</span><span class="p">,</span> <span class="n">fptr_forces</span><span class="p">,</span> <span class="n">drift</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="mf">1.0_rp</span><span class="p">,</span> <span class="mf">1.0_rp</span><span class="p">)</span>
<a name="ln-285"></a>    <span class="k">end if</span>
<a name="ln-286"></a>
<a name="ln-287"></a>    <span class="c">!Calculate random force &amp; store it in module variable diffusion.</span>
<a name="ln-288"></a>    <span class="k">call </span><span class="n">get_rv_gaussian</span><span class="p">(</span><span class="mf">0.0_rp</span><span class="p">,</span> <span class="mf">1.0_rp</span><span class="p">,</span> <span class="n">diffusion</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">)</span> 
<a name="ln-289"></a>
<a name="ln-290"></a>    <span class="c">!Performs the operation: x = A.x, where A is the square root of mobility.</span>
<a name="ln-291"></a>    <span class="c">!Only the upper triangular part of the square root matrix is</span>
<a name="ln-292"></a>    <span class="c">!considered. For hi_method=&#39;cholesky&#39;, the square root matrix is calculated</span>
<a name="ln-293"></a>    <span class="c">!before trmv.</span>
<a name="ln-294"></a>    <span class="c">!Trmv operation on the sqrt of mobility matrix.</span>
<a name="ln-295"></a>
<a name="ln-296"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">mob_fctr</span> <span class="o">==</span> <span class="s1">&#39;CHOL&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-297"></a><span class="k">        call </span><span class="n">potrf</span><span class="p">(</span><span class="n">mobility</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="n">info</span><span class="p">)</span>
<a name="ln-298"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-299"></a><span class="k">            </span><span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-300"></a>            <span class="k">call </span><span class="n">logger</span><span class="p">%</span><span class="n">fatal</span><span class="p">(</span> <span class="s1">&#39;potrf:&#39;</span><span class="p">,</span> <span class="s1">&#39;err code &#39;</span><span class="o">//</span><span class="n">str_from_num</span><span class="p">(</span><span class="n">info</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-301"></a>            <span class="k">return</span>
<a name="ln-302"></a><span class="k">        end if</span>
<a name="ln-303"></a>        <span class="c">! Default for trmv: access the upper triangular part only</span>
<a name="ln-304"></a>        <span class="k">call </span><span class="n">trmv</span><span class="p">(</span><span class="n">mobility</span><span class="p">,</span> <span class="n">diffusion</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">)</span>
<a name="ln-305"></a>    <span class="k">else if</span> <span class="p">(</span><span class="n">mob_fctr</span> <span class="o">==</span> <span class="s1">&#39;KRYL&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-306"></a><span class="k">        call </span><span class="n">calc_Bdw_kryl</span> <span class="p">(</span><span class="n">mobility</span><span class="p">,</span> <span class="n">diffusion</span><span class="p">,</span> <span class="n">ierr</span><span class="p">)</span>
<a name="ln-307"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ierr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-308"></a><span class="k">    end if</span>
<a name="ln-309"></a>
<a name="ln-310"></a>    <span class="c">!Update positions</span>
<a name="ln-311"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nb</span>
<a name="ln-312"></a>        <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">tim_stp</span><span class="o">*</span><span class="n">drift</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-313"></a>            <span class="o">+</span> <span class="n">sqrt_two_dt</span><span class="o">*</span><span class="n">diffusion</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<a name="ln-314"></a>    <span class="k">end do</span>
<a name="ln-315"></a>
<a name="ln-316"></a><span class="k">    end subroutine</span>
<a name="ln-317"></a>
<a name="ln-318"></a><span class="c">!******************************************************************************</span>
<a name="ln-319"></a>
<a name="ln-320"></a><span class="k">subroutine </span><span class="n">calc_ambient_velocity</span><span class="p">()</span>
<a name="ln-321"></a>    <span class="c">!! Calculates ambient velocity at the atom positions and store it in module</span>
<a name="ln-322"></a>    <span class="c">!! variable `drift`.</span>
<a name="ln-323"></a>
<a name="ln-324"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">nb</span>
<a name="ln-325"></a>
<a name="ln-326"></a>    <span class="n">nb</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-327"></a>
<a name="ln-328"></a>    <span class="k">select case</span><span class="p">(</span><span class="n">flow_style</span><span class="p">)</span>
<a name="ln-329"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-330"></a>        <span class="c">!Steady simple shear: Flow along x, gradient along y</span>
<a name="ln-331"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nb</span>
<a name="ln-332"></a>            <span class="n">drift</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">flow_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-333"></a>        <span class="k">end do</span>
<a name="ln-334"></a><span class="k">    case</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-335"></a>        <span class="c">!Steady planar extension in x-y plane</span>
<a name="ln-336"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nb</span>
<a name="ln-337"></a>            <span class="n">drift</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span>  <span class="n">flow_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-338"></a>            <span class="n">drift</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">flow_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-339"></a>        <span class="k">end do</span>
<a name="ln-340"></a><span class="k">    case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-341"></a>        <span class="c">!Steady uniaxial extension along x</span>
<a name="ln-342"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nb</span>
<a name="ln-343"></a>            <span class="n">drift</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span>  <span class="n">flow_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-344"></a>            <span class="n">drift</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5_rp</span><span class="o">*</span><span class="n">flow_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-345"></a>            <span class="n">drift</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>   <span class="o">=</span> <span class="o">-</span><span class="mf">0.5_rp</span><span class="o">*</span><span class="n">flow_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-346"></a>        <span class="k">end do</span>
<a name="ln-347"></a><span class="k">    case </span><span class="n">default</span>
<a name="ln-348"></a>        <span class="k">continue</span>
<a name="ln-349"></a><span class="k">    end select</span>
<a name="ln-350"></a>
<a name="ln-351"></a><span class="k">    end subroutine</span>
<a name="ln-352"></a>
<a name="ln-353"></a><span class="c">!******************************************************************************</span>
<a name="ln-354"></a>
<a name="ln-355"></a><span class="k">subroutine </span><span class="n">calc_rpy_tensor</span><span class="p">()</span>
<a name="ln-356"></a>    <span class="c">!! Calculates the RPY approximation to the mobility tensor. Overwrites</span>
<a name="ln-357"></a>    <span class="c">!! the upper triangular part of `mobility`.</span>
<a name="ln-358"></a>
<a name="ln-359"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ri</span><span class="p">,</span> <span class="n">rj</span><span class="p">,</span> <span class="n">rij</span>
<a name="ln-360"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">matrpy</span>
<a name="ln-361"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rijm</span><span class="p">,</span> <span class="n">irijm</span><span class="p">,</span> <span class="n">irijm2</span>
<a name="ln-362"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">consij</span>
<a name="ln-363"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">nb</span>
<a name="ln-364"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span>
<a name="ln-365"></a>
<a name="ln-366"></a>    <span class="n">nb</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-367"></a>
<a name="ln-368"></a>    <span class="c">!Reset mobility matrix to zero.</span>
<a name="ln-369"></a>    <span class="n">mobility</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-370"></a>
<a name="ln-371"></a>    <span class="c">!Calculate the RPY tensor (in strictly upper triangular form)</span>
<a name="ln-372"></a>    <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nb</span>
<a name="ln-373"></a>        <span class="n">rj</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">j</span><span class="p">)</span>
<a name="ln-374"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-375"></a>            <span class="n">ri</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-376"></a>            <span class="n">rij</span> <span class="o">=</span> <span class="n">rj</span> <span class="o">-</span> <span class="n">ri</span>
<a name="ln-377"></a>
<a name="ln-378"></a>            <span class="n">rijm</span> <span class="o">=</span> <span class="nb">norm2</span><span class="p">(</span><span class="n">rij</span><span class="p">)</span>
<a name="ln-379"></a>            <span class="n">irijm</span> <span class="o">=</span> <span class="mf">1.0_rp</span><span class="o">/</span><span class="n">rijm</span>
<a name="ln-380"></a>            <span class="n">irijm2</span> <span class="o">=</span> <span class="n">irijm</span><span class="o">*</span><span class="n">irijm</span>
<a name="ln-381"></a>
<a name="ln-382"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">rijm</span> <span class="o">&gt;=</span> <span class="mf">2.0_rp</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-383"></a><span class="k">              </span><span class="n">C1</span> <span class="o">=</span>  <span class="mf">1.0_rp</span> <span class="o">+</span> <span class="p">(</span><span class="mf">2.0_rp</span><span class="o">/</span><span class="mf">3.0_rp</span><span class="p">)</span><span class="o">*</span><span class="n">irijm2</span>
<a name="ln-384"></a>              <span class="n">C2</span> <span class="o">=</span>  <span class="mf">1.0_rp</span> <span class="o">-</span> <span class="mf">2.0_rp</span><span class="o">*</span><span class="n">irijm2</span>
<a name="ln-385"></a>              <span class="n">consij</span> <span class="o">=</span> <span class="mf">0.75_rp</span><span class="o">*</span><span class="n">irijm</span>
<a name="ln-386"></a>            <span class="k">else</span>
<a name="ln-387"></a><span class="k">              </span><span class="n">C1</span> <span class="o">=</span> <span class="mf">1.0_rp</span> <span class="o">-</span> <span class="mf">9.0_rp</span><span class="o">*</span><span class="n">rijm</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="mf">2.0_rp</span><span class="p">)</span>
<a name="ln-388"></a>              <span class="n">C2</span> <span class="o">=</span> <span class="mf">3.0_rp</span><span class="o">*</span><span class="n">rijm</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="mf">2.0_rp</span><span class="p">)</span>
<a name="ln-389"></a>              <span class="n">consij</span> <span class="o">=</span> <span class="mf">1.0_rp</span>
<a name="ln-390"></a>            <span class="k">end if</span>
<a name="ln-391"></a>
<a name="ln-392"></a><span class="k">            </span><span class="n">matrpy</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">consij</span><span class="o">*</span><span class="p">(</span> <span class="n">C1</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">irijm2</span> <span class="p">)</span>
<a name="ln-393"></a>            <span class="n">matrpy</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">consij</span><span class="o">*</span><span class="p">(</span>      <span class="n">C2</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">irijm2</span> <span class="p">)</span>
<a name="ln-394"></a>            <span class="n">matrpy</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">consij</span><span class="o">*</span><span class="p">(</span>      <span class="n">C2</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">irijm2</span> <span class="p">)</span>
<a name="ln-395"></a>
<a name="ln-396"></a>            <span class="n">matrpy</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">consij</span><span class="o">*</span><span class="p">(</span>      <span class="n">C2</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">irijm2</span> <span class="p">)</span>
<a name="ln-397"></a>            <span class="n">matrpy</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">consij</span><span class="o">*</span><span class="p">(</span> <span class="n">C1</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">irijm2</span> <span class="p">)</span>
<a name="ln-398"></a>            <span class="n">matrpy</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">consij</span><span class="o">*</span><span class="p">(</span>      <span class="n">C2</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">irijm2</span> <span class="p">)</span>
<a name="ln-399"></a>
<a name="ln-400"></a>            <span class="n">matrpy</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">consij</span><span class="o">*</span><span class="p">(</span>      <span class="n">C2</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">irijm2</span> <span class="p">)</span>
<a name="ln-401"></a>            <span class="n">matrpy</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">consij</span><span class="o">*</span><span class="p">(</span>      <span class="n">C2</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">irijm2</span> <span class="p">)</span>
<a name="ln-402"></a>            <span class="n">matrpy</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">consij</span><span class="o">*</span><span class="p">(</span> <span class="n">C1</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">rij</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">irijm2</span> <span class="p">)</span>
<a name="ln-403"></a>
<a name="ln-404"></a>            <span class="n">mobility</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">j</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">matrpy</span>
<a name="ln-405"></a>        <span class="k">end do</span>
<a name="ln-406"></a><span class="k">    end do</span>
<a name="ln-407"></a>   
<a name="ln-408"></a>    <span class="c">!Copy upper triangular part to lower triangular part. This is not necessary</span>
<a name="ln-409"></a>    <span class="c">!if the lower triangular part is not accessed in subsequent calculations.</span>
<a name="ln-410"></a>
<a name="ln-411"></a>    <span class="c">!do j = 2, (3*nb-1)</span>
<a name="ln-412"></a>    <span class="c">!    do i = 1, j-1</span>
<a name="ln-413"></a>    <span class="c">!        rpy_tensor(j,i) = rpy_tensor(i,j)</span>
<a name="ln-414"></a>    <span class="c">!    end do</span>
<a name="ln-415"></a>    <span class="c">!end do</span>
<a name="ln-416"></a>
<a name="ln-417"></a>    <span class="c">!Put one on the diagonal.</span>
<a name="ln-418"></a>    <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">nb</span>
<a name="ln-419"></a>       <span class="n">mobility</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0_rp</span>
<a name="ln-420"></a>    <span class="k">end do</span>
<a name="ln-421"></a>
<a name="ln-422"></a><span class="k">    end subroutine</span>
<a name="ln-423"></a>
<a name="ln-424"></a><span class="c">!******************************************************************************</span>
<a name="ln-425"></a>
<a name="ln-426"></a><span class="k">subroutine </span><span class="n">calc_Bdw_kryl</span> <span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">Bdw</span><span class="p">,</span> <span class="n">ierr</span><span class="p">)</span>
<a name="ln-427"></a>    <span class="c">!! Calculates *B.dW* using Krylov subspace method.</span>
<a name="ln-428"></a>
<a name="ln-429"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">D</span>
<a name="ln-430"></a>        <span class="c">!! (3N,3N) symmetric positive definite matrix.</span>
<a name="ln-431"></a>        <span class="c">!!</span>
<a name="ln-432"></a>        <span class="c">!! Diffusivity matrix. Only the upper triangular part of the matrix is used.</span>
<a name="ln-433"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span>   <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Bdw</span>
<a name="ln-434"></a>        <span class="c">!! (3N,) vector. On entry contains vector **dW**. On return, contains </span>
<a name="ln-435"></a>        <span class="c">!! **B.dW**, where **B** is the square root matrix of **D**.</span>
<a name="ln-436"></a>    <span class="kt">integer</span><span class="p">,</span>                  <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-437"></a>        <span class="c">!! Error flag</span>
<a name="ln-438"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>     <span class="kd">::</span> <span class="n">dimk</span> <span class="o">=</span> <span class="mi">12</span>
<a name="ln-439"></a>        <span class="c">! Dimension of Krylov subspace</span>
<a name="ln-440"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">parameter</span>    <span class="kd">::</span> <span class="n">Ek_thres</span> <span class="o">=</span> <span class="mf">0.01_rp</span>
<a name="ln-441"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>       <span class="kd">::</span> <span class="n">Bdwold</span>
<a name="ln-442"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>       <span class="kd">::</span> <span class="n">w</span>
<a name="ln-443"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">dimk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">V</span>
<a name="ln-444"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">dimk</span><span class="p">,</span> <span class="n">dimk</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">P</span>
<a name="ln-445"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">dimk</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">diagH</span>     
<a name="ln-446"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">dimk</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">diagHsav</span>  
<a name="ln-447"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">dimk</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">subH</span>      
<a name="ln-448"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">dimk</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">subHsav</span>   
<a name="ln-449"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">dimk</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">sqrtHcol1</span> 
<a name="ln-450"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">dimk</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">Ptranscol1</span>
<a name="ln-451"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">normz</span>
<a name="ln-452"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Ek</span>
<a name="ln-453"></a>    <span class="kt">integer</span>  <span class="kd">::</span> <span class="n">ncol</span>
<a name="ln-454"></a>    <span class="kt">integer</span>  <span class="kd">::</span> <span class="n">j</span>
<a name="ln-455"></a>    <span class="kt">integer</span>  <span class="kd">::</span> <span class="n">info</span>
<a name="ln-456"></a>    
<a name="ln-457"></a>    <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-458"></a>    
<a name="ln-459"></a>    <span class="n">ncol</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-460"></a>    <span class="n">diagH</span>  <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-461"></a>    <span class="n">subH</span>   <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-462"></a>    <span class="n">Bdwold</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-463"></a>    
<a name="ln-464"></a>    <span class="n">normz</span> <span class="o">=</span> <span class="nb">norm2</span><span class="p">(</span><span class="n">Bdw</span><span class="p">)</span>
<a name="ln-465"></a>    
<a name="ln-466"></a>    <span class="n">V</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Bdw</span><span class="o">/</span><span class="n">normz</span>
<a name="ln-467"></a>    
<a name="ln-468"></a>    <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dimk</span>
<a name="ln-469"></a>       <span class="k">call </span><span class="n">symv</span> <span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">V</span><span class="p">(:,</span><span class="n">j</span><span class="p">),</span> <span class="n">w</span><span class="p">)</span> <span class="c">!Default using upper triangular part</span>
<a name="ln-470"></a>    
<a name="ln-471"></a>       <span class="k">if</span> <span class="p">(</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-472"></a><span class="k">           </span><span class="n">w</span> <span class="o">=</span> <span class="n">w</span> <span class="o">-</span> <span class="n">subH</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">V</span><span class="p">(:,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-473"></a>       <span class="k">end if</span>
<a name="ln-474"></a><span class="k">    </span>
<a name="ln-475"></a><span class="k">       </span><span class="n">diagH</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="nb">dot_product</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">V</span><span class="p">(:,</span><span class="n">j</span><span class="p">))</span>
<a name="ln-476"></a>    
<a name="ln-477"></a>       <span class="k">if</span> <span class="p">(</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">dimk</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-478"></a><span class="k">           </span><span class="n">w</span> <span class="o">=</span> <span class="n">w</span> <span class="o">-</span> <span class="n">diagH</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">V</span><span class="p">(:,</span><span class="n">j</span><span class="p">)</span>
<a name="ln-479"></a>           <span class="n">subH</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="nb">norm2</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<a name="ln-480"></a>           <span class="n">V</span><span class="p">(:,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">w</span><span class="o">/</span><span class="n">subH</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a name="ln-481"></a>       <span class="k">end if</span>
<a name="ln-482"></a>    
<a name="ln-483"></a>       <span class="c">!Update Bdw</span>
<a name="ln-484"></a>    
<a name="ln-485"></a>       <span class="k">if</span> <span class="p">(</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="mi">5</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-486"></a><span class="k">            </span><span class="n">diagHsav</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">diagH</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="p">)</span>
<a name="ln-487"></a>            <span class="n">subHsav</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">subH</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="p">)</span>
<a name="ln-488"></a>    
<a name="ln-489"></a>            <span class="k">call </span><span class="n">stevd</span> <span class="p">(</span><span class="n">diagHsav</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="p">),</span> <span class="n">subHsav</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="p">),</span> <span class="n">P</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="p">),</span> <span class="n">info</span><span class="p">)</span>
<a name="ln-490"></a>      
<a name="ln-491"></a>            <span class="k">if</span> <span class="p">(</span> <span class="n">info</span> <span class="o">/=</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-492"></a><span class="k">                write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;calc_Bdw_kryl: info = &#39;</span><span class="p">,</span> <span class="n">info</span>
<a name="ln-493"></a>                <span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-494"></a>                <span class="k">return</span>
<a name="ln-495"></a><span class="k">            end if</span>
<a name="ln-496"></a><span class="k">    </span>
<a name="ln-497"></a><span class="k">            </span><span class="n">diagHsav</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span> <span class="n">diagHsav</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-498"></a>            
<a name="ln-499"></a>            <span class="n">Ptranscol1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="p">)</span>
<a name="ln-500"></a>      
<a name="ln-501"></a>            <span class="n">Ptranscol1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">diagHsav</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">Ptranscol1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="p">)</span>
<a name="ln-502"></a>      
<a name="ln-503"></a>            <span class="k">call </span><span class="n">gemv</span> <span class="p">(</span> <span class="n">P</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="p">),</span> <span class="n">Ptranscol1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="p">),</span> <span class="n">sqrtHcol1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-504"></a>      
<a name="ln-505"></a>            <span class="k">call </span><span class="n">gemv</span> <span class="p">(</span> <span class="n">V</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="p">),</span> <span class="n">sqrtHcol1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="p">),</span> <span class="n">Bdw</span><span class="p">,</span> <span class="n">normz</span><span class="p">,</span> <span class="mf">0.0_rp</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">)</span>
<a name="ln-506"></a>    
<a name="ln-507"></a>            <span class="c">!Error calculation</span>
<a name="ln-508"></a>    
<a name="ln-509"></a>            <span class="k">if</span> <span class="p">(</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">)</span> <span class="k">then</span> <span class="c">!Check only after several iterations, say 5</span>
<a name="ln-510"></a>                 <span class="n">Ek</span> <span class="o">=</span> <span class="mf">1.0_rp</span>
<a name="ln-511"></a>            <span class="k">else</span>
<a name="ln-512"></a><span class="k">                 </span><span class="n">Ek</span> <span class="o">=</span> <span class="nb">norm2</span><span class="p">(</span><span class="n">Bdw</span> <span class="o">-</span> <span class="n">Bdwold</span><span class="p">)</span><span class="o">/</span><span class="nb">norm2</span><span class="p">(</span><span class="n">Bdwold</span><span class="p">)</span>
<a name="ln-513"></a>            <span class="k">end if</span>
<a name="ln-514"></a><span class="k">    </span>
<a name="ln-515"></a><span class="k">            if</span> <span class="p">(</span> <span class="n">Ek</span> <span class="o">&lt;=</span> <span class="n">Ek_thres</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-516"></a><span class="k">                 exit</span>
<a name="ln-517"></a><span class="k">            end if</span>
<a name="ln-518"></a><span class="k">    </span>
<a name="ln-519"></a><span class="k">            </span><span class="n">Bdwold</span> <span class="o">=</span> <span class="n">Bdw</span>
<a name="ln-520"></a>    
<a name="ln-521"></a>       <span class="k">end if</span>
<a name="ln-522"></a><span class="k">    </span>
<a name="ln-523"></a><span class="k">    end do</span>
<a name="ln-524"></a><span class="k">    </span>
<a name="ln-525"></a><span class="k">    end subroutine</span>
<a name="ln-526"></a>
<a name="ln-527"></a><span class="c">!******************************************************************************</span>
<a name="ln-528"></a>
<a name="ln-529"></a><span class="k">end module </span><span class="n">m_bd_solver</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> BROWNPAK was developed by Sarit Dutta</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>