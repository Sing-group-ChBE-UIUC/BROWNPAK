<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for BROWNPAK">
   
    <meta name="author" content="Sarit Dutta" >
    <link rel="icon" href="../favicon.png">

    <title>m_cell_list.f90 &ndash; BROWNPAK</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">BROWNPAK <small>0.2</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>m_cell_list.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 3.1% of total for source files.">193 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/m_cell_list.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">m_cell_list.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_cell_list.html">m_cell_list</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_cell_list.f90.html#src">m_cell_list.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_cell_list.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilem_cell_listf90EfferentGraph" width="603pt" height="255pt"
 viewBox="0.00 0.00 603.00 254.86" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 250.859)">
<title>sourcefile~~m_cell_list.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-250.859 599,-250.859 599,4 -4,4"/>
<!-- sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~m_cell_list.f90</title>
<polygon fill="none" stroke="#000000" points="595,-166 516,-166 516,-142 595,-142 595,-166"/>
<text text-anchor="middle" x="555.5" y="-151.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_cell_list.f90</text>
</g>
<!-- sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~m_vector.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/m_vector.f90.html" xlink:title="m_vector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="358.5,-226 285.5,-226 285.5,-202 358.5,-202 358.5,-226"/>
<text text-anchor="middle" x="322" y="-211.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_vector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_vector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M441,-174C412.8043,-178.8318 382.2402,-189.2234 359.1478,-198.2038"/>
<polygon fill="#ff0000" stroke="#ff0000" points="357.7362,-194.9984 349.7372,-201.9457 360.3227,-201.5031 357.7362,-194.9984"/>
</g>
<!-- sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~m_precision.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/m_precision.f90.html" xlink:title="m_precision.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="87,-166 0,-166 0,-142 87,-142 87,-166"/>
<text text-anchor="middle" x="43.5" y="-151.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_precision.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M441,-174C388.871,-182.9332 374.7057,-169.6018 322,-174"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M515.7684,-161.0046C493.7435,-164.8712 465.8619,-169.7395 441,-174"/>
</g>
<!-- sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~m_globals.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/m_globals.f90.html" xlink:title="m_globals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480,-146 402,-146 402,-122 480,-122 480,-146"/>
<text text-anchor="middle" x="441" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_globals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M515.7748,-147.0611C507.5113,-145.6177 498.7086,-144.0801 490.1522,-142.5855"/>
<polygon fill="#ff0000" stroke="#ff0000" points="490.7211,-139.132 480.268,-140.859 489.5166,-146.0276 490.7211,-139.132"/>
</g>
<!-- sourcefile~m_vector.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~m_vector.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M291.6764,-226.043C251.4674,-240.0753 179.0587,-258.5277 123,-235 94.0094,-222.8327 70.2729,-194.3651 56.5034,-174.6438"/>
<polygon fill="#ff0000" stroke="#ff0000" points="59.3743,-172.6407 50.8952,-166.288 53.5621,-176.5418 59.3743,-172.6407"/>
</g>
<!-- sourcefile~m_qsort.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~m_qsort.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/m_qsort.f90.html" xlink:title="m_qsort.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="216.5,-226 148.5,-226 148.5,-202 216.5,-202 216.5,-226"/>
<text text-anchor="middle" x="182.5" y="-211.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_qsort.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_vector.f90&#45;&gt;sourcefile~m_qsort.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~m_vector.f90&#45;&gt;sourcefile~m_qsort.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M285.348,-214C267.3664,-214 245.5643,-214 226.6694,-214"/>
<polygon fill="#ff0000" stroke="#ff0000" points="226.5141,-210.5001 216.514,-214 226.514,-217.5001 226.5141,-210.5001"/>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M322,-174C260.2148,-179.1559 244.5,-174.0157 182.5,-174"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M416.6741,-146.0427C393.1322,-156.7545 356.1006,-171.1544 322,-174"/>
</g>
<!-- sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~m_simbox.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/m_simbox.f90.html" xlink:title="m_simbox.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="361,-146 283,-146 283,-122 361,-122 361,-146"/>
<text text-anchor="middle" x="322" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_simbox.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_simbox.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M401.7052,-134C392.058,-134 381.6067,-134 371.5462,-134"/>
<polygon fill="#0000ff" stroke="#0000ff" points="371.2536,-130.5001 361.2536,-134 371.2536,-137.5001 371.2536,-130.5001"/>
</g>
<!-- sourcefile~m_trajectory.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~m_trajectory.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/m_trajectory.f90.html" xlink:title="m_trajectory.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-64 278,-64 278,-40 366,-40 366,-64"/>
<text text-anchor="middle" x="322" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_trajectory.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_trajectory.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_trajectory.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M423.4411,-121.9006C403.4909,-108.1534 370.7412,-85.5864 347.8669,-69.8242"/>
<polygon fill="#0000ff" stroke="#0000ff" points="349.8512,-66.9411 339.6309,-64.149 345.8793,-72.7052 349.8512,-66.9411"/>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M296.4048,-146.0054C268.8928,-157.7911 223.5674,-174.0104 182.5,-174"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M182.5,-174C154.0891,-173.9928 122.7417,-169.848 97.0182,-165.334"/>
<polygon fill="#ff0000" stroke="#ff0000" points="97.5569,-161.8746 87.0916,-163.5257 96.3024,-168.7613 97.5569,-161.8746"/>
</g>
<!-- sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~m_constants_math.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/m_constants_math.f90.html" xlink:title="m_constants_math.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="242,-146 123,-146 123,-122 242,-122 242,-146"/>
<text text-anchor="middle" x="182.5" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_constants_math.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M282.7702,-134C273.1823,-134 262.6358,-134 252.0942,-134"/>
<polygon fill="#ff0000" stroke="#ff0000" points="252.0202,-130.5001 242.0201,-134 252.0201,-137.5001 252.0202,-130.5001"/>
</g>
<!-- sourcefile~m_ran_num.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~m_ran_num.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/m_ran_num.f90.html" xlink:title="m_ran_num.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="225.5,-104 139.5,-104 139.5,-80 225.5,-80 225.5,-104"/>
<text text-anchor="middle" x="182.5" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ran_num.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_ran_num.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_ran_num.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M282.7702,-122.1889C267.0066,-117.4429 248.6524,-111.9168 231.9878,-106.8996"/>
<polygon fill="#ff0000" stroke="#ff0000" points="232.9881,-103.5456 222.4036,-104.014 230.97,-110.2484 232.9881,-103.5456"/>
</g>
<!-- sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M277.7372,-47.6701C235.7748,-45.4828 172.0384,-47.2476 123,-71 94.3462,-84.8789 70.5266,-113.7014 56.6468,-133.4473"/>
<polygon fill="#00ff00" stroke="#00ff00" points="53.7021,-131.5536 50.9873,-141.7947 59.496,-135.4818 53.7021,-131.5536"/>
</g>
<!-- sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~m_logger.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~EfferentGraph_node10"><a xlink:href=".././sourcefile/m_logger.f90.html" xlink:title="m_logger.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="219.5,-24 145.5,-24 145.5,0 219.5,0 219.5,-24"/>
<text text-anchor="middle" x="182.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_logger.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_logger.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M280.1454,-39.9987C264.1947,-35.425 245.9138,-30.1832 229.5153,-25.4811"/>
<polygon fill="#00ff00" stroke="#00ff00" points="230.1632,-22.0259 219.5858,-22.6339 228.2337,-28.7547 230.1632,-22.0259"/>
</g>
<!-- sourcefile~m_qsort.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~m_qsort.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M154.3713,-201.8581C133.2699,-192.7496 104.1686,-180.1879 81.0753,-170.2196"/>
<polygon fill="#0000ff" stroke="#0000ff" points="82.1552,-166.8736 71.5869,-166.1238 79.381,-173.3004 82.1552,-166.8736"/>
</g>
<!-- sourcefile~m_constants_math.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~m_constants_math.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M122.7448,-142.5979C114.2703,-143.8172 105.5985,-145.065 97.2471,-146.2666"/>
<polygon fill="#ff0000" stroke="#ff0000" points="96.6535,-142.8159 87.2539,-147.7045 97.6505,-149.7445 96.6535,-142.8159"/>
</g>
<!-- sourcefile~m_ran_num.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~m_ran_num.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M145.6937,-104.1041C138.1149,-106.8432 130.2406,-109.8726 123,-113 106.5104,-120.1222 88.6925,-129.1782 74.1127,-136.9666"/>
<polygon fill="#00ff00" stroke="#00ff00" points="72.1779,-134.0338 65.0458,-141.8685 75.5071,-140.1914 72.1779,-134.0338"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_cell_list.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilem_cell_listf90AfferentGraph" width="538pt" height="194pt"
 viewBox="0.00 0.00 538.00 194.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 190)">
<title>sourcefile~~m_cell_list.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-190 534,-190 534,4 -4,4"/>
<!-- sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~m_cell_list.f90</title>
<polygon fill="none" stroke="#000000" points="79,-144 0,-144 0,-120 79,-120 79,-144"/>
<text text-anchor="middle" x="39.5" y="-129.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_cell_list.f90</text>
</g>
<!-- sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~m_mpcd.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/m_mpcd.f90.html" xlink:title="m_mpcd.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="324,-186 254,-186 254,-162 324,-162 324,-186"/>
<text text-anchor="middle" x="289" y="-171.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_mpcd.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_cell_list.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M253.7819,-168.0715C210.7677,-160.8306 137.7383,-148.5371 89.0646,-140.3435"/>
<polygon fill="#ff0000" stroke="#ff0000" points="89.5097,-136.8693 79.0674,-138.6606 88.3476,-143.7722 89.5097,-136.8693"/>
</g>
<!-- sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~m_interaction.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/m_interaction.f90.html" xlink:title="m_interaction.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="208,-124 115,-124 115,-100 208,-100 208,-124"/>
<text text-anchor="middle" x="161.5" y="-109.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_interaction.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M262.7738,-161.8935C256.6024,-159.008 250.0583,-155.9185 244,-153 227.8064,-145.1991 209.9314,-136.3459 194.9722,-128.8677"/>
<polygon fill="#00ffff" stroke="#00ffff" points="196.1183,-125.5272 185.6098,-124.1769 192.9826,-131.7856 196.1183,-125.5272"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_cell_list.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M114.6805,-119.6753C106.3681,-121.038 97.6838,-122.4617 89.2924,-123.8373"/>
<polygon fill="#ff0000" stroke="#ff0000" points="88.549,-120.4124 79.2469,-125.4841 89.6814,-127.3202 88.549,-120.4124"/>
</g>
<!-- sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~m_bd_solver.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/m_bd_solver.f90.html" xlink:title="m_bd_solver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="334,-64 244,-64 244,-40 334,-40 334,-64"/>
<text text-anchor="middle" x="289" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_bd_solver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M263.1985,-64.1419C244.0157,-73.1691 217.6253,-85.5881 196.5353,-95.5128"/>
<polygon fill="#00ffff" stroke="#00ffff" points="194.821,-92.4513 187.2632,-99.8762 197.8017,-98.785 194.821,-92.4513"/>
</g>
<!-- sourcefile~m_kmc.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~m_kmc.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/m_kmc.f90.html" xlink:title="m_kmc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="321,-144 257,-144 257,-120 321,-120 321,-144"/>
<text text-anchor="middle" x="289" y="-129.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_kmc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_kmc.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~m_kmc.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M256.8264,-126.9532C245.0691,-125.1089 231.3948,-122.9639 218.1361,-120.8841"/>
<polygon fill="#00ffff" stroke="#00ffff" points="218.5384,-117.4045 208.1168,-119.3124 217.4536,-124.3199 218.5384,-117.4045"/>
</g>
<!-- sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~m_setup.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/m_setup.f90.html" xlink:title="m_setup.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="440,-104 370,-104 370,-80 440,-80 440,-104"/>
<text text-anchor="middle" x="405" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_setup.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_mpcd.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M392.7574,-104.3719C379.2325,-117.5768 356.3918,-138.5461 334,-153 331.8451,-154.391 329.5833,-155.7423 327.2686,-157.0443"/>
<polygon fill="#ff0000" stroke="#ff0000" points="325.4245,-154.0592 318.1926,-161.8019 328.6745,-160.2591 325.4245,-154.0592"/>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M369.8531,-94.8868C330.2206,-98.142 265.2031,-103.4823 218.3302,-107.3322"/>
<polygon fill="#00ffff" stroke="#00ffff" points="218.0025,-103.8473 208.3226,-108.1542 218.5755,-110.8238 218.0025,-103.8473"/>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_bd_solver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M370.1962,-79.9987C358.7166,-76.0402 345.7856,-71.5813 333.6742,-67.4049"/>
<polygon fill="#ff0000" stroke="#ff0000" points="334.7749,-64.0823 324.1802,-64.1311 332.4929,-70.6999 334.7749,-64.0823"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="530,-84 476,-84 476,-60 530,-60 530,-84"/>
<text text-anchor="middle" x="503" y="-69.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_mpcd.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M486.4234,-84.0552C474.0193,-92.7578 456.4329,-104.4359 440,-113 405.3847,-131.04 364.1888,-147.3633 333.5773,-158.5749"/>
<polygon fill="#ff0000" stroke="#ff0000" points="332.2431,-155.3355 324.0322,-162.0311 334.6264,-161.9173 332.2431,-155.3355"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_bd_solver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M475.8968,-69.467C442.9597,-66.3888 386.556,-61.1174 344.3063,-57.1688"/>
<polygon fill="#ff0000" stroke="#ff0000" points="344.4476,-53.6669 334.1653,-56.2211 343.7962,-60.6365 344.4476,-53.6669"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M475.9616,-77.518C467.8936,-79.1646 458.824,-81.0155 449.9341,-82.8298"/>
<polygon fill="#00ff66" stroke="#00ff66" points="449.1346,-79.4207 440.0365,-84.8497 450.5344,-86.2793 449.1346,-79.4207"/>
</g>
<!-- sourcefile~m_relax.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~m_relax.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/m_relax.f90.html" xlink:title="m_relax.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="438.5,-24 371.5,-24 371.5,0 438.5,0 438.5,-24"/>
<text text-anchor="middle" x="405" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_relax.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_relax.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_relax.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M483.1682,-59.8581C468.9552,-51.1562 449.5942,-39.3026 433.697,-29.5696"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="435.1584,-26.3604 424.8023,-24.1238 431.5032,-32.3304 435.1584,-26.3604"/>
</g>
<!-- sourcefile~m_relax.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~m_relax.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M371.1914,-9.8022C337.3489,-8.9834 284.611,-11.5404 244,-31 215.2737,-44.7648 190.4593,-72.5906 175.7458,-91.755"/>
<polygon fill="#00ffff" stroke="#00ffff" points="172.8719,-89.7544 169.7186,-99.8691 178.4913,-93.9285 172.8719,-89.7544"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_cell_list.html">m_cell_list</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_cell_list.f90.html#src">m_cell_list.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">module </span><span class="n">m_cell_list</span>
<a name="ln-2"></a>    <span class="c">!! Sorts atoms using a cell list.</span>
<a name="ln-3"></a>    <span class="c">!!</span>
<a name="ln-4"></a>    <span class="c">!! The algorithm to build the cell list partially follows the techniques in Watanabe et</span>
<a name="ln-5"></a>    <span class="c">!! al, 2011, “Efficient Implementations of Molecular Dynamics Simulations for</span>
<a name="ln-6"></a>    <span class="c">!! Lennard-Jones Systems,” Prog. Theor. Phys. 126, 203–235.</span>
<a name="ln-7"></a>    <span class="c">!!</span>
<a name="ln-8"></a>    <span class="c">!! The pairlist is not explicitly built, rather the cells are directly</span>
<a name="ln-9"></a>    <span class="c">!! looped over during force calculation.</span>
<a name="ln-10"></a>
<a name="ln-11"></a><span class="k">use </span><span class="n">m_precision</span>
<a name="ln-12"></a><span class="k">use </span><span class="n">m_vector</span>
<a name="ln-13"></a><span class="k">use </span><span class="n">m_globals</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">simbox</span>
<a name="ln-14"></a>
<a name="ln-15"></a><span class="k">implicit none</span>
<a name="ln-16"></a>
<a name="ln-17"></a><span class="k">private</span>
<a name="ln-18"></a>
<a name="ln-19"></a><span class="k">public</span> <span class="kd">::</span> <span class="n">cl_init</span><span class="p">,</span> <span class="n">cl_delete</span><span class="p">,</span> <span class="n">cl_print</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-20"></a>          <span class="n">cl_set_cell_size</span><span class="p">,</span> <span class="n">cl_build</span><span class="p">,</span> <span class="n">cl_build_cell_nbrs</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-21"></a>          <span class="n">cl_get_num_cells</span><span class="p">,</span> <span class="n">cl_get_contents</span><span class="p">,</span> <span class="n">cl_get_nbr_cells</span> 
<a name="ln-22"></a>
<a name="ln-23"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">cell_size</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-24"></a>    <span class="c">!! Cell size along *x*, *y*, &amp; *z*.</span>
<a name="ln-25"></a><span class="kt">integer</span><span class="p">,</span>  <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">nc_max</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-26"></a>    <span class="c">!! Maximum number of cells along *x*, *y*, &amp; *z*.</span>
<a name="ln-27"></a><span class="kt">integer</span><span class="p">,</span>  <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">nc</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-28"></a>    <span class="c">!! Number of cells along *x*, *y*, &amp; *z*.</span>
<a name="ln-29"></a><span class="kt">integer</span>  <span class="kd">::</span> <span class="n">nct_max</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-30"></a>    <span class="c">!! Maximum total number of cells.</span>
<a name="ln-31"></a><span class="kt">integer</span>  <span class="kd">::</span> <span class="n">nct</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-32"></a>    <span class="c">!! Total of cells.</span>
<a name="ln-33"></a><span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">cells</span>
<a name="ln-34"></a>    <span class="c">!! *(na_max,)* array. Listing atoms in each cell.</span>
<a name="ln-35"></a><span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">cells_pos</span>
<a name="ln-36"></a>    <span class="c">!! *(0:nct_max,)* index array. Note: 0-based indexing.</span>
<a name="ln-37"></a><span class="k">type</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cell_nbrs</span>
<a name="ln-38"></a>    <span class="c">!! Lists neighbor cells for each cell.</span>
<a name="ln-39"></a><span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">cell_nbrs_pos</span>
<a name="ln-40"></a>    <span class="c">!! *(0:nct_max,)* index array. Note: 0-based indexing.</span>
<a name="ln-41"></a><span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">host_cells</span>
<a name="ln-42"></a>    <span class="c">!! *(na_max,)* array. *host_cells(i)* stores the linear index of the cell</span>
<a name="ln-43"></a>    <span class="c">!! containing atom *i*. *na_max* is the total number of atoms under consideration.</span>
<a name="ln-44"></a><span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">cell_pop</span>
<a name="ln-45"></a>    <span class="c">!! *(0:nct_max-1,)* array storing population of each cell. Note: 0-based indexing.</span>
<a name="ln-46"></a><span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">13</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">d</span> <span class="o">=</span> <span class="nb">reshape</span><span class="p">(</span> <span class="p">[</span>           <span class="p">&amp;</span>
<a name="ln-47"></a>                <span class="p">&amp;</span>                            <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-48"></a>                <span class="p">&amp;</span>    <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>   <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-49"></a>                <span class="p">&amp;</span>    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>   <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-50"></a>                <span class="p">&amp;</span>   <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-51"></a>                <span class="p">&amp;</span>   <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">13</span><span class="p">]</span> <span class="p">)</span>
<a name="ln-52"></a>
<a name="ln-53"></a><span class="k">contains</span>
<a name="ln-54"></a>
<a name="ln-55"></a><span class="c">!******************************************************************************</span>
<a name="ln-56"></a>
<a name="ln-57"></a><span class="k">subroutine </span><span class="n">cl_init</span><span class="p">(</span><span class="n">na_max</span><span class="p">,</span> <span class="n">cs_min</span><span class="p">)</span>
<a name="ln-58"></a>    <span class="c">!! Initializes a cell list.</span>
<a name="ln-59"></a>
<a name="ln-60"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">na_max</span>
<a name="ln-61"></a>        <span class="c">!! Maximum number of atoms to be handled.</span>
<a name="ln-62"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cs_min</span>
<a name="ln-63"></a>        <span class="c">!! Minimum size (i.e. length) of a cell.</span>
<a name="ln-64"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">nelem</span>
<a name="ln-65"></a>    
<a name="ln-66"></a>    <span class="c">!The following defines an upper bound on the number of cells</span>
<a name="ln-67"></a>    <span class="n">nc_max</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">ceiling</span><span class="p">(</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">cs_min</span> <span class="p">)</span>
<a name="ln-68"></a>    <span class="n">nc_max</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="nb">ceiling</span><span class="p">(</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">cs_min</span> <span class="p">)</span>
<a name="ln-69"></a>    <span class="n">nc_max</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">ceiling</span><span class="p">(</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">cs_min</span> <span class="p">)</span>
<a name="ln-70"></a>
<a name="ln-71"></a>    <span class="n">nct_max</span> <span class="o">=</span> <span class="nb">product</span><span class="p">(</span><span class="n">nc_max</span><span class="p">)</span>
<a name="ln-72"></a>
<a name="ln-73"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">na_max</span><span class="p">))</span>
<a name="ln-74"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">cells_pos</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nct_max</span><span class="p">))</span>
<a name="ln-75"></a>
<a name="ln-76"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">host_cells</span><span class="p">(</span><span class="n">na_max</span><span class="p">))</span>
<a name="ln-77"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">cell_pop</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nct_max</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-78"></a>
<a name="ln-79"></a>    <span class="c">!Provisional allocation with nelem (arbitrary) elements,</span>
<a name="ln-80"></a>    <span class="c">!will expand/contract later.</span>
<a name="ln-81"></a>    <span class="n">nelem</span> <span class="o">=</span> <span class="mi">8</span>
<a name="ln-82"></a>    <span class="k">call </span><span class="n">ivector_init</span><span class="p">(</span><span class="n">cell_nbrs</span><span class="p">,</span> <span class="n">nelem</span><span class="p">)</span>
<a name="ln-83"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nelem</span><span class="p">))</span>
<a name="ln-84"></a>
<a name="ln-85"></a>    <span class="k">end subroutine</span>
<a name="ln-86"></a>
<a name="ln-87"></a><span class="c">!******************************************************************************</span>
<a name="ln-88"></a>
<a name="ln-89"></a><span class="k">subroutine </span><span class="n">cl_set_cell_size</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
<a name="ln-90"></a>    <span class="c">!! Sets the cell size. The actual cell size may be slightly larger.</span>
<a name="ln-91"></a>
<a name="ln-92"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cs</span>
<a name="ln-93"></a>
<a name="ln-94"></a>    <span class="n">nc</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">floor</span><span class="p">(</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">cs</span> <span class="p">)</span>
<a name="ln-95"></a>    <span class="n">nc</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="nb">floor</span><span class="p">(</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">cs</span> <span class="p">)</span>
<a name="ln-96"></a>    <span class="n">nc</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">floor</span><span class="p">(</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">cs</span> <span class="p">)</span>
<a name="ln-97"></a>
<a name="ln-98"></a>    <span class="n">nct</span> <span class="o">=</span> <span class="nb">product</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span>
<a name="ln-99"></a>
<a name="ln-100"></a>    <span class="n">cell_size</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">nc</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-101"></a>    <span class="n">cell_size</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">nc</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-102"></a>    <span class="n">cell_size</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">nc</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-103"></a>
<a name="ln-104"></a>    <span class="k">end subroutine</span>
<a name="ln-105"></a>
<a name="ln-106"></a><span class="c">!******************************************************************************</span>
<a name="ln-107"></a>
<a name="ln-108"></a><span class="k">subroutine </span><span class="n">cl_build_cell_nbrs</span><span class="p">()</span>
<a name="ln-109"></a>    <span class="c">!! Makes a table of neighboring cells.</span>
<a name="ln-110"></a>
<a name="ln-111"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">j</span>
<a name="ln-112"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ncx</span><span class="p">,</span> <span class="n">ncy</span><span class="p">,</span> <span class="n">ncz</span>
<a name="ln-113"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">icx</span><span class="p">,</span> <span class="n">icy</span><span class="p">,</span> <span class="n">icz</span><span class="p">,</span> <span class="n">ic</span>
<a name="ln-114"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">jcx</span><span class="p">,</span> <span class="n">jcy</span><span class="p">,</span> <span class="n">jcz</span><span class="p">,</span> <span class="n">jc</span>
<a name="ln-115"></a>
<a name="ln-116"></a>    <span class="k">if</span> <span class="p">(</span> <span class="n">size</span><span class="p">(</span><span class="n">cell_nbrs_pos</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">nct</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-117"></a><span class="k">        deallocate</span><span class="p">(</span><span class="n">cell_nbrs_pos</span><span class="p">)</span>
<a name="ln-118"></a>        <span class="k">allocate</span><span class="p">(</span><span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nct</span><span class="p">))</span>
<a name="ln-119"></a>    <span class="k">end if</span>
<a name="ln-120"></a>
<a name="ln-121"></a><span class="k">    </span><span class="n">ncx</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">ncy</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">ncz</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-122"></a>
<a name="ln-123"></a>    <span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-124"></a>
<a name="ln-125"></a>    <span class="k">do </span><span class="n">icz</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncz</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-126"></a>        <span class="k">do </span><span class="n">icy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncy</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-127"></a>            <span class="k">do </span><span class="n">icx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-128"></a>                <span class="n">ic</span> <span class="o">=</span> <span class="n">icz</span><span class="o">*</span><span class="n">ncx</span><span class="o">*</span><span class="n">ncy</span> <span class="o">+</span> <span class="n">icy</span><span class="o">*</span><span class="n">ncx</span> <span class="o">+</span> <span class="n">icx</span>
<a name="ln-129"></a>                <span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-130"></a>                <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span>
<a name="ln-131"></a>                    <span class="n">jcx</span> <span class="o">=</span> <span class="nb">modulo</span><span class="p">(</span> <span class="n">icx</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">),</span> <span class="n">ncx</span> <span class="p">)</span>
<a name="ln-132"></a>                    <span class="n">jcy</span> <span class="o">=</span> <span class="nb">modulo</span><span class="p">(</span> <span class="n">icy</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="p">),</span> <span class="n">ncy</span> <span class="p">)</span>
<a name="ln-133"></a>                    <span class="n">jcz</span> <span class="o">=</span> <span class="nb">modulo</span><span class="p">(</span> <span class="n">icz</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">j</span><span class="p">),</span> <span class="n">ncz</span> <span class="p">)</span>
<a name="ln-134"></a>                    <span class="n">jc</span> <span class="o">=</span> <span class="n">jcz</span><span class="o">*</span><span class="n">ncx</span><span class="o">*</span><span class="n">ncy</span> <span class="o">+</span> <span class="n">jcy</span><span class="o">*</span><span class="n">ncx</span> <span class="o">+</span> <span class="n">jcx</span>
<a name="ln-135"></a>                    <span class="k">call </span><span class="n">cell_nbrs</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="n">jc</span><span class="p">)</span>
<a name="ln-136"></a>                    <span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-137"></a>                <span class="k">end do</span>
<a name="ln-138"></a><span class="k">            end do</span>
<a name="ln-139"></a><span class="k">        end do</span>
<a name="ln-140"></a><span class="k">    end do</span>
<a name="ln-141"></a>
<a name="ln-142"></a><span class="k">    call </span><span class="n">cell_nbrs</span><span class="p">%</span><span class="n">shrink_to_fit</span><span class="p">()</span>
<a name="ln-143"></a>
<a name="ln-144"></a>    <span class="k">end subroutine</span>
<a name="ln-145"></a>
<a name="ln-146"></a><span class="c">!******************************************************************************</span>
<a name="ln-147"></a>
<a name="ln-148"></a><span class="k">subroutine </span><span class="n">cl_delete</span><span class="p">()</span>
<a name="ln-149"></a>    <span class="c">!! Deallocates memory allocated in `cl_init`.</span>
<a name="ln-150"></a>
<a name="ln-151"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">cells</span><span class="p">))</span>         <span class="k">deallocate</span><span class="p">(</span><span class="n">cells</span><span class="p">)</span>
<a name="ln-152"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">cells_pos</span><span class="p">))</span>     <span class="k">deallocate</span><span class="p">(</span><span class="n">cells_pos</span><span class="p">)</span>
<a name="ln-153"></a>
<a name="ln-154"></a>    <span class="k">call </span><span class="n">cell_nbrs</span><span class="p">%</span><span class="n">delete</span><span class="p">()</span>
<a name="ln-155"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">cell_nbrs_pos</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">cell_nbrs_pos</span><span class="p">)</span>
<a name="ln-156"></a>
<a name="ln-157"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">host_cells</span><span class="p">))</span>    <span class="k">deallocate</span><span class="p">(</span><span class="n">host_cells</span><span class="p">)</span>
<a name="ln-158"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">cell_pop</span><span class="p">))</span>      <span class="k">deallocate</span><span class="p">(</span><span class="n">cell_pop</span><span class="p">)</span>
<a name="ln-159"></a>
<a name="ln-160"></a>    <span class="n">cell_size</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-161"></a>    <span class="n">nc_max</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">nc</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-162"></a>    <span class="n">nct_max</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">nct</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-163"></a>
<a name="ln-164"></a>    <span class="k">end subroutine</span>
<a name="ln-165"></a>
<a name="ln-166"></a><span class="c">!******************************************************************************</span>
<a name="ln-167"></a>
<a name="ln-168"></a><span class="k">subroutine </span><span class="n">cl_build</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
<a name="ln-169"></a>    <span class="c">!! Sorts atoms into cells for calculating short-range interations</span>
<a name="ln-170"></a>
<a name="ln-171"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">coords</span>
<a name="ln-172"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ri</span>
<a name="ln-173"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">na</span><span class="p">,</span> <span class="n">iatm</span><span class="p">,</span> <span class="n">j</span>
<a name="ln-174"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ncx</span><span class="p">,</span> <span class="n">ncy</span><span class="p">,</span> <span class="n">ncz</span>
<a name="ln-175"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">icx</span><span class="p">,</span> <span class="n">icy</span><span class="p">,</span> <span class="n">icz</span><span class="p">,</span> <span class="n">ic</span>
<a name="ln-176"></a>
<a name="ln-177"></a>    <span class="n">cells</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-178"></a>    <span class="n">host_cells</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-179"></a>    <span class="n">cell_pop</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-180"></a>    <span class="n">ncx</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">ncy</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">ncz</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-181"></a>    <span class="n">na</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-182"></a>
<a name="ln-183"></a>    <span class="c">!Loop over particles and put into cells</span>
<a name="ln-184"></a>    <span class="k">do </span><span class="n">iatm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na</span>
<a name="ln-185"></a>        <span class="n">ri</span> <span class="o">=</span> <span class="n">coords</span><span class="p">(:,</span><span class="n">iatm</span><span class="p">)</span>
<a name="ln-186"></a>        <span class="n">icx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">ri</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">cell_size</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-187"></a>        <span class="n">icy</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">cell_size</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-188"></a>        <span class="n">icz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">ri</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">cell_size</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-189"></a>
<a name="ln-190"></a>        <span class="k">if</span> <span class="p">((</span><span class="n">icx</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">icy</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">icz</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-191"></a><span class="k">            print</span><span class="o">*</span><span class="p">,</span> <span class="n">ri</span>
<a name="ln-192"></a>            <span class="k">stop</span>
<a name="ln-193"></a><span class="k">        end if</span>
<a name="ln-194"></a>
<a name="ln-195"></a>        <span class="c">!If atoms are exactly on the box edge</span>
<a name="ln-196"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">icx</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">ncx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="n">icx</span> <span class="o">=</span> <span class="n">ncx</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-197"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">icy</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">ncy</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="n">icy</span> <span class="o">=</span> <span class="n">ncy</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-198"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">icz</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">ncz</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="n">icz</span> <span class="o">=</span> <span class="n">ncz</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-199"></a>
<a name="ln-200"></a>        <span class="n">ic</span> <span class="o">=</span> <span class="n">icz</span><span class="o">*</span><span class="n">ncx</span><span class="o">*</span><span class="n">ncy</span> <span class="o">+</span> <span class="n">icy</span><span class="o">*</span><span class="n">ncx</span> <span class="o">+</span> <span class="n">icx</span>
<a name="ln-201"></a>        <span class="n">host_cells</span><span class="p">(</span><span class="n">iatm</span><span class="p">)</span> <span class="o">=</span> <span class="n">ic</span>
<a name="ln-202"></a>        <span class="n">cell_pop</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">cell_pop</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-203"></a>    <span class="k">end do</span>
<a name="ln-204"></a>
<a name="ln-205"></a>    <span class="c">!Loop over all cells to set up pointers</span>
<a name="ln-206"></a>    <span class="n">cells_pos</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-207"></a>    <span class="k">do </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">nct</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-208"></a>        <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">+</span> <span class="n">cell_pop</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-209"></a>    <span class="k">end do</span>
<a name="ln-210"></a>
<a name="ln-211"></a>    <span class="c">!Loop over all atoms</span>
<a name="ln-212"></a>    <span class="k">do </span><span class="n">iatm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na</span>
<a name="ln-213"></a>        <span class="n">ic</span> <span class="o">=</span> <span class="n">host_cells</span><span class="p">(</span><span class="n">iatm</span><span class="p">)</span>
<a name="ln-214"></a>        <span class="n">j</span> <span class="o">=</span> <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-215"></a>        <span class="n">cells</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">iatm</span>
<a name="ln-216"></a>        <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-217"></a>    <span class="k">end do</span>
<a name="ln-218"></a>
<a name="ln-219"></a>    <span class="c">!Loop over all cells to set up pointers</span>
<a name="ln-220"></a>    <span class="n">cells_pos</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-221"></a>    <span class="k">do </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">nct</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-222"></a>        <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">+</span> <span class="n">cell_pop</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-223"></a>    <span class="k">end do</span>
<a name="ln-224"></a>
<a name="ln-225"></a><span class="k">    end subroutine</span>
<a name="ln-226"></a>
<a name="ln-227"></a><span class="c">!******************************************************************************</span>
<a name="ln-228"></a>
<a name="ln-229"></a><span class="k">function </span><span class="n">cl_get_num_cells</span><span class="p">()</span> <span class="k">result</span> <span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a name="ln-230"></a>    <span class="c">!! Returns the total number of cells</span>
<a name="ln-231"></a>
<a name="ln-232"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-233"></a>
<a name="ln-234"></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">nct</span>
<a name="ln-235"></a>
<a name="ln-236"></a>    <span class="k">end function</span>
<a name="ln-237"></a>
<a name="ln-238"></a><span class="c">!******************************************************************************</span>
<a name="ln-239"></a>
<a name="ln-240"></a><span class="k">subroutine </span><span class="n">cl_get_contents</span><span class="p">(</span><span class="n">ic</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>
<a name="ln-241"></a>    <span class="c">!! Returns a pointer to the entries of cell with linear index *ic*.</span>
<a name="ln-242"></a>
<a name="ln-243"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ic</span>
<a name="ln-244"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-245"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ibeg</span><span class="p">,</span> <span class="n">iend</span>
<a name="ln-246"></a>
<a name="ln-247"></a>    <span class="n">res</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-248"></a>    <span class="n">ibeg</span> <span class="o">=</span> <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="p">);</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-249"></a>    <span class="n">res</span> <span class="o">=&gt;</span> <span class="n">cells</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span>
<a name="ln-250"></a>
<a name="ln-251"></a>    <span class="k">end subroutine</span>
<a name="ln-252"></a>
<a name="ln-253"></a><span class="c">!******************************************************************************</span>
<a name="ln-254"></a>
<a name="ln-255"></a><span class="k">subroutine </span><span class="n">cl_get_nbr_cells</span><span class="p">(</span><span class="n">ic</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>
<a name="ln-256"></a>    <span class="c">!! Returns a pointer to the neighbor cells of cell with linear index *ic*.</span>
<a name="ln-257"></a>
<a name="ln-258"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ic</span>
<a name="ln-259"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-260"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ibeg</span><span class="p">,</span> <span class="n">iend</span>
<a name="ln-261"></a>
<a name="ln-262"></a>    <span class="n">res</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-263"></a>    <span class="n">ibeg</span> <span class="o">=</span> <span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="n">ic</span><span class="p">);</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-264"></a>    <span class="k">call </span><span class="n">cell_nbrs</span><span class="p">%</span><span class="n">get_data</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">ibeg</span><span class="p">,</span> <span class="n">iend</span><span class="p">)</span>
<a name="ln-265"></a>
<a name="ln-266"></a>    <span class="k">end subroutine</span>
<a name="ln-267"></a>
<a name="ln-268"></a><span class="c">!********************************************************************************</span>
<a name="ln-269"></a>
<a name="ln-270"></a><span class="k">subroutine </span><span class="n">cl_print</span><span class="p">()</span>
<a name="ln-271"></a>    <span class="c">!! Prints a cell list</span>
<a name="ln-272"></a>
<a name="ln-273"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">aic</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-274"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">nbrc</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-275"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ncx</span><span class="p">,</span> <span class="n">ncy</span><span class="p">,</span> <span class="n">ncz</span>
<a name="ln-276"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">icx</span><span class="p">,</span> <span class="n">icy</span><span class="p">,</span> <span class="n">icz</span><span class="p">,</span> <span class="n">ic</span>
<a name="ln-277"></a>
<a name="ln-278"></a>    <span class="n">ncx</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">ncy</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">ncz</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-279"></a>
<a name="ln-280"></a>    <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(&quot;ncx: &quot;, i0, &quot; ncy: &quot;, i0, &quot; ncz: &quot;, i0)&#39;</span><span class="p">)</span> <span class="n">ncx</span><span class="p">,</span> <span class="n">ncy</span><span class="p">,</span> <span class="n">ncz</span>
<a name="ln-281"></a>    <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(&quot;lcx: &quot;, g0.6, &quot; lcy: &quot;, g0.6, &quot; lcz: &quot;, g0.6)&#39;</span><span class="p">)</span> <span class="n">cell_size</span>
<a name="ln-282"></a>    <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;CELL CONTENTS&#39;</span>
<a name="ln-283"></a>    <span class="k">do </span><span class="n">icz</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncz</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-284"></a>        <span class="k">do </span><span class="n">icy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncy</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-285"></a>            <span class="k">do </span><span class="n">icx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-286"></a>                <span class="n">ic</span> <span class="o">=</span> <span class="n">icz</span><span class="o">*</span><span class="n">ncx</span><span class="o">*</span><span class="n">ncy</span> <span class="o">+</span> <span class="n">icy</span><span class="o">*</span><span class="n">ncx</span> <span class="o">+</span> <span class="n">icx</span>
<a name="ln-287"></a>                <span class="k">call </span><span class="n">cl_get_contents</span><span class="p">(</span><span class="n">ic</span><span class="p">,</span> <span class="n">aic</span><span class="p">)</span>
<a name="ln-288"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">size</span><span class="p">(</span><span class="n">aic</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-289"></a><span class="k">                    write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(&quot;(&quot;,i0,&quot;,&quot;,i0,&quot;,&quot;,i0,&quot;)[&quot;,i0,&quot;] &quot;)&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">icx</span><span class="p">,</span> <span class="n">icy</span><span class="p">,</span> <span class="n">icz</span><span class="p">,</span> <span class="n">ic</span>
<a name="ln-290"></a>                    <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">size</span><span class="p">(</span><span class="n">aic</span><span class="p">),</span> <span class="n">aic</span>
<a name="ln-291"></a>                <span class="k">end if</span>
<a name="ln-292"></a><span class="k">            end do</span>
<a name="ln-293"></a><span class="k">        end do</span>
<a name="ln-294"></a><span class="k">    end do</span>
<a name="ln-295"></a>
<a name="ln-296"></a><span class="k">    write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>
<a name="ln-297"></a>    <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;NBR CELLS&#39;</span>
<a name="ln-298"></a>    <span class="k">do </span><span class="n">icz</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncz</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-299"></a>        <span class="k">do </span><span class="n">icy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncy</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-300"></a>            <span class="k">do </span><span class="n">icx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-301"></a>                <span class="n">ic</span> <span class="o">=</span> <span class="n">icz</span><span class="o">*</span><span class="n">ncx</span><span class="o">*</span><span class="n">ncy</span> <span class="o">+</span> <span class="n">icy</span><span class="o">*</span><span class="n">ncx</span> <span class="o">+</span> <span class="n">icx</span>
<a name="ln-302"></a>                <span class="k">call </span><span class="n">cl_get_nbr_cells</span><span class="p">(</span><span class="n">ic</span><span class="p">,</span> <span class="n">nbrc</span><span class="p">)</span>
<a name="ln-303"></a>                <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(&quot;(&quot;,i0,&quot;,&quot;,i0,&quot;,&quot;,i0,&quot;)[&quot;,i0,&quot;] &quot;)&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">icx</span><span class="p">,</span> <span class="n">icy</span><span class="p">,</span> <span class="n">icz</span><span class="p">,</span> <span class="n">ic</span>
<a name="ln-304"></a>                <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">size</span><span class="p">(</span><span class="n">nbrc</span><span class="p">),</span> <span class="n">nbrc</span>
<a name="ln-305"></a>            <span class="k">end do</span>
<a name="ln-306"></a><span class="k">        end do</span>
<a name="ln-307"></a><span class="k">    end do</span>
<a name="ln-308"></a>
<a name="ln-309"></a><span class="k">    end subroutine</span>
<a name="ln-310"></a>
<a name="ln-311"></a><span class="c">!********************************************************************************</span>
<a name="ln-312"></a>
<a name="ln-313"></a><span class="k">end module </span><span class="n">m_cell_list</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> BROWNPAK was developed by Sarit Dutta</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>