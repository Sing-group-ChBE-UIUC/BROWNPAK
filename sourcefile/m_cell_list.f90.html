<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for BROWNPAK">
   
    <meta name="author" content="Sarit Dutta" >
    <link rel="icon" href="../favicon.png">

    <title>m_cell_list.f90 &ndash; BROWNPAK</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">BROWNPAK <small>0.2</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>m_cell_list.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 3.1% of total for source files.">193 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/m_cell_list.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">m_cell_list.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_cell_list.html">m_cell_list</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_cell_list.f90.html#src">m_cell_list.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_cell_list.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilem_cell_listf90EfferentGraph" width="603pt" height="276pt"
 viewBox="0.00 0.00 603.00 275.86" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 271.8561)">
<title>sourcefile~~m_cell_list.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-271.8561 599,-271.8561 599,4 -4,4"/>
<!-- sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~m_cell_list.f90</title>
<polygon fill="none" stroke="#000000" points="595,-124 516,-124 516,-100 595,-100 595,-124"/>
<text text-anchor="middle" x="555.5" y="-109.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_cell_list.f90</text>
</g>
<!-- sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~m_globals.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/m_globals.f90.html" xlink:title="m_globals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480,-186 402,-186 402,-162 480,-162 480,-186"/>
<text text-anchor="middle" x="441" y="-171.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_globals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M533.1514,-124.1014C515.8134,-133.4897 491.5693,-146.6175 472.3,-157.0515"/>
<polygon fill="#ff0000" stroke="#ff0000" points="470.4192,-154.0897 463.2922,-161.9291 473.7524,-160.2452 470.4192,-154.0897"/>
</g>
<!-- sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~m_precision.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/m_precision.f90.html" xlink:title="m_precision.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="87,-125 0,-125 0,-101 87,-101 87,-125"/>
<text text-anchor="middle" x="43.5" y="-110.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_precision.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M441,-52C386.5553,-33.6796 237.7394,-36.237 182.5,-52"/>
</g>
<!-- sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~m_vector.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/m_vector.f90.html" xlink:title="m_vector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="358.5,-24 285.5,-24 285.5,0 358.5,0 358.5,-24"/>
<text text-anchor="middle" x="322" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_vector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_vector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M441,-52C416.7073,-43.8256 389.6221,-34.7206 367.436,-27.2649"/>
<polygon fill="#ff0000" stroke="#ff0000" points="368.5274,-23.9394 357.9334,-24.0717 366.2977,-30.5748 368.5274,-23.9394"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M536.8799,-99.8673C514.8784,-86.1067 476.7344,-64.0244 441,-52"/>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M430.4542,-186.0739C417.0695,-200.4842 392.5124,-224.009 366,-235 290.259,-266.3993 260.1975,-280.1861 182.5,-254"/>
</g>
<!-- sourcefile~m_trajectory.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~m_trajectory.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/m_trajectory.f90.html" xlink:title="m_trajectory.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-226 278,-226 278,-202 366,-202 366,-226"/>
<text text-anchor="middle" x="322" y="-211.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_trajectory.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_trajectory.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_trajectory.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M405.2961,-186.0013C393.5197,-189.9598 380.2542,-194.4187 367.8296,-198.5951"/>
<polygon fill="#ff0000" stroke="#ff0000" points="366.4537,-195.3651 358.09,-201.8689 368.684,-202.0003 366.4537,-195.3651"/>
</g>
<!-- sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~m_simbox.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/m_simbox.f90.html" xlink:title="m_simbox.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="361,-165 283,-165 283,-141 361,-141 361,-165"/>
<text text-anchor="middle" x="322" y="-150.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_simbox.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_simbox.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M401.7052,-167.0656C391.9564,-165.3453 381.3866,-163.48 371.2286,-161.6874"/>
<polygon fill="#ff0000" stroke="#ff0000" points="371.7097,-158.2183 361.2536,-159.9271 370.4932,-165.1118 371.7097,-158.2183"/>
</g>
<!-- sourcefile~m_vector.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~m_vector.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M285.2932,-22.5529C257.1654,-30.6327 217.3877,-42.0445 182.5,-52"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M182.5,-52C155.8056,-59.6175 148.5949,-60.2521 123,-71 105.999,-78.1391 87.7608,-87.6322 73.0468,-95.787"/>
<polygon fill="#0000ff" stroke="#0000ff" points="70.9335,-92.96 63.935,-100.9144 74.3664,-99.0605 70.9335,-92.96"/>
</g>
<!-- sourcefile~m_qsort.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~m_qsort.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/m_qsort.f90.html" xlink:title="m_qsort.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="216.5,-24 148.5,-24 148.5,0 216.5,0 216.5,-24"/>
<text text-anchor="middle" x="182.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_qsort.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_vector.f90&#45;&gt;sourcefile~m_qsort.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~m_vector.f90&#45;&gt;sourcefile~m_qsort.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M285.348,-12C267.3664,-12 245.5643,-12 226.6694,-12"/>
<polygon fill="#0000ff" stroke="#0000ff" points="226.5141,-8.5001 216.514,-12 226.514,-15.5001 226.5141,-8.5001"/>
</g>
<!-- sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M182.5,-254C156.1939,-245.1341 145.0794,-251.8261 123,-235 88.0539,-208.3686 63.9158,-161.6675 52.0174,-134.4215"/>
<polygon fill="#ff0000" stroke="#ff0000" points="55.1637,-132.8743 48.0595,-125.0142 48.7115,-135.5889 55.1637,-132.8743"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M294.0295,-226.0826C259.5985,-240.2461 203.1521,-260.9603 182.5,-254"/>
</g>
<!-- sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~m_logger.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~EfferentGraph_node10"><a xlink:href=".././sourcefile/m_logger.f90.html" xlink:title="m_logger.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="219.5,-226 145.5,-226 145.5,-202 219.5,-202 219.5,-226"/>
<text text-anchor="middle" x="182.5" y="-211.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_logger.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_logger.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M277.8613,-214C262.6851,-214 245.6303,-214 230.1848,-214"/>
<polygon fill="#ff0000" stroke="#ff0000" points="229.7918,-210.5001 219.7918,-214 229.7917,-217.5001 229.7918,-210.5001"/>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M282.8097,-159.1052C242.1835,-164.1169 177.1593,-168.4269 123,-155 103.803,-150.2408 84.1342,-139.9042 69.1631,-130.677"/>
<polygon fill="#00ff00" stroke="#00ff00" points="70.8054,-127.5728 60.4948,-125.1349 67.0347,-133.4704 70.8054,-127.5728"/>
</g>
<!-- sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~m_constants_math.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/m_constants_math.f90.html" xlink:title="m_constants_math.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="242,-146 123,-146 123,-122 242,-122 242,-146"/>
<text text-anchor="middle" x="182.5" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_constants_math.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M282.7702,-147.6569C273.1823,-146.351 262.6358,-144.9146 252.0942,-143.4788"/>
<polygon fill="#00ff00" stroke="#00ff00" points="252.401,-139.9883 242.0201,-142.1067 251.4563,-146.9243 252.401,-139.9883"/>
</g>
<!-- sourcefile~m_ran_num.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~m_ran_num.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/m_ran_num.f90.html" xlink:title="m_ran_num.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="225.5,-104 139.5,-104 139.5,-80 225.5,-80 225.5,-104"/>
<text text-anchor="middle" x="182.5" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ran_num.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_ran_num.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_ran_num.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M299.5935,-140.8571C283.7458,-132.5023 261.868,-121.4345 242,-113 237.6295,-111.1446 233.0333,-109.3155 228.4131,-107.557"/>
<polygon fill="#00ff00" stroke="#00ff00" points="229.5537,-104.2471 218.9605,-104.0606 227.1253,-110.8124 229.5537,-104.2471"/>
</g>
<!-- sourcefile~m_qsort.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~m_qsort.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M149.332,-24.0959C140.4558,-27.9651 131.0874,-32.6536 123,-38 99.1953,-53.7368 75.9228,-76.8675 60.7726,-93.2739"/>
<polygon fill="#0000ff" stroke="#0000ff" points="58.1415,-90.9651 54.021,-100.7258 63.329,-95.6651 58.1415,-90.9651"/>
</g>
<!-- sourcefile~m_constants_math.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~m_constants_math.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M122.7448,-124.9722C114.2703,-123.6919 105.5985,-122.3818 97.2471,-121.1201"/>
<polygon fill="#ff0000" stroke="#ff0000" points="97.6646,-117.6435 87.2539,-119.6103 96.6189,-124.565 97.6646,-117.6435"/>
</g>
<!-- sourcefile~m_ran_num.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_cell_list.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~m_ran_num.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M139.2815,-98.5294C125.9425,-100.5447 111.0889,-102.7887 97.1364,-104.8967"/>
<polygon fill="#00ff00" stroke="#00ff00" points="96.5355,-101.4476 87.1705,-106.4023 97.5812,-108.3691 96.5355,-101.4476"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_cell_list.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilem_cell_listf90AfferentGraph" width="538pt" height="192pt"
 viewBox="0.00 0.00 538.00 192.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 188)">
<title>sourcefile~~m_cell_list.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-188 534,-188 534,4 -4,4"/>
<!-- sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~m_cell_list.f90</title>
<polygon fill="none" stroke="#000000" points="79,-144 0,-144 0,-120 79,-120 79,-144"/>
<text text-anchor="middle" x="39.5" y="-129.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_cell_list.f90</text>
</g>
<!-- sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~m_interaction.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/m_interaction.f90.html" xlink:title="m_interaction.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="208,-124 115,-124 115,-100 208,-100 208,-124"/>
<text text-anchor="middle" x="161.5" y="-109.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_interaction.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_cell_list.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M114.6805,-119.6753C106.3681,-121.038 97.6838,-122.4617 89.2924,-123.8373"/>
<polygon fill="#ff0000" stroke="#ff0000" points="88.549,-120.4124 79.2469,-125.4841 89.6814,-127.3202 88.549,-120.4124"/>
</g>
<!-- sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~m_mpcd.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/m_mpcd.f90.html" xlink:title="m_mpcd.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="324,-184 254,-184 254,-160 324,-160 324,-184"/>
<text text-anchor="middle" x="289" y="-169.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_mpcd.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_cell_list.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M253.7819,-166.3538C210.7677,-159.4578 137.7383,-147.7496 89.0646,-139.9462"/>
<polygon fill="#ff0000" stroke="#ff0000" points="89.4954,-136.4707 79.0674,-138.3435 88.3872,-143.3824 89.4954,-136.4707"/>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M263.1985,-159.8581C244.0157,-150.8309 217.6253,-138.4119 196.5353,-128.4872"/>
<polygon fill="#ff0000" stroke="#ff0000" points="197.8017,-125.215 187.2632,-124.1238 194.821,-131.5487 197.8017,-125.215"/>
</g>
<!-- sourcefile~m_kmc.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~m_kmc.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/m_kmc.f90.html" xlink:title="m_kmc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="321,-24 257,-24 257,0 321,0 321,-24"/>
<text text-anchor="middle" x="289" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_kmc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_kmc.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~m_kmc.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M265.9939,-24.0753C258.7564,-28.1919 250.8655,-33.0202 244,-38 220.8446,-54.7954 196.7594,-77.041 180.634,-92.7417"/>
<polygon fill="#ff0000" stroke="#ff0000" points="178.0644,-90.36 173.3962,-99.8711 182.9766,-95.347 178.0644,-90.36"/>
</g>
<!-- sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~m_setup.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/m_setup.f90.html" xlink:title="m_setup.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="440,-144 370,-144 370,-120 440,-120 440,-144"/>
<text text-anchor="middle" x="405" y="-129.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_setup.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M369.8531,-129.1132C330.2206,-125.858 265.2031,-120.5177 218.3302,-116.6678"/>
<polygon fill="#ff0000" stroke="#ff0000" points="218.5755,-113.1762 208.3226,-115.8458 218.0025,-120.1527 218.5755,-113.1762"/>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_mpcd.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M370.1962,-144.0013C358.7166,-147.9598 345.7856,-152.4187 333.6742,-156.5951"/>
<polygon fill="#00ffff" stroke="#00ffff" points="332.4929,-153.3001 324.1802,-159.8689 334.7749,-159.9177 332.4929,-153.3001"/>
</g>
<!-- sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~m_bd_solver.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/m_bd_solver.f90.html" xlink:title="m_bd_solver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="334,-104 244,-104 244,-80 334,-80 334,-104"/>
<text text-anchor="middle" x="289" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_bd_solver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_bd_solver.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M370.1962,-119.9987C358.7166,-116.0402 345.7856,-111.5813 333.6742,-107.4049"/>
<polygon fill="#00ff66" stroke="#00ff66" points="334.7749,-104.0823 324.1802,-104.1311 332.4929,-110.6999 334.7749,-104.0823"/>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M243.6893,-99.1076C235.5474,-100.3847 226.9666,-101.7307 218.5436,-103.052"/>
<polygon fill="#ff0000" stroke="#ff0000" points="217.7247,-99.6376 208.3879,-104.645 218.8095,-106.553 217.7247,-99.6376"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="530,-124 476,-124 476,-100 530,-100 530,-124"/>
<text text-anchor="middle" x="503" y="-109.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_mpcd.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M488.506,-124.1882C476.3584,-133.6927 458.1357,-146.3583 440,-153 406.0435,-165.4356 365.2358,-170.0051 334.608,-171.5649"/>
<polygon fill="#00ffff" stroke="#00ffff" points="334.0721,-168.0842 324.2271,-171.9991 334.3646,-175.0781 334.0721,-168.0842"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M475.9616,-117.518C467.8936,-119.1646 458.824,-121.0155 449.9341,-122.8298"/>
<polygon fill="#cbff00" stroke="#cbff00" points="449.1346,-119.4207 440.0365,-124.8497 450.5344,-126.2793 449.1346,-119.4207"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_bd_solver.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M475.8968,-109.467C442.9597,-106.3888 386.556,-101.1174 344.3063,-97.1688"/>
<polygon fill="#00ff66" stroke="#00ff66" points="344.4476,-93.6669 334.1653,-96.2211 343.7962,-100.6365 344.4476,-93.6669"/>
</g>
<!-- sourcefile~m_relax.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~m_relax.f90</title>
<g id="a_sourcefile~~m_cell_list.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/m_relax.f90.html" xlink:title="m_relax.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="438.5,-64 371.5,-64 371.5,-40 438.5,-40 438.5,-64"/>
<text text-anchor="middle" x="405" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_relax.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_relax.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_relax.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M483.1682,-99.8581C468.9552,-91.1562 449.5942,-79.3026 433.697,-69.5696"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="435.1584,-66.3604 424.8023,-64.1238 431.5032,-72.3304 435.1584,-66.3604"/>
</g>
<!-- sourcefile~m_relax.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_cell_list.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~m_relax.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M371.3337,-52.6298C338.285,-54.0212 286.756,-58.2716 244,-71 225.212,-76.5932 205.504,-86.2284 190.0633,-94.7534"/>
<polygon fill="#ff0000" stroke="#ff0000" points="188.0156,-91.8911 181.0471,-99.8718 191.4715,-97.9786 188.0156,-91.8911"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_cell_list.html">m_cell_list</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_cell_list.f90.html#src">m_cell_list.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">module </span><span class="n">m_cell_list</span>
<a name="ln-2"></a>    <span class="c">!! Sorts atoms using a cell list.</span>
<a name="ln-3"></a>    <span class="c">!!</span>
<a name="ln-4"></a>    <span class="c">!! The algorithm to build the cell list partially follows the techniques in Watanabe et</span>
<a name="ln-5"></a>    <span class="c">!! al, 2011, “Efficient Implementations of Molecular Dynamics Simulations for</span>
<a name="ln-6"></a>    <span class="c">!! Lennard-Jones Systems,” Prog. Theor. Phys. 126, 203–235.</span>
<a name="ln-7"></a>    <span class="c">!!</span>
<a name="ln-8"></a>    <span class="c">!! The pairlist is not explicitly built, rather the cells are directly</span>
<a name="ln-9"></a>    <span class="c">!! looped over during force calculation.</span>
<a name="ln-10"></a>
<a name="ln-11"></a><span class="k">use </span><span class="n">m_precision</span>
<a name="ln-12"></a><span class="k">use </span><span class="n">m_vector</span>
<a name="ln-13"></a><span class="k">use </span><span class="n">m_globals</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">simbox</span>
<a name="ln-14"></a>
<a name="ln-15"></a><span class="k">implicit none</span>
<a name="ln-16"></a>
<a name="ln-17"></a><span class="k">private</span>
<a name="ln-18"></a>
<a name="ln-19"></a><span class="k">public</span> <span class="kd">::</span> <span class="n">cl_init</span><span class="p">,</span> <span class="n">cl_delete</span><span class="p">,</span> <span class="n">cl_print</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-20"></a>          <span class="n">cl_set_cell_size</span><span class="p">,</span> <span class="n">cl_build</span><span class="p">,</span> <span class="n">cl_build_cell_nbrs</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-21"></a>          <span class="n">cl_get_num_cells</span><span class="p">,</span> <span class="n">cl_get_contents</span><span class="p">,</span> <span class="n">cl_get_nbr_cells</span> 
<a name="ln-22"></a>
<a name="ln-23"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">cell_size</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-24"></a>    <span class="c">!! Cell size along *x*, *y*, &amp; *z*.</span>
<a name="ln-25"></a><span class="kt">integer</span><span class="p">,</span>  <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">nc_max</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-26"></a>    <span class="c">!! Maximum number of cells along *x*, *y*, &amp; *z*.</span>
<a name="ln-27"></a><span class="kt">integer</span><span class="p">,</span>  <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">nc</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-28"></a>    <span class="c">!! Number of cells along *x*, *y*, &amp; *z*.</span>
<a name="ln-29"></a><span class="kt">integer</span>  <span class="kd">::</span> <span class="n">nct_max</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-30"></a>    <span class="c">!! Maximum total number of cells.</span>
<a name="ln-31"></a><span class="kt">integer</span>  <span class="kd">::</span> <span class="n">nct</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-32"></a>    <span class="c">!! Total of cells.</span>
<a name="ln-33"></a><span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">cells</span>
<a name="ln-34"></a>    <span class="c">!! *(na_max,)* array. Listing atoms in each cell.</span>
<a name="ln-35"></a><span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">cells_pos</span>
<a name="ln-36"></a>    <span class="c">!! *(0:nct_max,)* index array. Note: 0-based indexing.</span>
<a name="ln-37"></a><span class="k">type</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cell_nbrs</span>
<a name="ln-38"></a>    <span class="c">!! Lists neighbor cells for each cell.</span>
<a name="ln-39"></a><span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">cell_nbrs_pos</span>
<a name="ln-40"></a>    <span class="c">!! *(0:nct_max,)* index array. Note: 0-based indexing.</span>
<a name="ln-41"></a><span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">host_cells</span>
<a name="ln-42"></a>    <span class="c">!! *(na_max,)* array. *host_cells(i)* stores the linear index of the cell</span>
<a name="ln-43"></a>    <span class="c">!! containing atom *i*. *na_max* is the total number of atoms under consideration.</span>
<a name="ln-44"></a><span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">cell_pop</span>
<a name="ln-45"></a>    <span class="c">!! *(0:nct_max-1,)* array storing population of each cell. Note: 0-based indexing.</span>
<a name="ln-46"></a><span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">13</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">d</span> <span class="o">=</span> <span class="nb">reshape</span><span class="p">(</span> <span class="p">[</span>           <span class="p">&amp;</span>
<a name="ln-47"></a>                <span class="p">&amp;</span>                            <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-48"></a>                <span class="p">&amp;</span>    <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>   <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-49"></a>                <span class="p">&amp;</span>    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>   <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-50"></a>                <span class="p">&amp;</span>   <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-51"></a>                <span class="p">&amp;</span>   <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">13</span><span class="p">]</span> <span class="p">)</span>
<a name="ln-52"></a>
<a name="ln-53"></a><span class="k">contains</span>
<a name="ln-54"></a>
<a name="ln-55"></a><span class="c">!******************************************************************************</span>
<a name="ln-56"></a>
<a name="ln-57"></a><span class="k">subroutine </span><span class="n">cl_init</span><span class="p">(</span><span class="n">na_max</span><span class="p">,</span> <span class="n">cs_min</span><span class="p">)</span>
<a name="ln-58"></a>    <span class="c">!! Initializes a cell list.</span>
<a name="ln-59"></a>
<a name="ln-60"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">na_max</span>
<a name="ln-61"></a>        <span class="c">!! Maximum number of atoms to be handled.</span>
<a name="ln-62"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cs_min</span>
<a name="ln-63"></a>        <span class="c">!! Minimum size (i.e. length) of a cell.</span>
<a name="ln-64"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">nelem</span>
<a name="ln-65"></a>    
<a name="ln-66"></a>    <span class="c">!The following defines an upper bound on the number of cells</span>
<a name="ln-67"></a>    <span class="n">nc_max</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">ceiling</span><span class="p">(</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">cs_min</span> <span class="p">)</span>
<a name="ln-68"></a>    <span class="n">nc_max</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="nb">ceiling</span><span class="p">(</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">cs_min</span> <span class="p">)</span>
<a name="ln-69"></a>    <span class="n">nc_max</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">ceiling</span><span class="p">(</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">cs_min</span> <span class="p">)</span>
<a name="ln-70"></a>
<a name="ln-71"></a>    <span class="n">nct_max</span> <span class="o">=</span> <span class="nb">product</span><span class="p">(</span><span class="n">nc_max</span><span class="p">)</span>
<a name="ln-72"></a>
<a name="ln-73"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">cells</span><span class="p">(</span><span class="n">na_max</span><span class="p">))</span>
<a name="ln-74"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">cells_pos</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nct_max</span><span class="p">))</span>
<a name="ln-75"></a>
<a name="ln-76"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">host_cells</span><span class="p">(</span><span class="n">na_max</span><span class="p">))</span>
<a name="ln-77"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">cell_pop</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nct_max</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-78"></a>
<a name="ln-79"></a>    <span class="c">!Provisional allocation with nelem (arbitrary) elements,</span>
<a name="ln-80"></a>    <span class="c">!will expand/contract later.</span>
<a name="ln-81"></a>    <span class="n">nelem</span> <span class="o">=</span> <span class="mi">8</span>
<a name="ln-82"></a>    <span class="k">call </span><span class="n">ivector_init</span><span class="p">(</span><span class="n">cell_nbrs</span><span class="p">,</span> <span class="n">nelem</span><span class="p">)</span>
<a name="ln-83"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nelem</span><span class="p">))</span>
<a name="ln-84"></a>
<a name="ln-85"></a>    <span class="k">end subroutine</span>
<a name="ln-86"></a>
<a name="ln-87"></a><span class="c">!******************************************************************************</span>
<a name="ln-88"></a>
<a name="ln-89"></a><span class="k">subroutine </span><span class="n">cl_set_cell_size</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
<a name="ln-90"></a>    <span class="c">!! Sets the cell size. The actual cell size may be slightly larger.</span>
<a name="ln-91"></a>
<a name="ln-92"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cs</span>
<a name="ln-93"></a>
<a name="ln-94"></a>    <span class="n">nc</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">floor</span><span class="p">(</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">cs</span> <span class="p">)</span>
<a name="ln-95"></a>    <span class="n">nc</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="nb">floor</span><span class="p">(</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">cs</span> <span class="p">)</span>
<a name="ln-96"></a>    <span class="n">nc</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">floor</span><span class="p">(</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">cs</span> <span class="p">)</span>
<a name="ln-97"></a>
<a name="ln-98"></a>    <span class="n">nct</span> <span class="o">=</span> <span class="nb">product</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span>
<a name="ln-99"></a>
<a name="ln-100"></a>    <span class="n">cell_size</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">nc</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-101"></a>    <span class="n">cell_size</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">nc</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-102"></a>    <span class="n">cell_size</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">nc</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-103"></a>
<a name="ln-104"></a>    <span class="k">end subroutine</span>
<a name="ln-105"></a>
<a name="ln-106"></a><span class="c">!******************************************************************************</span>
<a name="ln-107"></a>
<a name="ln-108"></a><span class="k">subroutine </span><span class="n">cl_build_cell_nbrs</span><span class="p">()</span>
<a name="ln-109"></a>    <span class="c">!! Makes a table of neighboring cells.</span>
<a name="ln-110"></a>
<a name="ln-111"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">j</span>
<a name="ln-112"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ncx</span><span class="p">,</span> <span class="n">ncy</span><span class="p">,</span> <span class="n">ncz</span>
<a name="ln-113"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">icx</span><span class="p">,</span> <span class="n">icy</span><span class="p">,</span> <span class="n">icz</span><span class="p">,</span> <span class="n">ic</span>
<a name="ln-114"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">jcx</span><span class="p">,</span> <span class="n">jcy</span><span class="p">,</span> <span class="n">jcz</span><span class="p">,</span> <span class="n">jc</span>
<a name="ln-115"></a>
<a name="ln-116"></a>    <span class="k">if</span> <span class="p">(</span> <span class="n">size</span><span class="p">(</span><span class="n">cell_nbrs_pos</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">nct</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-117"></a><span class="k">        deallocate</span><span class="p">(</span><span class="n">cell_nbrs_pos</span><span class="p">)</span>
<a name="ln-118"></a>        <span class="k">allocate</span><span class="p">(</span><span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nct</span><span class="p">))</span>
<a name="ln-119"></a>    <span class="k">end if</span>
<a name="ln-120"></a>
<a name="ln-121"></a><span class="k">    </span><span class="n">ncx</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">ncy</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">ncz</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-122"></a>
<a name="ln-123"></a>    <span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-124"></a>
<a name="ln-125"></a>    <span class="k">do </span><span class="n">icz</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncz</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-126"></a>        <span class="k">do </span><span class="n">icy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncy</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-127"></a>            <span class="k">do </span><span class="n">icx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-128"></a>                <span class="n">ic</span> <span class="o">=</span> <span class="n">icz</span><span class="o">*</span><span class="n">ncx</span><span class="o">*</span><span class="n">ncy</span> <span class="o">+</span> <span class="n">icy</span><span class="o">*</span><span class="n">ncx</span> <span class="o">+</span> <span class="n">icx</span>
<a name="ln-129"></a>                <span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-130"></a>                <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span>
<a name="ln-131"></a>                    <span class="n">jcx</span> <span class="o">=</span> <span class="nb">modulo</span><span class="p">(</span> <span class="n">icx</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">),</span> <span class="n">ncx</span> <span class="p">)</span>
<a name="ln-132"></a>                    <span class="n">jcy</span> <span class="o">=</span> <span class="nb">modulo</span><span class="p">(</span> <span class="n">icy</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="p">),</span> <span class="n">ncy</span> <span class="p">)</span>
<a name="ln-133"></a>                    <span class="n">jcz</span> <span class="o">=</span> <span class="nb">modulo</span><span class="p">(</span> <span class="n">icz</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">j</span><span class="p">),</span> <span class="n">ncz</span> <span class="p">)</span>
<a name="ln-134"></a>                    <span class="n">jc</span> <span class="o">=</span> <span class="n">jcz</span><span class="o">*</span><span class="n">ncx</span><span class="o">*</span><span class="n">ncy</span> <span class="o">+</span> <span class="n">jcy</span><span class="o">*</span><span class="n">ncx</span> <span class="o">+</span> <span class="n">jcx</span>
<a name="ln-135"></a>                    <span class="k">call </span><span class="n">cell_nbrs</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="n">jc</span><span class="p">)</span>
<a name="ln-136"></a>                    <span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-137"></a>                <span class="k">end do</span>
<a name="ln-138"></a><span class="k">            end do</span>
<a name="ln-139"></a><span class="k">        end do</span>
<a name="ln-140"></a><span class="k">    end do</span>
<a name="ln-141"></a>
<a name="ln-142"></a><span class="k">    call </span><span class="n">cell_nbrs</span><span class="p">%</span><span class="n">shrink_to_fit</span><span class="p">()</span>
<a name="ln-143"></a>
<a name="ln-144"></a>    <span class="k">end subroutine</span>
<a name="ln-145"></a>
<a name="ln-146"></a><span class="c">!******************************************************************************</span>
<a name="ln-147"></a>
<a name="ln-148"></a><span class="k">subroutine </span><span class="n">cl_delete</span><span class="p">()</span>
<a name="ln-149"></a>    <span class="c">!! Deallocates memory allocated in `cl_init`.</span>
<a name="ln-150"></a>
<a name="ln-151"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">cells</span><span class="p">))</span>         <span class="k">deallocate</span><span class="p">(</span><span class="n">cells</span><span class="p">)</span>
<a name="ln-152"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">cells_pos</span><span class="p">))</span>     <span class="k">deallocate</span><span class="p">(</span><span class="n">cells_pos</span><span class="p">)</span>
<a name="ln-153"></a>
<a name="ln-154"></a>    <span class="k">call </span><span class="n">cell_nbrs</span><span class="p">%</span><span class="n">delete</span><span class="p">()</span>
<a name="ln-155"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">cell_nbrs_pos</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">cell_nbrs_pos</span><span class="p">)</span>
<a name="ln-156"></a>
<a name="ln-157"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">host_cells</span><span class="p">))</span>    <span class="k">deallocate</span><span class="p">(</span><span class="n">host_cells</span><span class="p">)</span>
<a name="ln-158"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">cell_pop</span><span class="p">))</span>      <span class="k">deallocate</span><span class="p">(</span><span class="n">cell_pop</span><span class="p">)</span>
<a name="ln-159"></a>
<a name="ln-160"></a>    <span class="n">cell_size</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-161"></a>    <span class="n">nc_max</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">nc</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-162"></a>    <span class="n">nct_max</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">nct</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-163"></a>
<a name="ln-164"></a>    <span class="k">end subroutine</span>
<a name="ln-165"></a>
<a name="ln-166"></a><span class="c">!******************************************************************************</span>
<a name="ln-167"></a>
<a name="ln-168"></a><span class="k">subroutine </span><span class="n">cl_build</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
<a name="ln-169"></a>    <span class="c">!! Sorts atoms into cells for calculating short-range interations</span>
<a name="ln-170"></a>
<a name="ln-171"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">coords</span>
<a name="ln-172"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ri</span>
<a name="ln-173"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">na</span><span class="p">,</span> <span class="n">iatm</span><span class="p">,</span> <span class="n">j</span>
<a name="ln-174"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ncx</span><span class="p">,</span> <span class="n">ncy</span><span class="p">,</span> <span class="n">ncz</span>
<a name="ln-175"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">icx</span><span class="p">,</span> <span class="n">icy</span><span class="p">,</span> <span class="n">icz</span><span class="p">,</span> <span class="n">ic</span>
<a name="ln-176"></a>
<a name="ln-177"></a>    <span class="n">cells</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-178"></a>    <span class="n">host_cells</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-179"></a>    <span class="n">cell_pop</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-180"></a>    <span class="n">ncx</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">ncy</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">ncz</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-181"></a>    <span class="n">na</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-182"></a>
<a name="ln-183"></a>    <span class="c">!Loop over particles and put into cells</span>
<a name="ln-184"></a>    <span class="k">do </span><span class="n">iatm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na</span>
<a name="ln-185"></a>        <span class="n">ri</span> <span class="o">=</span> <span class="n">coords</span><span class="p">(:,</span><span class="n">iatm</span><span class="p">)</span>
<a name="ln-186"></a>        <span class="n">icx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">ri</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">cell_size</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-187"></a>        <span class="n">icy</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">cell_size</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-188"></a>        <span class="n">icz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">ri</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">cell_size</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-189"></a>
<a name="ln-190"></a>        <span class="k">if</span> <span class="p">((</span><span class="n">icx</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">icy</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">icz</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-191"></a><span class="k">            print</span><span class="o">*</span><span class="p">,</span> <span class="n">ri</span>
<a name="ln-192"></a>            <span class="k">stop</span>
<a name="ln-193"></a><span class="k">        end if</span>
<a name="ln-194"></a>
<a name="ln-195"></a>        <span class="c">!If atoms are exactly on the box edge</span>
<a name="ln-196"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">icx</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">ncx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="n">icx</span> <span class="o">=</span> <span class="n">ncx</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-197"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">icy</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">ncy</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="n">icy</span> <span class="o">=</span> <span class="n">ncy</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-198"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">icz</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">ncz</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="n">icz</span> <span class="o">=</span> <span class="n">ncz</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-199"></a>
<a name="ln-200"></a>        <span class="n">ic</span> <span class="o">=</span> <span class="n">icz</span><span class="o">*</span><span class="n">ncx</span><span class="o">*</span><span class="n">ncy</span> <span class="o">+</span> <span class="n">icy</span><span class="o">*</span><span class="n">ncx</span> <span class="o">+</span> <span class="n">icx</span>
<a name="ln-201"></a>        <span class="n">host_cells</span><span class="p">(</span><span class="n">iatm</span><span class="p">)</span> <span class="o">=</span> <span class="n">ic</span>
<a name="ln-202"></a>        <span class="n">cell_pop</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">cell_pop</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-203"></a>    <span class="k">end do</span>
<a name="ln-204"></a>
<a name="ln-205"></a>    <span class="c">!Loop over all cells to set up pointers</span>
<a name="ln-206"></a>    <span class="n">cells_pos</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-207"></a>    <span class="k">do </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">nct</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-208"></a>        <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">+</span> <span class="n">cell_pop</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-209"></a>    <span class="k">end do</span>
<a name="ln-210"></a>
<a name="ln-211"></a>    <span class="c">!Loop over all atoms</span>
<a name="ln-212"></a>    <span class="k">do </span><span class="n">iatm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na</span>
<a name="ln-213"></a>        <span class="n">ic</span> <span class="o">=</span> <span class="n">host_cells</span><span class="p">(</span><span class="n">iatm</span><span class="p">)</span>
<a name="ln-214"></a>        <span class="n">j</span> <span class="o">=</span> <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-215"></a>        <span class="n">cells</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">iatm</span>
<a name="ln-216"></a>        <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-217"></a>    <span class="k">end do</span>
<a name="ln-218"></a>
<a name="ln-219"></a>    <span class="c">!Loop over all cells to set up pointers</span>
<a name="ln-220"></a>    <span class="n">cells_pos</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-221"></a>    <span class="k">do </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">nct</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-222"></a>        <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">+</span> <span class="n">cell_pop</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-223"></a>    <span class="k">end do</span>
<a name="ln-224"></a>
<a name="ln-225"></a><span class="k">    end subroutine</span>
<a name="ln-226"></a>
<a name="ln-227"></a><span class="c">!******************************************************************************</span>
<a name="ln-228"></a>
<a name="ln-229"></a><span class="k">function </span><span class="n">cl_get_num_cells</span><span class="p">()</span> <span class="k">result</span> <span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a name="ln-230"></a>    <span class="c">!! Returns the total number of cells</span>
<a name="ln-231"></a>
<a name="ln-232"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-233"></a>
<a name="ln-234"></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">nct</span>
<a name="ln-235"></a>
<a name="ln-236"></a>    <span class="k">end function</span>
<a name="ln-237"></a>
<a name="ln-238"></a><span class="c">!******************************************************************************</span>
<a name="ln-239"></a>
<a name="ln-240"></a><span class="k">subroutine </span><span class="n">cl_get_contents</span><span class="p">(</span><span class="n">ic</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>
<a name="ln-241"></a>    <span class="c">!! Returns a pointer to the entries of cell with linear index *ic*.</span>
<a name="ln-242"></a>
<a name="ln-243"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ic</span>
<a name="ln-244"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-245"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ibeg</span><span class="p">,</span> <span class="n">iend</span>
<a name="ln-246"></a>
<a name="ln-247"></a>    <span class="n">res</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-248"></a>    <span class="n">ibeg</span> <span class="o">=</span> <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="p">);</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">cells_pos</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-249"></a>    <span class="n">res</span> <span class="o">=&gt;</span> <span class="n">cells</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span>
<a name="ln-250"></a>
<a name="ln-251"></a>    <span class="k">end subroutine</span>
<a name="ln-252"></a>
<a name="ln-253"></a><span class="c">!******************************************************************************</span>
<a name="ln-254"></a>
<a name="ln-255"></a><span class="k">subroutine </span><span class="n">cl_get_nbr_cells</span><span class="p">(</span><span class="n">ic</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>
<a name="ln-256"></a>    <span class="c">!! Returns a pointer to the neighbor cells of cell with linear index *ic*.</span>
<a name="ln-257"></a>
<a name="ln-258"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ic</span>
<a name="ln-259"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-260"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ibeg</span><span class="p">,</span> <span class="n">iend</span>
<a name="ln-261"></a>
<a name="ln-262"></a>    <span class="n">res</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-263"></a>    <span class="n">ibeg</span> <span class="o">=</span> <span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="n">ic</span><span class="p">);</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">cell_nbrs_pos</span><span class="p">(</span><span class="n">ic</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-264"></a>    <span class="k">call </span><span class="n">cell_nbrs</span><span class="p">%</span><span class="n">get_data</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">ibeg</span><span class="p">,</span> <span class="n">iend</span><span class="p">)</span>
<a name="ln-265"></a>
<a name="ln-266"></a>    <span class="k">end subroutine</span>
<a name="ln-267"></a>
<a name="ln-268"></a><span class="c">!********************************************************************************</span>
<a name="ln-269"></a>
<a name="ln-270"></a><span class="k">subroutine </span><span class="n">cl_print</span><span class="p">()</span>
<a name="ln-271"></a>    <span class="c">!! Prints a cell list</span>
<a name="ln-272"></a>
<a name="ln-273"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">aic</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-274"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">nbrc</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-275"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ncx</span><span class="p">,</span> <span class="n">ncy</span><span class="p">,</span> <span class="n">ncz</span>
<a name="ln-276"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">icx</span><span class="p">,</span> <span class="n">icy</span><span class="p">,</span> <span class="n">icz</span><span class="p">,</span> <span class="n">ic</span>
<a name="ln-277"></a>
<a name="ln-278"></a>    <span class="n">ncx</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">ncy</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">ncz</span> <span class="o">=</span> <span class="n">nc</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-279"></a>
<a name="ln-280"></a>    <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(&quot;ncx: &quot;, i0, &quot; ncy: &quot;, i0, &quot; ncz: &quot;, i0)&#39;</span><span class="p">)</span> <span class="n">ncx</span><span class="p">,</span> <span class="n">ncy</span><span class="p">,</span> <span class="n">ncz</span>
<a name="ln-281"></a>    <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(&quot;lcx: &quot;, g0.6, &quot; lcy: &quot;, g0.6, &quot; lcz: &quot;, g0.6)&#39;</span><span class="p">)</span> <span class="n">cell_size</span>
<a name="ln-282"></a>    <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;CELL CONTENTS&#39;</span>
<a name="ln-283"></a>    <span class="k">do </span><span class="n">icz</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncz</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-284"></a>        <span class="k">do </span><span class="n">icy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncy</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-285"></a>            <span class="k">do </span><span class="n">icx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-286"></a>                <span class="n">ic</span> <span class="o">=</span> <span class="n">icz</span><span class="o">*</span><span class="n">ncx</span><span class="o">*</span><span class="n">ncy</span> <span class="o">+</span> <span class="n">icy</span><span class="o">*</span><span class="n">ncx</span> <span class="o">+</span> <span class="n">icx</span>
<a name="ln-287"></a>                <span class="k">call </span><span class="n">cl_get_contents</span><span class="p">(</span><span class="n">ic</span><span class="p">,</span> <span class="n">aic</span><span class="p">)</span>
<a name="ln-288"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">size</span><span class="p">(</span><span class="n">aic</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-289"></a><span class="k">                    write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(&quot;(&quot;,i0,&quot;,&quot;,i0,&quot;,&quot;,i0,&quot;)[&quot;,i0,&quot;] &quot;)&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">icx</span><span class="p">,</span> <span class="n">icy</span><span class="p">,</span> <span class="n">icz</span><span class="p">,</span> <span class="n">ic</span>
<a name="ln-290"></a>                    <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">size</span><span class="p">(</span><span class="n">aic</span><span class="p">),</span> <span class="n">aic</span>
<a name="ln-291"></a>                <span class="k">end if</span>
<a name="ln-292"></a><span class="k">            end do</span>
<a name="ln-293"></a><span class="k">        end do</span>
<a name="ln-294"></a><span class="k">    end do</span>
<a name="ln-295"></a>
<a name="ln-296"></a><span class="k">    write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>
<a name="ln-297"></a>    <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;NBR CELLS&#39;</span>
<a name="ln-298"></a>    <span class="k">do </span><span class="n">icz</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncz</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-299"></a>        <span class="k">do </span><span class="n">icy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncy</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-300"></a>            <span class="k">do </span><span class="n">icx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ncx</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-301"></a>                <span class="n">ic</span> <span class="o">=</span> <span class="n">icz</span><span class="o">*</span><span class="n">ncx</span><span class="o">*</span><span class="n">ncy</span> <span class="o">+</span> <span class="n">icy</span><span class="o">*</span><span class="n">ncx</span> <span class="o">+</span> <span class="n">icx</span>
<a name="ln-302"></a>                <span class="k">call </span><span class="n">cl_get_nbr_cells</span><span class="p">(</span><span class="n">ic</span><span class="p">,</span> <span class="n">nbrc</span><span class="p">)</span>
<a name="ln-303"></a>                <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(&quot;(&quot;,i0,&quot;,&quot;,i0,&quot;,&quot;,i0,&quot;)[&quot;,i0,&quot;] &quot;)&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">icx</span><span class="p">,</span> <span class="n">icy</span><span class="p">,</span> <span class="n">icz</span><span class="p">,</span> <span class="n">ic</span>
<a name="ln-304"></a>                <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">size</span><span class="p">(</span><span class="n">nbrc</span><span class="p">),</span> <span class="n">nbrc</span>
<a name="ln-305"></a>            <span class="k">end do</span>
<a name="ln-306"></a><span class="k">        end do</span>
<a name="ln-307"></a><span class="k">    end do</span>
<a name="ln-308"></a>
<a name="ln-309"></a><span class="k">    end subroutine</span>
<a name="ln-310"></a>
<a name="ln-311"></a><span class="c">!********************************************************************************</span>
<a name="ln-312"></a>
<a name="ln-313"></a><span class="k">end module </span><span class="n">m_cell_list</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> BROWNPAK was developed by Sarit Dutta</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>