<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for BROWNPAK">
   
    <meta name="author" content="Sarit Dutta" >
    <link rel="icon" href="../favicon.png">

    <title>m_connectivity.f90 &ndash; BROWNPAK</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">BROWNPAK <small>0.2</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>m_connectivity.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 2.9% of total for source files.">181 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/m_connectivity.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">m_connectivity.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_connectivity.html">m_connectivity</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_connectivity.f90.html#src">m_connectivity.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_connectivity.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilem_connectivityf90EfferentGraph" width="623pt" height="297pt"
 viewBox="0.00 0.00 623.00 296.77" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 292.766)">
<title>sourcefile~~m_connectivity.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-292.766 619,-292.766 619,4 -4,4"/>
<!-- sourcefile~m_connectivity.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~m_connectivity.f90</title>
<polygon fill="none" stroke="#000000" points="615,-204 516,-204 516,-180 615,-180 615,-204"/>
<text text-anchor="middle" x="565.5" y="-189.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_connectivity.f90</text>
</g>
<!-- sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~m_vector.f90</title>
<g id="a_sourcefile~~m_connectivity.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/m_vector.f90.html" xlink:title="m_vector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="358.5,-264 285.5,-264 285.5,-240 358.5,-240 358.5,-264"/>
<text text-anchor="middle" x="322" y="-249.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_vector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_vector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M545.1779,-204.0968C528.3136,-213.5482 503.3921,-226.1871 480,-233 443.6562,-243.5851 400.9573,-248.2822 369.1161,-250.3619"/>
<polygon fill="#ff0000" stroke="#ff0000" points="368.5359,-246.8899 358.7589,-250.9716 368.9473,-253.8778 368.5359,-246.8899"/>
</g>
<!-- sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~m_precision.f90</title>
<g id="a_sourcefile~~m_connectivity.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/m_precision.f90.html" xlink:title="m_precision.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="87,-144 0,-144 0,-120 87,-120 87,-144"/>
<text text-anchor="middle" x="43.5" y="-129.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_precision.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M515.7687,-191.3201C504.039,-191.187 491.5787,-191.0677 480,-191 445.3339,-190.7973 436.3815,-186.5626 402,-191 365.5422,-195.7054 358.6328,-208.943 322,-212"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M322,-212C260.0719,-214.9854 243.3852,-223.7044 182.5,-212"/>
</g>
<!-- sourcefile~m_table.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~m_table.f90</title>
<g id="a_sourcefile~~m_connectivity.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/m_table.f90.html" xlink:title="m_table.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="474.5,-224 407.5,-224 407.5,-200 474.5,-200 474.5,-224"/>
<text text-anchor="middle" x="441" y="-209.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_table.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_table.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_table.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M515.9366,-199.962C505.6696,-201.6113 494.9218,-203.3379 484.8754,-204.9517"/>
<polygon fill="#ff0000" stroke="#ff0000" points="484.0277,-201.543 474.7094,-206.5848 485.138,-208.4544 484.0277,-201.543"/>
</g>
<!-- sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~m_globals.f90</title>
<g id="a_sourcefile~~m_connectivity.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/m_globals.f90.html" xlink:title="m_globals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480,-144 402,-144 402,-120 480,-120 480,-144"/>
<text text-anchor="middle" x="441" y="-129.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_globals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M540.3056,-179.8581C521.5742,-170.8309 495.8047,-158.4119 475.2109,-148.4872"/>
<polygon fill="#ff0000" stroke="#ff0000" points="476.6849,-145.3124 466.157,-144.1238 473.6459,-151.6183 476.6849,-145.3124"/>
</g>
<!-- sourcefile~m_vector.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~m_vector.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M295.7458,-264.1078C255.5699,-280.6912 177.7448,-304.9803 123,-273 78.9626,-247.2746 57.409,-187.1612 48.5926,-154.3456"/>
<polygon fill="#ff0000" stroke="#ff0000" points="51.9123,-153.1954 46.0769,-144.3524 45.1241,-154.9043 51.9123,-153.1954"/>
</g>
<!-- sourcefile~m_qsort.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~m_qsort.f90</title>
<g id="a_sourcefile~~m_connectivity.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/m_qsort.f90.html" xlink:title="m_qsort.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="216.5,-264 148.5,-264 148.5,-240 216.5,-240 216.5,-264"/>
<text text-anchor="middle" x="182.5" y="-249.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_qsort.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_vector.f90&#45;&gt;sourcefile~m_qsort.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~m_vector.f90&#45;&gt;sourcefile~m_qsort.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M285.348,-252C267.3664,-252 245.5643,-252 226.6694,-252"/>
<polygon fill="#ff0000" stroke="#ff0000" points="226.5141,-248.5001 216.514,-252 226.514,-255.5001 226.5141,-248.5001"/>
</g>
<!-- sourcefile~m_table.f90&#45;&gt;sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~m_table.f90&#45;&gt;sourcefile~m_vector.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M407.2177,-223.3554C394.9522,-227.4782 380.8813,-232.208 367.7545,-236.6203"/>
<polygon fill="#00ffff" stroke="#00ffff" points="366.3097,-233.4135 357.9461,-239.9173 368.5401,-240.0487 366.3097,-233.4135"/>
</g>
<!-- sourcefile~m_table.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~m_table.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M407.3407,-210.511C383.476,-209.8186 350.7205,-209.6033 322,-212"/>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M401.7983,-132C330.2343,-132 178.3449,-132 97.2178,-132"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="97.2086,-128.5001 87.2085,-132 97.2085,-135.5001 97.2086,-128.5001"/>
</g>
<!-- sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~m_simbox.f90</title>
<g id="a_sourcefile~~m_connectivity.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/m_simbox.f90.html" xlink:title="m_simbox.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="361,-84 283,-84 283,-60 361,-60 361,-84"/>
<text text-anchor="middle" x="322" y="-69.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_simbox.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_simbox.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M416.9186,-119.8581C399.1759,-110.9122 374.8269,-98.6354 355.2328,-88.756"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="356.5506,-85.5008 346.0456,-84.1238 353.3991,-91.7512 356.5506,-85.5008"/>
</g>
<!-- sourcefile~m_trajectory.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~m_trajectory.f90</title>
<g id="a_sourcefile~~m_connectivity.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/m_trajectory.f90.html" xlink:title="m_trajectory.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-184 278,-184 278,-160 366,-160 366,-184"/>
<text text-anchor="middle" x="322" y="-169.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_trajectory.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_trajectory.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_trajectory.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M405.2961,-144.0013C393.5197,-147.9598 380.2542,-152.4187 367.8296,-156.5951"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="366.4537,-153.3651 358.09,-159.8689 368.684,-160.0003 366.4537,-153.3651"/>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M282.6493,-64.4178C241.6113,-58.1888 175.9993,-53.0097 123,-71 98.7309,-79.238 76.0664,-98.1956 61.1968,-112.8071"/>
<polygon fill="#ff0000" stroke="#ff0000" points="58.6713,-110.3836 54.1643,-119.9721 63.667,-115.287 58.6713,-110.3836"/>
</g>
<!-- sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~m_constants_math.f90</title>
<g id="a_sourcefile~~m_connectivity.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/m_constants_math.f90.html" xlink:title="m_constants_math.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="242,-24 123,-24 123,0 242,0 242,-24"/>
<text text-anchor="middle" x="182.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_constants_math.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M293.7701,-59.8581C272.4983,-50.7089 243.1259,-38.0757 219.9005,-28.0862"/>
<polygon fill="#ff0000" stroke="#ff0000" points="221.2572,-24.8598 210.6879,-24.1238 218.4914,-31.2902 221.2572,-24.8598"/>
</g>
<!-- sourcefile~m_ran_num.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~m_ran_num.f90</title>
<g id="a_sourcefile~~m_connectivity.f90~~EfferentGraph_node10"><a xlink:href=".././sourcefile/m_ran_num.f90.html" xlink:title="m_ran_num.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="225.5,-104 139.5,-104 139.5,-80 225.5,-80 225.5,-104"/>
<text text-anchor="middle" x="182.5" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ran_num.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_ran_num.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_ran_num.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M282.7702,-77.6243C268.2268,-79.7094 251.4782,-82.1107 235.8858,-84.3461"/>
<polygon fill="#ff0000" stroke="#ff0000" points="235.2432,-80.9024 225.8412,-85.7862 236.2367,-87.8315 235.2432,-80.9024"/>
</g>
<!-- sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M301.4819,-184.2302C274.5248,-198.8228 225.5505,-220.2759 182.5,-212"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M182.5,-212C155.2392,-206.7594 147.6,-205.8629 123,-193 101.2771,-181.6415 79.3823,-164.3064 64.086,-151.0151"/>
<polygon fill="#00ff00" stroke="#00ff00" points="66.1116,-148.133 56.3099,-144.1107 61.4639,-153.3674 66.1116,-148.133"/>
</g>
<!-- sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~m_logger.f90</title>
<g id="a_sourcefile~~m_connectivity.f90~~EfferentGraph_node11"><a xlink:href=".././sourcefile/m_logger.f90.html" xlink:title="m_logger.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="219.5,-184 145.5,-184 145.5,-160 219.5,-160 219.5,-184"/>
<text text-anchor="middle" x="182.5" y="-169.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_logger.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_logger.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M277.8613,-172C262.6851,-172 245.6303,-172 230.1848,-172"/>
<polygon fill="#00ff00" stroke="#00ff00" points="229.7918,-168.5001 219.7918,-172 229.7917,-175.5001 229.7918,-168.5001"/>
</g>
<!-- sourcefile~m_qsort.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~m_qsort.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M148.2974,-240.2231C139.6095,-236.4021 130.5932,-231.6579 123,-226 95.3805,-205.42 71.0304,-173.5007 56.7784,-152.6736"/>
<polygon fill="#0000ff" stroke="#0000ff" points="59.6021,-150.5998 51.1368,-144.2289 53.7815,-154.4883 59.6021,-150.5998"/>
</g>
<!-- sourcefile~m_constants_math.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~m_constants_math.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M147.6763,-24.0514C139.181,-27.8243 130.4124,-32.4768 123,-38 95.3805,-58.58 71.0304,-90.4993 56.7784,-111.3264"/>
<polygon fill="#ff0000" stroke="#ff0000" points="53.7815,-109.5117 51.1368,-119.7711 59.6021,-113.4002 53.7815,-109.5117"/>
</g>
<!-- sourcefile~m_ran_num.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_connectivity.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~m_ran_num.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M140.7954,-104.0013C126.495,-108.1165 110.3148,-112.7727 95.3125,-117.0899"/>
<polygon fill="#00ff00" stroke="#00ff00" points="94.2976,-113.7399 85.6556,-119.8689 96.2335,-120.4669 94.2976,-113.7399"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_connectivity.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilem_connectivityf90AfferentGraph" width="558pt" height="192pt"
 viewBox="0.00 0.00 558.00 192.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_connectivity.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 188)">
<title>sourcefile~~m_connectivity.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-188 554,-188 554,4 -4,4"/>
<!-- sourcefile~m_connectivity.f90 -->
<g id="sourcefile~~m_connectivity.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~m_connectivity.f90</title>
<polygon fill="none" stroke="#000000" points="99,-104 0,-104 0,-80 99,-80 99,-104"/>
<text text-anchor="middle" x="49.5" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_connectivity.f90</text>
</g>
<!-- sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_connectivity.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~m_interaction.f90</title>
<g id="a_sourcefile~~m_connectivity.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/m_interaction.f90.html" xlink:title="m_interaction.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="228,-104 135,-104 135,-80 228,-80 228,-104"/>
<text text-anchor="middle" x="181.5" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_interaction.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_connectivity.f90 -->
<g id="sourcefile~~m_connectivity.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_connectivity.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M134.9617,-92C126.6392,-92 117.8632,-92 109.2315,-92"/>
<polygon fill="#ff0000" stroke="#ff0000" points="109.2008,-88.5001 99.2008,-92 109.2007,-95.5001 109.2008,-88.5001"/>
</g>
<!-- sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_connectivity.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~m_mpcd.f90</title>
<g id="a_sourcefile~~m_connectivity.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/m_mpcd.f90.html" xlink:title="m_mpcd.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="344,-184 274,-184 274,-160 344,-160 344,-184"/>
<text text-anchor="middle" x="309" y="-169.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_mpcd.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_connectivity.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M287.3399,-159.8099C279.8897,-155.5314 271.5302,-150.6349 264,-146 244.9345,-134.2651 223.8177,-120.427 207.7213,-109.6973"/>
<polygon fill="#ff0000" stroke="#ff0000" points="209.5977,-106.7416 199.3402,-104.0892 205.7048,-112.5593 209.5977,-106.7416"/>
</g>
<!-- sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_connectivity.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~m_bd_solver.f90</title>
<g id="a_sourcefile~~m_connectivity.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/m_bd_solver.f90.html" xlink:title="m_bd_solver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="354,-104 264,-104 264,-80 354,-80 354,-104"/>
<text text-anchor="middle" x="309" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_bd_solver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_connectivity.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M263.6893,-92C255.5474,-92 246.9666,-92 238.5436,-92"/>
<polygon fill="#ff0000" stroke="#ff0000" points="238.3879,-88.5001 228.3879,-92 238.3879,-95.5001 238.3879,-88.5001"/>
</g>
<!-- sourcefile~m_kmc.f90 -->
<g id="sourcefile~~m_connectivity.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~m_kmc.f90</title>
<g id="a_sourcefile~~m_connectivity.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/m_kmc.f90.html" xlink:title="m_kmc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="341,-24 277,-24 277,0 341,0 341,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_kmc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_kmc.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_connectivity.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~m_kmc.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M287.3399,-24.1901C279.8897,-28.4686 271.5302,-33.3651 264,-38 244.9345,-49.7349 223.8177,-63.573 207.7213,-74.3027"/>
<polygon fill="#ff0000" stroke="#ff0000" points="205.7048,-71.4407 199.3402,-79.9108 209.5977,-77.2584 205.7048,-71.4407"/>
</g>
<!-- sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_connectivity.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~m_setup.f90</title>
<g id="a_sourcefile~~m_connectivity.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/m_setup.f90.html" xlink:title="m_setup.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="460,-144 390,-144 390,-120 460,-120 460,-144"/>
<text text-anchor="middle" x="425" y="-129.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_setup.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_connectivity.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M389.9394,-129.204C357.1899,-126.2759 307.0324,-120.9801 264,-113 254.401,-111.2199 244.263,-108.9603 234.5031,-106.5872"/>
<polygon fill="#ff0000" stroke="#ff0000" points="235.058,-103.1183 224.5077,-104.0884 233.3602,-109.9093 235.058,-103.1183"/>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_connectivity.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_mpcd.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M390.1962,-144.0013C378.7166,-147.9598 365.7856,-152.4187 353.6742,-156.5951"/>
<polygon fill="#ff0000" stroke="#ff0000" points="352.4929,-153.3001 344.1802,-159.8689 354.7749,-159.9177 352.4929,-153.3001"/>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_connectivity.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_bd_solver.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M390.1962,-119.9987C378.7166,-116.0402 365.7856,-111.5813 353.6742,-107.4049"/>
<polygon fill="#cbff00" stroke="#cbff00" points="354.7749,-104.0823 344.1802,-104.1311 352.4929,-110.6999 354.7749,-104.0823"/>
</g>
<!-- sourcefile~m_relax.f90 -->
<g id="sourcefile~~m_connectivity.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~m_relax.f90</title>
<g id="a_sourcefile~~m_connectivity.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/m_relax.f90.html" xlink:title="m_relax.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="458.5,-64 391.5,-64 391.5,-40 458.5,-40 458.5,-64"/>
<text text-anchor="middle" x="425" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_relax.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_relax.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_connectivity.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~m_relax.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M391.1943,-54.6842C358.4813,-57.5883 307.5858,-62.9173 264,-71 254.401,-72.7801 244.263,-75.0397 234.5031,-77.4128"/>
<polygon fill="#ff0000" stroke="#ff0000" points="233.3602,-74.0907 224.5077,-79.9116 235.058,-80.8817 233.3602,-74.0907"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~m_connectivity.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~m_connectivity.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="550,-124 496,-124 496,-100 550,-100 550,-124"/>
<text text-anchor="middle" x="523" y="-109.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_connectivity.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_mpcd.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M508.506,-124.1882C496.3584,-133.6927 478.1357,-146.3583 460,-153 426.0435,-165.4356 385.2358,-170.0051 354.608,-171.5649"/>
<polygon fill="#ff0000" stroke="#ff0000" points="354.0721,-168.0842 344.2271,-171.9991 354.3646,-175.0781 354.0721,-168.0842"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_connectivity.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_bd_solver.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M495.8968,-109.467C462.9597,-106.3888 406.556,-101.1174 364.3063,-97.1688"/>
<polygon fill="#cbff00" stroke="#cbff00" points="364.4476,-93.6669 354.1653,-96.2211 363.7962,-100.6365 364.4476,-93.6669"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_connectivity.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M495.9616,-117.518C487.8936,-119.1646 478.824,-121.0155 469.9341,-122.8298"/>
<polygon fill="#0066ff" stroke="#0066ff" points="469.1346,-119.4207 460.0365,-124.8497 470.5344,-126.2793 469.1346,-119.4207"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_relax.f90 -->
<g id="sourcefile~~m_connectivity.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_relax.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M503.1682,-99.8581C488.9552,-91.1562 469.5942,-79.3026 453.697,-69.5696"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="455.1584,-66.3604 444.8023,-64.1238 451.5032,-72.3304 455.1584,-66.3604"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_connectivity.html">m_connectivity</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_connectivity.f90.html#src">m_connectivity.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">module </span><span class="n">m_connectivity</span>
<a name="ln-2"></a>    <span class="c">!! Routines for building atom-&gt;bond, atom-&gt;angle, etc. tables and excluded</span>
<a name="ln-3"></a>    <span class="c">!! atoms table.</span>
<a name="ln-4"></a>
<a name="ln-5"></a><span class="k">use </span><span class="n">m_precision</span>
<a name="ln-6"></a><span class="k">use </span><span class="n">m_vector</span>
<a name="ln-7"></a><span class="k">use </span><span class="n">m_table</span>
<a name="ln-8"></a><span class="k">use </span><span class="n">m_globals</span>
<a name="ln-9"></a>
<a name="ln-10"></a><span class="k">implicit none</span>
<a name="ln-11"></a>
<a name="ln-12"></a><span class="k">private</span>
<a name="ln-13"></a>
<a name="ln-14"></a><span class="k">public</span> <span class="kd">::</span> <span class="n">atbo_build</span><span class="p">,</span> <span class="n">atan_build</span><span class="p">,</span> <span class="n">atdh_build</span><span class="p">,</span> <span class="n">exat_build</span>
<a name="ln-15"></a><span class="k">public</span> <span class="kd">::</span> <span class="n">atbo_tab</span><span class="p">,</span> <span class="n">atan_tab</span><span class="p">,</span> <span class="n">atdh_tab</span><span class="p">,</span> <span class="n">exat_tab</span>
<a name="ln-16"></a>
<a name="ln-17"></a><span class="k">type</span><span class="p">(</span><span class="n">itable_t</span><span class="p">)</span> <span class="kd">::</span> <span class="n">atbo_tab</span>
<a name="ln-18"></a>    <span class="c">!! Atoms -&gt; bonds table</span>
<a name="ln-19"></a><span class="k">type</span><span class="p">(</span><span class="n">itable_t</span><span class="p">)</span> <span class="kd">::</span> <span class="n">atan_tab</span>
<a name="ln-20"></a>    <span class="c">!! Atoms -&gt; angles table</span>
<a name="ln-21"></a><span class="k">type</span><span class="p">(</span><span class="n">itable_t</span><span class="p">)</span> <span class="kd">::</span> <span class="n">atdh_tab</span>
<a name="ln-22"></a>    <span class="c">!! Atoms -&gt; dihedrals table</span>
<a name="ln-23"></a><span class="k">type</span><span class="p">(</span><span class="n">itable_t</span><span class="p">)</span> <span class="kd">::</span> <span class="n">atat_tab</span>
<a name="ln-24"></a>    <span class="c">!! Atoms -&gt; bonded atoms table (1-ring)</span>
<a name="ln-25"></a><span class="k">type</span><span class="p">(</span><span class="n">itable_t</span><span class="p">)</span> <span class="kd">::</span> <span class="n">exat_tab</span>
<a name="ln-26"></a>    <span class="c">!! Atoms -&gt; excluded atoms (from vdw calculation) table</span>
<a name="ln-27"></a>
<a name="ln-28"></a><span class="k">contains</span>
<a name="ln-29"></a>
<a name="ln-30"></a><span class="c">!********************************************************************************</span>
<a name="ln-31"></a>
<a name="ln-32"></a><span class="k">subroutine </span><span class="n">atbo_build</span><span class="p">()</span>
<a name="ln-33"></a>
<a name="ln-34"></a>    <span class="k">type</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">buf_map</span>
<a name="ln-35"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iatm</span><span class="p">,</span> <span class="n">jatm</span><span class="p">,</span> <span class="n">ibnd</span>
<a name="ln-36"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">j</span>
<a name="ln-37"></a>
<a name="ln-38"></a>    <span class="c">!Build table as list of lists</span>
<a name="ln-39"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">buf_map</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">))</span>
<a name="ln-40"></a>    <span class="k">do </span><span class="n">iatm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-41"></a>        <span class="k">call </span><span class="n">ivector_init</span><span class="p">(</span><span class="n">buf_map</span><span class="p">(</span><span class="n">iatm</span><span class="p">))</span>
<a name="ln-42"></a>    <span class="k">end do</span>
<a name="ln-43"></a>
<a name="ln-44"></a><span class="k">    do </span><span class="n">ibnd</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_bonds</span>
<a name="ln-45"></a>        <span class="n">iatm</span> <span class="o">=</span> <span class="n">bonds</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">ibnd</span><span class="p">)</span>
<a name="ln-46"></a>        <span class="n">jatm</span> <span class="o">=</span> <span class="n">bonds</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">ibnd</span><span class="p">)</span>
<a name="ln-47"></a>        <span class="k">call </span><span class="n">buf_map</span><span class="p">(</span><span class="n">iatm</span><span class="p">)%</span><span class="n">append</span><span class="p">(</span><span class="n">ibnd</span><span class="p">)</span>
<a name="ln-48"></a>        <span class="k">call </span><span class="n">buf_map</span><span class="p">(</span><span class="n">jatm</span><span class="p">)%</span><span class="n">append</span><span class="p">(</span><span class="n">ibnd</span><span class="p">)</span>
<a name="ln-49"></a>    <span class="k">end do</span>
<a name="ln-50"></a>
<a name="ln-51"></a>    <span class="c">!Sort in ascending order</span>
<a name="ln-52"></a>    <span class="k">do </span><span class="n">iatm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-53"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">buf_map</span><span class="p">(</span><span class="n">iatm</span><span class="p">)%</span><span class="nb">len</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">call </span><span class="n">buf_map</span><span class="p">(</span><span class="n">iatm</span><span class="p">)%</span><span class="n">sort</span><span class="p">()</span>
<a name="ln-54"></a>    <span class="k">end do</span>
<a name="ln-55"></a>
<a name="ln-56"></a>    <span class="c">!Copy over to table</span>
<a name="ln-57"></a>    <span class="k">call </span><span class="n">itbl_init</span><span class="p">(</span><span class="n">atbo_tab</span><span class="p">,</span> <span class="n">num_atoms</span><span class="p">)</span>
<a name="ln-58"></a>    <span class="k">do </span><span class="n">iatm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-59"></a>        <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">buf_map</span><span class="p">(</span><span class="n">iatm</span><span class="p">)%</span><span class="nb">len</span>
<a name="ln-60"></a><span class="nb">            </span><span class="n">jatm</span> <span class="o">=</span> <span class="n">buf_map</span><span class="p">(</span><span class="n">iatm</span><span class="p">)%</span><span class="n">get_val</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a name="ln-61"></a>            <span class="k">call </span><span class="n">atbo_tab</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="n">iatm</span><span class="p">,</span> <span class="n">jatm</span><span class="p">)</span>
<a name="ln-62"></a>        <span class="k">end do</span>
<a name="ln-63"></a><span class="k">    end do</span>
<a name="ln-64"></a>
<a name="ln-65"></a>    <span class="c">!Delete list of lists table</span>
<a name="ln-66"></a>    <span class="k">do </span><span class="n">iatm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-67"></a>        <span class="k">call </span><span class="n">buf_map</span><span class="p">(</span><span class="n">iatm</span><span class="p">)%</span><span class="n">delete</span><span class="p">()</span>
<a name="ln-68"></a>    <span class="k">end do</span>
<a name="ln-69"></a><span class="k">    deallocate</span><span class="p">(</span><span class="n">buf_map</span><span class="p">)</span>
<a name="ln-70"></a>
<a name="ln-71"></a>    <span class="c">!Release additional memory</span>
<a name="ln-72"></a>    <span class="k">call </span><span class="n">atbo_tab</span><span class="p">%</span><span class="n">shrink_to_fit</span><span class="p">()</span>
<a name="ln-73"></a>
<a name="ln-74"></a>    <span class="k">end subroutine</span>
<a name="ln-75"></a>
<a name="ln-76"></a><span class="c">!********************************************************************************</span>
<a name="ln-77"></a>
<a name="ln-78"></a><span class="k">subroutine </span><span class="n">atan_build</span><span class="p">()</span>
<a name="ln-79"></a>
<a name="ln-80"></a>    <span class="k">type</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">buf_map</span>
<a name="ln-81"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iatm</span><span class="p">,</span> <span class="n">jatm</span><span class="p">,</span> <span class="n">katm</span><span class="p">,</span> <span class="n">iang</span>
<a name="ln-82"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">j</span>
<a name="ln-83"></a>
<a name="ln-84"></a>    <span class="c">!Build table as list of lists</span>
<a name="ln-85"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">buf_map</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">))</span>
<a name="ln-86"></a>    <span class="k">do </span><span class="n">iatm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-87"></a>        <span class="k">call </span><span class="n">ivector_init</span><span class="p">(</span><span class="n">buf_map</span><span class="p">(</span><span class="n">iatm</span><span class="p">))</span>
<a name="ln-88"></a>    <span class="k">end do</span>
<a name="ln-89"></a>
<a name="ln-90"></a><span class="k">    do </span><span class="n">iang</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_angles</span>
<a name="ln-91"></a>        <span class="n">iatm</span> <span class="o">=</span> <span class="n">angles</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">iang</span><span class="p">)</span>
<a name="ln-92"></a>        <span class="n">jatm</span> <span class="o">=</span> <span class="n">angles</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">iang</span><span class="p">)</span>
<a name="ln-93"></a>        <span class="n">katm</span> <span class="o">=</span> <span class="n">angles</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">iang</span><span class="p">)</span>
<a name="ln-94"></a>        <span class="k">call </span><span class="n">buf_map</span><span class="p">(</span><span class="n">iatm</span><span class="p">)%</span><span class="n">append</span><span class="p">(</span><span class="n">iang</span><span class="p">)</span>
<a name="ln-95"></a>        <span class="k">call </span><span class="n">buf_map</span><span class="p">(</span><span class="n">jatm</span><span class="p">)%</span><span class="n">append</span><span class="p">(</span><span class="n">iang</span><span class="p">)</span>
<a name="ln-96"></a>        <span class="k">call </span><span class="n">buf_map</span><span class="p">(</span><span class="n">katm</span><span class="p">)%</span><span class="n">append</span><span class="p">(</span><span class="n">iang</span><span class="p">)</span>
<a name="ln-97"></a>    <span class="k">end do</span>
<a name="ln-98"></a>
<a name="ln-99"></a>    <span class="c">!Sort in ascending order</span>
<a name="ln-100"></a>    <span class="k">do </span><span class="n">iatm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-101"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">buf_map</span><span class="p">(</span><span class="n">iatm</span><span class="p">)%</span><span class="nb">len</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">call </span><span class="n">buf_map</span><span class="p">(</span><span class="n">iatm</span><span class="p">)%</span><span class="n">sort</span><span class="p">()</span>
<a name="ln-102"></a>    <span class="k">end do</span>
<a name="ln-103"></a>
<a name="ln-104"></a>    <span class="c">!Copy over to table</span>
<a name="ln-105"></a>    <span class="k">call </span><span class="n">itbl_init</span><span class="p">(</span><span class="n">atan_tab</span><span class="p">,</span> <span class="n">num_atoms</span><span class="p">)</span>
<a name="ln-106"></a>    <span class="k">do </span><span class="n">iatm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-107"></a>        <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">buf_map</span><span class="p">(</span><span class="n">iatm</span><span class="p">)%</span><span class="nb">len</span>
<a name="ln-108"></a><span class="nb">            </span><span class="n">jatm</span> <span class="o">=</span> <span class="n">buf_map</span><span class="p">(</span><span class="n">iatm</span><span class="p">)%</span><span class="n">get_val</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a name="ln-109"></a>            <span class="k">call </span><span class="n">atan_tab</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="n">iatm</span><span class="p">,</span> <span class="n">jatm</span><span class="p">)</span>
<a name="ln-110"></a>        <span class="k">end do</span>
<a name="ln-111"></a><span class="k">    end do</span>
<a name="ln-112"></a>
<a name="ln-113"></a>    <span class="c">!Delete list of lists table</span>
<a name="ln-114"></a>    <span class="k">do </span><span class="n">iatm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-115"></a>        <span class="k">call </span><span class="n">buf_map</span><span class="p">(</span><span class="n">iatm</span><span class="p">)%</span><span class="n">delete</span><span class="p">()</span>
<a name="ln-116"></a>    <span class="k">end do</span>
<a name="ln-117"></a><span class="k">    deallocate</span><span class="p">(</span><span class="n">buf_map</span><span class="p">)</span>
<a name="ln-118"></a>
<a name="ln-119"></a>    <span class="c">!Release additional memory</span>
<a name="ln-120"></a>    <span class="k">call </span><span class="n">atan_tab</span><span class="p">%</span><span class="n">shrink_to_fit</span><span class="p">()</span>
<a name="ln-121"></a>
<a name="ln-122"></a>    <span class="k">end subroutine</span>
<a name="ln-123"></a>
<a name="ln-124"></a><span class="c">!********************************************************************************</span>
<a name="ln-125"></a>
<a name="ln-126"></a><span class="k">subroutine </span><span class="n">atdh_build</span><span class="p">()</span>
<a name="ln-127"></a>
<a name="ln-128"></a>    <span class="k">type</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">buf_map</span>
<a name="ln-129"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iatm</span><span class="p">,</span> <span class="n">jatm</span><span class="p">,</span> <span class="n">katm</span><span class="p">,</span> <span class="n">latm</span><span class="p">,</span> <span class="n">idhd</span>
<a name="ln-130"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">j</span>
<a name="ln-131"></a>
<a name="ln-132"></a>    <span class="c">!Build table as list of lists</span>
<a name="ln-133"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">buf_map</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">))</span>
<a name="ln-134"></a>    <span class="k">do </span><span class="n">iatm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-135"></a>        <span class="k">call </span><span class="n">ivector_init</span><span class="p">(</span><span class="n">buf_map</span><span class="p">(</span><span class="n">iatm</span><span class="p">))</span>
<a name="ln-136"></a>    <span class="k">end do</span>
<a name="ln-137"></a>
<a name="ln-138"></a><span class="k">    do </span><span class="n">idhd</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_dihedrals</span>
<a name="ln-139"></a>        <span class="n">iatm</span> <span class="o">=</span> <span class="n">dihedrals</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">idhd</span><span class="p">)</span>
<a name="ln-140"></a>        <span class="n">jatm</span> <span class="o">=</span> <span class="n">dihedrals</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">idhd</span><span class="p">)</span>
<a name="ln-141"></a>        <span class="n">katm</span> <span class="o">=</span> <span class="n">dihedrals</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">idhd</span><span class="p">)</span>
<a name="ln-142"></a>        <span class="n">latm</span> <span class="o">=</span> <span class="n">dihedrals</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">idhd</span><span class="p">)</span>
<a name="ln-143"></a>        <span class="k">call </span><span class="n">buf_map</span><span class="p">(</span><span class="n">iatm</span><span class="p">)%</span><span class="n">append</span><span class="p">(</span><span class="n">idhd</span><span class="p">)</span>
<a name="ln-144"></a>        <span class="k">call </span><span class="n">buf_map</span><span class="p">(</span><span class="n">jatm</span><span class="p">)%</span><span class="n">append</span><span class="p">(</span><span class="n">idhd</span><span class="p">)</span>
<a name="ln-145"></a>        <span class="k">call </span><span class="n">buf_map</span><span class="p">(</span><span class="n">katm</span><span class="p">)%</span><span class="n">append</span><span class="p">(</span><span class="n">idhd</span><span class="p">)</span>
<a name="ln-146"></a>        <span class="k">call </span><span class="n">buf_map</span><span class="p">(</span><span class="n">latm</span><span class="p">)%</span><span class="n">append</span><span class="p">(</span><span class="n">idhd</span><span class="p">)</span>
<a name="ln-147"></a>    <span class="k">end do</span>
<a name="ln-148"></a>
<a name="ln-149"></a>    <span class="c">!Sort in ascending order</span>
<a name="ln-150"></a>    <span class="k">do </span><span class="n">iatm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-151"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">buf_map</span><span class="p">(</span><span class="n">iatm</span><span class="p">)%</span><span class="nb">len</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">call </span><span class="n">buf_map</span><span class="p">(</span><span class="n">iatm</span><span class="p">)%</span><span class="n">sort</span><span class="p">()</span>
<a name="ln-152"></a>    <span class="k">end do</span>
<a name="ln-153"></a>
<a name="ln-154"></a>    <span class="c">!Copy over to table</span>
<a name="ln-155"></a>    <span class="k">call </span><span class="n">itbl_init</span><span class="p">(</span><span class="n">atdh_tab</span><span class="p">,</span> <span class="n">num_atoms</span><span class="p">)</span>
<a name="ln-156"></a>    <span class="k">do </span><span class="n">iatm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-157"></a>        <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">buf_map</span><span class="p">(</span><span class="n">iatm</span><span class="p">)%</span><span class="nb">len</span>
<a name="ln-158"></a><span class="nb">            </span><span class="n">jatm</span> <span class="o">=</span> <span class="n">buf_map</span><span class="p">(</span><span class="n">iatm</span><span class="p">)%</span><span class="n">get_val</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a name="ln-159"></a>            <span class="k">call </span><span class="n">atdh_tab</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="n">iatm</span><span class="p">,</span> <span class="n">jatm</span><span class="p">)</span>
<a name="ln-160"></a>        <span class="k">end do</span>
<a name="ln-161"></a><span class="k">    end do</span>
<a name="ln-162"></a>
<a name="ln-163"></a>    <span class="c">!Delete list of lists table</span>
<a name="ln-164"></a>    <span class="k">do </span><span class="n">iatm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-165"></a>        <span class="k">call </span><span class="n">buf_map</span><span class="p">(</span><span class="n">iatm</span><span class="p">)%</span><span class="n">delete</span><span class="p">()</span>
<a name="ln-166"></a>    <span class="k">end do</span>
<a name="ln-167"></a><span class="k">    deallocate</span><span class="p">(</span><span class="n">buf_map</span><span class="p">)</span>
<a name="ln-168"></a>
<a name="ln-169"></a>    <span class="c">!Release additional memory</span>
<a name="ln-170"></a>    <span class="k">call </span><span class="n">atdh_tab</span><span class="p">%</span><span class="n">shrink_to_fit</span><span class="p">()</span>
<a name="ln-171"></a>
<a name="ln-172"></a>    <span class="k">end subroutine</span>
<a name="ln-173"></a>
<a name="ln-174"></a><span class="c">!********************************************************************************</span>
<a name="ln-175"></a>
<a name="ln-176"></a><span class="k">subroutine </span><span class="n">atat_build</span><span class="p">()</span>
<a name="ln-177"></a>
<a name="ln-178"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">inc_bonds</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-179"></a>    <span class="k">type</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">)</span> <span class="kd">::</span> <span class="n">excl_atms</span>
<a name="ln-180"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iatm</span><span class="p">,</span> <span class="n">jatm</span><span class="p">,</span> <span class="n">jbnd</span><span class="p">,</span> <span class="n">jbnd_atm1</span><span class="p">,</span> <span class="n">jbnd_atm2</span>
<a name="ln-181"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">j</span>
<a name="ln-182"></a>
<a name="ln-183"></a>    <span class="c">!Initialize table</span>
<a name="ln-184"></a>    <span class="k">call </span><span class="n">itbl_init</span><span class="p">(</span><span class="n">atat_tab</span><span class="p">,</span> <span class="n">num_atoms</span><span class="p">)</span>
<a name="ln-185"></a>    <span class="c">!List of excluded atoms</span>
<a name="ln-186"></a>    <span class="k">call </span><span class="n">ivector_init</span><span class="p">(</span><span class="n">excl_atms</span><span class="p">)</span>
<a name="ln-187"></a>
<a name="ln-188"></a>    <span class="k">do </span><span class="n">iatm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-189"></a>        <span class="k">call </span><span class="n">excl_atms</span><span class="p">%</span><span class="n">clear</span><span class="p">()</span>
<a name="ln-190"></a>        <span class="c">!Get incident bonds</span>
<a name="ln-191"></a>        <span class="k">call </span><span class="n">atbo_tab</span><span class="p">%</span><span class="n">get_row</span><span class="p">(</span><span class="n">iatm</span><span class="p">,</span> <span class="n">inc_bonds</span><span class="p">)</span>
<a name="ln-192"></a>        <span class="c">!Add atoms from each of the incident bonds, excluding iatom</span>
<a name="ln-193"></a>        <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">inc_bonds</span><span class="p">)</span>
<a name="ln-194"></a>            <span class="n">jbnd</span> <span class="o">=</span> <span class="n">inc_bonds</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a name="ln-195"></a>            <span class="n">jbnd_atm1</span> <span class="o">=</span> <span class="n">bonds</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">jbnd</span><span class="p">)</span>
<a name="ln-196"></a>            <span class="n">jbnd_atm2</span> <span class="o">=</span> <span class="n">bonds</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">jbnd</span><span class="p">)</span>
<a name="ln-197"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">jbnd_atm1</span> <span class="o">/=</span> <span class="n">iatm</span><span class="p">)</span> <span class="k">call </span><span class="n">excl_atms</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="n">jbnd_atm1</span><span class="p">)</span>
<a name="ln-198"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">jbnd_atm2</span> <span class="o">/=</span> <span class="n">iatm</span><span class="p">)</span> <span class="k">call </span><span class="n">excl_atms</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="n">jbnd_atm2</span><span class="p">)</span>
<a name="ln-199"></a>        <span class="k">end do</span>
<a name="ln-200"></a>        <span class="c">!Sort and remove duplicates. These are the atoms in the 1-ring.</span>
<a name="ln-201"></a>        <span class="k">call </span><span class="n">excl_atms</span><span class="p">%</span><span class="n">unique</span><span class="p">()</span>
<a name="ln-202"></a>
<a name="ln-203"></a>        <span class="c">!Add to atat_tab. Note that iatm does not appear in the atat table</span>
<a name="ln-204"></a>        <span class="c">!for iatm.</span>
<a name="ln-205"></a>        <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">excl_atms</span><span class="p">%</span><span class="nb">len</span>
<a name="ln-206"></a><span class="nb">            </span><span class="n">jatm</span> <span class="o">=</span> <span class="n">excl_atms</span><span class="p">%</span><span class="n">get_val</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a name="ln-207"></a>            <span class="k">call </span><span class="n">atat_tab</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="n">iatm</span><span class="p">,</span> <span class="n">jatm</span><span class="p">)</span>
<a name="ln-208"></a>        <span class="k">end do</span>
<a name="ln-209"></a><span class="k">    end do</span>
<a name="ln-210"></a>
<a name="ln-211"></a>    <span class="c">!Release additional memory</span>
<a name="ln-212"></a>    <span class="k">call </span><span class="n">atat_tab</span><span class="p">%</span><span class="n">shrink_to_fit</span><span class="p">()</span>
<a name="ln-213"></a>
<a name="ln-214"></a>    <span class="k">end subroutine</span>
<a name="ln-215"></a>
<a name="ln-216"></a><span class="c">!********************************************************************************</span>
<a name="ln-217"></a>
<a name="ln-218"></a><span class="k">subroutine </span><span class="n">exat_build</span><span class="p">()</span>
<a name="ln-219"></a>
<a name="ln-220"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">nbr_atms</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-221"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">nbr2_atms</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-222"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">nbr3_atms</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-223"></a>    <span class="k">type</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">)</span> <span class="kd">::</span> <span class="n">excl_atms</span>
<a name="ln-224"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iatm</span><span class="p">,</span> <span class="n">jatm</span><span class="p">,</span> <span class="n">j2atm</span><span class="p">,</span> <span class="n">j3atm</span>
<a name="ln-225"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">j</span><span class="p">,</span> <span class="n">j2</span><span class="p">,</span> <span class="n">j3</span>
<a name="ln-226"></a>
<a name="ln-227"></a>    <span class="c">!Build atat_tab. This is the 1-ring neighborhood of each atom.</span>
<a name="ln-228"></a>    <span class="k">call </span><span class="n">atat_build</span><span class="p">()</span>
<a name="ln-229"></a>    <span class="k">call </span><span class="n">atat_tab</span><span class="p">%</span><span class="n">shrink_to_fit</span><span class="p">()</span>
<a name="ln-230"></a>
<a name="ln-231"></a>    <span class="c">!Debug statements</span>
<a name="ln-232"></a>    <span class="c">!print*, &#39;ATAT_TAB&#39;</span>
<a name="ln-233"></a>    <span class="c">!call atat_tab%print()</span>
<a name="ln-234"></a>
<a name="ln-235"></a>    <span class="c">!Initialize table</span>
<a name="ln-236"></a>    <span class="k">call </span><span class="n">itbl_init</span><span class="p">(</span><span class="n">exat_tab</span><span class="p">,</span> <span class="n">num_atoms</span><span class="p">)</span>
<a name="ln-237"></a>    <span class="c">!List of excluded atoms</span>
<a name="ln-238"></a>    <span class="k">call </span><span class="n">ivector_init</span><span class="p">(</span><span class="n">excl_atms</span><span class="p">)</span>
<a name="ln-239"></a>
<a name="ln-240"></a>    <span class="k">do </span><span class="n">iatm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-241"></a>        <span class="k">call </span><span class="n">excl_atms</span><span class="p">%</span><span class="n">clear</span><span class="p">()</span>
<a name="ln-242"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">excluded_atoms</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-243"></a>            <span class="c">!Get atoms in 1-ring neighborhood</span>
<a name="ln-244"></a>            <span class="k">call </span><span class="n">atat_tab</span><span class="p">%</span><span class="n">get_row</span><span class="p">(</span><span class="n">iatm</span><span class="p">,</span> <span class="n">nbr_atms</span><span class="p">)</span>
<a name="ln-245"></a>            <span class="c">!Add atoms to excluded atoms list. First adding iatm itself.</span>
<a name="ln-246"></a>            <span class="k">call </span><span class="n">excl_atms</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="n">iatm</span><span class="p">)</span>
<a name="ln-247"></a>            <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">nbr_atms</span><span class="p">)</span>
<a name="ln-248"></a>                <span class="n">jatm</span> <span class="o">=</span> <span class="n">nbr_atms</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a name="ln-249"></a>                <span class="k">call </span><span class="n">excl_atms</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="n">jatm</span><span class="p">)</span>
<a name="ln-250"></a>                <span class="c">!Atoms for second ring neighbors</span>
<a name="ln-251"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">excluded_atoms</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-252"></a><span class="k">                    call </span><span class="n">atat_tab</span><span class="p">%</span><span class="n">get_row</span><span class="p">(</span><span class="n">jatm</span><span class="p">,</span> <span class="n">nbr2_atms</span><span class="p">)</span>
<a name="ln-253"></a>                    <span class="k">do </span><span class="n">j2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">nbr2_atms</span><span class="p">)</span>
<a name="ln-254"></a>                        <span class="n">j2atm</span> <span class="o">=</span> <span class="n">nbr2_atms</span><span class="p">(</span><span class="n">j2</span><span class="p">)</span>
<a name="ln-255"></a>                        <span class="k">call </span><span class="n">excl_atms</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="n">j2atm</span><span class="p">)</span>
<a name="ln-256"></a>                        <span class="c">!Atoms for third ring neighbors</span>
<a name="ln-257"></a>                        <span class="k">if</span> <span class="p">(</span><span class="n">excluded_atoms</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-258"></a><span class="k">                            call </span><span class="n">atat_tab</span><span class="p">%</span><span class="n">get_row</span><span class="p">(</span><span class="n">j2atm</span><span class="p">,</span> <span class="n">nbr3_atms</span><span class="p">)</span>
<a name="ln-259"></a>                            <span class="k">do </span><span class="n">j3</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">nbr3_atms</span><span class="p">)</span>
<a name="ln-260"></a>                                <span class="n">j3atm</span> <span class="o">=</span> <span class="n">nbr3_atms</span><span class="p">(</span><span class="n">j3</span><span class="p">)</span>
<a name="ln-261"></a>                                <span class="k">call </span><span class="n">excl_atms</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="n">j3atm</span><span class="p">)</span>
<a name="ln-262"></a>                            <span class="k">end do</span>
<a name="ln-263"></a>                            <span class="c">!Finished adding all third ring neighbors</span>
<a name="ln-264"></a>                        <span class="k">end if</span>
<a name="ln-265"></a><span class="k">                    end do</span>
<a name="ln-266"></a>                    <span class="c">!Finished adding all second ring neighbors</span>
<a name="ln-267"></a>                <span class="k">end if</span>
<a name="ln-268"></a>                <span class="c">!Finished adding all first ring neighbors</span>
<a name="ln-269"></a>            <span class="k">end do</span>
<a name="ln-270"></a><span class="k">        end if</span>
<a name="ln-271"></a>
<a name="ln-272"></a>        <span class="c">!Sort and remove duplicates</span>
<a name="ln-273"></a>        <span class="k">call </span><span class="n">excl_atms</span><span class="p">%</span><span class="n">unique</span><span class="p">()</span>
<a name="ln-274"></a>
<a name="ln-275"></a>        <span class="c">!Add to exat_tab. Note that iatom appears in the excluded atoms list for</span>
<a name="ln-276"></a>        <span class="c">!iatom.</span>
<a name="ln-277"></a>        <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">excl_atms</span><span class="p">%</span><span class="nb">len</span>
<a name="ln-278"></a><span class="nb">            </span><span class="n">jatm</span> <span class="o">=</span> <span class="n">excl_atms</span><span class="p">%</span><span class="n">get_val</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a name="ln-279"></a>            <span class="k">call </span><span class="n">exat_tab</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="n">iatm</span><span class="p">,</span> <span class="n">jatm</span><span class="p">)</span>
<a name="ln-280"></a>        <span class="k">end do</span>
<a name="ln-281"></a><span class="k">    end do</span>
<a name="ln-282"></a>
<a name="ln-283"></a>    <span class="c">!Release additional memory</span>
<a name="ln-284"></a>    <span class="k">call </span><span class="n">exat_tab</span><span class="p">%</span><span class="n">shrink_to_fit</span><span class="p">()</span>
<a name="ln-285"></a>
<a name="ln-286"></a>    <span class="c">!atat_tab no longer required</span>
<a name="ln-287"></a>    <span class="k">call </span><span class="n">atat_tab</span><span class="p">%</span><span class="n">delete</span><span class="p">()</span>
<a name="ln-288"></a>
<a name="ln-289"></a>    <span class="k">end subroutine</span>
<a name="ln-290"></a>
<a name="ln-291"></a><span class="c">!********************************************************************************</span>
<a name="ln-292"></a>
<a name="ln-293"></a><span class="k">end module </span><span class="n">m_connectivity</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> BROWNPAK was developed by Sarit Dutta</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>