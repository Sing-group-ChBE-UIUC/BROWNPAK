<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for BROWNPAK">
   
    <meta name="author" content="Sarit Dutta" >
    <link rel="icon" href="../favicon.png">

    <title>m_config_io.f90 &ndash; BROWNPAK</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">BROWNPAK <small>0.2</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>m_config_io.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title="10.1% of total for source files.">624 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/m_config_io.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">m_config_io.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_config_io.html">m_config_io</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_config_io.f90.html#src">m_config_io.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_config_io.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilem_config_iof90EfferentGraph" width="611pt" height="257pt"
 viewBox="0.00 0.00 611.00 256.77" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_config_io.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 252.7694)">
<title>sourcefile~~m_config_io.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-252.7694 607,-252.7694 607,4 -4,4"/>
<!-- sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_config_io.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~m_config_io.f90</title>
<polygon fill="none" stroke="#000000" points="603,-64 516,-64 516,-40 603,-40 603,-64"/>
<text text-anchor="middle" x="559.5" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_config_io.f90</text>
</g>
<!-- sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_config_io.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~m_globals.f90</title>
<g id="a_sourcefile~~m_config_io.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/m_globals.f90.html" xlink:title="m_globals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480,-145 402,-145 402,-121 480,-121 480,-145"/>
<text text-anchor="middle" x="441" y="-130.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_globals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_config_io.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M541.7594,-64.1265C522.0376,-77.6072 489.9854,-99.5163 467.3344,-114.9993"/>
<polygon fill="#ff0000" stroke="#ff0000" points="465.1425,-112.258 458.8619,-120.7906 469.0927,-118.0369 465.1425,-112.258"/>
</g>
<!-- sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_config_io.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~m_precision.f90</title>
<g id="a_sourcefile~~m_config_io.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/m_precision.f90.html" xlink:title="m_precision.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="87,-146 0,-146 0,-122 87,-122 87,-146"/>
<text text-anchor="middle" x="43.5" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_precision.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_config_io.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M441,-52C388.2943,-56.3982 374.5146,-45.7191 322,-52"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M515.8117,-50.2673C493.4071,-49.8177 465.7045,-49.9384 441,-52"/>
</g>
<!-- sourcefile~m_strings.f90 -->
<g id="sourcefile~~m_config_io.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~m_strings.f90</title>
<g id="a_sourcefile~~m_config_io.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/m_strings.f90.html" xlink:title="m_strings.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="479,-24 403,-24 403,0 479,0 479,-24"/>
<text text-anchor="middle" x="441" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_strings.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_strings.f90 -->
<g id="sourcefile~~m_config_io.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_strings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M523.9461,-39.9987C512.2192,-36.0402 499.0095,-31.5813 486.637,-27.4049"/>
<polygon fill="#ff0000" stroke="#ff0000" points="487.5326,-24.0132 476.9384,-24.1311 485.2938,-30.6456 487.5326,-24.0132"/>
</g>
<!-- sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_config_io.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~m_simbox.f90</title>
<g id="a_sourcefile~~m_config_io.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/m_simbox.f90.html" xlink:title="m_simbox.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="361,-104 283,-104 283,-80 361,-80 361,-104"/>
<text text-anchor="middle" x="322" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_simbox.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_config_io.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_simbox.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M441,-52C411.162,-54.4899 379.0799,-65.8261 355.7544,-75.7973"/>
<polygon fill="#ff0000" stroke="#ff0000" points="354.0621,-72.7183 346.3259,-79.9573 356.8878,-79.1227 354.0621,-72.7183"/>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_config_io.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M401.891,-143.0647C351.5255,-155.1319 261.1099,-173.7776 182.5,-174"/>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_config_io.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_simbox.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M405.9397,-120.9204C393.702,-116.704 379.7948,-111.9125 366.8696,-107.4593"/>
<polygon fill="#ff0000" stroke="#ff0000" points="367.8156,-104.0834 357.2209,-104.1349 365.5354,-110.7016 367.8156,-104.0834"/>
</g>
<!-- sourcefile~m_trajectory.f90 -->
<g id="sourcefile~~m_config_io.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~m_trajectory.f90</title>
<g id="a_sourcefile~~m_config_io.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/m_trajectory.f90.html" xlink:title="m_trajectory.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-226 278,-226 278,-202 366,-202 366,-226"/>
<text text-anchor="middle" x="322" y="-211.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_trajectory.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_trajectory.f90 -->
<g id="sourcefile~~m_config_io.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_trajectory.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M425.5195,-145.0505C410.5743,-156.5158 387.1597,-174.039 366,-188 361.5772,-190.9181 356.8234,-193.8897 352.1339,-196.7309"/>
<polygon fill="#ff0000" stroke="#ff0000" points="350.1042,-193.8658 343.2986,-201.9858 353.6825,-199.8821 350.1042,-193.8658"/>
</g>
<!-- sourcefile~m_strings.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_config_io.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~m_strings.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M322,-52C233.4611,-59.3884 205.4209,-37.826 123,-71 99.0718,-80.631 76.5001,-99.8643 61.5656,-114.5594"/>
<polygon fill="#00ffff" stroke="#00ffff" points="59.0039,-112.1726 54.4852,-121.7555 63.9936,-117.0821 59.0039,-112.1726"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M415.2522,-24.0917C391.6215,-34.3485 355.3277,-48.0139 322,-52"/>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_config_io.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M182.5,-174C145.8858,-174.1036 105.8877,-161.113 78.2383,-149.9106"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="79.5753,-146.6761 68.9991,-146.0472 76.8747,-153.1342 79.5753,-146.6761"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M311.0064,-104.0723C289.0105,-126.8344 237.0001,-173.8458 182.5,-174"/>
</g>
<!-- sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_config_io.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~m_constants_math.f90</title>
<g id="a_sourcefile~~m_config_io.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/m_constants_math.f90.html" xlink:title="m_constants_math.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="242,-146 123,-146 123,-122 242,-122 242,-146"/>
<text text-anchor="middle" x="182.5" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_constants_math.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_config_io.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M282.7702,-103.8111C267.0066,-108.5571 248.6524,-114.0832 231.9878,-119.1004"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="230.97,-115.7516 222.4036,-121.986 232.9881,-122.4544 230.97,-115.7516"/>
</g>
<!-- sourcefile~m_ran_num.f90 -->
<g id="sourcefile~~m_config_io.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~m_ran_num.f90</title>
<g id="a_sourcefile~~m_config_io.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/m_ran_num.f90.html" xlink:title="m_ran_num.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="225.5,-104 139.5,-104 139.5,-80 225.5,-80 225.5,-104"/>
<text text-anchor="middle" x="182.5" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ran_num.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_ran_num.f90 -->
<g id="sourcefile~~m_config_io.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_ran_num.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M282.7702,-92C268.2268,-92 251.4782,-92 235.8858,-92"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="235.8412,-88.5001 225.8412,-92 235.8412,-95.5001 235.8412,-88.5001"/>
</g>
<!-- sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_config_io.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M293.6663,-226.0549C253.5257,-241.1883 178.7848,-262.0833 123,-235 89.1245,-218.5536 65.3649,-179.9032 53.1044,-155.4679"/>
<polygon fill="#ff0000" stroke="#ff0000" points="56.1749,-153.7763 48.6951,-146.2727 49.863,-156.803 56.1749,-153.7763"/>
</g>
<!-- sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_config_io.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~m_logger.f90</title>
<g id="a_sourcefile~~m_config_io.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/m_logger.f90.html" xlink:title="m_logger.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="219.5,-226 145.5,-226 145.5,-202 219.5,-202 219.5,-226"/>
<text text-anchor="middle" x="182.5" y="-211.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_logger.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_config_io.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_logger.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M277.8613,-214C262.6851,-214 245.6303,-214 230.1848,-214"/>
<polygon fill="#ff0000" stroke="#ff0000" points="229.7918,-210.5001 219.7918,-214 229.7917,-217.5001 229.7918,-210.5001"/>
</g>
<!-- sourcefile~m_constants_math.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_config_io.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~m_constants_math.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M122.7448,-134C114.3634,-134 105.7891,-134 97.5226,-134"/>
<polygon fill="#00ff00" stroke="#00ff00" points="97.254,-130.5001 87.2539,-134 97.2539,-137.5001 97.254,-130.5001"/>
</g>
<!-- sourcefile~m_ran_num.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_config_io.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~m_ran_num.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M142.6682,-104.0355C127.2553,-108.6926 109.4459,-114.0739 93.2089,-118.9801"/>
<polygon fill="#0000ff" stroke="#0000ff" points="91.8978,-115.7198 83.3376,-121.9627 93.9226,-122.4206 91.8978,-115.7198"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_config_io.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilem_config_iof90AfferentGraph" width="417pt" height="152pt"
 viewBox="0.00 0.00 417.00 152.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_config_io.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 148)">
<title>sourcefile~~m_config_io.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-148 413,-148 413,4 -4,4"/>
<!-- sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_config_io.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~m_config_io.f90</title>
<polygon fill="none" stroke="#000000" points="87,-84 0,-84 0,-60 87,-60 87,-84"/>
<text text-anchor="middle" x="43.5" y="-69.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_config_io.f90</text>
</g>
<!-- sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_config_io.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~m_mpcd.f90</title>
<g id="a_sourcefile~~m_config_io.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/m_mpcd.f90.html" xlink:title="m_mpcd.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="203,-144 133,-144 133,-120 203,-120 203,-144"/>
<text text-anchor="middle" x="168" y="-129.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_mpcd.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_config_io.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_config_io.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M142.8056,-119.8581C124.0742,-110.8309 98.3047,-98.4119 77.7109,-88.4872"/>
<polygon fill="#ff0000" stroke="#ff0000" points="79.1849,-85.3124 68.657,-84.1238 76.1459,-91.6183 79.1849,-85.3124"/>
</g>
<!-- sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_config_io.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~m_setup.f90</title>
<g id="a_sourcefile~~m_config_io.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/m_setup.f90.html" xlink:title="m_setup.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="319,-104 249,-104 249,-80 319,-80 319,-104"/>
<text text-anchor="middle" x="284" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_setup.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_config_io.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_config_io.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M248.7717,-89.0704C208.9861,-85.7618 143.7783,-80.3392 97.5429,-76.4942"/>
<polygon fill="#ff0000" stroke="#ff0000" points="97.6529,-72.9914 87.3972,-75.6505 97.0728,-79.9673 97.6529,-72.9914"/>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_config_io.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_mpcd.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M249.1962,-104.0013C237.7166,-107.9598 224.7856,-112.4187 212.6742,-116.5951"/>
<polygon fill="#ff0000" stroke="#ff0000" points="211.4929,-113.3001 203.1802,-119.8689 213.7749,-119.9177 211.4929,-113.3001"/>
</g>
<!-- sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_config_io.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~m_bd_solver.f90</title>
<g id="a_sourcefile~~m_config_io.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/m_bd_solver.f90.html" xlink:title="m_bd_solver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="213,-64 123,-64 123,-40 213,-40 213,-64"/>
<text text-anchor="middle" x="168" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_bd_solver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_config_io.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_bd_solver.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M249.1962,-79.9987C237.7166,-76.0402 224.7856,-71.5813 212.6742,-67.4049"/>
<polygon fill="#00ffff" stroke="#00ffff" points="213.7749,-64.0823 203.1802,-64.1311 211.4929,-70.6999 213.7749,-64.0823"/>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_config_io.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_config_io.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M122.7005,-59.277C114.4952,-60.5951 105.8647,-61.9816 97.4408,-63.3348"/>
<polygon fill="#ff0000" stroke="#ff0000" points="96.6289,-59.9203 87.3106,-64.9622 97.7392,-66.8317 96.6289,-59.9203"/>
</g>
<!-- sourcefile~m_relax.f90 -->
<g id="sourcefile~~m_config_io.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~m_relax.f90</title>
<g id="a_sourcefile~~m_config_io.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/m_relax.f90.html" xlink:title="m_relax.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="317.5,-24 250.5,-24 250.5,0 317.5,0 317.5,-24"/>
<text text-anchor="middle" x="284" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_relax.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_relax.f90&#45;&gt;sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_config_io.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~m_relax.f90&#45;&gt;sourcefile~m_config_io.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M250.2918,-12.4911C217.2117,-13.7784 165.6598,-17.9528 123,-31 104.7989,-36.5667 85.8035,-46.2008 70.9462,-54.7317"/>
<polygon fill="#ff0000" stroke="#ff0000" points="69.1039,-51.7549 62.2742,-59.8547 72.6643,-57.7818 69.1039,-51.7549"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~m_config_io.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~m_config_io.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="409,-84 355,-84 355,-60 409,-60 409,-84"/>
<text text-anchor="middle" x="382" y="-69.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_config_io.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_mpcd.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M367.506,-84.1882C355.3584,-93.6927 337.1357,-106.3583 319,-113 285.0435,-125.4356 244.2358,-130.0051 213.608,-131.5649"/>
<polygon fill="#ff0000" stroke="#ff0000" points="213.0721,-128.0842 203.2271,-131.9991 213.3646,-135.0781 213.0721,-128.0842"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_config_io.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M354.9616,-77.518C346.8936,-79.1646 337.824,-81.0155 328.9341,-82.8298"/>
<polygon fill="#7fff00" stroke="#7fff00" points="328.1346,-79.4207 319.0365,-84.8497 329.5344,-86.2793 328.1346,-79.4207"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_config_io.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_bd_solver.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M354.8968,-69.467C321.9597,-66.3888 265.556,-61.1174 223.3063,-57.1688"/>
<polygon fill="#00ffff" stroke="#00ffff" points="223.4476,-53.6669 213.1653,-56.2211 222.7962,-60.6365 223.4476,-53.6669"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_relax.f90 -->
<g id="sourcefile~~m_config_io.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_relax.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M362.1682,-59.8581C347.9552,-51.1562 328.5942,-39.3026 312.697,-29.5696"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="314.1584,-26.3604 303.8023,-24.1238 310.5032,-32.3304 314.1584,-26.3604"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_config_io.html">m_config_io</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_config_io.f90.html#src">m_config_io.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">module </span><span class="n">m_config_io</span>
<a name="ln-2"></a>    <span class="c">!! Routines for IO of config and dump files.</span>
<a name="ln-3"></a>
<a name="ln-4"></a><span class="k">use </span><span class="n">m_precision</span>
<a name="ln-5"></a><span class="k">use </span><span class="n">m_strings</span>
<a name="ln-6"></a><span class="k">use </span><span class="n">m_simbox</span>
<a name="ln-7"></a><span class="k">use </span><span class="n">m_globals</span>
<a name="ln-8"></a>
<a name="ln-9"></a><span class="k">implicit none</span>
<a name="ln-10"></a>
<a name="ln-11"></a><span class="k">contains</span>
<a name="ln-12"></a>
<a name="ln-13"></a><span class="c">!******************************************************************************</span>
<a name="ln-14"></a>
<a name="ln-15"></a><span class="k">subroutine </span><span class="n">read_dump</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<a name="ln-16"></a>    <span class="c">!! Reads from DUMP file</span>
<a name="ln-17"></a>
<a name="ln-18"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fn</span>
<a name="ln-19"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mat</span>
<a name="ln-20"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">fu</span>
<a name="ln-21"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lvel</span>
<a name="ln-22"></a>
<a name="ln-23"></a>    <span class="k">open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">fu</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">fn</span><span class="p">,</span> <span class="nb">access</span><span class="o">=</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="s1">&#39;unformatted&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-24"></a>        <span class="n">action</span><span class="o">=</span><span class="s1">&#39;read&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;old&#39;</span><span class="p">)</span>
<a name="ln-25"></a>
<a name="ln-26"></a>    <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">leql</span><span class="p">,</span> <span class="n">nts</span>
<a name="ln-27"></a>
<a name="ln-28"></a>    <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">mat</span>
<a name="ln-29"></a>    <span class="k">call </span><span class="n">simbox</span><span class="p">%</span><span class="n">set_basis</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
<a name="ln-30"></a>    <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">imcon</span>
<a name="ln-31"></a>
<a name="ln-32"></a>    <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_atom_types</span>
<a name="ln-33"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">atom_names</span> <span class="p">(</span><span class="n">num_atom_types</span><span class="p">))</span>
<a name="ln-34"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">atom_styles</span><span class="p">(</span><span class="n">num_atom_types</span><span class="p">))</span>
<a name="ln-35"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">atom_mass</span>  <span class="p">(</span><span class="n">num_atom_types</span><span class="p">))</span>
<a name="ln-36"></a>    <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">atom_names</span><span class="p">,</span> <span class="n">atom_styles</span><span class="p">,</span> <span class="n">atom_mass</span>
<a name="ln-37"></a>
<a name="ln-38"></a>    <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">mpcd_avnc</span><span class="p">,</span> <span class="n">num_mpcd_atoms</span>
<a name="ln-39"></a>    <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_atoms</span><span class="p">,</span> <span class="n">num_atoms_tot</span>
<a name="ln-40"></a>
<a name="ln-41"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">atoms</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">))</span>
<a name="ln-42"></a>    <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">atoms</span>
<a name="ln-43"></a>
<a name="ln-44"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">num_atoms_tot</span><span class="p">))</span>
<a name="ln-45"></a>    <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">coordinates</span>
<a name="ln-46"></a>
<a name="ln-47"></a>    <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">lvel</span>
<a name="ln-48"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">lvel</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-49"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">velocities</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">num_atoms_tot</span><span class="p">))</span>
<a name="ln-50"></a>        <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">velocities</span>
<a name="ln-51"></a>    <span class="k">end if</span>
<a name="ln-52"></a>
<a name="ln-53"></a><span class="k">    allocate</span><span class="p">(</span><span class="n">charge</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">))</span>
<a name="ln-54"></a>    <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">charge</span>
<a name="ln-55"></a>
<a name="ln-56"></a>    <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_bond_types</span>
<a name="ln-57"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_bond_types</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-58"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">bond_styles</span><span class="p">(</span><span class="n">num_bond_types</span><span class="p">))</span>
<a name="ln-59"></a>        <span class="k">allocate</span><span class="p">(</span><span class="n">bond_params</span><span class="p">(</span><span class="n">mxparam</span><span class="p">,</span><span class="n">num_bond_types</span><span class="p">))</span>
<a name="ln-60"></a>        <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">bond_styles</span><span class="p">,</span> <span class="n">bond_params</span>
<a name="ln-61"></a>    <span class="k">end if</span>
<a name="ln-62"></a>
<a name="ln-63"></a><span class="k">    read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_bonds</span>
<a name="ln-64"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_bonds</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-65"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">bonds</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">num_bonds</span><span class="p">))</span>
<a name="ln-66"></a>        <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">bonds</span>
<a name="ln-67"></a>    <span class="k">end if</span>
<a name="ln-68"></a>
<a name="ln-69"></a><span class="k">    read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_angle_types</span>
<a name="ln-70"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_angle_types</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-71"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">angle_styles</span><span class="p">(</span><span class="n">num_angle_types</span><span class="p">))</span>
<a name="ln-72"></a>        <span class="k">allocate</span><span class="p">(</span><span class="n">angle_params</span><span class="p">(</span><span class="n">mxparam</span><span class="p">,</span><span class="n">num_angle_types</span><span class="p">))</span>
<a name="ln-73"></a>        <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">angle_styles</span><span class="p">,</span> <span class="n">angle_params</span>
<a name="ln-74"></a>    <span class="k">end if</span>
<a name="ln-75"></a>
<a name="ln-76"></a><span class="k">    read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_angles</span>
<a name="ln-77"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_angles</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-78"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">angles</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">num_angles</span><span class="p">))</span>
<a name="ln-79"></a>        <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">angles</span>
<a name="ln-80"></a>    <span class="k">end if</span>
<a name="ln-81"></a>
<a name="ln-82"></a><span class="k">    read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_dihedral_types</span>
<a name="ln-83"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_dihedral_types</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-84"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">dihedral_styles</span><span class="p">(</span><span class="n">num_dihedral_types</span><span class="p">))</span>
<a name="ln-85"></a>        <span class="k">allocate</span><span class="p">(</span><span class="n">dihedral_params</span><span class="p">(</span><span class="n">mxparam</span><span class="p">,</span><span class="n">num_dihedral_types</span><span class="p">))</span>
<a name="ln-86"></a>        <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">dihedral_styles</span><span class="p">,</span> <span class="n">dihedral_params</span>
<a name="ln-87"></a>    <span class="k">end if</span>
<a name="ln-88"></a>
<a name="ln-89"></a><span class="k">    read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_dihedrals</span>
<a name="ln-90"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_dihedrals</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-91"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">dihedrals</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">num_dihedrals</span><span class="p">))</span>
<a name="ln-92"></a>        <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">dihedrals</span>
<a name="ln-93"></a>    <span class="k">end if</span>
<a name="ln-94"></a>
<a name="ln-95"></a><span class="k">    read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_branches</span>
<a name="ln-96"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_branches</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-97"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">branches</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">num_branches</span><span class="p">))</span>
<a name="ln-98"></a>        <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">branches</span>
<a name="ln-99"></a>    <span class="k">end if</span>
<a name="ln-100"></a>
<a name="ln-101"></a><span class="k">    read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_molecule_types</span>
<a name="ln-102"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">molecule_names</span><span class="p">(</span><span class="n">num_molecule_types</span><span class="p">))</span>
<a name="ln-103"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">molecule_pop</span>  <span class="p">(</span><span class="n">num_molecule_types</span><span class="p">))</span>
<a name="ln-104"></a>    <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">molecule_names</span><span class="p">,</span> <span class="n">molecule_pop</span>
<a name="ln-105"></a>    <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_molecules</span>
<a name="ln-106"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">molecules</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="n">num_molecules</span><span class="p">))</span>
<a name="ln-107"></a>    <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">molecules</span>
<a name="ln-108"></a>
<a name="ln-109"></a>    <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_tether_types</span>
<a name="ln-110"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_tether_types</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-111"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">tether_styles</span><span class="p">(</span><span class="n">num_tether_types</span><span class="p">))</span>
<a name="ln-112"></a>        <span class="k">allocate</span><span class="p">(</span><span class="n">tether_params</span><span class="p">(</span><span class="n">mxparam</span><span class="p">,</span> <span class="n">num_tether_types</span><span class="p">))</span>
<a name="ln-113"></a>        <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">tether_styles</span><span class="p">,</span> <span class="n">tether_params</span>
<a name="ln-114"></a>    <span class="k">end if</span>
<a name="ln-115"></a>
<a name="ln-116"></a><span class="k">    read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_tethers</span>
<a name="ln-117"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_tethers</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-118"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">tethers</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">num_tethers</span><span class="p">))</span>
<a name="ln-119"></a>        <span class="k">allocate</span><span class="p">(</span><span class="n">tether_points</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">num_tethers</span><span class="p">))</span>
<a name="ln-120"></a>        <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">tethers</span><span class="p">,</span> <span class="n">tether_points</span>
<a name="ln-121"></a>    <span class="k">end if</span>
<a name="ln-122"></a>
<a name="ln-123"></a><span class="k">    read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_vdw_types</span>
<a name="ln-124"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_vdw_types</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-125"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">vdw_styles</span><span class="p">(</span><span class="n">num_vdw_types</span><span class="p">))</span>
<a name="ln-126"></a>        <span class="k">allocate</span><span class="p">(</span><span class="n">vdw_pairs</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">num_vdw_types</span><span class="p">))</span>
<a name="ln-127"></a>        <span class="k">allocate</span><span class="p">(</span><span class="n">vdw_params</span><span class="p">(</span><span class="n">mxparam</span><span class="p">,</span><span class="n">num_vdw_types</span><span class="p">))</span>
<a name="ln-128"></a>        <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">vdw_pairs</span><span class="p">,</span> <span class="n">vdw_styles</span><span class="p">,</span> <span class="n">vdw_params</span>
<a name="ln-129"></a>    <span class="k">end if</span>
<a name="ln-130"></a>
<a name="ln-131"></a><span class="k">    read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_externals</span>
<a name="ln-132"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_externals</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-133"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">external_styles</span><span class="p">(</span><span class="n">num_externals</span><span class="p">))</span>
<a name="ln-134"></a>        <span class="k">allocate</span><span class="p">(</span><span class="n">external_params</span><span class="p">(</span><span class="n">mxparam</span><span class="p">,</span><span class="n">num_externals</span><span class="p">))</span>
<a name="ln-135"></a>        <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">external_styles</span><span class="p">,</span> <span class="n">external_params</span>
<a name="ln-136"></a>    <span class="k">end if</span>
<a name="ln-137"></a>
<a name="ln-138"></a><span class="k">    read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">flow_style</span>
<a name="ln-139"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">flow_style</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-140"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">flow_params</span><span class="p">(</span><span class="n">mxparam</span><span class="p">))</span>
<a name="ln-141"></a>        <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">flow_params</span>
<a name="ln-142"></a>    <span class="k">end if</span>
<a name="ln-143"></a>
<a name="ln-144"></a><span class="k">    if</span> <span class="p">(</span> <span class="p">(</span><span class="n">num_tethers</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">imcon</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">molecule_com</span>
<a name="ln-145"></a>
<a name="ln-146"></a>    <span class="k">close</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span>
<a name="ln-147"></a>
<a name="ln-148"></a>    <span class="k">end subroutine</span>
<a name="ln-149"></a>
<a name="ln-150"></a><span class="c">!******************************************************************************</span>
<a name="ln-151"></a>
<a name="ln-152"></a><span class="k">subroutine </span><span class="n">write_dump</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<a name="ln-153"></a>    <span class="c">!! Writes to DUMP file.</span>
<a name="ln-154"></a>
<a name="ln-155"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fn</span>
<a name="ln-156"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">fu</span>
<a name="ln-157"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lvel</span>
<a name="ln-158"></a>
<a name="ln-159"></a>    <span class="k">open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">fu</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">fn</span><span class="p">,</span> <span class="nb">access</span><span class="o">=</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="s1">&#39;unformatted&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-160"></a>        <span class="n">action</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">)</span>
<a name="ln-161"></a>
<a name="ln-162"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">leql</span><span class="p">,</span> <span class="n">nts</span>
<a name="ln-163"></a>
<a name="ln-164"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span>
<a name="ln-165"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">imcon</span>
<a name="ln-166"></a>
<a name="ln-167"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_atom_types</span><span class="p">,</span> <span class="n">atom_names</span><span class="p">,</span> <span class="n">atom_styles</span><span class="p">,</span> <span class="n">atom_mass</span>
<a name="ln-168"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">mpcd_avnc</span><span class="p">,</span> <span class="n">num_mpcd_atoms</span>
<a name="ln-169"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_atoms</span><span class="p">,</span> <span class="n">num_atoms_tot</span>
<a name="ln-170"></a>
<a name="ln-171"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">atoms</span>
<a name="ln-172"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">coordinates</span>
<a name="ln-173"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">velocities</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-174"></a>        <span class="c">!A logical indicating whether velocities are written</span>
<a name="ln-175"></a>        <span class="n">lvel</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-176"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">lvel</span><span class="p">,</span> <span class="n">velocities</span>
<a name="ln-177"></a>    <span class="k">else</span>
<a name="ln-178"></a><span class="k">        </span><span class="n">lvel</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-179"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">lvel</span>
<a name="ln-180"></a>    <span class="k">end if</span>
<a name="ln-181"></a><span class="k">    write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">charge</span>
<a name="ln-182"></a>
<a name="ln-183"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_bond_types</span>
<a name="ln-184"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_bond_types</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">bond_styles</span><span class="p">,</span> <span class="n">bond_params</span>
<a name="ln-185"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_bonds</span>
<a name="ln-186"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_bonds</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">bonds</span>
<a name="ln-187"></a>
<a name="ln-188"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_angle_types</span>
<a name="ln-189"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_angle_types</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">angle_styles</span><span class="p">,</span> <span class="n">angle_params</span>
<a name="ln-190"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_angles</span>
<a name="ln-191"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_angles</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">angles</span>
<a name="ln-192"></a>
<a name="ln-193"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_dihedral_types</span>
<a name="ln-194"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_dihedral_types</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">dihedral_styles</span><span class="p">,</span> <span class="n">dihedral_params</span>
<a name="ln-195"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_dihedrals</span>
<a name="ln-196"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_dihedrals</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">dihedrals</span>
<a name="ln-197"></a>
<a name="ln-198"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_branches</span>
<a name="ln-199"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_branches</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">branches</span>
<a name="ln-200"></a>
<a name="ln-201"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_molecule_types</span><span class="p">,</span> <span class="n">molecule_names</span><span class="p">,</span> <span class="n">molecule_pop</span>
<a name="ln-202"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_molecules</span><span class="p">,</span> <span class="n">molecules</span>
<a name="ln-203"></a>
<a name="ln-204"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_tether_types</span>
<a name="ln-205"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_tether_types</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">tether_styles</span><span class="p">,</span> <span class="n">tether_params</span>
<a name="ln-206"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_tethers</span>
<a name="ln-207"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_tethers</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">tethers</span><span class="p">,</span> <span class="n">tether_points</span>
<a name="ln-208"></a>
<a name="ln-209"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_vdw_types</span>
<a name="ln-210"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_vdw_types</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">vdw_pairs</span><span class="p">,</span> <span class="n">vdw_styles</span><span class="p">,</span> <span class="n">vdw_params</span>
<a name="ln-211"></a>
<a name="ln-212"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">num_externals</span>
<a name="ln-213"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_externals</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">external_styles</span><span class="p">,</span> <span class="n">external_params</span>
<a name="ln-214"></a>
<a name="ln-215"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">flow_style</span>
<a name="ln-216"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">flow_style</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">flow_params</span>
<a name="ln-217"></a>
<a name="ln-218"></a>    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">num_tethers</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">imcon</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span> <span class="n">molecule_com</span>
<a name="ln-219"></a>
<a name="ln-220"></a>    <span class="k">close</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span>
<a name="ln-221"></a>
<a name="ln-222"></a>    <span class="k">end subroutine</span>
<a name="ln-223"></a>
<a name="ln-224"></a><span class="c">!******************************************************************************</span>
<a name="ln-225"></a>
<a name="ln-226"></a><span class="k">subroutine </span><span class="n">read_config</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<a name="ln-227"></a>    <span class="c">!! Read from CONFIG file</span>
<a name="ln-228"></a>
<a name="ln-229"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fn</span>
<a name="ln-230"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">mxrdln</span><span class="p">)</span> <span class="kd">::</span> <span class="n">line</span>
<a name="ln-231"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">word</span>
<a name="ln-232"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mat</span>
<a name="ln-233"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">it</span><span class="p">,</span> <span class="n">npar</span><span class="p">,</span> <span class="n">ibr</span>
<a name="ln-234"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">fu</span><span class="p">,</span> <span class="n">ios</span>
<a name="ln-235"></a>
<a name="ln-236"></a>    <span class="k">open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">fu</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">fn</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;read&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;old&#39;</span><span class="p">)</span>
<a name="ln-237"></a>
<a name="ln-238"></a>    <span class="k">do </span>
<a name="ln-239"></a><span class="k">        call </span><span class="n">readline</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="n">ios</span><span class="p">)</span>
<a name="ln-240"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ios</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-241"></a>
<a name="ln-242"></a><span class="k">        </span><span class="n">line</span> <span class="o">=</span> <span class="nb">adjustl</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-243"></a>
<a name="ln-244"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">str_startswith</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;SIMBOX&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-245"></a>            <span class="c">!Read simulation box size into lattice vectors defining the box</span>
<a name="ln-246"></a>            <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">mat</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-247"></a>            <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">mat</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-248"></a>            <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">mat</span><span class="p">(:,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-249"></a>            <span class="k">call </span><span class="n">simbox</span><span class="p">%</span><span class="n">set_basis</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
<a name="ln-250"></a>        <span class="k">end if</span>
<a name="ln-251"></a>
<a name="ln-252"></a><span class="k">        if</span> <span class="p">(</span><span class="n">str_startswith</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;IMCON&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-253"></a>            <span class="c">!Read box boundary condition</span>
<a name="ln-254"></a>            <span class="k">call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-255"></a>            <span class="n">imcon</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-256"></a>        <span class="k">end if</span>
<a name="ln-257"></a>
<a name="ln-258"></a><span class="k">        if</span> <span class="p">(</span><span class="n">str_startswith</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;ATOM_TYPES&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-259"></a><span class="k">            call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-260"></a>            <span class="n">num_atom_types</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-261"></a>
<a name="ln-262"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">atom_names</span> <span class="p">(</span><span class="n">num_atom_types</span><span class="p">))</span>
<a name="ln-263"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">atom_styles</span><span class="p">(</span><span class="n">num_atom_types</span><span class="p">))</span>
<a name="ln-264"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">atom_mass</span>  <span class="p">(</span><span class="n">num_atom_types</span><span class="p">))</span>
<a name="ln-265"></a>
<a name="ln-266"></a>            <span class="k">do </span><span class="n">it</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atom_types</span>
<a name="ln-267"></a>                <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">atom_names</span><span class="p">(</span><span class="n">it</span><span class="p">),</span> <span class="n">atom_styles</span><span class="p">(</span><span class="n">it</span><span class="p">),</span> <span class="n">atom_mass</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<a name="ln-268"></a>            <span class="k">end do</span>
<a name="ln-269"></a><span class="k">        end if</span>
<a name="ln-270"></a>
<a name="ln-271"></a><span class="k">        if</span> <span class="p">(</span><span class="n">str_startswith</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;MPCD_ATOMS&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-272"></a><span class="k">            call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-273"></a>            <span class="k">call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-274"></a>            <span class="n">num_mpcd_atoms</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<a name="ln-275"></a>            <span class="n">mpcd_avnc</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-276"></a>        <span class="k">end if</span>
<a name="ln-277"></a>
<a name="ln-278"></a><span class="k">        if</span> <span class="p">(</span><span class="n">str_startswith</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;ATOMS&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-279"></a><span class="k">            call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-280"></a>            <span class="n">num_atoms</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-281"></a>
<a name="ln-282"></a>            <span class="n">num_atoms_tot</span> <span class="o">=</span> <span class="n">num_mpcd_atoms</span> <span class="o">+</span> <span class="n">num_atoms</span>
<a name="ln-283"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">atoms</span> <span class="p">(</span><span class="n">num_atoms</span><span class="p">))</span>
<a name="ln-284"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">charge</span> <span class="p">(</span><span class="n">num_atoms</span><span class="p">))</span>
<a name="ln-285"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">num_atoms_tot</span><span class="p">))</span>
<a name="ln-286"></a>
<a name="ln-287"></a>            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-288"></a>                <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">atoms</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">charge</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-289"></a>            <span class="k">end do</span>
<a name="ln-290"></a><span class="k">        end if</span>
<a name="ln-291"></a>
<a name="ln-292"></a><span class="k">        if</span> <span class="p">(</span><span class="n">str_startswith</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;BOND_TYPES&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-293"></a><span class="k">            call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-294"></a>            <span class="n">num_bond_types</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-295"></a>
<a name="ln-296"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">bond_styles</span><span class="p">(</span><span class="n">num_bond_types</span><span class="p">))</span>
<a name="ln-297"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">bond_params</span><span class="p">(</span><span class="n">mxparam</span><span class="p">,</span> <span class="n">num_bond_types</span><span class="p">))</span>
<a name="ln-298"></a>            <span class="n">bond_params</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-299"></a>
<a name="ln-300"></a>            <span class="k">do </span><span class="n">it</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_bond_types</span>
<a name="ln-301"></a>                <span class="k">call </span><span class="n">readline</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="n">ios</span><span class="p">)</span>
<a name="ln-302"></a>                <span class="k">call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-303"></a>                <span class="n">bond_styles</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<a name="ln-304"></a>                <span class="k">call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-305"></a>                <span class="n">npar</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<a name="ln-306"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">npar</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-307"></a><span class="k">                    read</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">bond_params</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">npar</span><span class="p">,</span><span class="n">it</span><span class="p">)</span>
<a name="ln-308"></a>                <span class="k">end if</span>
<a name="ln-309"></a><span class="k">            end do</span>
<a name="ln-310"></a><span class="k">        end if</span>
<a name="ln-311"></a>
<a name="ln-312"></a><span class="k">        if</span> <span class="p">(</span><span class="n">str_startswith</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;BONDS&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-313"></a><span class="k">            call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-314"></a>            <span class="n">num_bonds</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-315"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">bonds</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">num_bonds</span><span class="p">))</span>
<a name="ln-316"></a>            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_bonds</span>
<a name="ln-317"></a>                <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">bonds</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-318"></a>            <span class="k">end do</span>
<a name="ln-319"></a><span class="k">        end if</span>
<a name="ln-320"></a>
<a name="ln-321"></a><span class="k">        if</span> <span class="p">(</span><span class="n">str_startswith</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;ANGLE_TYPES&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-322"></a><span class="k">            call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-323"></a>            <span class="n">num_angle_types</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-324"></a>
<a name="ln-325"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">angle_styles</span><span class="p">(</span><span class="n">num_angle_types</span><span class="p">))</span>
<a name="ln-326"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">angle_params</span><span class="p">(</span><span class="n">mxparam</span><span class="p">,</span> <span class="n">num_angle_types</span><span class="p">))</span>
<a name="ln-327"></a>            <span class="n">angle_params</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-328"></a>
<a name="ln-329"></a>            <span class="k">do </span><span class="n">it</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_angle_types</span>
<a name="ln-330"></a>                <span class="k">call </span><span class="n">readline</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="n">ios</span><span class="p">)</span>
<a name="ln-331"></a>                <span class="k">call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-332"></a>                <span class="n">angle_styles</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<a name="ln-333"></a>                <span class="k">call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-334"></a>                <span class="n">npar</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<a name="ln-335"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">npar</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-336"></a><span class="k">                    read</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">angle_params</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">npar</span><span class="p">,</span><span class="n">it</span><span class="p">)</span>
<a name="ln-337"></a>                <span class="k">end if</span>
<a name="ln-338"></a><span class="k">            end do</span>
<a name="ln-339"></a><span class="k">        end if</span>
<a name="ln-340"></a>
<a name="ln-341"></a><span class="k">        if</span> <span class="p">(</span><span class="n">str_startswith</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;ANGLES&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-342"></a><span class="k">            call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-343"></a>            <span class="n">num_angles</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-344"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">angles</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">num_angles</span><span class="p">))</span>
<a name="ln-345"></a>            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_angles</span>
<a name="ln-346"></a>                <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">angles</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-347"></a>            <span class="k">end do</span>
<a name="ln-348"></a><span class="k">        end if</span>
<a name="ln-349"></a>
<a name="ln-350"></a><span class="k">        if</span> <span class="p">(</span><span class="n">str_startswith</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;DIHEDRAL_TYPES&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-351"></a><span class="k">            call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-352"></a>            <span class="n">num_dihedral_types</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-353"></a>
<a name="ln-354"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">dihedral_styles</span><span class="p">(</span><span class="n">num_dihedral_types</span><span class="p">))</span>
<a name="ln-355"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">dihedral_params</span><span class="p">(</span><span class="n">mxparam</span><span class="p">,</span> <span class="n">num_dihedral_types</span><span class="p">))</span>
<a name="ln-356"></a>            <span class="n">dihedral_params</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-357"></a>
<a name="ln-358"></a>            <span class="k">do </span><span class="n">it</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_dihedral_types</span>
<a name="ln-359"></a>                <span class="k">call </span><span class="n">readline</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="n">ios</span><span class="p">)</span>
<a name="ln-360"></a>                <span class="k">call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-361"></a>                <span class="n">dihedral_styles</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<a name="ln-362"></a>                <span class="k">call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-363"></a>                <span class="n">npar</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<a name="ln-364"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">npar</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-365"></a><span class="k">                    read</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">dihedral_params</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">npar</span><span class="p">,</span><span class="n">it</span><span class="p">)</span>
<a name="ln-366"></a>                <span class="k">end if</span>
<a name="ln-367"></a><span class="k">            end do</span>
<a name="ln-368"></a><span class="k">        end if</span>
<a name="ln-369"></a>
<a name="ln-370"></a><span class="k">        if</span> <span class="p">(</span><span class="n">str_startswith</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;DIHEDRALS&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-371"></a><span class="k">            call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-372"></a>            <span class="n">num_dihedrals</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-373"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">dihedrals</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">num_dihedrals</span><span class="p">))</span>
<a name="ln-374"></a>            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_dihedrals</span>
<a name="ln-375"></a>                <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">dihedrals</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-376"></a>            <span class="k">end do</span>
<a name="ln-377"></a><span class="k">        end if</span>
<a name="ln-378"></a>
<a name="ln-379"></a><span class="k">        if</span> <span class="p">(</span><span class="n">str_startswith</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;BRANCHES&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-380"></a><span class="k">            call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-381"></a>            <span class="n">num_branches</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-382"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">branches</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">num_branches</span><span class="p">))</span>
<a name="ln-383"></a>            <span class="k">do </span><span class="n">ibr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_branches</span>
<a name="ln-384"></a>                <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">branches</span><span class="p">(:,</span><span class="n">ibr</span><span class="p">)</span>
<a name="ln-385"></a>            <span class="k">end do</span>
<a name="ln-386"></a><span class="k">        end if</span>
<a name="ln-387"></a>
<a name="ln-388"></a><span class="k">        if</span> <span class="p">(</span><span class="n">str_startswith</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;MOLECULE_TYPES&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-389"></a><span class="k">            call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-390"></a>            <span class="n">num_molecule_types</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-391"></a>
<a name="ln-392"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">molecule_names</span><span class="p">(</span><span class="n">num_molecule_types</span><span class="p">))</span>
<a name="ln-393"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">molecule_pop</span><span class="p">(</span><span class="n">num_molecule_types</span><span class="p">))</span>
<a name="ln-394"></a>
<a name="ln-395"></a>            <span class="k">do </span><span class="n">it</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_molecule_types</span>
<a name="ln-396"></a>                <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">molecule_names</span><span class="p">(</span><span class="n">it</span><span class="p">),</span> <span class="n">molecule_pop</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<a name="ln-397"></a>            <span class="k">end do</span>
<a name="ln-398"></a><span class="k">        end if</span>
<a name="ln-399"></a>
<a name="ln-400"></a><span class="k">        if</span> <span class="p">(</span><span class="n">str_startswith</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;MOLECULES&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-401"></a><span class="k">            call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-402"></a>            <span class="n">num_molecules</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-403"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">molecules</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="n">num_molecules</span><span class="p">))</span>
<a name="ln-404"></a>            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_molecules</span>
<a name="ln-405"></a>                <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">molecules</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-406"></a>            <span class="k">end do</span>
<a name="ln-407"></a><span class="k">        end if</span>
<a name="ln-408"></a>
<a name="ln-409"></a><span class="k">        if</span> <span class="p">(</span><span class="n">str_startswith</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;TETHER_TYPES&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-410"></a><span class="k">            call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-411"></a>            <span class="n">num_tether_types</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-412"></a>
<a name="ln-413"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">tether_styles</span><span class="p">(</span><span class="n">num_tether_types</span><span class="p">))</span>
<a name="ln-414"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">tether_params</span><span class="p">(</span><span class="n">mxparam</span><span class="p">,</span> <span class="n">num_tether_types</span><span class="p">))</span>
<a name="ln-415"></a>            <span class="n">tether_params</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-416"></a>
<a name="ln-417"></a>            <span class="k">do </span><span class="n">it</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_tether_types</span>
<a name="ln-418"></a>                <span class="k">call </span><span class="n">readline</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="n">ios</span><span class="p">)</span>
<a name="ln-419"></a>                <span class="k">call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-420"></a>                <span class="n">tether_styles</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<a name="ln-421"></a>                <span class="k">call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-422"></a>                <span class="n">npar</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<a name="ln-423"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">npar</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-424"></a><span class="k">                    read</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">tether_params</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">npar</span><span class="p">,</span><span class="n">it</span><span class="p">)</span>
<a name="ln-425"></a>                <span class="k">end if</span>
<a name="ln-426"></a><span class="k">            end do</span>
<a name="ln-427"></a><span class="k">        end if</span>
<a name="ln-428"></a>
<a name="ln-429"></a><span class="k">        if</span> <span class="p">(</span><span class="n">str_startswith</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;TETHERS&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-430"></a><span class="k">            call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-431"></a>            <span class="n">num_tethers</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-432"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">tethers</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">num_tethers</span><span class="p">))</span>
<a name="ln-433"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">tether_points</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">num_tethers</span><span class="p">))</span>
<a name="ln-434"></a>            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_tethers</span>
<a name="ln-435"></a>                <span class="k">read</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">tethers</span><span class="p">(:,</span><span class="n">i</span><span class="p">),</span> <span class="n">tether_points</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-436"></a>            <span class="k">end do</span>
<a name="ln-437"></a><span class="k">        end if</span>
<a name="ln-438"></a>
<a name="ln-439"></a><span class="k">        if</span> <span class="p">(</span><span class="n">str_startswith</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;VDW&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-440"></a><span class="k">            call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-441"></a>            <span class="n">num_vdw_types</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-442"></a>
<a name="ln-443"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">vdw_styles</span><span class="p">(</span><span class="n">num_vdw_types</span><span class="p">))</span>
<a name="ln-444"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">vdw_pairs</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">num_vdw_types</span><span class="p">))</span>
<a name="ln-445"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">vdw_params</span><span class="p">(</span><span class="n">mxparam</span><span class="p">,</span><span class="n">num_vdw_types</span><span class="p">))</span>
<a name="ln-446"></a>            <span class="n">vdw_params</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-447"></a>
<a name="ln-448"></a>            <span class="k">do </span><span class="n">it</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_vdw_types</span>
<a name="ln-449"></a>                <span class="k">call </span><span class="n">readline</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="n">ios</span><span class="p">)</span>
<a name="ln-450"></a>                <span class="k">call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-451"></a>                <span class="n">vdw_pairs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">it</span><span class="p">)</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<a name="ln-452"></a>                <span class="k">call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-453"></a>                <span class="n">vdw_pairs</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">it</span><span class="p">)</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<a name="ln-454"></a>                <span class="k">call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-455"></a>                <span class="n">vdw_styles</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<a name="ln-456"></a>                <span class="k">call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-457"></a>                <span class="n">npar</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<a name="ln-458"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">npar</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-459"></a><span class="k">                    read</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">vdw_params</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">npar</span><span class="p">,</span><span class="n">it</span><span class="p">)</span>
<a name="ln-460"></a>                <span class="k">end if</span>
<a name="ln-461"></a><span class="k">            end do</span>
<a name="ln-462"></a><span class="k">        end if</span>
<a name="ln-463"></a>
<a name="ln-464"></a><span class="k">        if</span> <span class="p">(</span><span class="n">str_startswith</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;EXTERNAL&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-465"></a><span class="k">            call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-466"></a>            <span class="n">num_externals</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-467"></a>
<a name="ln-468"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">external_styles</span><span class="p">(</span><span class="n">num_externals</span><span class="p">))</span>
<a name="ln-469"></a>            <span class="k">allocate</span><span class="p">(</span><span class="n">external_params</span><span class="p">(</span><span class="n">mxparam</span><span class="p">,</span><span class="n">num_externals</span><span class="p">))</span>
<a name="ln-470"></a>            <span class="n">external_params</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-471"></a>
<a name="ln-472"></a>            <span class="k">do </span><span class="n">it</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_externals</span>
<a name="ln-473"></a>                <span class="k">call </span><span class="n">readline</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="n">ios</span><span class="p">)</span>
<a name="ln-474"></a>                <span class="k">call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-475"></a>                <span class="n">external_styles</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<a name="ln-476"></a>                <span class="k">call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-477"></a>                <span class="n">npar</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<a name="ln-478"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">npar</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-479"></a><span class="k">                    read</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">external_params</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">npar</span><span class="p">,</span><span class="n">it</span><span class="p">)</span>
<a name="ln-480"></a>                <span class="k">end if</span>
<a name="ln-481"></a><span class="k">            end do</span>
<a name="ln-482"></a><span class="k">        end if</span>
<a name="ln-483"></a>
<a name="ln-484"></a><span class="k">        if</span> <span class="p">(</span><span class="n">str_startswith</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;FLOW_FIELD&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-485"></a><span class="k">            allocate</span><span class="p">(</span><span class="n">flow_params</span><span class="p">(</span><span class="n">mxparam</span><span class="p">))</span>
<a name="ln-486"></a>            <span class="n">flow_params</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-487"></a>            <span class="k">call </span><span class="n">readline</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="n">ios</span><span class="p">)</span>
<a name="ln-488"></a>            <span class="k">call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-489"></a>            <span class="n">flow_style</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<a name="ln-490"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">flow_style</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-491"></a><span class="k">                call </span><span class="n">str_split</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span>
<a name="ln-492"></a>                <span class="n">npar</span> <span class="o">=</span> <span class="n">str_to_i</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
<a name="ln-493"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">npar</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-494"></a><span class="k">                    read</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">flow_params</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">npar</span><span class="p">)</span>
<a name="ln-495"></a>                <span class="k">end if</span>
<a name="ln-496"></a><span class="k">            end if</span>
<a name="ln-497"></a><span class="k">        end if</span>
<a name="ln-498"></a><span class="k">    end do</span>
<a name="ln-499"></a>
<a name="ln-500"></a><span class="k">    close</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span>
<a name="ln-501"></a>
<a name="ln-502"></a>    <span class="k">end subroutine</span>
<a name="ln-503"></a>
<a name="ln-504"></a><span class="c">!*******************************************************************************</span>
<a name="ln-505"></a>
<a name="ln-506"></a><span class="k">subroutine </span><span class="n">write_config</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
<a name="ln-507"></a>    <span class="c">!! Write to cfg file</span>
<a name="ln-508"></a>
<a name="ln-509"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fn</span>
<a name="ln-510"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">title</span>
<a name="ln-511"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">fu</span>
<a name="ln-512"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">it</span>
<a name="ln-513"></a>
<a name="ln-514"></a>    <span class="k">open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">fu</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">fn</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">)</span>
<a name="ln-515"></a>
<a name="ln-516"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s1">&#39;#&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">title</span><span class="p">))</span>
<a name="ln-517"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s1">&#39;version 1.0&#39;</span>
<a name="ln-518"></a>
<a name="ln-519"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>
<a name="ln-520"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s1">&#39;SIMBOX&#39;</span>
<a name="ln-521"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(3(g0.8,2x))&#39;</span><span class="p">)</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-522"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(3(g0.8,2x))&#39;</span><span class="p">)</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-523"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(3(g0.8,2x))&#39;</span><span class="p">)</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(:,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-524"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>
<a name="ln-525"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(a,2x,i0)&#39;</span><span class="p">)</span> <span class="s1">&#39;IMCON&#39;</span><span class="p">,</span> <span class="n">imcon</span>
<a name="ln-526"></a>
<a name="ln-527"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>
<a name="ln-528"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(a,2x,i0)&#39;</span><span class="p">)</span> <span class="s1">&#39;ATOM_TYPES&#39;</span><span class="p">,</span> <span class="n">num_atom_types</span>
<a name="ln-529"></a>    <span class="k">do </span><span class="n">it</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atom_types</span>
<a name="ln-530"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(a,2x,i0,2x,g0.6)&#39;</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">atom_names</span><span class="p">(</span><span class="n">it</span><span class="p">))),</span> <span class="p">&amp;</span>
<a name="ln-531"></a>            <span class="n">atom_styles</span><span class="p">(</span><span class="n">it</span><span class="p">),</span> <span class="n">atom_mass</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<a name="ln-532"></a>    <span class="k">end do</span>
<a name="ln-533"></a>
<a name="ln-534"></a><span class="k">    if</span> <span class="p">(</span><span class="n">num_mpcd_atoms</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-535"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>
<a name="ln-536"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(a,2x, i0,2x,i0)&#39;</span><span class="p">)</span> <span class="s1">&#39;MPCD_ATOMS&#39;</span><span class="p">,</span> <span class="n">num_mpcd_atoms</span><span class="p">,</span> <span class="n">mpcd_avnc</span>
<a name="ln-537"></a>    <span class="k">end if</span>
<a name="ln-538"></a>
<a name="ln-539"></a><span class="k">    write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>
<a name="ln-540"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(a,2x,i0)&#39;</span><span class="p">)</span> <span class="s1">&#39;ATOMS&#39;</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-541"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-542"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(i0,2x,*(g0.14,2x))&#39;</span><span class="p">)</span> <span class="n">atoms</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">charge</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-543"></a>    <span class="k">end do</span>
<a name="ln-544"></a>
<a name="ln-545"></a><span class="k">    if</span> <span class="p">(</span><span class="n">num_bonds</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-546"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>
<a name="ln-547"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(a,2x,i0)&#39;</span><span class="p">)</span> <span class="s1">&#39;BOND_TYPES&#39;</span><span class="p">,</span> <span class="n">num_bond_types</span>
<a name="ln-548"></a>        <span class="k">do </span><span class="n">it</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_bond_types</span>
<a name="ln-549"></a>            <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(i0,2x,i0,2x,*(g0.6,2x))&#39;</span><span class="p">)</span> <span class="n">bond_styles</span><span class="p">(</span><span class="n">it</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-550"></a>                <span class="n">size</span><span class="p">(</span><span class="n">bond_params</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">bond_params</span><span class="p">(:,</span><span class="n">it</span><span class="p">)</span>
<a name="ln-551"></a>        <span class="k">end do</span>
<a name="ln-552"></a>
<a name="ln-553"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>
<a name="ln-554"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(a,2x,i0)&#39;</span><span class="p">)</span> <span class="s1">&#39;BONDS&#39;</span><span class="p">,</span> <span class="n">num_bonds</span>
<a name="ln-555"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_bonds</span>
<a name="ln-556"></a>            <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(*(i0,2x))&#39;</span><span class="p">)</span> <span class="n">bonds</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-557"></a>        <span class="k">end do</span>
<a name="ln-558"></a><span class="k">    end if</span>
<a name="ln-559"></a>
<a name="ln-560"></a><span class="k">    if</span> <span class="p">(</span><span class="n">num_angles</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-561"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>
<a name="ln-562"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(a,2x,i0)&#39;</span><span class="p">)</span> <span class="s1">&#39;ANGLE_TYPES&#39;</span><span class="p">,</span> <span class="n">num_angle_types</span>
<a name="ln-563"></a>        <span class="k">do </span><span class="n">it</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_angle_types</span>
<a name="ln-564"></a>            <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(i0,2x,i0,2x,*(g0.6,2x))&#39;</span><span class="p">)</span> <span class="n">angle_styles</span><span class="p">(</span><span class="n">it</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-565"></a>                <span class="n">size</span><span class="p">(</span><span class="n">angle_params</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">angle_params</span><span class="p">(:,</span><span class="n">it</span><span class="p">)</span>
<a name="ln-566"></a>        <span class="k">end do</span>
<a name="ln-567"></a>
<a name="ln-568"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>
<a name="ln-569"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(a,2x,i0)&#39;</span><span class="p">)</span> <span class="s1">&#39;ANGLES&#39;</span><span class="p">,</span> <span class="n">num_angles</span>
<a name="ln-570"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_angles</span>
<a name="ln-571"></a>            <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(*(i0,2x))&#39;</span><span class="p">)</span> <span class="n">angles</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-572"></a>        <span class="k">end do</span>
<a name="ln-573"></a><span class="k">    end if</span>
<a name="ln-574"></a>
<a name="ln-575"></a><span class="k">    if</span> <span class="p">(</span><span class="n">num_dihedrals</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-576"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>
<a name="ln-577"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(a,2x,i0)&#39;</span><span class="p">)</span> <span class="s1">&#39;DIHEDRAL_TYPES&#39;</span><span class="p">,</span> <span class="n">num_dihedral_types</span>
<a name="ln-578"></a>        <span class="k">do </span><span class="n">it</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_dihedral_types</span>
<a name="ln-579"></a>            <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(i0,2x,i0,2x,*(g0.6,2x))&#39;</span><span class="p">)</span> <span class="n">dihedral_styles</span><span class="p">(</span><span class="n">it</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-580"></a>                <span class="n">size</span><span class="p">(</span><span class="n">dihedral_params</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">dihedral_params</span><span class="p">(:,</span><span class="n">it</span><span class="p">)</span>
<a name="ln-581"></a>        <span class="k">end do</span>
<a name="ln-582"></a>
<a name="ln-583"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>
<a name="ln-584"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(a,2x,i0)&#39;</span><span class="p">)</span> <span class="s1">&#39;DIHEDRALS&#39;</span><span class="p">,</span> <span class="n">num_dihedrals</span>
<a name="ln-585"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_dihedrals</span>
<a name="ln-586"></a>            <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(*(i0,2x))&#39;</span><span class="p">)</span> <span class="n">dihedrals</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-587"></a>        <span class="k">end do</span>
<a name="ln-588"></a><span class="k">    end if</span>
<a name="ln-589"></a>
<a name="ln-590"></a><span class="k">    if</span> <span class="p">(</span><span class="n">num_branches</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-591"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>
<a name="ln-592"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(a,2x,i0)&#39;</span><span class="p">)</span> <span class="s1">&#39;BRANCHES&#39;</span><span class="p">,</span> <span class="n">num_branches</span>
<a name="ln-593"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_branches</span>
<a name="ln-594"></a>            <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(*(i0,2x))&#39;</span><span class="p">)</span> <span class="n">branches</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-595"></a>        <span class="k">end do</span>
<a name="ln-596"></a><span class="k">    end if</span>
<a name="ln-597"></a>
<a name="ln-598"></a><span class="k">    write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>
<a name="ln-599"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(a,2x,i0)&#39;</span><span class="p">)</span> <span class="s1">&#39;MOLECULE_TYPES&#39;</span><span class="p">,</span> <span class="n">num_molecule_types</span>
<a name="ln-600"></a>    <span class="k">do </span><span class="n">it</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_molecule_types</span>
<a name="ln-601"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(a,2x,i0)&#39;</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">molecule_names</span><span class="p">(</span><span class="n">it</span><span class="p">))),</span> <span class="n">molecule_pop</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<a name="ln-602"></a>    <span class="k">end do</span>
<a name="ln-603"></a>
<a name="ln-604"></a><span class="k">    write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>
<a name="ln-605"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(a,2x,i0)&#39;</span><span class="p">)</span> <span class="s1">&#39;MOLECULES&#39;</span><span class="p">,</span> <span class="n">num_molecules</span>
<a name="ln-606"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_molecules</span>
<a name="ln-607"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(*(i0,2x))&#39;</span><span class="p">)</span> <span class="n">molecules</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-608"></a>    <span class="k">end do</span>
<a name="ln-609"></a>
<a name="ln-610"></a><span class="k">    if</span> <span class="p">(</span><span class="n">num_tethers</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-611"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>
<a name="ln-612"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(a,2x,i0)&#39;</span><span class="p">)</span> <span class="s1">&#39;TETHER_TYPES&#39;</span><span class="p">,</span> <span class="n">num_tether_types</span>
<a name="ln-613"></a>        <span class="k">do </span><span class="n">it</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_tether_types</span>
<a name="ln-614"></a>            <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(i0,2x,i0,2x,*(g0.6,2x))&#39;</span><span class="p">)</span> <span class="n">tether_styles</span><span class="p">(</span><span class="n">it</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-615"></a>                <span class="n">size</span><span class="p">(</span><span class="n">tether_params</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">tether_params</span><span class="p">(:,</span><span class="n">it</span><span class="p">)</span>
<a name="ln-616"></a>        <span class="k">end do</span>
<a name="ln-617"></a>
<a name="ln-618"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>
<a name="ln-619"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(a,2x,i0)&#39;</span><span class="p">)</span> <span class="s1">&#39;TETHERS&#39;</span><span class="p">,</span> <span class="n">num_tethers</span>
<a name="ln-620"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_tethers</span>
<a name="ln-621"></a>            <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(2(i0,2x),3(g0.6,2x))&#39;</span><span class="p">)</span> <span class="n">tethers</span><span class="p">(:,</span><span class="n">i</span><span class="p">),</span> <span class="n">tether_points</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-622"></a>        <span class="k">end do</span>
<a name="ln-623"></a><span class="k">    end if</span>
<a name="ln-624"></a>
<a name="ln-625"></a><span class="k">    if</span> <span class="p">(</span><span class="n">num_vdw_types</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-626"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>
<a name="ln-627"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(a,2x,i0)&#39;</span><span class="p">)</span> <span class="s1">&#39;VDW&#39;</span><span class="p">,</span> <span class="n">num_vdw_types</span>
<a name="ln-628"></a>        <span class="k">do </span><span class="n">it</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_vdw_types</span>
<a name="ln-629"></a>            <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span><span class="s1">&#39;(2(i0,2x),i0,2x,i0,2x,*(g0.6,2x))&#39;</span><span class="p">)</span> <span class="n">vdw_pairs</span><span class="p">(:,</span><span class="n">it</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-630"></a>                <span class="n">vdw_styles</span><span class="p">(</span><span class="n">it</span><span class="p">),</span> <span class="n">size</span><span class="p">(</span><span class="n">vdw_params</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">vdw_params</span><span class="p">(:,</span><span class="n">it</span><span class="p">)</span>
<a name="ln-631"></a>        <span class="k">end do</span>
<a name="ln-632"></a><span class="k">    end if</span>
<a name="ln-633"></a>
<a name="ln-634"></a><span class="k">    if</span> <span class="p">(</span><span class="n">num_externals</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-635"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>
<a name="ln-636"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(a,2x,i0)&#39;</span><span class="p">)</span> <span class="s1">&#39;EXTERNAL&#39;</span><span class="p">,</span> <span class="n">num_externals</span>
<a name="ln-637"></a>        <span class="k">do </span><span class="n">it</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_externals</span>
<a name="ln-638"></a>            <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span><span class="s1">&#39;(i0,2x,i0,2x,*(g0.6,2x))&#39;</span><span class="p">)</span> <span class="n">external_styles</span><span class="p">(</span><span class="n">it</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-639"></a>                <span class="n">size</span><span class="p">(</span><span class="n">external_params</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">external_params</span><span class="p">(:,</span><span class="n">it</span><span class="p">)</span>
<a name="ln-640"></a>        <span class="k">end do</span>
<a name="ln-641"></a><span class="k">    end if</span>
<a name="ln-642"></a>
<a name="ln-643"></a><span class="k">    write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>
<a name="ln-644"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span> <span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s1">&#39;FLOW_FIELD&#39;</span>
<a name="ln-645"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span><span class="s1">&#39;(i0,2x,i0,2x,*(g0.6,2x))&#39;</span><span class="p">,</span> <span class="n">advance</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span> <span class="n">flow_style</span>
<a name="ln-646"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">flow_style</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then </span>
<a name="ln-647"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span><span class="s1">&#39;(i0,2x,*(g0.6,2x))&#39;</span><span class="p">)</span> <span class="n">size</span><span class="p">(</span><span class="n">flow_params</span><span class="p">),</span> <span class="n">flow_params</span>
<a name="ln-648"></a>    <span class="k">else</span>
<a name="ln-649"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<a name="ln-650"></a>    <span class="k">end if</span>
<a name="ln-651"></a>
<a name="ln-652"></a><span class="k">    close</span><span class="p">(</span><span class="n">fu</span><span class="p">)</span>
<a name="ln-653"></a>
<a name="ln-654"></a>    <span class="k">end subroutine</span>
<a name="ln-655"></a>
<a name="ln-656"></a><span class="c">!******************************************************************************</span>
<a name="ln-657"></a>
<a name="ln-658"></a><span class="k">subroutine </span><span class="n">write_ldf</span><span class="p">(</span><span class="n">fn_ld</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">with_mpcd_atoms</span><span class="p">)</span>
<a name="ln-659"></a>    <span class="c">!! Write to a LAMMPS data file.</span>
<a name="ln-660"></a>
<a name="ln-661"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fn_ld</span>
<a name="ln-662"></a>        <span class="c">!! Name of the file</span>
<a name="ln-663"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">title</span>
<a name="ln-664"></a>        <span class="c">!! Title of the configuation</span>
<a name="ln-665"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">with_mpcd_atoms</span>
<a name="ln-666"></a>        <span class="c">!! Include MPCD atoms in the file? {T, F}</span>
<a name="ln-667"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tilt_factors</span>
<a name="ln-668"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">chge</span>
<a name="ln-669"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">with_mpcd_atoms_</span>
<a name="ln-670"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">fu_ld</span>
<a name="ln-671"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">cntr_atm</span><span class="p">,</span> <span class="n">iatm_beg</span><span class="p">,</span> <span class="n">natm</span>
<a name="ln-672"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">iatm</span><span class="p">,</span> <span class="n">imol</span>
<a name="ln-673"></a>
<a name="ln-674"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">with_mpcd_atoms</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-675"></a><span class="k">        </span><span class="n">with_mpcd_atoms_</span> <span class="o">=</span> <span class="n">with_mpcd_atoms</span>
<a name="ln-676"></a>    <span class="k">else</span>
<a name="ln-677"></a><span class="k">        </span><span class="n">with_mpcd_atoms_</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-678"></a>    <span class="k">end if</span>
<a name="ln-679"></a>
<a name="ln-680"></a><span class="k">    open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">fu_ld</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">fn_ld</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">)</span>
<a name="ln-681"></a>
<a name="ln-682"></a>    <span class="c">!Header</span>
<a name="ln-683"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s1">&#39;#&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">title</span><span class="p">))</span>
<a name="ln-684"></a>
<a name="ln-685"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">with_mpcd_atoms_</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-686"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="s1">&#39;(i0,2x,a)&#39;</span><span class="p">)</span> <span class="n">num_atoms_tot</span><span class="p">,</span> <span class="s1">&#39;atoms&#39;</span>
<a name="ln-687"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="s1">&#39;(i0,2x,a)&#39;</span><span class="p">)</span> <span class="n">num_atom_types</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;atom types&#39;</span>
<a name="ln-688"></a>    <span class="k">else</span>
<a name="ln-689"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="s1">&#39;(i0,2x,a)&#39;</span><span class="p">)</span> <span class="n">num_atoms</span><span class="p">,</span> <span class="s1">&#39;atoms&#39;</span>
<a name="ln-690"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="s1">&#39;(i0,2x,a)&#39;</span><span class="p">)</span> <span class="n">num_atom_types</span><span class="p">,</span> <span class="s1">&#39;atom types&#39;</span>
<a name="ln-691"></a>    <span class="k">end if</span>
<a name="ln-692"></a>
<a name="ln-693"></a><span class="k">    if</span> <span class="p">(</span><span class="n">num_bonds</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-694"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="s1">&#39;(i0,2x,a)&#39;</span><span class="p">)</span> <span class="n">num_bonds</span><span class="p">,</span> <span class="s1">&#39;bonds&#39;</span>
<a name="ln-695"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="s1">&#39;(i0,2x,a)&#39;</span><span class="p">)</span> <span class="n">num_bond_types</span><span class="p">,</span> <span class="s1">&#39;bond types&#39;</span>
<a name="ln-696"></a>    <span class="k">end if</span>
<a name="ln-697"></a>
<a name="ln-698"></a><span class="k">    if</span> <span class="p">(</span><span class="n">num_angles</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-699"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="s1">&#39;(i0,2x,a)&#39;</span><span class="p">)</span> <span class="n">num_angles</span><span class="p">,</span> <span class="s1">&#39;angles&#39;</span>
<a name="ln-700"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="s1">&#39;(i0,2x,a)&#39;</span><span class="p">)</span> <span class="n">num_angle_types</span><span class="p">,</span> <span class="s1">&#39;angle types&#39;</span>
<a name="ln-701"></a>    <span class="k">end if</span>
<a name="ln-702"></a>
<a name="ln-703"></a><span class="k">    if</span> <span class="p">(</span><span class="n">num_dihedrals</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-704"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="s1">&#39;(i0,2x,a)&#39;</span><span class="p">)</span> <span class="n">num_dihedrals</span><span class="p">,</span> <span class="s1">&#39;dihedrals&#39;</span>
<a name="ln-705"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="s1">&#39;(i0,2x,a)&#39;</span><span class="p">)</span> <span class="n">num_dihedral_types</span><span class="p">,</span> <span class="s1">&#39;dihedral types&#39;</span>
<a name="ln-706"></a>    <span class="k">end if</span>
<a name="ln-707"></a>
<a name="ln-708"></a>    <span class="c">!Simulation box &amp; tilt factors</span>
<a name="ln-709"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="s1">&#39;(a,2x,g0.6,2x,a)&#39;</span><span class="p">)</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;xlo xhi&#39;</span>
<a name="ln-710"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="s1">&#39;(a,2x,g0.6,2x,a)&#39;</span><span class="p">)</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;ylo yhi&#39;</span>
<a name="ln-711"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="s1">&#39;(a,2x,g0.6,2x,a)&#39;</span><span class="p">)</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="n">simbox</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;zlo zhi&#39;</span>
<a name="ln-712"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s1">&#39;0.0 0.0 0.0 xy xz yz&#39;</span>
<a name="ln-713"></a>
<a name="ln-714"></a>    <span class="c">!TODO: Triclinic box</span>
<a name="ln-715"></a>    <span class="c">!   tilt_factors(1) = dot_product(simbox%basis(:,1)/norm2(simbox%basis(:,1)), &amp;</span>
<a name="ln-716"></a>    <span class="c">!       simbox%basis(:,2)/norm2(simbox%basis(:,2)))</span>
<a name="ln-717"></a>    <span class="c">!   tilt_factors(2) = dot_product(simbox%basis(:,1)/norm2(simbox%basis(:,1)), &amp;</span>
<a name="ln-718"></a>    <span class="c">!       simbox%basis(:,3)/norm2(simbox%basis(:,3)))</span>
<a name="ln-719"></a>    <span class="c">!   tilt_factors(3) = dot_product(simbox%basis(:,2)/norm2(simbox%basis(:,2)), &amp;</span>
<a name="ln-720"></a>    <span class="c">!       simbox%basis(:,3)/norm2(simbox%basis(:,3)))</span>
<a name="ln-721"></a>    <span class="c">!   tilt_factors = acos(tilt_factors)</span>
<a name="ln-722"></a>    <span class="c">!   write(fu_ld,&#39;(3(g0.6,2x),a)&#39;) tilt_factors, &#39;xy xz yz&#39;</span>
<a name="ln-723"></a>
<a name="ln-724"></a>    <span class="c">!Body: Atoms</span>
<a name="ln-725"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<a name="ln-726"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s1">&#39;Atoms # full&#39;</span>
<a name="ln-727"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<a name="ln-728"></a>
<a name="ln-729"></a>    <span class="n">cntr_atm</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-730"></a>    <span class="k">do </span><span class="n">imol</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_molecules</span>
<a name="ln-731"></a>        <span class="n">natm</span> <span class="o">=</span> <span class="n">molecules</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">imol</span><span class="p">)</span>
<a name="ln-732"></a>        <span class="n">iatm_beg</span> <span class="o">=</span> <span class="n">molecules</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">imol</span><span class="p">)</span>
<a name="ln-733"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">natm</span>
<a name="ln-734"></a>            <span class="n">iatm</span> <span class="o">=</span> <span class="n">iatm_beg</span> <span class="o">+</span> <span class="n">i</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-735"></a>            <span class="k">write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="s1">&#39;(i0,2x,i0,2x,i0,2x,4(g0.8,2x))&#39;</span><span class="p">)</span> <span class="n">cntr_atm</span><span class="p">,</span> <span class="n">imol</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-736"></a>                <span class="n">atoms</span><span class="p">(</span><span class="n">iatm</span><span class="p">),</span> <span class="n">charge</span><span class="p">(</span><span class="n">iatm</span><span class="p">),</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">iatm</span><span class="p">)</span>
<a name="ln-737"></a>            <span class="n">cntr_atm</span> <span class="o">=</span> <span class="n">cntr_atm</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-738"></a>        <span class="k">end do</span>
<a name="ln-739"></a><span class="k">    end do</span>
<a name="ln-740"></a>
<a name="ln-741"></a><span class="k">    if</span> <span class="p">(</span><span class="n">with_mpcd_atoms_</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-742"></a><span class="k">        </span><span class="n">imol</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">chge</span> <span class="o">=</span> <span class="mf">0.0_rp</span> <span class="c">!No charge on MPCD atoms</span>
<a name="ln-743"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">num_atoms</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms_tot</span>
<a name="ln-744"></a>            <span class="k">write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="s1">&#39;(i0,2x,i0,2x,i0,2x,4(g0.8,2x))&#39;</span><span class="p">)</span> <span class="n">cntr_atm</span><span class="p">,</span> <span class="n">imol</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-745"></a>                <span class="p">(</span><span class="n">num_atom_types</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">chge</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-746"></a>            <span class="n">cntr_atm</span> <span class="o">=</span> <span class="n">cntr_atm</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-747"></a>        <span class="k">end do</span>
<a name="ln-748"></a><span class="k">    end if</span>
<a name="ln-749"></a>
<a name="ln-750"></a>    <span class="c">!Body: Bonds</span>
<a name="ln-751"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_bonds</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-752"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<a name="ln-753"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s1">&#39;Bonds&#39;</span>
<a name="ln-754"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<a name="ln-755"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_bonds</span>
<a name="ln-756"></a>            <span class="k">write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="s1">&#39;(i0,2x,3(i0,2x))&#39;</span><span class="p">)</span> <span class="n">i</span><span class="p">,</span> <span class="n">bonds</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-757"></a>        <span class="k">end do</span>
<a name="ln-758"></a><span class="k">    end if</span>
<a name="ln-759"></a>
<a name="ln-760"></a>    <span class="c">!Body: Angles</span>
<a name="ln-761"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_angles</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-762"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<a name="ln-763"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s1">&#39;Angles&#39;</span>
<a name="ln-764"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<a name="ln-765"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_angles</span>
<a name="ln-766"></a>            <span class="k">write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="s1">&#39;(i0,2x,4(i0,2x))&#39;</span><span class="p">)</span> <span class="n">i</span><span class="p">,</span> <span class="n">angles</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-767"></a>        <span class="k">end do</span>
<a name="ln-768"></a><span class="k">    end if</span>
<a name="ln-769"></a>
<a name="ln-770"></a>    <span class="c">!Body: Dihedrals</span>
<a name="ln-771"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_dihedrals</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-772"></a><span class="k">        write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<a name="ln-773"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s1">&#39;Dihedrals&#39;</span>
<a name="ln-774"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<a name="ln-775"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_dihedrals</span>
<a name="ln-776"></a>            <span class="k">write</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">,</span><span class="s1">&#39;(i0,2x,5(i0,2x))&#39;</span><span class="p">)</span> <span class="n">i</span><span class="p">,</span> <span class="n">dihedrals</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-777"></a>        <span class="k">end do</span>
<a name="ln-778"></a><span class="k">    end if</span>
<a name="ln-779"></a>
<a name="ln-780"></a><span class="k">    close</span><span class="p">(</span><span class="n">fu_ld</span><span class="p">)</span>
<a name="ln-781"></a>
<a name="ln-782"></a>    <span class="k">end subroutine</span>
<a name="ln-783"></a>
<a name="ln-784"></a><span class="c">!*******************************************************************************</span>
<a name="ln-785"></a>
<a name="ln-786"></a><span class="k">subroutine </span><span class="n">write_xyz</span><span class="p">(</span><span class="n">fn_xyz</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">with_mpcd_atoms</span><span class="p">)</span>
<a name="ln-787"></a>    <span class="c">!! Write to an XYZ file.</span>
<a name="ln-788"></a>
<a name="ln-789"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fn_xyz</span>
<a name="ln-790"></a>        <span class="c">!! Name of the XYZ file</span>
<a name="ln-791"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">title</span>
<a name="ln-792"></a>        <span class="c">!! Title (for the configuration)</span>
<a name="ln-793"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">with_mpcd_atoms</span>
<a name="ln-794"></a>        <span class="c">!! Include MPCD atoms in the file? {T, F}</span>
<a name="ln-795"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iatm</span>
<a name="ln-796"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">na</span>
<a name="ln-797"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">fu_xyz</span>
<a name="ln-798"></a>
<a name="ln-799"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">with_mpcd_atoms</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-800"></a><span class="k">        if</span> <span class="p">(</span><span class="n">with_mpcd_atoms</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-801"></a><span class="k">            </span><span class="n">na</span> <span class="o">=</span> <span class="n">num_atoms_tot</span>
<a name="ln-802"></a>        <span class="k">else</span>
<a name="ln-803"></a><span class="k">            </span><span class="n">na</span> <span class="o">=</span> <span class="n">num_atoms</span>
<a name="ln-804"></a>        <span class="k">end if</span>
<a name="ln-805"></a><span class="k">    else</span>
<a name="ln-806"></a><span class="k">        </span><span class="n">na</span> <span class="o">=</span> <span class="n">num_atoms</span>
<a name="ln-807"></a>    <span class="k">end if</span>
<a name="ln-808"></a>
<a name="ln-809"></a><span class="k">    open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">fu_xyz</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">fn_xyz</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">)</span>
<a name="ln-810"></a>
<a name="ln-811"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu_xyz</span><span class="p">,</span> <span class="s1">&#39;(i0)&#39;</span><span class="p">)</span> <span class="n">na</span>
<a name="ln-812"></a>    <span class="k">write</span><span class="p">(</span><span class="n">fu_xyz</span><span class="p">,</span> <span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="n">title</span>
<a name="ln-813"></a>
<a name="ln-814"></a>    <span class="k">do </span><span class="n">iatm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">na</span>
<a name="ln-815"></a>        <span class="k">write</span><span class="p">(</span><span class="n">fu_xyz</span><span class="p">,</span><span class="s1">&#39;(3(g0.7,2x))&#39;</span><span class="p">)</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">iatm</span><span class="p">)</span>
<a name="ln-816"></a>    <span class="k">end do</span>
<a name="ln-817"></a>
<a name="ln-818"></a><span class="k">    close</span><span class="p">(</span><span class="n">fu_xyz</span><span class="p">)</span>
<a name="ln-819"></a>
<a name="ln-820"></a>    <span class="k">end subroutine</span>
<a name="ln-821"></a>
<a name="ln-822"></a><span class="c">!*******************************************************************************</span>
<a name="ln-823"></a>
<a name="ln-824"></a><span class="k">end module </span><span class="n">m_config_io</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> BROWNPAK was developed by Sarit Dutta</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>