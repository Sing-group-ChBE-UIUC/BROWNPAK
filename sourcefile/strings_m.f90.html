<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for BROWNPAK">
   
    <meta name="author" content="Sarit Dutta" >
    <link rel="icon" href="../favicon.png">

    <title>strings_m.f90 &ndash; BROWNPAK</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">BROWNPAK <small>0.7</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
    <li><a href="../blockdata/nitbd.html">Block Data</a></li>
    
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../blockdata/nitbd.html">Block Data</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>strings_m.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 6.9% of total for source files.">590 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/strings_m.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">strings_m.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/strings_m.html">strings_m</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/strings_m.f90.html#src">strings_m.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~strings_m.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilestrings_mf90EfferentGraph" width="210pt" height="32pt"
 viewBox="0.00 0.00 210.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~strings_m.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>sourcefile~~strings_m.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 206,-28 206,4 -4,4"/>
<!-- sourcefile~strings_m.f90 -->
<g id="sourcefile~~strings_m.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~strings_m.f90</title>
<polygon fill="none" stroke="#000000" points="202,-24 126,-24 126,0 202,0 202,-24"/>
<text text-anchor="middle" x="164" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">strings_m.f90</text>
</g>
<!-- sourcefile~constants_m.f90 -->
<g id="sourcefile~~strings_m.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~constants_m.f90</title>
<g id="a_sourcefile~~strings_m.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/constants_m.f90.html" xlink:title="constants_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="90,-24 0,-24 0,0 90,0 90,-24"/>
<text text-anchor="middle" x="45" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">constants_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~strings_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~strings_m.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~strings_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M125.6926,-12C117.6741,-12 109.065,-12 100.5634,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="100.2938,-8.5001 90.2938,-12 100.2937,-15.5001 100.2938,-8.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~strings_m.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilestrings_mf90AfferentGraph" width="641pt" height="292pt"
 viewBox="0.00 0.00 641.00 291.58" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~strings_m.f90~~AfferentGraph" class="graph" transform="scale(.7106 .7106) rotate(0) translate(4 406.3081)">
<title>sourcefile~~strings_m.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-406.3081 898,-406.3081 898,4 -4,4"/>
<!-- sourcefile~strings_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~strings_m.f90</title>
<polygon fill="none" stroke="#000000" points="76,-320.4814 0,-320.4814 0,-296.4814 76,-296.4814 76,-320.4814"/>
<text text-anchor="middle" x="38" y="-306.0814" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">strings_m.f90</text>
</g>
<!-- sourcefile~config_io_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~config_io_m.f90</title>
<g id="a_sourcefile~~strings_m.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/config_io_m.f90.html" xlink:title="config_io_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="569,-341.4814 482,-341.4814 482,-317.4814 569,-317.4814 569,-341.4814"/>
<text text-anchor="middle" x="525.5" y="-327.0814" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">config_io_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~config_io_m.f90&#45;&gt;sourcefile~strings_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~config_io_m.f90&#45;&gt;sourcefile~strings_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M508.3487,-341.7395C484.7438,-357.5527 440.2901,-383.6143 397.5,-388.4814"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397.5,-388.4814C271.1452,-402.8534 230.1955,-416.406 112,-369.4814 89.6731,-360.6174 69.0074,-342.3686 55.2224,-328.1291"/>
<polygon fill="#ff0000" stroke="#ff0000" points="57.6864,-325.6395 48.3051,-320.7159 52.5684,-330.4151 57.6864,-325.6395"/>
</g>
<!-- sourcefile~brown_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~brown_m.f90</title>
<g id="a_sourcefile~~strings_m.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/brown_m.f90.html" xlink:title="brown_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="309.5,-42.4814 236.5,-42.4814 236.5,-18.4814 309.5,-18.4814 309.5,-42.4814"/>
<text text-anchor="middle" x="273" y="-28.0814" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">brown_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~brown_m.f90&#45;&gt;sourcefile~strings_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~brown_m.f90&#45;&gt;sourcefile~strings_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M236.3476,-37.1531C211.0222,-43.1545 177.5995,-53.9622 153,-72.4814"/>
</g>
<!-- sourcefile~control_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~control_m.f90</title>
<g id="a_sourcefile~~strings_m.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/control_m.f90.html" xlink:title="control_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="311,-84.4814 235,-84.4814 235,-60.4814 311,-60.4814 311,-84.4814"/>
<text text-anchor="middle" x="273" y="-70.0814" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">control_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~control_m.f90&#45;&gt;sourcefile~strings_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~control_m.f90&#45;&gt;sourcefile~strings_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M234.9351,-61.5135C209.2848,-56.5508 176.052,-55.1272 153,-72.4814"/>
</g>
<!-- sourcefile~setup_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~setup_m.f90</title>
<g id="a_sourcefile~~strings_m.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/setup_m.f90.html" xlink:title="setup_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="804,-182.4814 734,-182.4814 734,-158.4814 804,-158.4814 804,-182.4814"/>
<text text-anchor="middle" x="769" y="-168.0814" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">setup_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~setup_m.f90&#45;&gt;sourcefile~strings_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~setup_m.f90&#45;&gt;sourcefile~strings_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M653,-308.4814C616.4959,-326.1419 610.1432,-336.714 572,-350.4814 497.3411,-377.4285 475.893,-376.0459 397.5,-388.4814"/>
</g>
<!-- sourcefile~setup_m.f90&#45;&gt;sourcefile~config_io_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~setup_m.f90&#45;&gt;sourcefile~config_io_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M653,-308.4814C630.2627,-319.5917 602.8067,-324.9881 579.2056,-327.549"/>
<polygon fill="#ff0000" stroke="#ff0000" points="578.6369,-324.0869 569.009,-328.5089 579.2931,-331.0561 578.6369,-324.0869"/>
</g>
<!-- sourcefile~setup_m.f90&#45;&gt;sourcefile~control_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~setup_m.f90&#45;&gt;sourcefile~control_m.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M397.5,-148.4814C355.8544,-140.0242 352.2937,-120.5866 316,-98.4814 311.4597,-95.716 306.6445,-92.794 301.9425,-89.9466"/>
<polygon fill="#aaff00" stroke="#aaff00" points="303.51,-86.8043 293.142,-84.6236 299.8872,-92.7939 303.51,-86.8043"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M733.677,-162.0313C694.4556,-153.1173 629.1327,-139.6587 572,-134.4814 530.8353,-130.751 520.1839,-130.9698 479,-134.4814 442.3801,-137.6038 433.5176,-155.7956 397.5,-148.4814"/>
</g>
<!-- sourcefile~stats_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~stats_m.f90</title>
<g id="a_sourcefile~~strings_m.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/stats_m.f90.html" xlink:title="stats_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="431,-200.4814 364,-200.4814 364,-176.4814 431,-176.4814 431,-200.4814"/>
<text text-anchor="middle" x="397.5" y="-186.0814" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">stats_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~setup_m.f90&#45;&gt;sourcefile~stats_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~setup_m.f90&#45;&gt;sourcefile~stats_m.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M653,-308.4814C616.5653,-326.2847 608.336,-284.4853 572,-266.4814 515.173,-238.3244 501.4229,-230.1571 443,-205.4814 442.1504,-205.1225 441.2903,-204.7633 440.4221,-204.4044"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="441.5104,-201.07 430.9258,-200.6024 438.9085,-207.5685 441.5104,-201.07"/>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M763.2901,-182.6364C749.2336,-210.9441 709.9119,-280.9477 653,-308.4814"/>
</g>
<!-- sourcefile~interaction_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~interaction_m.f90</title>
<g id="a_sourcefile~~strings_m.f90~~AfferentGraph_node12"><a xlink:href=".././sourcefile/interaction_m.f90.html" xlink:title="interaction_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="572,-299.4814 479,-299.4814 479,-275.4814 572,-275.4814 572,-299.4814"/>
<text text-anchor="middle" x="525.5" y="-285.0814" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">interaction_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~setup_m.f90&#45;&gt;sourcefile~interaction_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~setup_m.f90&#45;&gt;sourcefile~interaction_m.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M653,-308.4814C623.2006,-323.0425 585.2961,-313.7811 558.587,-303.3564"/>
<polygon fill="#7fff00" stroke="#7fff00" points="559.8673,-300.0984 549.2891,-299.5051 557.1885,-306.5656 559.8673,-300.0984"/>
</g>
<!-- sourcefile~bd_solver_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~bd_solver_m.f90</title>
<g id="a_sourcefile~~strings_m.f90~~AfferentGraph_node14"><a xlink:href=".././sourcefile/bd_solver_m.f90.html" xlink:title="bd_solver_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="698,-242.4814 608,-242.4814 608,-218.4814 698,-218.4814 698,-242.4814"/>
<text text-anchor="middle" x="653" y="-228.0814" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">bd_solver_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~setup_m.f90&#45;&gt;sourcefile~bd_solver_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~setup_m.f90&#45;&gt;sourcefile~bd_solver_m.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M745.5257,-182.6232C728.2303,-191.5691 704.4951,-203.8459 685.395,-213.7253"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="683.7136,-210.6545 676.4394,-218.3575 686.9296,-216.872 683.7136,-210.6545"/>
</g>
<!-- sourcefile~stats_m.f90&#45;&gt;sourcefile~strings_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~stats_m.f90&#45;&gt;sourcefile~strings_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M374.6979,-176.3295C315.8354,-145.1382 162.6888,-65.1873 153,-72.4814"/>
</g>
<!-- sourcefile~stats_m.f90&#45;&gt;sourcefile~control_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~stats_m.f90&#45;&gt;sourcefile~control_m.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M370.7751,-176.3852C364.1358,-172.5667 357.3857,-167.9035 352,-162.4814 329.0012,-139.3266 338.7113,-121.9182 316,-98.4814 313.0632,-95.4507 309.7008,-92.637 306.1787,-90.0665"/>
<polygon fill="#aaff00" stroke="#aaff00" points="308.0669,-87.1191 297.7952,-84.5224 304.2056,-92.9579 308.0669,-87.1191"/>
</g>
<!-- sourcefile~ia_bond_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~ia_bond_m.f90</title>
<g id="a_sourcefile~~strings_m.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/ia_bond_m.f90.html" xlink:title="ia_bond_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="194,-360.4814 112,-360.4814 112,-336.4814 194,-336.4814 194,-360.4814"/>
<text text-anchor="middle" x="153" y="-346.0814" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ia_bond_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~ia_bond_m.f90&#45;&gt;sourcefile~strings_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~ia_bond_m.f90&#45;&gt;sourcefile~strings_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M118.4962,-336.48C107.2283,-332.5608 94.5498,-328.1509 82.646,-324.0104"/>
<polygon fill="#ff0000" stroke="#ff0000" points="83.4717,-320.592 72.8769,-320.6125 81.172,-327.2035 83.4717,-320.592"/>
</g>
<!-- sourcefile~aabbtree_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~aabbtree_m.f90</title>
<g id="a_sourcefile~~strings_m.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/aabbtree_m.f90.html" xlink:title="aabbtree_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="316,-300.4814 230,-300.4814 230,-276.4814 316,-276.4814 316,-300.4814"/>
<text text-anchor="middle" x="273" y="-286.0814" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">aabbtree_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~strings_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~strings_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M229.8974,-292.1497C189.2567,-295.6084 128.4439,-300.784 86.2111,-304.3783"/>
<polygon fill="#ff0000" stroke="#ff0000" points="85.8323,-300.8978 76.1652,-305.2333 86.426,-307.8726 85.8323,-300.8978"/>
</g>
<!-- sourcefile~aabb_m.fpp -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~aabb_m.fpp</title>
<g id="a_sourcefile~~strings_m.f90~~AfferentGraph_node9"><a xlink:href=".././sourcefile/aabb_m.fpp.html" xlink:title="aabb_m.fpp">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="187,-280.4814 119,-280.4814 119,-256.4814 187,-256.4814 187,-280.4814"/>
<text text-anchor="middle" x="153" y="-266.0814" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">aabb_m.fpp</text>
</a>
</g>
</g>
<!-- sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~aabb_m.fpp -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~aabb_m.fpp</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M229.6772,-281.2609C219.0953,-279.4972 207.7615,-277.6083 197.1418,-275.8383"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="197.666,-272.3775 187.2266,-274.1858 196.5151,-279.2822 197.666,-272.3775"/>
</g>
<!-- sourcefile~aabb_m.fpp&#45;&gt;sourcefile~strings_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~aabb_m.fpp&#45;&gt;sourcefile~strings_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M118.8076,-280.3744C107.3141,-284.3721 94.3252,-288.89 82.176,-293.1158"/>
<polygon fill="#ff0000" stroke="#ff0000" points="80.9524,-289.8356 72.6573,-296.4266 83.2521,-296.4471 80.9524,-289.8356"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~strings_m.f90~~AfferentGraph_node10"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="894,-104.4814 840,-104.4814 840,-80.4814 894,-80.4814 894,-104.4814"/>
<text text-anchor="middle" x="867" y="-90.0814" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~strings_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~strings_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397.5,-72.4814C352.2953,-65.2296 359.3267,-24.2749 316,-9.4814 279.8282,2.8693 265.9975,3.3684 230,-9.4814 188.3564,-24.3466 188.6203,-46.283 153,-72.4814"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M153,-72.4814C79.1191,-125.093 50.6097,-238.5151 41.5768,-286.4159"/>
<polygon fill="#ff0000" stroke="#ff0000" points="38.1139,-285.8987 39.8082,-296.3572 45.0057,-287.1248 38.1139,-285.8987"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M839.8609,-93.0036C767.5784,-94.0326 564.5188,-94.5591 397.5,-72.4814"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~control_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~control_m.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M397.5,-72.4814C372.6077,-68.4881 344.5539,-68.1336 321.3866,-68.9311"/>
<polygon fill="#aaff00" stroke="#aaff00" points="320.9565,-65.4461 311.1149,-69.3696 321.2551,-72.4398 320.9565,-65.4461"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~setup_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~setup_m.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M851.6875,-104.6689C835.7218,-117.3762 810.5079,-137.4444 792.117,-152.0821"/>
<polygon fill="#00ff00" stroke="#00ff00" points="789.8496,-149.4134 784.205,-158.3794 794.2089,-154.8904 789.8496,-149.4134"/>
</g>
<!-- sourcefile~aabbtree_sm.fpp -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~aabbtree_sm.fpp</title>
<g id="a_sourcefile~~strings_m.f90~~AfferentGraph_node11"><a xlink:href=".././sourcefile/aabbtree_sm.fpp.html" xlink:title="aabbtree_sm.fpp">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443,-322.4814 352,-322.4814 352,-298.4814 443,-298.4814 443,-322.4814"/>
<text text-anchor="middle" x="397.5" y="-308.0814" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">aabbtree_sm.fpp</text>
</a>
</g>
</g>
<!-- sourcefile~aabbtree_sm.fpp&#45;&gt;sourcefile~aabbtree_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~aabbtree_sm.fpp&#45;&gt;sourcefile~aabbtree_m.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M351.8477,-302.4143C343.4678,-300.9335 334.655,-299.3762 326.0796,-297.8609"/>
<polygon fill="#0000ff" stroke="#0000ff" points="326.6184,-294.4019 316.1619,-296.1084 325.4003,-301.2952 326.6184,-294.4019"/>
</g>
<!-- sourcefile~interaction_m.f90&#45;&gt;sourcefile~control_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~interaction_m.f90&#45;&gt;sourcefile~control_m.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M501.4808,-275.3968C485.11,-267.2689 462.8805,-256.4433 443,-247.4814 403.0432,-229.4691 384.9032,-238.4359 352,-209.4814 315.4934,-177.3559 291.6866,-124.1047 280.4814,-94.3378"/>
<polygon fill="#aaff00" stroke="#aaff00" points="283.7441,-93.0681 277.0433,-84.8614 277.1637,-95.4555 283.7441,-93.0681"/>
</g>
<!-- sourcefile~interaction_m.f90&#45;&gt;sourcefile~stats_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~interaction_m.f90&#45;&gt;sourcefile~stats_m.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M499.6571,-275.4684C492.5717,-271.5453 485.1539,-266.8084 479,-261.4814 459.1057,-244.2603 462.8139,-231.7948 443,-214.4814 439.5145,-211.4357 435.6175,-208.5738 431.61,-205.9428"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="433.1402,-202.777 422.7776,-200.5704 429.5024,-208.7575 433.1402,-202.777"/>
</g>
<!-- sourcefile~interaction_m.f90&#45;&gt;sourcefile~ia_bond_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~interaction_m.f90&#45;&gt;sourcefile~ia_bond_m.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M497.1497,-299.4984C491.0809,-302.2881 484.7639,-305.3597 479,-308.4814 462.3046,-317.5233 461.061,-325.6253 443,-331.4814 362.6678,-357.5278 263.3534,-356.7741 204.2574,-353.136"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="204.2717,-349.6292 194.0605,-352.4547 203.8049,-356.6137 204.2717,-349.6292"/>
</g>
<!-- sourcefile~pairtab_m.fpp -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~pairtab_m.fpp</title>
<g id="a_sourcefile~~strings_m.f90~~AfferentGraph_node13"><a xlink:href=".././sourcefile/pairtab_m.fpp.html" xlink:title="pairtab_m.fpp">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-280.4814 359,-280.4814 359,-256.4814 436,-256.4814 436,-280.4814"/>
<text text-anchor="middle" x="397.5" y="-266.0814" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pairtab_m.fpp</text>
</a>
</g>
</g>
<!-- sourcefile~interaction_m.f90&#45;&gt;sourcefile~pairtab_m.fpp -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~interaction_m.f90&#45;&gt;sourcefile~pairtab_m.fpp</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M478.927,-280.5682C468.3098,-278.9922 457,-277.3134 446.2929,-275.724"/>
<polygon fill="#00ffff" stroke="#00ffff" points="446.6598,-272.2402 436.2543,-274.2339 445.632,-279.1644 446.6598,-272.2402"/>
</g>
<!-- sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~aabbtree_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~aabbtree_m.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M358.7899,-274.6998C348.4061,-276.3679 336.9976,-278.2006 325.9847,-279.9698"/>
<polygon fill="#0000ff" stroke="#0000ff" points="325.3412,-276.5282 316.0229,-281.57 326.4515,-283.4396 325.3412,-276.5282"/>
</g>
<!-- sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~config_io_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~config_io_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M642.7933,-242.6444C628.3789,-259.2337 600.6096,-289.1026 572,-308.4814 569.8823,-309.9158 567.6508,-311.2938 565.358,-312.6098"/>
<polygon fill="#ff0000" stroke="#ff0000" points="563.5404,-309.6112 556.3226,-317.3671 566.8017,-315.8052 563.5404,-309.6112"/>
</g>
<!-- sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~brown_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~brown_m.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M639.8061,-218.1969C618.016,-198.85 572.2496,-162.0847 525.5,-148.4814"/>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M525.5,-148.4814C446.8743,-125.6026 421.4978,-129.7882 352,-86.4814 333.0608,-74.6796 334.2548,-64.3164 316,-51.4814 314.1225,-50.1613 312.1496,-48.8816 310.1235,-47.6489"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="311.4693,-44.3915 301.0329,-42.5662 308.0532,-50.5013 311.4693,-44.3915"/>
</g>
<!-- sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~control_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~control_m.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M525.5,-148.4814C470.8766,-132.5869 453.2509,-159.803 397.5,-148.4814"/>
</g>
<!-- sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~stats_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~stats_m.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M525.5,-148.4814C508.1278,-143.4264 464.6699,-159.2529 433.2037,-172.4692"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="431.6848,-169.312 423.8654,-176.461 434.4363,-175.7486 431.6848,-169.312"/>
</g>
<!-- sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~interaction_m.f90 -->
<g id="sourcefile~~strings_m.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~interaction_m.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M625.9605,-242.5696C607.2816,-250.9202 582.2241,-262.1223 561.8076,-271.2497"/>
<polygon fill="#7fff00" stroke="#7fff00" points="560.2013,-268.1339 552.5005,-275.4105 563.0582,-274.5244 560.2013,-268.1339"/>
</g>
</g>
</svg>
</div><script>var pansourcefilestrings_mf90AfferentGraph = svgPanZoom('#sourcefilestrings_mf90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/strings_m.html">strings_m</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/strings_m.f90.html#src">strings_m.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">module </span><span class="n">strings_m</span>
<a name="ln-2"></a><span class="c">!! summary: Routines for string handling</span>
<a name="ln-3"></a><span class="c">!! author:  George Benthien &amp; others</span>
<a name="ln-4"></a><span class="c">!!</span>
<a name="ln-5"></a><span class="c">!! Many of these routines were originally written by</span>
<a name="ln-6"></a><span class="c">!! [George Benthien](https://gbenthien.net/strings/str-index.html), some have</span>
<a name="ln-7"></a><span class="c">!! been written by Sarit Dutta or gathered/modified from other authors (appropriately credited).</span>
<a name="ln-8"></a><span class="c">!!</span>
<a name="ln-9"></a><span class="c">!! These routines were developed primarily to aid in the reading and manipulation</span>
<a name="ln-10"></a><span class="c">!! of input data from an ASCII text file. Accordingly, it is assumed that all</span>
<a name="ln-11"></a><span class="c">!! characters to be processed are ASCII characters.  </span>
<a name="ln-12"></a>
<a name="ln-13"></a><span class="k">use </span><span class="n">constants_m</span>
<a name="ln-14"></a>
<a name="ln-15"></a><span class="k">implicit none</span>
<a name="ln-16"></a>
<a name="ln-17"></a><span class="k">private</span> <span class="kd">::</span> <span class="n">str_from_inum</span><span class="p">,</span> <span class="n">str_from_ilnum</span><span class="p">,</span> <span class="n">str_from_dnum</span>
<a name="ln-18"></a>
<a name="ln-19"></a><span class="k">interface </span><span class="n">str_from_num</span>
<a name="ln-20"></a><span class="c">!!  Generic  interface for writing a number to a string. The calling syntax is </span>
<a name="ln-21"></a><span class="c">!!  `str_from_num(num, frmt)` where `number` is a real number or an integer,</span>
<a name="ln-22"></a><span class="c">!!  `format` is the format desired, e.g., *e15.6*, *i5*, etc.</span>
<a name="ln-23"></a>    <span class="k">module procedure </span><span class="n">str_from_inum</span>
<a name="ln-24"></a>    <span class="k">module procedure </span><span class="n">str_from_ilnum</span>
<a name="ln-25"></a>    <span class="k">module procedure </span><span class="n">str_from_dnum</span>
<a name="ln-26"></a><span class="k">end interface </span><span class="n">str_from_num</span>
<a name="ln-27"></a>
<a name="ln-28"></a><span class="k">contains</span>
<a name="ln-29"></a>
<a name="ln-30"></a><span class="c">!******************************************************************************</span>
<a name="ln-31"></a>
<a name="ln-32"></a><span class="k">pure function </span><span class="n">str_is_letter</span><span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a name="ln-33"></a>    <span class="c">!! Returns `.true.` if `str` contains only letters (*a--z* or *A--Z*) and</span>
<a name="ln-34"></a>    <span class="c">!! `.false.` otherwise.</span>
<a name="ln-35"></a>
<a name="ln-36"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-37"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-38"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ch</span>
<a name="ln-39"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-40"></a>    
<a name="ln-41"></a>    <span class="n">res</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-42"></a>
<a name="ln-43"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-44"></a>        <span class="n">ch</span> <span class="o">=</span> <span class="n">str</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span>
<a name="ln-45"></a>
<a name="ln-46"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
<a name="ln-47"></a>        <span class="k">case</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">:</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
<a name="ln-48"></a>            <span class="k">cycle</span>
<a name="ln-49"></a><span class="k">        case</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<a name="ln-50"></a>            <span class="k">cycle</span>
<a name="ln-51"></a><span class="k">        case </span><span class="n">default</span>
<a name="ln-52"></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-53"></a>            <span class="k">return</span>
<a name="ln-54"></a><span class="k">        end select</span>
<a name="ln-55"></a>
<a name="ln-56"></a><span class="k">    end do</span>
<a name="ln-57"></a><span class="k">    </span>
<a name="ln-58"></a><span class="k">    end function</span>
<a name="ln-59"></a>
<a name="ln-60"></a><span class="c">!******************************************************************************</span>
<a name="ln-61"></a>
<a name="ln-62"></a><span class="k">pure function </span><span class="n">str_is_digit</span><span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a name="ln-63"></a>    <span class="c">!! Returns `.true.` if `str` contains only digits (0,1,...,9) and </span>
<a name="ln-64"></a>    <span class="c">!!`.false.` otherwise.</span>
<a name="ln-65"></a>
<a name="ln-66"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-67"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-68"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ch</span>
<a name="ln-69"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-70"></a>
<a name="ln-71"></a>    <span class="n">res</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-72"></a>
<a name="ln-73"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-74"></a>        <span class="n">ch</span> <span class="o">=</span> <span class="n">str</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span>
<a name="ln-75"></a>
<a name="ln-76"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
<a name="ln-77"></a>        <span class="k">case</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">:</span><span class="s1">&#39;9&#39;</span><span class="p">)</span>
<a name="ln-78"></a>            <span class="k">cycle</span>
<a name="ln-79"></a><span class="k">        case </span><span class="n">default</span>
<a name="ln-80"></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-81"></a>            <span class="k">return</span>
<a name="ln-82"></a><span class="k">        end select</span>
<a name="ln-83"></a>
<a name="ln-84"></a><span class="k">    end do</span>
<a name="ln-85"></a><span class="k">    </span>
<a name="ln-86"></a><span class="k">    end function</span>
<a name="ln-87"></a>
<a name="ln-88"></a><span class="c">!*******************************************************************************</span>
<a name="ln-89"></a>
<a name="ln-90"></a><span class="k">pure function </span><span class="n">str_is_space</span><span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a name="ln-91"></a>    <span class="c">!! Returns `.true.` if `str` is non-empty and contains only whitespace</span>
<a name="ln-92"></a>    <span class="c">!! characters (tab or blankspace). Otherwise `.false.` is returned.</span>
<a name="ln-93"></a>    <span class="c">!!</span>
<a name="ln-94"></a>    <span class="c">!! *Note*: This function will return `.false.` for an empty string.</span>
<a name="ln-95"></a>
<a name="ln-96"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-97"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-98"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">lenstr</span>
<a name="ln-99"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ich</span>
<a name="ln-100"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-101"></a>
<a name="ln-102"></a>    <span class="n">lenstr</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-103"></a>
<a name="ln-104"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">lenstr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-105"></a><span class="k">        </span><span class="n">res</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-106"></a>        <span class="k">return</span>
<a name="ln-107"></a><span class="k">    end if</span>
<a name="ln-108"></a>
<a name="ln-109"></a><span class="k">    </span><span class="n">res</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-110"></a>
<a name="ln-111"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">lenstr</span>
<a name="ln-112"></a>        <span class="n">ich</span> <span class="o">=</span> <span class="nb">iachar</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">))</span>
<a name="ln-113"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">ich</span><span class="p">)</span>
<a name="ln-114"></a>        <span class="k">case</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">32</span><span class="p">)</span>
<a name="ln-115"></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-116"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-117"></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-118"></a>            <span class="k">return</span>
<a name="ln-119"></a><span class="k">        end select</span>
<a name="ln-120"></a><span class="k">    end do</span>
<a name="ln-121"></a>
<a name="ln-122"></a><span class="k">    end function</span>
<a name="ln-123"></a>
<a name="ln-124"></a><span class="c">!*******************************************************************************</span>
<a name="ln-125"></a>
<a name="ln-126"></a><span class="k">pure function </span><span class="n">str_is_comment</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">comment_str</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a name="ln-127"></a>    <span class="c">!!  Returns `.true.` if `line` is a comment, `.false.` other wise.</span>
<a name="ln-128"></a>    <span class="c">!!</span>
<a name="ln-129"></a>    <span class="c">!!  `line` is a comment if `comment_str` is its first non-blank character</span>
<a name="ln-130"></a>    <span class="c">!!  sequence. If `line` is an empty string or contains only blankspaces, the</span>
<a name="ln-131"></a>    <span class="c">!!  return value is `.false.` If `comment_str` is empty, the return value is</span>
<a name="ln-132"></a>    <span class="c">!!  `.true.`.</span>
<a name="ln-133"></a>
<a name="ln-134"></a>
<a name="ln-135"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">line</span>
<a name="ln-136"></a>        <span class="c">!!  Input string</span>
<a name="ln-137"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">comment_str</span>
<a name="ln-138"></a>        <span class="c">!!  String marking the beginning of a comment.</span>
<a name="ln-139"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-140"></a>
<a name="ln-141"></a>    <span class="n">res</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-142"></a>
<a name="ln-143"></a>    <span class="k">if</span> <span class="p">(</span> <span class="nb">index</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">line</span><span class="p">),</span><span class="n">comment_str</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-144"></a><span class="k">         </span><span class="n">res</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-145"></a>    <span class="k">end if</span>
<a name="ln-146"></a>
<a name="ln-147"></a><span class="k">    end function</span>
<a name="ln-148"></a>
<a name="ln-149"></a><span class="c">!*******************************************************************************</span>
<a name="ln-150"></a>
<a name="ln-151"></a><span class="k">pure function </span><span class="n">str_compact</span><span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ostr</span><span class="p">)</span>
<a name="ln-152"></a>    <span class="c">!! Returns a copy of `str` with multiple spaces and tabs converted to</span>
<a name="ln-153"></a>    <span class="c">!! single spaces, control characters deleted, and leading and trailing</span>
<a name="ln-154"></a>    <span class="c">!! spaces removed.</span>
<a name="ln-155"></a>    
<a name="ln-156"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">str</span>
<a name="ln-157"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ostr</span>
<a name="ln-158"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">))</span> <span class="kd">::</span> <span class="n">buf</span>
<a name="ln-159"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ch</span>
<a name="ln-160"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">lenstr</span>
<a name="ln-161"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">isp</span><span class="p">,</span> <span class="n">ich</span>
<a name="ln-162"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span>
<a name="ln-163"></a>    
<a name="ln-164"></a>    <span class="n">lenstr</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-165"></a>    <span class="n">isp</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-166"></a>    <span class="n">buf</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-167"></a>    
<a name="ln-168"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">lenstr</span>
<a name="ln-169"></a>        <span class="n">ch</span> <span class="o">=</span> <span class="n">str</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span>
<a name="ln-170"></a>        <span class="n">ich</span> <span class="o">=</span> <span class="nb">iachar</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
<a name="ln-171"></a>        
<a name="ln-172"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">ich</span><span class="p">)</span>
<a name="ln-173"></a>            <span class="k">case</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">32</span><span class="p">)</span>     <span class="c">! space or tab character</span>
<a name="ln-174"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">isp</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-175"></a><span class="k">                    </span><span class="n">k</span> <span class="o">=</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-176"></a>                    <span class="n">buf</span><span class="p">(</span><span class="n">k</span><span class="p">:</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-177"></a>                <span class="k">end if</span>
<a name="ln-178"></a><span class="k">                </span><span class="n">isp</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-179"></a>            <span class="k">case</span><span class="p">(</span><span class="mi">33</span><span class="p">:)</span>      <span class="c">! not a space, quote, or control character</span>
<a name="ln-180"></a>                <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-181"></a>                <span class="n">buf</span><span class="p">(</span><span class="n">k</span><span class="p">:</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">ch</span>
<a name="ln-182"></a>                <span class="n">isp</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-183"></a>        <span class="k">end select</span>
<a name="ln-184"></a><span class="k">    end do</span>
<a name="ln-185"></a><span class="k">    </span>
<a name="ln-186"></a><span class="k">    </span><span class="n">ostr</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">buf</span><span class="p">))</span>
<a name="ln-187"></a>    
<a name="ln-188"></a>    <span class="k">end function</span>
<a name="ln-189"></a>
<a name="ln-190"></a><span class="c">!******************************************************************************</span>
<a name="ln-191"></a>
<a name="ln-192"></a><span class="k">pure function </span><span class="n">str_remove_stcc</span><span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ostr</span><span class="p">)</span>
<a name="ln-193"></a>    <span class="c">!! Returns a copy of the string `str` with spaces, tabs, and</span>
<a name="ln-194"></a>    <span class="c">!! control characters removed.</span>
<a name="ln-195"></a>
<a name="ln-196"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">str</span>
<a name="ln-197"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ostr</span>
<a name="ln-198"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">))</span> <span class="kd">::</span> <span class="n">buf</span>
<a name="ln-199"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ch</span>
<a name="ln-200"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">lenstr</span>
<a name="ln-201"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ich</span>
<a name="ln-202"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">k</span>
<a name="ln-203"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-204"></a>    
<a name="ln-205"></a>    <span class="n">lenstr</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-206"></a>    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-207"></a>    
<a name="ln-208"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">lenstr</span>
<a name="ln-209"></a>        <span class="n">ch</span> <span class="o">=</span> <span class="n">str</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span>
<a name="ln-210"></a>        <span class="n">ich</span> <span class="o">=</span> <span class="nb">iachar</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
<a name="ln-211"></a>
<a name="ln-212"></a>        <span class="k">select case</span><span class="p">(</span><span class="n">ich</span><span class="p">)</span>    
<a name="ln-213"></a>            <span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">32</span><span class="p">)</span>  <span class="c">! space, tab, or control character</span>
<a name="ln-214"></a>                <span class="k">cycle       </span>
<a name="ln-215"></a><span class="k">            case</span><span class="p">(</span><span class="mi">33</span><span class="p">:)</span>  
<a name="ln-216"></a>                <span class="n">k</span> <span class="o">=</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-217"></a>                <span class="n">buf</span><span class="p">(</span><span class="n">k</span><span class="p">:</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">ch</span>
<a name="ln-218"></a>        <span class="k">end select</span>
<a name="ln-219"></a><span class="k">    end do</span>
<a name="ln-220"></a><span class="k">    </span>
<a name="ln-221"></a><span class="k">    </span><span class="n">ostr</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">buf</span><span class="p">))</span>
<a name="ln-222"></a>    
<a name="ln-223"></a>    <span class="k">end function</span>
<a name="ln-224"></a>
<a name="ln-225"></a><span class="c">!******************************************************************************</span>
<a name="ln-226"></a>
<a name="ln-227"></a><span class="k">pure function </span><span class="n">str_to_upper</span><span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ucstr</span><span class="p">)</span>
<a name="ln-228"></a>    <span class="c">!!  This function returns a string that is like the string `str` with all characters</span>
<a name="ln-229"></a>    <span class="c">!!  that are not between a pair of quotes (&quot;...&quot; or &#39;...&#39;) converted to uppercase.</span>
<a name="ln-230"></a>    
<a name="ln-231"></a>    <span class="kt">character</span> <span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-232"></a>    <span class="kt">character</span> <span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">))</span> <span class="kd">::</span> <span class="n">ucstr</span>
<a name="ln-233"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ilen</span>
<a name="ln-234"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ioffset</span>
<a name="ln-235"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iquote</span>
<a name="ln-236"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iav</span>
<a name="ln-237"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iqc</span>
<a name="ln-238"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-239"></a>    
<a name="ln-240"></a>    <span class="n">ilen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-241"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>     
<a name="ln-242"></a>    <span class="n">iquote</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-243"></a>    <span class="n">ucstr</span> <span class="o">=</span> <span class="n">str</span>
<a name="ln-244"></a>
<a name="ln-245"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ilen</span>
<a name="ln-246"></a>        <span class="n">iav</span> <span class="o">=</span> <span class="nb">iachar</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">))</span>
<a name="ln-247"></a>
<a name="ln-248"></a>        <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">iquote</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">((</span><span class="n">iav</span><span class="o">==</span><span class="mi">34</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">iav</span><span class="o">==</span><span class="mi">39</span><span class="p">))</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-249"></a><span class="k">            </span><span class="n">iquote</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-250"></a>            <span class="n">iqc</span> <span class="o">=</span> <span class="n">iav</span>
<a name="ln-251"></a>            <span class="k">cycle</span>
<a name="ln-252"></a><span class="k">        end if</span>
<a name="ln-253"></a>
<a name="ln-254"></a><span class="k">        if</span> <span class="p">(</span> <span class="p">(</span><span class="n">iquote</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">iav</span><span class="o">==</span><span class="n">iqc</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-255"></a><span class="k">            </span><span class="n">iquote</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-256"></a>            <span class="k">cycle</span>
<a name="ln-257"></a><span class="k">        end if</span>
<a name="ln-258"></a>
<a name="ln-259"></a><span class="k">        if</span> <span class="p">(</span><span class="n">iquote</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">cycle</span>
<a name="ln-260"></a>
<a name="ln-261"></a><span class="k">        if</span> <span class="p">(</span> <span class="p">(</span><span class="n">iav</span> <span class="o">&gt;=</span> <span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">))</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">iav</span> <span class="o">&lt;=</span> <span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">))</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-262"></a><span class="k">            </span><span class="n">ucstr</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="nb">achar</span><span class="p">(</span><span class="n">iav</span><span class="o">+</span><span class="n">ioffset</span><span class="p">)</span>
<a name="ln-263"></a>        <span class="k">end if</span>
<a name="ln-264"></a><span class="k">    end do</span>
<a name="ln-265"></a><span class="k">    </span>
<a name="ln-266"></a><span class="k">    end function</span>
<a name="ln-267"></a>
<a name="ln-268"></a><span class="c">!**********************************************************************</span>
<a name="ln-269"></a>
<a name="ln-270"></a><span class="k">pure function </span><span class="n">str_to_lower</span><span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">lcstr</span><span class="p">)</span>
<a name="ln-271"></a>    <span class="c">!!  This function returns a string that is like the string `str` with all characters</span>
<a name="ln-272"></a>    <span class="c">!!  that are not between a pair of quotes (&quot;...&quot; or &#39;...&#39;) converted to lowercase.</span>
<a name="ln-273"></a>
<a name="ln-274"></a>    <span class="kt">character</span> <span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="kd">::</span> <span class="n">str</span>
<a name="ln-275"></a>    <span class="kt">character</span> <span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">))</span>     <span class="kd">::</span> <span class="n">lcstr</span>
<a name="ln-276"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ilen</span>
<a name="ln-277"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ioffset</span>
<a name="ln-278"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iquote</span>
<a name="ln-279"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iav</span>
<a name="ln-280"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iqc</span>
<a name="ln-281"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-282"></a>    
<a name="ln-283"></a>    <span class="n">ilen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-284"></a>    <span class="n">ioffset</span> <span class="o">=</span> <span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span><span class="o">-</span><span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<a name="ln-285"></a>    <span class="n">iquote</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-286"></a>    <span class="n">lcstr</span> <span class="o">=</span> <span class="n">str</span>
<a name="ln-287"></a>    
<a name="ln-288"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ilen</span>
<a name="ln-289"></a>        <span class="n">iav</span> <span class="o">=</span> <span class="nb">iachar</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">))</span>
<a name="ln-290"></a>
<a name="ln-291"></a>        <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">iquote</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">((</span><span class="n">iav</span><span class="o">==</span><span class="mi">34</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">iav</span><span class="o">==</span><span class="mi">39</span><span class="p">))</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-292"></a><span class="k">            </span><span class="n">iquote</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-293"></a>            <span class="n">iqc</span> <span class="o">=</span> <span class="n">iav</span>
<a name="ln-294"></a>            <span class="k">cycle</span>
<a name="ln-295"></a><span class="k">        end if</span>
<a name="ln-296"></a>
<a name="ln-297"></a><span class="k">        if</span> <span class="p">(</span> <span class="p">(</span><span class="n">iquote</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">iav</span><span class="o">==</span><span class="n">iqc</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-298"></a><span class="k">            </span><span class="n">iquote</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-299"></a>            <span class="k">cycle</span>
<a name="ln-300"></a><span class="k">        end if</span>
<a name="ln-301"></a>
<a name="ln-302"></a><span class="k">        if</span> <span class="p">(</span><span class="n">iquote</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">cycle</span>
<a name="ln-303"></a>
<a name="ln-304"></a><span class="k">        if</span> <span class="p">(</span> <span class="p">(</span><span class="n">iav</span> <span class="o">&gt;=</span> <span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">))</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">iav</span> <span class="o">&lt;=</span> <span class="nb">iachar</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">))</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-305"></a><span class="k">            </span><span class="n">lcstr</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="nb">achar</span><span class="p">(</span><span class="n">iav</span><span class="o">-</span><span class="n">ioffset</span><span class="p">)</span>
<a name="ln-306"></a>        <span class="k">end if</span>
<a name="ln-307"></a><span class="k">    end do</span>
<a name="ln-308"></a><span class="k">    </span>
<a name="ln-309"></a><span class="k">    end function</span>
<a name="ln-310"></a>
<a name="ln-311"></a><span class="c">!******************************************************************************</span>
<a name="ln-312"></a>
<a name="ln-313"></a><span class="k">subroutine </span><span class="n">str_shift</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<a name="ln-314"></a>    <span class="c">!! Shifts characters in `str` by `n` positions (positive values</span>
<a name="ln-315"></a>    <span class="c">!! denote a right shift and negative values denote a left shift). Characters</span>
<a name="ln-316"></a>    <span class="c">!! that are shifted off the end are lost. Positions opened up by the shift </span>
<a name="ln-317"></a>    <span class="c">!! are replaced by spaces.</span>
<a name="ln-318"></a>
<a name="ln-319"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span><span class="kd">::</span> <span class="n">str</span>
<a name="ln-320"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">n</span>
<a name="ln-321"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">lenstr</span>
<a name="ln-322"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">nabs</span>
<a name="ln-323"></a>
<a name="ln-324"></a>    <span class="n">lenstr</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-325"></a>    <span class="n">nabs</span> <span class="o">=</span> <span class="nb">iabs</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a name="ln-326"></a>
<a name="ln-327"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">nabs</span> <span class="o">&gt;=</span> <span class="n">lenstr</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-328"></a><span class="k">        </span><span class="n">str</span> <span class="o">=</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">lenstr</span><span class="p">)</span>
<a name="ln-329"></a>        <span class="k">return</span>
<a name="ln-330"></a><span class="k">    end if</span>
<a name="ln-331"></a>
<a name="ln-332"></a><span class="k">    if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">str</span> <span class="o">=</span> <span class="n">str</span><span class="p">(</span><span class="n">nabs</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span><span class="o">//</span><span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">nabs</span><span class="p">)</span>  <span class="c">! shift left</span>
<a name="ln-333"></a>
<a name="ln-334"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">str</span> <span class="o">=</span> <span class="nb">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">nabs</span><span class="p">)</span><span class="o">//</span><span class="n">str</span><span class="p">(:</span><span class="n">lenstr</span><span class="o">-</span><span class="n">nabs</span><span class="p">)</span>  <span class="c">! shift right </span>
<a name="ln-335"></a>    
<a name="ln-336"></a>    <span class="k">end subroutine</span>
<a name="ln-337"></a>
<a name="ln-338"></a><span class="c">!******************************************************************************</span>
<a name="ln-339"></a>
<a name="ln-340"></a><span class="k">subroutine </span><span class="n">str_insert</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">substr</span><span class="p">,</span> <span class="nb">loc</span><span class="p">)</span>
<a name="ln-341"></a>    <span class="c">!! Inserts the string `substr` into the string `str` at position `loc`. </span>
<a name="ln-342"></a>    <span class="c">!! Characters in `str` starting at position `loc` are shifted right to</span>
<a name="ln-343"></a>    <span class="c">!! make room for the inserted string. Trailing spaces of `substr` are </span>
<a name="ln-344"></a>    <span class="c">!! removed prior to insertion.</span>
<a name="ln-345"></a>    
<a name="ln-346"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-347"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">substr</span>
<a name="ln-348"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">loc</span>
<a name="ln-349"></a><span class="nb">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">))</span>  <span class="kd">::</span><span class="n">tempstr</span>
<a name="ln-350"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">len_substr</span>
<a name="ln-351"></a>    
<a name="ln-352"></a>    <span class="n">len_substr</span> <span class="o">=</span> <span class="nb">len_trim</span><span class="p">(</span><span class="n">substr</span><span class="p">)</span>
<a name="ln-353"></a>    <span class="n">tempstr</span> <span class="o">=</span> <span class="n">str</span><span class="p">(</span><span class="nb">loc</span><span class="p">:)</span>
<a name="ln-354"></a>
<a name="ln-355"></a>    <span class="k">call </span><span class="n">str_shift</span><span class="p">(</span><span class="n">tempstr</span><span class="p">,</span> <span class="n">len_substr</span><span class="p">)</span>
<a name="ln-356"></a>
<a name="ln-357"></a>    <span class="n">tempstr</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">len_substr</span><span class="p">)</span> <span class="o">=</span> <span class="n">substr</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">len_substr</span><span class="p">)</span>
<a name="ln-358"></a>    <span class="n">str</span><span class="p">(</span><span class="nb">loc</span><span class="p">:)</span> <span class="o">=</span> <span class="n">tempstr</span>
<a name="ln-359"></a>    
<a name="ln-360"></a>    <span class="k">end subroutine</span>
<a name="ln-361"></a>
<a name="ln-362"></a><span class="c">!******************************************************************************</span>
<a name="ln-363"></a>
<a name="ln-364"></a><span class="k">subroutine </span><span class="n">str_del</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">substr</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<a name="ln-365"></a>    <span class="c">!! Deletes first `n` occurrences of substring `substr` from string `str` and</span>
<a name="ln-366"></a>    <span class="c">!! shifts characters left to fill hole. If `n &lt; 0`, all occurances are</span>
<a name="ln-367"></a>    <span class="c">!! deleted.  If `n` is not explicitly provided, it defaults to removing the</span>
<a name="ln-368"></a>    <span class="c">!! first occurrence. Trailing spaces or blanks are not considered part of</span>
<a name="ln-369"></a>    <span class="c">!! `substr`.</span>
<a name="ln-370"></a>    
<a name="ln-371"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-372"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">substr</span>
<a name="ln-373"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">optional</span><span class="p">,</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">n</span>
<a name="ln-374"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n_</span>
<a name="ln-375"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">lensubstr</span>
<a name="ln-376"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ipos</span>
<a name="ln-377"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">cntr</span>
<a name="ln-378"></a>    
<a name="ln-379"></a>    <span class="n">n_</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-380"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="n">n_</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-381"></a>
<a name="ln-382"></a>    <span class="n">lensubstr</span> <span class="o">=</span> <span class="nb">len_trim</span><span class="p">(</span><span class="n">substr</span><span class="p">)</span>
<a name="ln-383"></a>    <span class="n">cntr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-384"></a>    
<a name="ln-385"></a>    <span class="k">do</span>
<a name="ln-386"></a><span class="k">        if</span> <span class="p">((</span><span class="n">n_</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">cntr</span> <span class="o">&gt;</span> <span class="n">n_</span><span class="p">))</span> <span class="k">exit</span>
<a name="ln-387"></a>
<a name="ln-388"></a><span class="k">        </span><span class="n">ipos</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="n">substr</span><span class="p">)</span>
<a name="ln-389"></a>
<a name="ln-390"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ipos</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-391"></a>
<a name="ln-392"></a><span class="k">        </span><span class="n">str</span> <span class="o">=</span> <span class="n">str</span><span class="p">(:</span><span class="n">ipos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">ipos</span><span class="o">+</span><span class="n">lensubstr</span><span class="p">:)</span>
<a name="ln-393"></a>        <span class="n">cntr</span> <span class="o">=</span> <span class="n">cntr</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-394"></a>    <span class="k">end do   </span>
<a name="ln-395"></a>
<a name="ln-396"></a><span class="k">    end subroutine</span>
<a name="ln-397"></a>
<a name="ln-398"></a><span class="c">!**********************************************************************</span>
<a name="ln-399"></a>
<a name="ln-400"></a><span class="k">subroutine </span><span class="n">str_strip_comment</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">comment_str</span><span class="p">)</span>
<a name="ln-401"></a>    <span class="c">!!  Strips trailing comment from a string.</span>
<a name="ln-402"></a>    <span class="c">!!</span>
<a name="ln-403"></a>    <span class="c">!!  The comment is assumed to begin with the sequence of characters in</span>
<a name="ln-404"></a>    <span class="c">!!  `comment_str`. If the sequence `comment_str` is not found within `str`,</span>
<a name="ln-405"></a>    <span class="c">!!  no changes are made.</span>
<a name="ln-406"></a>
<a name="ln-407"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-408"></a>    <span class="c">!!  Input string</span>
<a name="ln-409"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">comment_str</span>
<a name="ln-410"></a>    <span class="c">!!  String indicating beginning of a comment.</span>
<a name="ln-411"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ipos</span>
<a name="ln-412"></a>
<a name="ln-413"></a>    <span class="n">ipos</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">str</span><span class="p">),</span><span class="n">comment_str</span><span class="p">)</span>
<a name="ln-414"></a>
<a name="ln-415"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">ipos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-416"></a><span class="k">        </span><span class="n">str</span> <span class="o">=</span> <span class="n">str</span><span class="p">(</span><span class="mi">1</span><span class="p">:(</span><span class="n">ipos</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-417"></a>    <span class="k">end if</span>
<a name="ln-418"></a>
<a name="ln-419"></a><span class="k">    end subroutine</span>
<a name="ln-420"></a>
<a name="ln-421"></a><span class="c">!**********************************************************************</span>
<a name="ln-422"></a>
<a name="ln-423"></a><span class="k">subroutine </span><span class="n">str_get_keyval</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">)</span>
<a name="ln-424"></a>    <span class="c">!! Split a string `str` into two strings, `key` and `val` based on space</span>
<a name="ln-425"></a>    <span class="c">!! delimiter.</span>
<a name="ln-426"></a>    <span class="c">!!</span>
<a name="ln-427"></a>    <span class="c">!! A non-empty non-comment string should be passed to this subroutine.</span>
<a name="ln-428"></a>    <span class="c">!! Keys can have corresponding empty values, but keys must always be present</span>
<a name="ln-429"></a>
<a name="ln-430"></a>    <span class="kt">character</span> <span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-431"></a>    <span class="kt">character</span> <span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">key</span>
<a name="ln-432"></a>    <span class="kt">character</span> <span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">intent</span> <span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">val</span>
<a name="ln-433"></a>    <span class="kt">character</span> <span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span> <span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">delimiter</span>
<a name="ln-434"></a>    <span class="kt">character</span> <span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">delimiter_</span>
<a name="ln-435"></a>    <span class="kt">character</span> <span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">str_just</span>
<a name="ln-436"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">m</span>
<a name="ln-437"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span>
<a name="ln-438"></a>    
<a name="ln-439"></a>    <span class="c">!blankspace is represented as the integer 32 in ascii chart.</span>
<a name="ln-440"></a>    <span class="n">delimiter_</span> <span class="o">=</span> <span class="nb">achar</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<a name="ln-441"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">delimiter</span><span class="p">))</span> <span class="n">delimiter_</span> <span class="o">=</span> <span class="n">delimiter</span>
<a name="ln-442"></a>
<a name="ln-443"></a>    <span class="n">str_just</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">str</span><span class="p">))</span>
<a name="ln-444"></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">str_just</span><span class="p">)</span>
<a name="ln-445"></a>
<a name="ln-446"></a>    <span class="n">m</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">str_just</span><span class="p">,</span> <span class="n">delimiter_</span><span class="p">)</span>
<a name="ln-447"></a>
<a name="ln-448"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-449"></a><span class="k">        </span><span class="n">key</span> <span class="o">=</span> <span class="n">str_just</span>
<a name="ln-450"></a>        <span class="n">val</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-451"></a>    <span class="k">else</span>
<a name="ln-452"></a><span class="k">        </span><span class="n">key</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">str_just</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-453"></a>        <span class="n">val</span>  <span class="o">=</span> <span class="n">str_just</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="nb">len_trim</span><span class="p">(</span><span class="n">delimiter_</span><span class="p">):</span><span class="n">n</span><span class="p">)</span>
<a name="ln-454"></a>    <span class="k">end if</span>
<a name="ln-455"></a>
<a name="ln-456"></a><span class="k">    </span><span class="n">val</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
<a name="ln-457"></a>
<a name="ln-458"></a>    <span class="k">end subroutine</span>
<a name="ln-459"></a>
<a name="ln-460"></a><span class="c">!******************************************************************************</span>
<a name="ln-461"></a>
<a name="ln-462"></a><span class="k">subroutine </span><span class="n">str_match</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">ipos</span><span class="p">,</span> <span class="n">imatch</span><span class="p">)</span>
<a name="ln-463"></a>    <span class="c">!! This routine finds the delimiter in string `str` that matches the delimiter</span>
<a name="ln-464"></a>    <span class="c">!! in position `ipos` of `str`. The argument `imatch` contains the position of</span>
<a name="ln-465"></a>    <span class="c">!! the matching delimiter. Allowable delimiters are (), [], {}, &lt;&gt;.</span>
<a name="ln-466"></a>    
<a name="ln-467"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-468"></a>    <span class="kt">integer</span><span class="p">,</span>          <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ipos</span>
<a name="ln-469"></a>    <span class="kt">integer</span><span class="p">,</span>         <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">imatch</span>
<a name="ln-470"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">delim1</span>
<a name="ln-471"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">delim2</span>
<a name="ln-472"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ch</span>
<a name="ln-473"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">lenstr</span>
<a name="ln-474"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">istart</span>
<a name="ln-475"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iend</span>
<a name="ln-476"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">inc</span>
<a name="ln-477"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">idelim2</span>
<a name="ln-478"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">isum</span>
<a name="ln-479"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-480"></a>    
<a name="ln-481"></a>    <span class="n">lenstr</span> <span class="o">=</span> <span class="nb">len_trim</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-482"></a>
<a name="ln-483"></a>    <span class="n">delim1</span> <span class="o">=</span> <span class="n">str</span><span class="p">(</span><span class="n">ipos</span><span class="p">:</span><span class="n">ipos</span><span class="p">)</span>
<a name="ln-484"></a>
<a name="ln-485"></a>    <span class="k">select case</span><span class="p">(</span><span class="n">delim1</span><span class="p">)</span>
<a name="ln-486"></a>        <span class="k">case</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">)</span>
<a name="ln-487"></a>            <span class="n">idelim2</span><span class="o">=</span><span class="nb">iachar</span><span class="p">(</span><span class="n">delim1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-488"></a>            <span class="n">istart</span><span class="o">=</span><span class="n">ipos</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-489"></a>            <span class="n">iend</span><span class="o">=</span><span class="n">lenstr</span>
<a name="ln-490"></a>            <span class="n">inc</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-491"></a>        <span class="k">case</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
<a name="ln-492"></a>            <span class="n">idelim2</span><span class="o">=</span><span class="nb">iachar</span><span class="p">(</span><span class="n">delim1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-493"></a>            <span class="n">istart</span><span class="o">=</span><span class="n">ipos</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-494"></a>            <span class="n">iend</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-495"></a>            <span class="n">inc</span><span class="o">=-</span><span class="mi">1</span>
<a name="ln-496"></a>        <span class="k">case</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">,</span><span class="s1">&#39;{&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;&#39;</span><span class="p">)</span>
<a name="ln-497"></a>            <span class="n">idelim2</span><span class="o">=</span><span class="nb">iachar</span><span class="p">(</span><span class="n">delim1</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span>
<a name="ln-498"></a>            <span class="n">istart</span><span class="o">=</span><span class="n">ipos</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-499"></a>            <span class="n">iend</span><span class="o">=</span><span class="n">lenstr</span>
<a name="ln-500"></a>            <span class="n">inc</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-501"></a>        <span class="k">case</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">,</span><span class="s1">&#39;}&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;&#39;</span><span class="p">)</span>
<a name="ln-502"></a>            <span class="n">idelim2</span><span class="o">=</span><span class="nb">iachar</span><span class="p">(</span><span class="n">delim1</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span>
<a name="ln-503"></a>            <span class="n">istart</span><span class="o">=</span><span class="n">ipos</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-504"></a>            <span class="n">iend</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-505"></a>            <span class="n">inc</span><span class="o">=-</span><span class="mi">1</span>
<a name="ln-506"></a>        <span class="k">case </span><span class="n">default</span>
<a name="ln-507"></a>            <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">delim1</span><span class="p">,</span><span class="s1">&#39; is not a valid delimiter&#39;</span>
<a name="ln-508"></a>            <span class="k">return</span>
<a name="ln-509"></a><span class="k">    end select</span>
<a name="ln-510"></a>
<a name="ln-511"></a><span class="k">    if</span> <span class="p">(</span><span class="n">istart</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">istart</span> <span class="o">&gt;</span> <span class="n">lenstr</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-512"></a><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">delim1</span><span class="p">,</span><span class="s1">&#39; has no matching delimiter&#39;</span>
<a name="ln-513"></a>        <span class="k">return</span>
<a name="ln-514"></a><span class="k">    end if</span>
<a name="ln-515"></a><span class="k">    </span><span class="n">delim2</span><span class="o">=</span><span class="nb">achar</span><span class="p">(</span><span class="n">idelim2</span><span class="p">)</span> <span class="c">! matching delimiter</span>
<a name="ln-516"></a>    
<a name="ln-517"></a>    <span class="n">isum</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-518"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">istart</span><span class="p">,</span> <span class="n">iend</span><span class="p">,</span> <span class="n">inc</span>
<a name="ln-519"></a>        <span class="n">ch</span><span class="o">=</span><span class="n">str</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span>
<a name="ln-520"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ch</span> <span class="o">/=</span> <span class="n">delim1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">ch</span> <span class="o">/=</span> <span class="n">delim2</span><span class="p">)</span> <span class="k">cycle</span>
<a name="ln-521"></a><span class="k">        if</span> <span class="p">(</span><span class="n">ch</span> <span class="o">==</span> <span class="n">delim1</span><span class="p">)</span> <span class="n">isum</span> <span class="o">=</span> <span class="n">isum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-522"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ch</span> <span class="o">==</span> <span class="n">delim2</span><span class="p">)</span> <span class="n">isum</span> <span class="o">=</span> <span class="n">isum</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-523"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">isum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-524"></a><span class="k">    end do</span>
<a name="ln-525"></a>
<a name="ln-526"></a><span class="k">    if</span><span class="p">(</span><span class="n">isum</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-527"></a><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">delim1</span><span class="p">,</span><span class="s1">&#39; has no matching delimiter&#39;</span>
<a name="ln-528"></a>        <span class="k">return</span>
<a name="ln-529"></a><span class="k">    end if   </span>
<a name="ln-530"></a>
<a name="ln-531"></a><span class="k">    </span><span class="n">imatch</span> <span class="o">=</span> <span class="n">i</span>
<a name="ln-532"></a>    
<a name="ln-533"></a>    <span class="k">end subroutine</span>
<a name="ln-534"></a>
<a name="ln-535"></a><span class="c">!**********************************************************************</span>
<a name="ln-536"></a>
<a name="ln-537"></a><span class="k">pure function </span><span class="n">str_from_inum</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">frmt</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-538"></a>
<a name="ln-539"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">num</span>
<a name="ln-540"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-541"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">frmt</span>
<a name="ln-542"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">frmt_</span>
<a name="ln-543"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span> <span class="kd">::</span> <span class="n">buf</span>
<a name="ln-544"></a>
<a name="ln-545"></a>    <span class="n">frmt_</span> <span class="o">=</span> <span class="s1">&#39;(i0)&#39;</span>
<a name="ln-546"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">frmt</span><span class="p">))</span> <span class="n">frmt_</span> <span class="o">=</span> <span class="n">frmt</span>
<a name="ln-547"></a>
<a name="ln-548"></a>    <span class="k">write</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">frmt_</span><span class="p">)</span> <span class="n">num</span>
<a name="ln-549"></a>
<a name="ln-550"></a>    <span class="n">str</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">buf</span><span class="p">))</span>
<a name="ln-551"></a>
<a name="ln-552"></a>    <span class="k">end function</span>
<a name="ln-553"></a>
<a name="ln-554"></a><span class="c">!**********************************************************************</span>
<a name="ln-555"></a>
<a name="ln-556"></a><span class="k">pure function </span><span class="n">str_from_ilnum</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">frmt</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-557"></a>
<a name="ln-558"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ip_long</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">num</span>
<a name="ln-559"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-560"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">frmt</span>
<a name="ln-561"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">frmt_</span>
<a name="ln-562"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span> <span class="kd">::</span> <span class="n">buf</span>
<a name="ln-563"></a>
<a name="ln-564"></a>    <span class="n">frmt_</span> <span class="o">=</span> <span class="s1">&#39;(i0)&#39;</span>
<a name="ln-565"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">frmt</span><span class="p">))</span> <span class="n">frmt_</span> <span class="o">=</span> <span class="n">frmt</span>
<a name="ln-566"></a>
<a name="ln-567"></a>    <span class="k">write</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">frmt_</span><span class="p">)</span> <span class="n">num</span>
<a name="ln-568"></a>
<a name="ln-569"></a>    <span class="n">str</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">buf</span><span class="p">))</span>
<a name="ln-570"></a>
<a name="ln-571"></a>    <span class="k">end function</span>
<a name="ln-572"></a>
<a name="ln-573"></a><span class="c">!**********************************************************************</span>
<a name="ln-574"></a>
<a name="ln-575"></a><span class="k">pure function </span><span class="n">str_from_dnum</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">frmt</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-576"></a>
<a name="ln-577"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">num</span>
<a name="ln-578"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-579"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">frmt</span>
<a name="ln-580"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">frmt_</span>
<a name="ln-581"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span> <span class="kd">::</span> <span class="n">buf</span>
<a name="ln-582"></a>
<a name="ln-583"></a>    <span class="n">frmt_</span> <span class="o">=</span> <span class="s1">&#39;(g0.15)&#39;</span>
<a name="ln-584"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">frmt</span><span class="p">))</span> <span class="n">frmt_</span> <span class="o">=</span> <span class="n">frmt</span>
<a name="ln-585"></a>
<a name="ln-586"></a>    <span class="k">write</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">frmt_</span><span class="p">)</span> <span class="n">num</span>
<a name="ln-587"></a>
<a name="ln-588"></a>    <span class="n">str</span> <span class="o">=</span> <span class="n">str_trimzero</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
<a name="ln-589"></a>
<a name="ln-590"></a>    <span class="k">end function</span>
<a name="ln-591"></a>
<a name="ln-592"></a><span class="c">!******************************************************************************</span>
<a name="ln-593"></a>
<a name="ln-594"></a><span class="k">subroutine </span><span class="n">str_compact_rlstr</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-595"></a>    <span class="c">!! author: Izaak Beekman</span>
<a name="ln-596"></a>    <span class="c">!! date: 02/24/2015</span>
<a name="ln-597"></a>    <span class="c">!!</span>
<a name="ln-598"></a>    <span class="c">!! Compact a string representing a real number, so that the same value is</span>
<a name="ln-599"></a>    <span class="c">!! displayed with fewer characters.</span>
<a name="ln-600"></a>
<a name="ln-601"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-602"></a>        <span class="c">!! string representation of a real number.</span>
<a name="ln-603"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">))</span> <span class="kd">::</span> <span class="n">significand</span>
<a name="ln-604"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">))</span> <span class="kd">::</span> <span class="n">expnt</span>
<a name="ln-605"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">separator</span>
<a name="ln-606"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">exp_start</span>
<a name="ln-607"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">decimal_pos</span>
<a name="ln-608"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">sig_trim</span>
<a name="ln-609"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">exp_trim</span>
<a name="ln-610"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>  <span class="c">!! counter</span>
<a name="ln-611"></a>
<a name="ln-612"></a>    <span class="n">str</span> <span class="o">=</span> <span class="nb">adjustl</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-613"></a>    <span class="n">exp_start</span> <span class="o">=</span> <span class="nb">scan</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="s1">&#39;eEdD&#39;</span><span class="p">)</span>
<a name="ln-614"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">exp_start</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">exp_start</span> <span class="o">=</span> <span class="nb">scan</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="s1">&#39;-+&#39;</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-615"></a>    <span class="n">decimal_pos</span> <span class="o">=</span> <span class="nb">scan</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-616"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">exp_start</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">separator</span> <span class="o">=</span> <span class="n">str</span><span class="p">(</span><span class="n">exp_start</span><span class="p">:</span><span class="n">exp_start</span><span class="p">)</span>
<a name="ln-617"></a>
<a name="ln-618"></a>    <span class="k">if</span> <span class="p">(</span> <span class="n">exp_start</span> <span class="o">&lt;</span> <span class="n">decimal_pos</span> <span class="p">)</span> <span class="k">then</span> <span class="c">!possibly signed, exponent-less float</span>
<a name="ln-619"></a>        <span class="n">significand</span> <span class="o">=</span> <span class="n">str</span>
<a name="ln-620"></a>        <span class="n">sig_trim</span> <span class="o">=</span> <span class="nb">len_trim</span><span class="p">(</span><span class="n">significand</span><span class="p">)</span>
<a name="ln-621"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="nb">len_trim</span><span class="p">(</span><span class="n">significand</span><span class="p">),</span><span class="n">decimal_pos</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span> <span class="c">!look from right to left at 0s</span>
<a name="ln-622"></a>                                                       <span class="c">!but save one after the decimal place</span>
<a name="ln-623"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">significand</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-624"></a><span class="k">                </span><span class="n">sig_trim</span> <span class="o">=</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-625"></a>            <span class="k">else</span>
<a name="ln-626"></a><span class="k">                exit</span>
<a name="ln-627"></a><span class="k">            end if</span>
<a name="ln-628"></a><span class="k">        end do</span>
<a name="ln-629"></a><span class="k">        </span><span class="n">str</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">significand</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">sig_trim</span><span class="p">))</span>
<a name="ln-630"></a>
<a name="ln-631"></a>    <span class="k">else if</span> <span class="p">(</span><span class="n">exp_start</span> <span class="o">&gt;</span> <span class="n">decimal_pos</span><span class="p">)</span> <span class="k">then</span> <span class="c">!float has exponent</span>
<a name="ln-632"></a>        <span class="n">significand</span> <span class="o">=</span> <span class="n">str</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">exp_start</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-633"></a>        <span class="n">sig_trim</span> <span class="o">=</span> <span class="nb">len_trim</span><span class="p">(</span><span class="n">significand</span><span class="p">)</span>
<a name="ln-634"></a>
<a name="ln-635"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="nb">len_trim</span><span class="p">(</span><span class="n">significand</span><span class="p">),</span><span class="n">decimal_pos</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span> <span class="c">!look from right to left at 0s</span>
<a name="ln-636"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">significand</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-637"></a><span class="k">                </span><span class="n">sig_trim</span> <span class="o">=</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-638"></a>            <span class="k">else</span>
<a name="ln-639"></a><span class="k">                exit</span>
<a name="ln-640"></a><span class="k">            end if</span>
<a name="ln-641"></a><span class="k">        end do</span>
<a name="ln-642"></a>
<a name="ln-643"></a><span class="k">        </span><span class="n">expnt</span> <span class="o">=</span> <span class="nb">adjustl</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">exp_start</span><span class="o">+</span><span class="mi">1</span><span class="p">:))</span>
<a name="ln-644"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">expnt</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">expnt</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-645"></a><span class="k">            </span><span class="n">separator</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">separator</span><span class="p">))</span><span class="o">//</span><span class="n">expnt</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-646"></a>            <span class="n">exp_start</span> <span class="o">=</span> <span class="n">exp_start</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-647"></a>            <span class="n">expnt</span>     <span class="o">=</span> <span class="nb">adjustl</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">exp_start</span><span class="o">+</span><span class="mi">1</span><span class="p">:))</span>
<a name="ln-648"></a>        <span class="k">end if</span>
<a name="ln-649"></a>
<a name="ln-650"></a><span class="k">        </span><span class="n">exp_trim</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-651"></a>
<a name="ln-652"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,(</span><span class="nb">len_trim</span><span class="p">(</span><span class="n">expnt</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c">!look at exponent leading zeros saving last</span>
<a name="ln-653"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">expnt</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-654"></a><span class="k">                </span><span class="n">exp_trim</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-655"></a>            <span class="k">else</span>
<a name="ln-656"></a><span class="k">                exit</span>
<a name="ln-657"></a><span class="k">            end if</span>
<a name="ln-658"></a><span class="k">        end do</span>
<a name="ln-659"></a><span class="k">        </span><span class="n">str</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">significand</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">sig_trim</span><span class="p">)))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-660"></a>              <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">separator</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-661"></a>              <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">expnt</span><span class="p">(</span><span class="n">exp_trim</span><span class="p">:)))</span>
<a name="ln-662"></a>
<a name="ln-663"></a>    <span class="c">!else</span>
<a name="ln-664"></a>        <span class="c">! mal-formed real, BUT this code should be unreachable</span>
<a name="ln-665"></a>    <span class="k">end if</span>
<a name="ln-666"></a>
<a name="ln-667"></a><span class="k">    end subroutine</span>
<a name="ln-668"></a>
<a name="ln-669"></a><span class="c">!*******************************************************************************</span>
<a name="ln-670"></a>
<a name="ln-671"></a><span class="k">pure function </span><span class="n">str_trimzero</span><span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a name="ln-672"></a>    <span class="c">!! Deletes nonsignificant trailing zeroes from number string str. If number</span>
<a name="ln-673"></a>    <span class="c">!! string ends in a decimal point, one trailing zero is added.</span>
<a name="ln-674"></a>
<a name="ln-675"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-676"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-677"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">))</span> <span class="kd">::</span> <span class="n">buf</span>
<a name="ln-678"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sexp</span>
<a name="ln-679"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ch</span>
<a name="ln-680"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ipos</span>
<a name="ln-681"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">lbuf</span>
<a name="ln-682"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-683"></a>
<a name="ln-684"></a>    <span class="n">buf</span> <span class="o">=</span> <span class="n">str</span>
<a name="ln-685"></a>    <span class="n">ipos</span> <span class="o">=</span> <span class="nb">scan</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="s1">&#39;eE&#39;</span><span class="p">)</span>
<a name="ln-686"></a>
<a name="ln-687"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">ipos</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-688"></a><span class="k">       </span><span class="n">sexp</span> <span class="o">=</span> <span class="n">buf</span><span class="p">(</span><span class="n">ipos</span><span class="p">:)</span>
<a name="ln-689"></a>       <span class="n">buf</span> <span class="o">=</span> <span class="n">buf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ipos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-690"></a>    <span class="n">endif</span>
<a name="ln-691"></a>
<a name="ln-692"></a>    <span class="n">lbuf</span> <span class="o">=</span> <span class="nb">len_trim</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
<a name="ln-693"></a>
<a name="ln-694"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">lbuf</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-695"></a>        <span class="n">ch</span> <span class="o">=</span> <span class="n">buf</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span>
<a name="ln-696"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ch</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span> <span class="k">cycle          </span>
<a name="ln-697"></a><span class="k">        if</span> <span class="p">(</span><span class="n">ch</span> <span class="o">==</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-698"></a><span class="k">            </span><span class="n">buf</span> <span class="o">=</span> <span class="n">buf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;0&#39;</span>
<a name="ln-699"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">ipos</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">buf</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sexp</span><span class="p">)</span>
<a name="ln-700"></a>            <span class="k">exit</span>
<a name="ln-701"></a><span class="k">        </span><span class="n">endif</span>
<a name="ln-702"></a>        <span class="n">buf</span> <span class="o">=</span> <span class="n">buf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="p">)</span>
<a name="ln-703"></a>        <span class="k">exit</span>
<a name="ln-704"></a><span class="k">    end do</span>
<a name="ln-705"></a>
<a name="ln-706"></a><span class="k">    if</span><span class="p">(</span><span class="n">ipos</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">buf</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sexp</span><span class="p">)</span>
<a name="ln-707"></a>
<a name="ln-708"></a>    <span class="n">res</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">buf</span><span class="p">))</span>
<a name="ln-709"></a>
<a name="ln-710"></a>    <span class="k">end function</span>
<a name="ln-711"></a>
<a name="ln-712"></a><span class="c">!***********************************************************************</span>
<a name="ln-713"></a>
<a name="ln-714"></a><span class="k">pure function </span><span class="n">str_to_d</span><span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a name="ln-715"></a>
<a name="ln-716"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-717"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-718"></a>
<a name="ln-719"></a>    <span class="k">read</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">res</span>
<a name="ln-720"></a>
<a name="ln-721"></a>    <span class="k">end function</span>
<a name="ln-722"></a>
<a name="ln-723"></a><span class="c">!***********************************************************************</span>
<a name="ln-724"></a>
<a name="ln-725"></a><span class="k">pure function </span><span class="n">str_to_i</span><span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a name="ln-726"></a>
<a name="ln-727"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-728"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-729"></a>
<a name="ln-730"></a>    <span class="k">read</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">res</span>
<a name="ln-731"></a>
<a name="ln-732"></a>    <span class="k">end function</span>
<a name="ln-733"></a>
<a name="ln-734"></a><span class="c">!***********************************************************************</span>
<a name="ln-735"></a>
<a name="ln-736"></a><span class="k">pure function </span><span class="n">str_strip</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">ends</span><span class="p">)</span> <span class="k">result</span> <span class="p">(</span><span class="n">ostr</span><span class="p">)</span>
<a name="ln-737"></a>    <span class="c">!! Returns a copy of string `str` with the leading and trailing characters</span>
<a name="ln-738"></a>    <span class="c">!! removed. The `chars` argument is a string specifying the set of characters to</span>
<a name="ln-739"></a>    <span class="c">!! be removed.  The `chars` argument is not a prefix or suffix; rather, all</span>
<a name="ln-740"></a>    <span class="c">!! combinations of its values are stripped. If `ends = &#39;l&#39;`, only leading</span>
<a name="ln-741"></a>    <span class="c">!! characters are removed, if `ends = &#39;r&#39;`, only trailing characters are</span>
<a name="ln-742"></a>    <span class="c">!! removed, and if `ends = &#39;b&#39;` both leading and trailing characters are</span>
<a name="ln-743"></a>    <span class="c">!! removed.</span>
<a name="ln-744"></a>
<a name="ln-745"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-746"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">chars</span>
<a name="ln-747"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ends</span>
<a name="ln-748"></a>        <span class="c">!! {&#39;l&#39;, &#39;r&#39;, &#39;b&#39;} </span>
<a name="ln-749"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ostr</span>
<a name="ln-750"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">lenstr</span>
<a name="ln-751"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ibeg</span>
<a name="ln-752"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iend</span>
<a name="ln-753"></a>
<a name="ln-754"></a>    <span class="n">lenstr</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-755"></a>
<a name="ln-756"></a>    <span class="k">select case</span> <span class="p">(</span><span class="n">ends</span><span class="p">)</span>
<a name="ln-757"></a>    <span class="k">case</span> <span class="p">(</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
<a name="ln-758"></a>        <span class="n">ibeg</span> <span class="o">=</span> <span class="nb">verify</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">chars</span><span class="p">)</span>
<a name="ln-759"></a>        <span class="n">iend</span> <span class="o">=</span> <span class="n">lenstr</span>
<a name="ln-760"></a>    <span class="k">case</span> <span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<a name="ln-761"></a>        <span class="n">ibeg</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-762"></a>        <span class="n">iend</span> <span class="o">=</span> <span class="nb">verify</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-763"></a>    <span class="k">case</span> <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<a name="ln-764"></a>        <span class="n">ibeg</span> <span class="o">=</span> <span class="nb">verify</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">chars</span><span class="p">)</span>
<a name="ln-765"></a>        <span class="n">iend</span> <span class="o">=</span> <span class="nb">verify</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-766"></a>    <span class="k">case </span><span class="n">default</span>
<a name="ln-767"></a>        <span class="n">ibeg</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-768"></a>        <span class="n">iend</span> <span class="o">=</span> <span class="n">lenstr</span>
<a name="ln-769"></a>    <span class="k">end select</span>
<a name="ln-770"></a>
<a name="ln-771"></a><span class="k">    if</span> <span class="p">((</span><span class="n">ibeg</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">iend</span><span class="o">==</span><span class="mi">0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-772"></a><span class="k">        </span><span class="n">ostr</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-773"></a>    <span class="k">else</span>
<a name="ln-774"></a><span class="k">        </span><span class="n">ostr</span> <span class="o">=</span> <span class="n">str</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">)</span>
<a name="ln-775"></a>    <span class="k">end if</span>
<a name="ln-776"></a>
<a name="ln-777"></a><span class="k">    end function</span>
<a name="ln-778"></a>
<a name="ln-779"></a><span class="c">!**********************************************************************</span>
<a name="ln-780"></a>
<a name="ln-781"></a><span class="k">subroutine </span><span class="n">str_split</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">,</span> <span class="n">before</span><span class="p">)</span>
<a name="ln-782"></a>    <span class="c">!! Routine finds the first instance of a character from `delims` in the the</span>
<a name="ln-783"></a>    <span class="c">!! string `str`. The characters before the found delimiter are output in</span>
<a name="ln-784"></a>    <span class="c">!! `before`. The characters after the found delimiter are output in `str`.</span>
<a name="ln-785"></a>    <span class="c">!! Repeated applications of this routine can be used to parse a string into its</span>
<a name="ln-786"></a>    <span class="c">!! component parts. Multiple whitespaces of `str` are compacted into a single</span>
<a name="ln-787"></a>    <span class="c">!! whitespace before splitting begins. If either `str` or `delimiter` is</span>
<a name="ln-788"></a>    <span class="c">!! empty, an empty string is retured in `before` and `str` remains</span>
<a name="ln-789"></a>    <span class="c">!! unchanged.</span>
<a name="ln-790"></a>    
<a name="ln-791"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-792"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">delimiter</span>
<a name="ln-793"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">before</span>
<a name="ln-794"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">lenstr</span>
<a name="ln-795"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">lendelim</span>
<a name="ln-796"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ipos</span>
<a name="ln-797"></a>    
<a name="ln-798"></a>    <span class="n">str</span> <span class="o">=</span> <span class="n">str_compact</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-799"></a>    <span class="n">lenstr</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-800"></a>    <span class="n">lendelim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">delimiter</span><span class="p">)</span>
<a name="ln-801"></a>
<a name="ln-802"></a>    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">lenstr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">lendelim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-803"></a>        <span class="c">! `str` or `delimiter` is empty</span>
<a name="ln-804"></a>        <span class="n">before</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-805"></a>        <span class="k">return        </span>
<a name="ln-806"></a><span class="k">    end if</span>
<a name="ln-807"></a>
<a name="ln-808"></a><span class="k">    </span><span class="n">ipos</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">)</span>
<a name="ln-809"></a>
<a name="ln-810"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">ipos</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span> 
<a name="ln-811"></a>        <span class="c">! string does not contain any delimiter</span>
<a name="ln-812"></a>        <span class="n">before</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-813"></a>        <span class="k">return</span>
<a name="ln-814"></a><span class="k">    else</span>
<a name="ln-815"></a><span class="k">        </span><span class="n">before</span> <span class="o">=</span> <span class="n">str</span><span class="p">(</span><span class="mi">1</span><span class="p">:(</span><span class="n">ipos</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-816"></a>        <span class="n">str</span> <span class="o">=</span> <span class="n">str</span><span class="p">((</span><span class="n">ipos</span><span class="o">+</span><span class="n">lendelim</span><span class="o">-</span><span class="mi">1</span><span class="p">):)</span>
<a name="ln-817"></a>    <span class="k">end if</span>
<a name="ln-818"></a><span class="k">    </span>
<a name="ln-819"></a><span class="k">    end subroutine</span>
<a name="ln-820"></a>
<a name="ln-821"></a><span class="c">!**********************************************************************</span>
<a name="ln-822"></a>
<a name="ln-823"></a><span class="k">subroutine </span><span class="n">str_append</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span>
<a name="ln-824"></a>    <span class="c">!! Appends a copy of the `source` string to the `dest` string, with </span>
<a name="ln-825"></a>    <span class="c">!! optional string `sep` in between. It is assumed that `dest` is long</span>
<a name="ln-826"></a>    <span class="c">!! enough to hold the result, otherwise an error will be generated.</span>
<a name="ln-827"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>       <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dest</span>
<a name="ln-828"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>           <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">source</span>
<a name="ln-829"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sep</span>
<a name="ln-830"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sep_</span>
<a name="ln-831"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">len_dest</span>
<a name="ln-832"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">len_source</span>
<a name="ln-833"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">len_sep_</span>
<a name="ln-834"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ipos</span>
<a name="ln-835"></a>
<a name="ln-836"></a>    <span class="n">sep_</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-837"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">sep</span><span class="p">))</span> <span class="n">sep_</span> <span class="o">=</span> <span class="n">sep</span>
<a name="ln-838"></a>
<a name="ln-839"></a>    <span class="n">len_dest</span> <span class="o">=</span> <span class="nb">len_trim</span><span class="p">(</span><span class="n">dest</span><span class="p">)</span>
<a name="ln-840"></a>    <span class="n">len_source</span> <span class="o">=</span> <span class="nb">len_trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">source</span><span class="p">))</span>
<a name="ln-841"></a>    <span class="n">len_sep_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sep_</span><span class="p">)</span>
<a name="ln-842"></a>
<a name="ln-843"></a>    <span class="n">ipos</span>  <span class="o">=</span> <span class="n">len_dest</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-844"></a>
<a name="ln-845"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">len_sep_</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-846"></a><span class="k">        </span><span class="n">dest</span><span class="p">(</span> <span class="n">ipos</span><span class="p">:(</span><span class="n">ipos</span><span class="o">+</span><span class="n">len_sep_</span><span class="p">)</span> <span class="p">)</span> <span class="o">=</span> <span class="n">sep_</span>
<a name="ln-847"></a>        <span class="n">ipos</span>  <span class="o">=</span> <span class="n">ipos</span> <span class="o">+</span> <span class="n">len_sep_</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-848"></a>    <span class="k">end if</span>
<a name="ln-849"></a>
<a name="ln-850"></a><span class="k">    </span><span class="n">dest</span><span class="p">(</span> <span class="n">ipos</span><span class="p">:(</span><span class="n">ipos</span><span class="o">+</span><span class="n">len_source</span><span class="p">)</span> <span class="p">)</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">source</span><span class="p">))</span>
<a name="ln-851"></a>
<a name="ln-852"></a>    <span class="k">end subroutine</span>
<a name="ln-853"></a>
<a name="ln-854"></a><span class="c">!**********************************************************************</span>
<a name="ln-855"></a>
<a name="ln-856"></a><span class="k">pure function </span><span class="n">str_startswith</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">finish</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a name="ln-857"></a>    <span class="c">!! Returns `.true.` if the string `str` starts with `prefix`, otherwise</span>
<a name="ln-858"></a>    <span class="c">!! returns `.false.`. With optional `start`, test beginning at that position.</span>
<a name="ln-859"></a>    <span class="c">!! With optional `finish`, stop comparing beyond that position.</span>
<a name="ln-860"></a>
<a name="ln-861"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-862"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">prefix</span>
<a name="ln-863"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">start</span>
<a name="ln-864"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">finish</span>
<a name="ln-865"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-866"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ibeg</span>
<a name="ln-867"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iend</span>
<a name="ln-868"></a>
<a name="ln-869"></a>    <span class="n">ibeg</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-870"></a>
<a name="ln-871"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">start</span><span class="p">))</span> <span class="n">ibeg</span> <span class="o">=</span> <span class="n">start</span>
<a name="ln-872"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">finish</span><span class="p">))</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">finish</span>
<a name="ln-873"></a>
<a name="ln-874"></a>    <span class="c">!Return .false. if prefix is longer than str(ibeg:iend)</span>
<a name="ln-875"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">iend</span><span class="o">-</span><span class="n">ibeg</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-876"></a><span class="k">        </span><span class="n">res</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-877"></a>        <span class="k">return</span>
<a name="ln-878"></a><span class="k">    end if</span>
<a name="ln-879"></a>
<a name="ln-880"></a><span class="k">    if</span> <span class="p">(</span><span class="nb">index</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">),</span> <span class="n">prefix</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-881"></a><span class="k">        </span><span class="n">res</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-882"></a>    <span class="k">else</span>
<a name="ln-883"></a><span class="k">        </span><span class="n">res</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-884"></a>    <span class="k">end if</span>
<a name="ln-885"></a><span class="k">    </span>
<a name="ln-886"></a><span class="k">    end function</span>
<a name="ln-887"></a>
<a name="ln-888"></a><span class="c">!**********************************************************************</span>
<a name="ln-889"></a>
<a name="ln-890"></a><span class="k">pure function </span><span class="n">str_endswith</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">suffix</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">finish</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a name="ln-891"></a>    <span class="c">!! Returns `.true.` if the string `str` ends with `suffix`, otherwise</span>
<a name="ln-892"></a>    <span class="c">!! return `.false.`. With optional `start`, test beginning at that position.</span>
<a name="ln-893"></a>    <span class="c">!! With optional `finish`, stop comparing beyond that position.</span>
<a name="ln-894"></a>
<a name="ln-895"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-896"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">suffix</span>
<a name="ln-897"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">start</span>
<a name="ln-898"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">finish</span>
<a name="ln-899"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-900"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ibeg</span>
<a name="ln-901"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iend</span>
<a name="ln-902"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iloc</span>
<a name="ln-903"></a>
<a name="ln-904"></a>    <span class="n">ibeg</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">iend</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-905"></a>
<a name="ln-906"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">start</span><span class="p">))</span> <span class="n">ibeg</span> <span class="o">=</span> <span class="n">start</span>
<a name="ln-907"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">finish</span><span class="p">))</span> <span class="n">iend</span> <span class="o">=</span> <span class="n">finish</span>
<a name="ln-908"></a>
<a name="ln-909"></a>    <span class="c">!Return .false. if suffix is longer than str(ibeg:iend)</span>
<a name="ln-910"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">suffix</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">iend</span><span class="o">-</span><span class="n">ibeg</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-911"></a><span class="k">        </span><span class="n">res</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-912"></a>        <span class="k">return</span>
<a name="ln-913"></a><span class="k">    end if</span>
<a name="ln-914"></a>
<a name="ln-915"></a>    <span class="c">! Getting last occurrance of suffix</span>
<a name="ln-916"></a>    <span class="n">iloc</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">ibeg</span><span class="p">:</span><span class="n">iend</span><span class="p">),</span> <span class="n">suffix</span><span class="p">,</span> <span class="n">back</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span> 
<a name="ln-917"></a>
<a name="ln-918"></a>    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">iloc</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">suffix</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">iend</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-919"></a><span class="k">        </span><span class="n">res</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-920"></a>    <span class="k">else</span>
<a name="ln-921"></a><span class="k">        </span><span class="n">res</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-922"></a>    <span class="k">end if</span>
<a name="ln-923"></a>
<a name="ln-924"></a><span class="k">    end function</span>
<a name="ln-925"></a>
<a name="ln-926"></a><span class="c">!******************************************************************************</span>
<a name="ln-927"></a>
<a name="ln-928"></a><span class="k">subroutine </span><span class="n">readline</span><span class="p">(</span><span class="n">nunitr</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">comment_str</span><span class="p">,</span> <span class="n">ios</span><span class="p">)</span>
<a name="ln-929"></a>    <span class="c">!!  Reads a line from unit=nunitr, ignoring blank lines</span>
<a name="ln-930"></a>    <span class="c">!!  and deleting comments</span>
<a name="ln-931"></a>
<a name="ln-932"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nunitr</span>
<a name="ln-933"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span><span class="kd">::</span> <span class="n">line</span>
<a name="ln-934"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">comment_str</span>
<a name="ln-935"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ios</span>
<a name="ln-936"></a>    
<a name="ln-937"></a>    <span class="k">do  </span>
<a name="ln-938"></a><span class="k">        read</span><span class="p">(</span><span class="n">nunitr</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">ios</span><span class="p">)</span> <span class="n">line</span>      <span class="c">! read input line</span>
<a name="ln-939"></a>
<a name="ln-940"></a>        <span class="k">if</span><span class="p">(</span><span class="n">ios</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-941"></a>
<a name="ln-942"></a><span class="k">        if</span> <span class="p">((</span><span class="nb">len_trim</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">str_is_comment</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">comment_str</span><span class="p">)))</span> <span class="k">then</span>
<a name="ln-943"></a><span class="k">            call </span><span class="n">str_strip_comment</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">comment_str</span><span class="p">)</span>
<a name="ln-944"></a>            <span class="k">exit</span>
<a name="ln-945"></a><span class="k">        end if</span>
<a name="ln-946"></a>
<a name="ln-947"></a><span class="k">    end do</span>
<a name="ln-948"></a><span class="k">    </span>
<a name="ln-949"></a><span class="k">    end subroutine</span>
<a name="ln-950"></a>
<a name="ln-951"></a><span class="c">!******************************************************************************</span>
<a name="ln-952"></a>
<a name="ln-953"></a><span class="k">end module </span><span class="n">strings_m</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> BROWNPAK was developed by Sarit Dutta</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>