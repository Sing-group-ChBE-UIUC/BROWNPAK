<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for BROWNPAK">
   
    <meta name="author" content="Sarit Dutta" >
    <link rel="icon" href="../favicon.png">

    <title>m_simbox.f90 &ndash; BROWNPAK</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">BROWNPAK <small>0.2</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>m_simbox.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 1.8% of total for source files.">110 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/m_simbox.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">m_simbox.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_simbox.html">m_simbox</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_simbox.f90.html#src">m_simbox.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_simbox.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilem_simboxf90EfferentGraph" width="364pt" height="112pt"
 viewBox="0.00 0.00 364.00 112.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_simbox.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 108)">
<title>sourcefile~~m_simbox.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-108 360,-108 360,4 -4,4"/>
<!-- sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_simbox.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~m_simbox.f90</title>
<polygon fill="none" stroke="#000000" points="356,-64 278,-64 278,-40 356,-40 356,-64"/>
<text text-anchor="middle" x="317" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_simbox.f90</text>
</g>
<!-- sourcefile~m_ran_num.f90 -->
<g id="sourcefile~~m_simbox.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~m_ran_num.f90</title>
<g id="a_sourcefile~~m_simbox.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/m_ran_num.f90.html" xlink:title="m_ran_num.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="225.5,-104 139.5,-104 139.5,-80 225.5,-80 225.5,-104"/>
<text text-anchor="middle" x="182.5" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ran_num.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_ran_num.f90 -->
<g id="sourcefile~~m_simbox.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_ran_num.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M277.7355,-63.6772C263.615,-67.8766 247.4912,-72.6718 232.5754,-77.1077"/>
<polygon fill="#ff0000" stroke="#ff0000" points="231.5686,-73.7555 222.9812,-79.961 233.5641,-80.4651 231.5686,-73.7555"/>
</g>
<!-- sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_simbox.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~m_precision.f90</title>
<g id="a_sourcefile~~m_simbox.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/m_precision.f90.html" xlink:title="m_precision.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="87,-64 0,-64 0,-40 87,-40 87,-64"/>
<text text-anchor="middle" x="43.5" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_precision.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_simbox.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M277.8141,-52C230.4561,-52 150.5244,-52 97.3872,-52"/>
<polygon fill="#ff0000" stroke="#ff0000" points="97.1346,-48.5001 87.1346,-52 97.1345,-55.5001 97.1346,-48.5001"/>
</g>
<!-- sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_simbox.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~m_constants_math.f90</title>
<g id="a_sourcefile~~m_simbox.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/m_constants_math.f90.html" xlink:title="m_constants_math.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="242,-24 123,-24 123,0 242,0 242,-24"/>
<text text-anchor="middle" x="182.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_constants_math.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_constants_math.f90 -->
<g id="sourcefile~~m_simbox.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~m_simbox.f90&#45;&gt;sourcefile~m_constants_math.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M277.7355,-40.3228C263.615,-36.1234 247.4912,-31.3282 232.5754,-26.8923"/>
<polygon fill="#ff0000" stroke="#ff0000" points="233.5641,-23.5349 222.9812,-24.039 231.5686,-30.2445 233.5641,-23.5349"/>
</g>
<!-- sourcefile~m_ran_num.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_simbox.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~m_ran_num.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M140.7954,-79.9987C126.495,-75.8835 110.3148,-71.2273 95.3125,-66.9101"/>
<polygon fill="#ff0000" stroke="#ff0000" points="96.2335,-63.5331 85.6556,-64.1311 94.2976,-70.2601 96.2335,-63.5331"/>
</g>
<!-- sourcefile~m_constants_math.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_simbox.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~m_constants_math.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M140.7954,-24.0013C126.495,-28.1165 110.3148,-32.7727 95.3125,-37.0899"/>
<polygon fill="#0000ff" stroke="#0000ff" points="94.2976,-33.7399 85.6556,-39.8689 96.2335,-40.4669 94.2976,-33.7399"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_simbox.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilem_simboxf90AfferentGraph" width="641pt" height="446pt"
 viewBox="0.00 0.00 641.00 445.52" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_simbox.f90~~AfferentGraph" class="graph" transform="scale(.7953 .7953) rotate(0) translate(4 556.2077)">
<title>sourcefile~~m_simbox.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-556.2077 802,-556.2077 802,4 -4,4"/>
<!-- sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~m_simbox.f90</title>
<polygon fill="none" stroke="#000000" points="78,-91.2809 0,-91.2809 0,-67.2809 78,-67.2809 78,-91.2809"/>
<text text-anchor="middle" x="39" y="-76.8809" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_simbox.f90</text>
</g>
<!-- sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~m_globals.f90</title>
<g id="a_sourcefile~~m_simbox.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/m_globals.f90.html" xlink:title="m_globals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="192,-111.2809 114,-111.2809 114,-87.2809 192,-87.2809 192,-111.2809"/>
<text text-anchor="middle" x="153" y="-96.8809" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_globals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_simbox.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M113.7677,-92.398C105.5277,-90.9524 96.7372,-89.4102 88.1859,-87.91"/>
<polygon fill="#ff0000" stroke="#ff0000" points="88.759,-84.4572 78.3046,-86.1764 87.5494,-91.3519 88.759,-84.4572"/>
</g>
<!-- sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~m_setup.f90</title>
<g id="a_sourcefile~~m_simbox.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/m_setup.f90.html" xlink:title="m_setup.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="698,-173.2809 628,-173.2809 628,-149.2809 698,-149.2809 698,-173.2809"/>
<text text-anchor="middle" x="663" y="-158.8809" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_setup.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_simbox.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M657.6814,-148.959C643.535,-118.1947 601.5958,-39.1978 537,-21.2809"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M537,-21.2809C425.8626,9.5453 390.104,3.6613 277.5,-21.2809"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M277.5,-21.2809C222.0535,-37.7944 210.18,-50.48 153,-59.2809"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M153,-59.2809C131.678,-62.5627 108.1897,-66.6094 88.1023,-70.2023"/>
<polygon fill="#ff0000" stroke="#ff0000" points="87.4604,-66.7615 78.2391,-71.9786 88.7011,-73.6507 87.4604,-66.7615"/>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M277.5,-21.2809C272.0279,-22.493 215.365,-58.8201 180.3953,-81.4649"/>
<polygon fill="#ff0000" stroke="#ff0000" points="178.0785,-78.7957 171.5922,-87.173 181.8869,-84.6691 178.0785,-78.7957"/>
</g>
<!-- sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~m_config_io.f90</title>
<g id="a_sourcefile~~m_simbox.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/m_config_io.f90.html" xlink:title="m_config_io.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453,-111.2809 366,-111.2809 366,-87.2809 453,-87.2809 453,-111.2809"/>
<text text-anchor="middle" x="409.5" y="-96.8809" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_config_io.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_config_io.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M537,-21.2809C492.1316,-8.8357 447.5215,-52.1583 424.8514,-79.1845"/>
<polygon fill="#0000ff" stroke="#0000ff" points="422.1201,-76.9959 418.5443,-86.969 427.559,-81.4026 422.1201,-76.9959"/>
</g>
<!-- sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~m_mpcd.f90</title>
<g id="a_sourcefile~~m_simbox.f90~~AfferentGraph_node9"><a xlink:href=".././sourcefile/m_mpcd.f90.html" xlink:title="m_mpcd.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="572,-193.2809 502,-193.2809 502,-169.2809 572,-169.2809 572,-193.2809"/>
<text text-anchor="middle" x="537" y="-178.8809" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_mpcd.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge34" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_mpcd.f90</title>
<path fill="none" stroke="#96ff00" stroke-dasharray="5,2" d="M627.902,-166.852C613.821,-169.0871 597.4095,-171.6921 582.4366,-174.0687"/>
<polygon fill="#96ff00" stroke="#96ff00" points="581.6744,-170.6458 572.3468,-175.6703 582.7719,-177.5592 581.6744,-170.6458"/>
</g>
<!-- sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~m_bd_solver.f90</title>
<g id="a_sourcefile~~m_simbox.f90~~AfferentGraph_node11"><a xlink:href=".././sourcefile/m_bd_solver.f90.html" xlink:title="m_bd_solver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="582,-113.2809 492,-113.2809 492,-89.2809 582,-89.2809 582,-113.2809"/>
<text text-anchor="middle" x="537" y="-98.8809" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_bd_solver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge37" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_bd_solver.f90</title>
<path fill="none" stroke="#00ff1e" stroke-dasharray="5,2" d="M637.502,-149.139C618.5449,-140.1118 592.465,-127.6928 571.6231,-117.7681"/>
<polygon fill="#00ff1e" stroke="#00ff1e" points="572.9935,-114.5441 562.4601,-113.4047 569.9839,-120.8641 572.9935,-114.5441"/>
</g>
<!-- sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~m_stats_io.f90</title>
<g id="a_sourcefile~~m_simbox.f90~~AfferentGraph_node12"><a xlink:href=".././sourcefile/m_stats_io.f90.html" xlink:title="m_stats_io.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="450,-153.2809 369,-153.2809 369,-129.2809 450,-129.2809 450,-153.2809"/>
<text text-anchor="middle" x="409.5" y="-138.8809" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_stats_io.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge39" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_stats_io.f90</title>
<path fill="none" stroke="#00ff78" stroke-dasharray="5,2" d="M627.7519,-158.5C584.3143,-155.0729 510.1768,-149.2238 460.5216,-145.3063"/>
<polygon fill="#00ff78" stroke="#00ff78" points="460.5615,-141.7986 450.3171,-144.5012 460.0108,-148.7769 460.5615,-141.7986"/>
</g>
<!-- sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~m_interaction.f90</title>
<g id="a_sourcefile~~m_simbox.f90~~AfferentGraph_node14"><a xlink:href=".././sourcefile/m_interaction.f90.html" xlink:title="m_interaction.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="456,-275.2809 363,-275.2809 363,-251.2809 456,-251.2809 456,-275.2809"/>
<text text-anchor="middle" x="409.5" y="-260.8809" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_interaction.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge45" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#00d1ff" stroke-dasharray="5,2" d="M655.2847,-173.4313C642.576,-192.2703 615.3001,-228.045 582,-244.2809 546.1364,-261.7666 501.2169,-266.246 466.2075,-266.4963"/>
<polygon fill="#00d1ff" stroke="#00d1ff" points="466.1621,-262.9962 456.1479,-266.4552 466.1334,-269.9961 466.1621,-262.9962"/>
</g>
<!-- sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_simbox.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_simbox.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M375.8612,-87.1923C326.819,-71.1215 232.8332,-46.1879 153,-59.2809"/>
</g>
<!-- sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M365.7359,-99.9994C340.0049,-100.0772 306.8612,-99.5823 277.5,-97.2809"/>
</g>
<!-- sourcefile~m_ia_vdw.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~m_ia_vdw.f90</title>
<g id="a_sourcefile~~m_simbox.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/m_ia_vdw.f90.html" xlink:title="m_ia_vdw.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="316,-481.2809 239,-481.2809 239,-457.2809 316,-457.2809 316,-481.2809"/>
<text text-anchor="middle" x="277.5" y="-466.8809" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_vdw.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M238.7031,-457.3605C234.6735,-454.8725 230.9733,-451.8789 228,-448.2809 186.0225,-397.4844 162.0314,-190.2458 155.1115,-121.5337"/>
<polygon fill="#ff0000" stroke="#ff0000" points="158.5766,-121.0062 154.1143,-111.3969 151.6102,-121.6916 158.5766,-121.0062"/>
</g>
<!-- sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~m_cell_list.f90</title>
<g id="a_sourcefile~~m_simbox.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/m_cell_list.f90.html" xlink:title="m_cell_list.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="317,-523.2809 238,-523.2809 238,-499.2809 317,-499.2809 317,-523.2809"/>
<text text-anchor="middle" x="277.5" y="-508.8809" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_cell_list.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M238.145,-499.1218C234.3161,-496.6831 230.8159,-493.7664 228,-490.2809 181.3127,-432.4926 160.1496,-196.0579 154.5646,-121.7448"/>
<polygon fill="#ff0000" stroke="#ff0000" points="158.045,-121.3468 153.8263,-111.6281 151.0635,-121.8563 158.045,-121.3468"/>
</g>
<!-- sourcefile~m_ia_tether.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~m_ia_tether.f90</title>
<g id="a_sourcefile~~m_simbox.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/m_ia_tether.f90.html" xlink:title="m_ia_tether.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="320,-439.2809 235,-439.2809 235,-415.2809 320,-415.2809 320,-439.2809"/>
<text text-anchor="middle" x="277.5" y="-424.8809" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_tether.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_ia_tether.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~m_ia_tether.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M238.8001,-415.2792C234.7539,-412.8051 231.0233,-409.837 228,-406.2809 190.7035,-362.4109 164.1475,-184.0975 155.7923,-121.296"/>
<polygon fill="#ff0000" stroke="#ff0000" points="159.2508,-120.7501 154.4858,-111.2873 152.3097,-121.6563 159.2508,-120.7501"/>
</g>
<!-- sourcefile~m_ia_angle.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~m_ia_angle.f90</title>
<g id="a_sourcefile~~m_simbox.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/m_ia_angle.f90.html" xlink:title="m_ia_angle.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="319.5,-397.2809 235.5,-397.2809 235.5,-373.2809 319.5,-373.2809 319.5,-397.2809"/>
<text text-anchor="middle" x="277.5" y="-382.8809" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_angle.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_ia_angle.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~m_ia_angle.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M238.9242,-373.1718C234.8566,-370.7161 231.0871,-367.7817 228,-364.2809 195.4616,-327.3822 166.773,-178.5752 156.7696,-121.6131"/>
<polygon fill="#ff0000" stroke="#ff0000" points="160.1747,-120.7633 155.0225,-111.5056 153.277,-121.9557 160.1747,-120.7633"/>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M501.9309,-185.1154C464.9894,-187.4819 406.2831,-186.3644 363,-162.2809 340.3143,-149.6581 347.8755,-131.7143 327,-116.2809 308.0512,-102.2719 300.9615,-99.4871 277.5,-97.2809"/>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_config_io.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M523.0447,-169.2494C507.4158,-156.1471 480.9906,-135.086 456,-120.2809 453.4994,-118.7994 450.8758,-117.3527 448.202,-115.9563"/>
<polygon fill="#0000ff" stroke="#0000ff" points="449.5389,-112.713 439.0227,-111.424 446.4398,-118.9896 449.5389,-112.713"/>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_cell_list.f90</title>
<path fill="none" stroke="#ff5900" stroke-dasharray="5,2" d="M503.6968,-193.3836C499.426,-195.881 495.3745,-198.8281 492,-202.2809 464.1804,-230.7461 483.6192,-255.6212 456,-284.2809 424.1369,-317.3443 391.5165,-293.2912 363,-329.2809 317.4643,-386.75 373.9421,-433.9547 327,-490.2809 326.2828,-491.1414 325.5241,-491.9674 324.7294,-492.7603"/>
<polygon fill="#ff5900" stroke="#ff5900" points="322.4467,-490.1027 316.7505,-499.036 326.7743,-495.6047 322.4467,-490.1027"/>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge41" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_stats_io.f90</title>
<path fill="none" stroke="#00ff78" stroke-dasharray="5,2" d="M501.8226,-170.2448C488.2877,-165.9986 472.5862,-161.0726 458.0131,-156.5007"/>
<polygon fill="#00ff78" stroke="#00ff78" points="458.7341,-153.0587 448.1449,-153.4048 456.6386,-159.7377 458.7341,-153.0587"/>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge43" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#00d1ff" stroke-dasharray="5,2" d="M508.9443,-193.3134C503.2283,-196.0577 497.3348,-199.1073 492,-202.2809 470.6202,-214.9995 448.0147,-231.9952 431.8836,-244.8163"/>
<polygon fill="#00d1ff" stroke="#00d1ff" points="429.6763,-242.1 424.079,-251.0956 434.0643,-247.5539 429.6763,-242.1"/>
</g>
<!-- sourcefile~m_control_io.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~m_control_io.f90</title>
<g id="a_sourcefile~~m_simbox.f90~~AfferentGraph_node10"><a xlink:href=".././sourcefile/m_control_io.f90.html" xlink:title="m_control_io.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="708,-355.2809 618,-355.2809 618,-331.2809 708,-331.2809 708,-355.2809"/>
<text text-anchor="middle" x="663" y="-340.8809" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_control_io.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_control_io.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~m_control_io.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M617.8407,-339.9454C593.7148,-339.0008 563.5891,-339.1617 537,-343.2809"/>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M277.5,-97.2809C252.7371,-95.3399 225.1221,-95.5442 202.2038,-96.359"/>
<polygon fill="#ff0000" stroke="#ff0000" points="201.8816,-92.8691 192.0314,-96.7708 202.1649,-99.8634 201.8816,-92.8691"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M502.3672,-89.1682C488.1845,-84.8097 471.4923,-80.4378 456,-78.2809 415.0615,-72.5813 404.0865,-73.7707 363,-78.2809 324.3055,-82.5285 316.3079,-100.3228 277.5,-97.2809"/>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_config_io.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M491.6893,-100.5701C482.5431,-100.4267 472.843,-100.2745 463.435,-100.1269"/>
<polygon fill="#0000ff" stroke="#0000ff" points="463.4348,-96.6266 453.3811,-99.9692 463.3249,-103.6257 463.4348,-96.6266"/>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge38" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_stats_io.f90</title>
<path fill="none" stroke="#00ff78" stroke-dasharray="5,2" d="M498.7458,-113.2822C485.8784,-117.319 471.3517,-121.8764 457.8134,-126.1237"/>
<polygon fill="#00ff78" stroke="#00ff78" points="456.6616,-122.8168 448.1679,-129.1498 458.7571,-129.4958 456.6616,-122.8168"/>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge44" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#00d1ff" stroke-dasharray="5,2" d="M527.4168,-113.4572C505.6342,-141.134 452.2198,-209.0016 425.4036,-243.074"/>
<polygon fill="#00d1ff" stroke="#00d1ff" points="422.6288,-240.9405 419.1944,-250.9633 428.1295,-245.2697 422.6288,-240.9405"/>
</g>
<!-- sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M379.1456,-129.2579C346.7582,-116.7747 297.4282,-98.8429 277.5,-97.2809"/>
</g>
<!-- sourcefile~m_ia_external.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~m_ia_external.f90</title>
<g id="a_sourcefile~~m_simbox.f90~~AfferentGraph_node13"><a xlink:href=".././sourcefile/m_ia_external.f90.html" xlink:title="m_ia_external.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="325.5,-355.2809 229.5,-355.2809 229.5,-331.2809 325.5,-331.2809 325.5,-355.2809"/>
<text text-anchor="middle" x="277.5" y="-340.8809" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_external.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_ia_external.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~m_ia_external.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M245.8806,-331.2417C239.2856,-327.565 232.8679,-322.9529 228,-317.2809 177.631,-258.5914 160.5696,-164.2969 155.2312,-121.5858"/>
<polygon fill="#ff0000" stroke="#ff0000" points="158.6835,-120.969 154.0655,-111.4335 151.7292,-121.7675 158.6835,-120.969"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M385.3858,-275.3413C348.2038,-292.0462 276.1438,-316.7128 228,-284.2809 173.0887,-247.2901 158.3659,-162.4843 154.4297,-121.8266"/>
<polygon fill="#ff0000" stroke="#ff0000" points="157.8966,-121.2823 153.5811,-111.6062 150.9206,-121.8616 157.8966,-121.2823"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_vdw.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_vdw.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M380.0611,-275.4894C373.627,-279.3734 367.4262,-284.2658 363,-290.2809 320.3143,-348.2903 373.2211,-393.0471 327,-448.2809 326.1575,-449.2876 325.2582,-450.2471 324.3109,-451.1616"/>
<polygon fill="#ff0000" stroke="#ff0000" points="322.0701,-448.4691 316.2539,-457.3248 326.3231,-454.029 322.0701,-448.4691"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_cell_list.f90</title>
<path fill="none" stroke="#ff5900" stroke-dasharray="5,2" d="M379.8636,-275.3476C373.4355,-279.2358 367.2869,-284.1657 363,-290.2809 311.1557,-364.2363 383.3566,-419.7035 327,-490.2809 326.301,-491.1563 325.5588,-491.9957 324.7789,-492.8007"/>
<polygon fill="#ff5900" stroke="#ff5900" points="322.4854,-490.1539 316.8945,-499.1535 326.8773,-495.6047 322.4854,-490.1539"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_tether.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge31" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_tether.f90</title>
<path fill="none" stroke="#ffb300" stroke-dasharray="5,2" d="M380.8679,-275.448C374.2557,-279.3727 367.7705,-284.2943 363,-290.2809 329.359,-332.4977 363.2089,-366.2448 327,-406.2809 326.1194,-407.2545 325.1863,-408.1845 324.2089,-409.0728"/>
<polygon fill="#ffb300" stroke="#ffb300" points="321.9875,-406.3615 315.9909,-415.096 326.1256,-412.0074 321.9875,-406.3615"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_angle.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge32" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_angle.f90</title>
<path fill="none" stroke="#f0ff00" stroke-dasharray="5,2" d="M382.4472,-275.4068C375.5059,-279.4232 368.465,-284.3999 363,-290.2809 338.1029,-317.0729 353.5199,-339.0941 327,-364.2809 325.7435,-365.4742 324.409,-366.6049 323.0144,-367.6757"/>
<polygon fill="#f0ff00" stroke="#f0ff00" points="320.9988,-364.8109 314.4944,-373.174 324.7945,-370.6925 320.9988,-364.8109"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_external.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge42" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_external.f90</title>
<path fill="none" stroke="#00ffd1" stroke-dasharray="5,2" d="M387.4142,-275.3992C379.582,-279.8806 370.7839,-285.1277 363,-290.2809 346.3234,-301.3213 343.907,-306.5967 327,-317.2809 322.0059,-320.4368 316.5888,-323.5617 311.232,-326.4918"/>
<polygon fill="#00ffd1" stroke="#00ffd1" points="309.545,-323.4248 302.3592,-331.2104 312.8317,-329.6052 309.545,-323.4248"/>
</g>
<!-- sourcefile~m_connectivity.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~m_connectivity.f90</title>
<g id="a_sourcefile~~m_simbox.f90~~AfferentGraph_node15"><a xlink:href=".././sourcefile/m_connectivity.f90.html" xlink:title="m_connectivity.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="327,-275.2809 228,-275.2809 228,-251.2809 327,-251.2809 327,-275.2809"/>
<text text-anchor="middle" x="277.5" y="-260.8809" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_connectivity.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_connectivity.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge48" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_connectivity.f90</title>
<path fill="none" stroke="#0078ff" stroke-dasharray="5,2" d="M362.9617,-263.2809C354.6392,-263.2809 345.8632,-263.2809 337.2315,-263.2809"/>
<polygon fill="#0078ff" stroke="#0078ff" points="337.2008,-259.781 327.2008,-263.2809 337.2007,-266.781 337.2008,-259.781"/>
</g>
<!-- sourcefile~m_verlet.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~m_verlet.f90</title>
<g id="a_sourcefile~~m_simbox.f90~~AfferentGraph_node17"><a xlink:href=".././sourcefile/m_verlet.f90.html" xlink:title="m_verlet.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="312.5,-233.2809 242.5,-233.2809 242.5,-209.2809 312.5,-209.2809 312.5,-233.2809"/>
<text text-anchor="middle" x="277.5" y="-218.8809" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_verlet.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_verlet.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge49" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_verlet.f90</title>
<path fill="none" stroke="#3c00ff" stroke-dasharray="5,2" d="M371.6741,-251.2454C356.2804,-246.3474 338.3693,-240.6484 322.3254,-235.5435"/>
<polygon fill="#3c00ff" stroke="#3c00ff" points="323.2068,-232.1511 312.6163,-232.4542 321.0843,-238.8216 323.2068,-232.1511"/>
</g>
<!-- sourcefile~m_ia_bond.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_node18" class="node">
<title>sourcefile~m_ia_bond.f90</title>
<g id="a_sourcefile~~m_simbox.f90~~AfferentGraph_node18"><a xlink:href=".././sourcefile/m_ia_bond.f90.html" xlink:title="m_ia_bond.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="318.5,-191.2809 236.5,-191.2809 236.5,-167.2809 318.5,-167.2809 318.5,-191.2809"/>
<text text-anchor="middle" x="277.5" y="-176.8809" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_bond.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_bond.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge50" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_bond.f90</title>
<path fill="none" stroke="#9500ff" stroke-dasharray="5,2" d="M395.9528,-251.2175C380.198,-237.6099 353.017,-215.4096 327,-200.2809 324.2159,-198.6619 321.2831,-197.0979 318.2924,-195.6035"/>
<polygon fill="#9500ff" stroke="#9500ff" points="319.7756,-192.4333 309.237,-191.3434 316.7957,-198.7674 319.7756,-192.4333"/>
</g>
<!-- sourcefile~m_ia_dihedral.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_node21" class="node">
<title>sourcefile~m_ia_dihedral.f90</title>
<g id="a_sourcefile~~m_simbox.f90~~AfferentGraph_node21"><a xlink:href=".././sourcefile/m_ia_dihedral.f90.html" xlink:title="m_ia_dihedral.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="325.5,-149.2809 229.5,-149.2809 229.5,-125.2809 325.5,-125.2809 325.5,-149.2809"/>
<text text-anchor="middle" x="277.5" y="-134.8809" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_dihedral.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_dihedral.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge52" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_dihedral.f90</title>
<path fill="none" stroke="#ff005a" stroke-dasharray="5,2" d="M401.0024,-250.9559C383.8185,-226.3006 345.0447,-172.085 327,-158.2809 325.1927,-156.8983 323.2809,-155.5887 321.3007,-154.3506"/>
<polygon fill="#ff005a" stroke="#ff005a" points="322.7399,-151.1471 312.2941,-149.3763 319.3556,-157.2747 322.7399,-151.1471"/>
</g>
<!-- sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M240.8559,-251.2065C236.2142,-248.7133 231.7759,-245.7599 228,-242.2809 191.1151,-208.2964 169.1548,-151.9717 159.2733,-121.1297"/>
<polygon fill="#ff0000" stroke="#ff0000" points="162.5558,-119.8957 156.2772,-111.3616 155.8635,-121.9484 162.5558,-119.8957"/>
</g>
<!-- sourcefile~m_kmc.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~m_kmc.f90</title>
<g id="a_sourcefile~~m_simbox.f90~~AfferentGraph_node16"><a xlink:href=".././sourcefile/m_kmc.f90.html" xlink:title="m_kmc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="569,-315.2809 505,-315.2809 505,-291.2809 569,-291.2809 569,-315.2809"/>
<text text-anchor="middle" x="537" y="-300.8809" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_kmc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_kmc.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~m_kmc.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M504.8224,-310.4485C472.0822,-318.2462 424.1331,-331.2162 409.5,-343.2809"/>
</g>
<!-- sourcefile~m_kmc.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge46" class="edge">
<title>sourcefile~m_kmc.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#00d1ff" stroke-dasharray="5,2" d="M504.8264,-293.1872C490.5309,-288.7023 473.4013,-283.3284 457.6308,-278.3807"/>
<polygon fill="#00d1ff" stroke="#00d1ff" points="458.6136,-275.0209 448.0245,-275.367 456.5182,-281.7 458.6136,-275.0209"/>
</g>
<!-- sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M242.3656,-209.1634C237.2911,-206.6379 232.3285,-203.6866 228,-200.2809 199.7645,-178.0649 176.848,-142.6963 164.0734,-120.2515"/>
<polygon fill="#ff0000" stroke="#ff0000" points="167.1358,-118.5568 159.2336,-111.4995 161.0101,-121.9443 167.1358,-118.5568"/>
</g>
<!-- sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M245.4633,-167.1653C239.5185,-164.5072 233.4645,-161.5112 228,-158.2809 208.4486,-146.7229 188.3288,-130.6238 173.8564,-118.1619"/>
<polygon fill="#ff0000" stroke="#ff0000" points="175.8622,-115.2658 166.0349,-111.3067 171.2483,-120.5301 175.8622,-115.2658"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_node19" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~m_simbox.f90~~AfferentGraph_node19"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="798,-275.2809 744,-275.2809 744,-251.2809 798,-251.2809 798,-275.2809"/>
<text text-anchor="middle" x="771" y="-260.8809" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M663,-263.2809C618.764,-254.6678 621.0538,-301.7906 582,-324.2809 563.1869,-335.1149 558.4537,-339.9573 537,-343.2809"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M537,-343.2809C481.0013,-351.9562 453.2224,-307.2328 409.5,-343.2809"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M758.1869,-251.1796C739.6747,-233.6959 705.2631,-201.196 683.2805,-180.4347"/>
<polygon fill="#00ff00" stroke="#00ff00" points="685.4698,-177.6881 675.7965,-173.3664 680.6634,-182.7772 685.4698,-177.6881"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge33" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_mpcd.f90</title>
<path fill="none" stroke="#96ff00" stroke-dasharray="5,2" d="M663,-263.2809C618.764,-254.6678 620.6298,-225.4919 582,-202.2809 579.656,-200.8725 577.202,-199.4907 574.7013,-198.1506"/>
<polygon fill="#96ff00" stroke="#96ff00" points="576.0552,-194.9127 565.554,-193.5068 572.8864,-201.1544 576.0552,-194.9127"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_control_io.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge35" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_control_io.f90</title>
<path fill="none" stroke="#3cff00" stroke-dasharray="5,2" d="M754.5971,-275.4312C736.7321,-288.6645 707.968,-309.9712 687.4407,-325.1767"/>
<polygon fill="#3cff00" stroke="#3cff00" points="685.1557,-322.5136 679.2034,-331.2784 689.3223,-328.1385 685.1557,-322.5136"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge36" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_bd_solver.f90</title>
<path fill="none" stroke="#00ff1e" stroke-dasharray="5,2" d="M663,-263.2809C660.8221,-262.8568 585.6897,-164.935 552.4986,-121.5577"/>
<polygon fill="#00ff1e" stroke="#00ff1e" points="555.1288,-119.2354 546.2734,-113.4188 549.5688,-123.4882 555.1288,-119.2354"/>
<path fill="none" stroke="#00ff1e" stroke-dasharray="5,2" d="M743.6492,-266.1458C721.6491,-267.7667 690.0544,-268.5486 663,-263.2809"/>
</g>
<!-- sourcefile~m_relax.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_node20" class="node">
<title>sourcefile~m_relax.f90</title>
<g id="a_sourcefile~~m_simbox.f90~~AfferentGraph_node20"><a xlink:href=".././sourcefile/m_relax.f90.html" xlink:title="m_relax.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="570.5,-235.2809 503.5,-235.2809 503.5,-211.2809 570.5,-211.2809 570.5,-235.2809"/>
<text text-anchor="middle" x="537" y="-220.8809" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_relax.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_relax.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge51" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_relax.f90</title>
<path fill="none" stroke="#ff00b4" stroke-dasharray="5,2" d="M663,-263.2809C633.8943,-257.6138 602.074,-247.4786 577.6925,-238.8287"/>
<polygon fill="#ff00b4" stroke="#ff00b4" points="578.6593,-235.4568 568.065,-235.3536 576.2827,-242.041 578.6593,-235.4568"/>
</g>
<!-- sourcefile~m_relax.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~m_relax.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M409.5,-343.2809C339.4434,-402.3784 403.6847,-482.0823 327,-532.2809 290.1862,-556.3796 261.6631,-560.6145 228,-532.2809 164.4479,-478.7903 154.7466,-203.0032 153.2664,-121.8008"/>
<polygon fill="#ff0000" stroke="#ff0000" points="156.7641,-121.6213 153.1073,-111.6776 149.7649,-121.7314 156.7641,-121.6213"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M527.7196,-235.6329C510.2243,-258.7005 472.6318,-307.1802 456,-320.2809 437.8876,-334.5479 427.2898,-328.6136 409.5,-343.2809"/>
</g>
<!-- sourcefile~m_relax.f90&#45;&gt;sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~m_relax.f90&#45;&gt;sourcefile~m_config_io.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M503.6968,-211.1782C499.426,-208.6808 495.3745,-205.7337 492,-202.2809 464.1804,-173.8157 483.996,-148.5726 456,-120.2809 454.9486,-119.2184 453.8337,-118.2047 452.6684,-117.238"/>
<polygon fill="#0000ff" stroke="#0000ff" points="454.6003,-114.3187 444.3814,-111.5211 450.6253,-120.0806 454.6003,-114.3187"/>
</g>
<!-- sourcefile~m_relax.f90&#45;&gt;sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge40" class="edge">
<title>sourcefile~m_relax.f90&#45;&gt;sourcefile~m_stats_io.f90</title>
<path fill="none" stroke="#00ff78" stroke-dasharray="5,2" d="M508.9443,-211.2483C503.2283,-208.504 497.3348,-205.4545 492,-202.2809 470.6202,-189.5623 448.0147,-172.5666 431.8836,-159.7455"/>
<polygon fill="#00ff78" stroke="#00ff78" points="434.0643,-157.0078 424.079,-153.4662 429.6763,-162.4618 434.0643,-157.0078"/>
</g>
<!-- sourcefile~m_relax.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge47" class="edge">
<title>sourcefile~m_relax.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#00d1ff" stroke-dasharray="5,2" d="M503.1671,-233.8951C489.2479,-238.2619 472.8679,-243.4007 457.7308,-248.1496"/>
<polygon fill="#00d1ff" stroke="#00d1ff" points="456.4952,-244.869 448.0015,-251.202 458.5906,-251.548 456.4952,-244.869"/>
</g>
<!-- sourcefile~m_ia_dihedral.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_simbox.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~m_ia_dihedral.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M238.1074,-125.2574C226.6423,-121.7581 213.9759,-117.892 201.9963,-114.2356"/>
<polygon fill="#ff0000" stroke="#ff0000" points="202.7225,-110.7979 192.1363,-111.2261 200.679,-117.493 202.7225,-110.7979"/>
</g>
</g>
</svg>
</div><script>var pansourcefilem_simboxf90AfferentGraph = svgPanZoom('#sourcefilem_simboxf90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_simbox.html">m_simbox</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_simbox.f90.html#src">m_simbox.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">module </span><span class="n">m_simbox</span>
<a name="ln-2"></a><span class="c">!! Implements a simulation box with appropriate boundary conditions.</span>
<a name="ln-3"></a>
<a name="ln-4"></a><span class="k">use </span><span class="n">m_precision</span>
<a name="ln-5"></a><span class="k">use </span><span class="n">m_constants_math</span>
<a name="ln-6"></a><span class="k">use </span><span class="n">m_ran_num</span>
<a name="ln-7"></a>
<a name="ln-8"></a><span class="k">implicit none</span>
<a name="ln-9"></a>
<a name="ln-10"></a><span class="k">type </span><span class="n">smbx_t</span>
<a name="ln-11"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">basis</span>
<a name="ln-12"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dl_basis</span>
<a name="ln-13"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">volume</span>
<a name="ln-14"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">is_deforming</span>
<a name="ln-15"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">is_aligned</span>
<a name="ln-16"></a>        <span class="c">!! Whether the basis vectors are aligned with the laboratory frame</span>
<a name="ln-17"></a>
<a name="ln-18"></a>    <span class="k">contains</span>
<a name="ln-19"></a><span class="k">        procedure</span> <span class="kd">::</span> <span class="n">set_basis</span> <span class="o">=&gt;</span> <span class="n">smbx_set_basis</span>
<a name="ln-20"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">freeze</span> <span class="o">=&gt;</span> <span class="n">smbx_freeze</span>
<a name="ln-21"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">unfreeze</span> <span class="o">=&gt;</span> <span class="n">smbx_unfreeze</span>
<a name="ln-22"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">get_image</span> <span class="o">=&gt;</span> <span class="n">smbx_get_image</span>
<a name="ln-23"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">wrap_all</span> <span class="o">=&gt;</span> <span class="n">smbx_wrap_all</span>
<a name="ln-24"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">to_center</span> <span class="o">=&gt;</span> <span class="n">smbx_to_center</span>
<a name="ln-25"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">get_rnd_points</span> <span class="o">=&gt;</span> <span class="n">smbx_get_rnd_points</span>
<a name="ln-26"></a><span class="k">end type </span><span class="n">smbx_t</span>
<a name="ln-27"></a>
<a name="ln-28"></a>
<a name="ln-29"></a><span class="k">contains</span>
<a name="ln-30"></a>
<a name="ln-31"></a><span class="c">!********************************************************************************</span>
<a name="ln-32"></a>
<a name="ln-33"></a><span class="k">subroutine </span><span class="n">smbx_init</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-34"></a>    <span class="c">!!Creates an instance of *smbx_t*. Can also be called to reset.</span>
<a name="ln-35"></a>
<a name="ln-36"></a>    <span class="k">type</span><span class="p">(</span><span class="n">smbx_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-37"></a>
<a name="ln-38"></a>    <span class="c">!Initialize to an identity matrix</span>
<a name="ln-39"></a>    <span class="n">this</span><span class="p">%</span><span class="n">basis</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-40"></a>    <span class="n">this</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0_rp</span>
<a name="ln-41"></a>    <span class="n">this</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0_rp</span>
<a name="ln-42"></a>    <span class="n">this</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0_rp</span>
<a name="ln-43"></a>    <span class="n">this</span><span class="p">%</span><span class="n">volume</span> <span class="o">=</span> <span class="mf">1.0_rp</span>
<a name="ln-44"></a>
<a name="ln-45"></a>    <span class="n">this</span><span class="p">%</span><span class="n">dl_basis</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">basis</span>
<a name="ln-46"></a>    <span class="n">this</span><span class="p">%</span><span class="n">is_deforming</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-47"></a>    <span class="n">this</span><span class="p">%</span><span class="n">is_aligned</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-48"></a>
<a name="ln-49"></a>    <span class="k">end subroutine</span>
<a name="ln-50"></a>
<a name="ln-51"></a><span class="c">!********************************************************************************</span>
<a name="ln-52"></a>
<a name="ln-53"></a><span class="k">subroutine </span><span class="n">smbx_set_basis</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">bv</span><span class="p">)</span>
<a name="ln-54"></a>    <span class="c">!!Sets all three basis vectors.</span>
<a name="ln-55"></a>
<a name="ln-56"></a>    <span class="k">class</span><span class="p">(</span><span class="n">smbx_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-57"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">bv</span>
<a name="ln-58"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span>
<a name="ln-59"></a>
<a name="ln-60"></a>    <span class="n">this</span><span class="p">%</span><span class="n">basis</span> <span class="o">=</span> <span class="n">bv</span>
<a name="ln-61"></a>
<a name="ln-62"></a>    <span class="n">a</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">basis</span><span class="p">(:,</span><span class="mi">1</span><span class="p">);</span> <span class="n">b</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">basis</span><span class="p">(:,</span><span class="mi">2</span><span class="p">);</span> <span class="n">c</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">basis</span><span class="p">(:,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-63"></a>
<a name="ln-64"></a>    <span class="n">this</span><span class="p">%</span><span class="n">volume</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span> <span class="n">b</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">b</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span> <span class="o">-</span> <span class="n">a</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span> <span class="n">b</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">b</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-65"></a>            <span class="o">+</span> <span class="n">a</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span> <span class="n">b</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">b</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-66"></a>
<a name="ln-67"></a>    <span class="k">end subroutine</span>
<a name="ln-68"></a>
<a name="ln-69"></a><span class="c">!********************************************************************************</span>
<a name="ln-70"></a>
<a name="ln-71"></a><span class="k">subroutine </span><span class="n">smbx_freeze</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-72"></a>    <span class="c">!!Specifies *this* as non-deforming.</span>
<a name="ln-73"></a>
<a name="ln-74"></a>    <span class="k">class</span><span class="p">(</span><span class="n">smbx_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-75"></a>
<a name="ln-76"></a>    <span class="n">this</span><span class="p">%</span><span class="n">is_deforming</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-77"></a>
<a name="ln-78"></a>    <span class="k">end subroutine</span>
<a name="ln-79"></a>
<a name="ln-80"></a><span class="c">!********************************************************************************</span>
<a name="ln-81"></a>
<a name="ln-82"></a><span class="k">subroutine </span><span class="n">smbx_unfreeze</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-83"></a>    <span class="c">!!Specifies *this* as deforming.</span>
<a name="ln-84"></a>
<a name="ln-85"></a>    <span class="k">class</span><span class="p">(</span><span class="n">smbx_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-86"></a>
<a name="ln-87"></a>    <span class="n">this</span><span class="p">%</span><span class="n">is_deforming</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-88"></a>
<a name="ln-89"></a>    <span class="k">end subroutine</span>
<a name="ln-90"></a>
<a name="ln-91"></a><span class="c">!********************************************************************************</span>
<a name="ln-92"></a>
<a name="ln-93"></a><span class="k">subroutine </span><span class="n">smbx_get_image</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
<a name="ln-94"></a>    <span class="c">!!Returns the image of *r* under PBC.</span>
<a name="ln-95"></a>    <span class="c">!https://scicomp.stackexchange.com/questions/20165/periodic-boundary-conditions-for-triclinic-box</span>
<a name="ln-96"></a>
<a name="ln-97"></a>    <span class="k">class</span><span class="p">(</span><span class="n">smbx_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-98"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">r</span>
<a name="ln-99"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rf</span>
<a name="ln-100"></a>    
<a name="ln-101"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">is_aligned</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-102"></a><span class="k">        </span><span class="n">r</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">r</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">this</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">nint</span><span class="p">(</span> <span class="n">r</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">this</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-103"></a>        <span class="n">r</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">r</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">this</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nb">nint</span><span class="p">(</span> <span class="n">r</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">this</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-104"></a>        <span class="n">r</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">r</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">this</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="nb">nint</span><span class="p">(</span> <span class="n">r</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">this</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-105"></a>    <span class="k">else</span>
<a name="ln-106"></a><span class="k">        </span><span class="n">rf</span> <span class="o">=</span> <span class="nb">matmul</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">dl_basis</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
<a name="ln-107"></a>        <span class="n">rf</span> <span class="o">=</span> <span class="n">rf</span> <span class="o">-</span> <span class="nb">nint</span><span class="p">(</span><span class="n">rf</span><span class="p">)</span>
<a name="ln-108"></a>        <span class="n">r</span> <span class="o">=</span> <span class="nb">matmul</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">basis</span><span class="p">,</span> <span class="n">rf</span><span class="p">)</span>
<a name="ln-109"></a>    <span class="k">end if</span>
<a name="ln-110"></a>
<a name="ln-111"></a><span class="k">    end subroutine</span>
<a name="ln-112"></a>
<a name="ln-113"></a><span class="c">!********************************************************************************</span>
<a name="ln-114"></a>
<a name="ln-115"></a><span class="k">subroutine </span><span class="n">smbx_wrap_all</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>
<a name="ln-116"></a>    <span class="c">!!Wraps atom positions w.r.t. periodic boundary conditions.</span>
<a name="ln-117"></a>    <span class="c">!https://scicomp.stackexchange.com/questions/20165/periodic-boundary-conditions-for-triclinic-box</span>
<a name="ln-118"></a>
<a name="ln-119"></a>    <span class="k">class</span><span class="p">(</span><span class="n">smbx_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-120"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">coords</span>
<a name="ln-121"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rf</span>
<a name="ln-122"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">diag</span>
<a name="ln-123"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span>
<a name="ln-124"></a>    
<a name="ln-125"></a>    <span class="n">n</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-126"></a>
<a name="ln-127"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">is_aligned</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-128"></a><span class="k">        </span><span class="n">diag</span> <span class="o">=</span> <span class="p">[</span><span class="n">this</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">this</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">this</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)]</span>
<a name="ln-129"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-130"></a>            <span class="n">coords</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">coords</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">diag</span><span class="o">*</span><span class="nb">floor</span><span class="p">(</span> <span class="n">coords</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">diag</span> <span class="p">)</span>
<a name="ln-131"></a>        <span class="k">end do</span>
<a name="ln-132"></a><span class="k">    else</span>
<a name="ln-133"></a><span class="k">        do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-134"></a>            <span class="n">rf</span> <span class="o">=</span> <span class="nb">matmul</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">dl_basis</span><span class="p">,</span> <span class="n">coords</span><span class="p">(:,</span><span class="n">i</span><span class="p">))</span>
<a name="ln-135"></a>            <span class="n">rf</span> <span class="o">=</span> <span class="n">rf</span> <span class="o">-</span> <span class="nb">floor</span><span class="p">(</span><span class="n">rf</span><span class="p">)</span>
<a name="ln-136"></a>            <span class="n">coords</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="nb">matmul</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">basis</span><span class="p">,</span> <span class="n">rf</span><span class="p">)</span>
<a name="ln-137"></a>        <span class="k">end do</span>
<a name="ln-138"></a><span class="k">    end if</span>
<a name="ln-139"></a>
<a name="ln-140"></a><span class="k">    end subroutine</span>
<a name="ln-141"></a>
<a name="ln-142"></a><span class="c">!********************************************************************************</span>
<a name="ln-143"></a>
<a name="ln-144"></a><span class="k">subroutine </span><span class="n">smbx_to_center</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">com</span><span class="p">)</span>
<a name="ln-145"></a>    <span class="c">!!Adjusts atom positions such that the c.o.m. of the atoms is at the center </span>
<a name="ln-146"></a>    <span class="c">!! of the box. Assumes all atoms to have the same mass and aligned axis.</span>
<a name="ln-147"></a>    <span class="c">!! Optionally returns the original c.o.m.</span>
<a name="ln-148"></a>
<a name="ln-149"></a>    <span class="k">class</span><span class="p">(</span><span class="n">smbx_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-150"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">coords</span>
<a name="ln-151"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">com</span>
<a name="ln-152"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">half_diag</span><span class="p">,</span> <span class="n">com_</span>
<a name="ln-153"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span>
<a name="ln-154"></a>    
<a name="ln-155"></a>    <span class="n">half_diag</span> <span class="o">=</span> <span class="mf">0.5_rp</span><span class="o">*</span><span class="p">[</span><span class="n">this</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">this</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">this</span><span class="p">%</span><span class="n">basis</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)]</span>
<a name="ln-156"></a>    <span class="n">n</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-157"></a>    <span class="n">com_</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
<a name="ln-158"></a>
<a name="ln-159"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-160"></a>        <span class="n">coords</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">coords</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">com_</span> <span class="o">+</span> <span class="n">half_diag</span>
<a name="ln-161"></a>    <span class="k">end do</span>
<a name="ln-162"></a>
<a name="ln-163"></a><span class="k">    if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">com</span><span class="p">))</span> <span class="n">com</span> <span class="o">=</span> <span class="n">com_</span> <span class="o">-</span> <span class="n">half_diag</span>
<a name="ln-164"></a>
<a name="ln-165"></a>    <span class="k">end subroutine</span>
<a name="ln-166"></a>
<a name="ln-167"></a><span class="c">!********************************************************************************</span>
<a name="ln-168"></a>
<a name="ln-169"></a><span class="k">subroutine </span><span class="n">smbx_get_rnd_points</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>
<a name="ln-170"></a>    <span class="c">!!Returns uniformly distributed points within the box.</span>
<a name="ln-171"></a>
<a name="ln-172"></a>    <span class="k">class</span><span class="p">(</span><span class="n">smbx_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-173"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">coords</span>
<a name="ln-174"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">r</span>
<a name="ln-175"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span>
<a name="ln-176"></a>    
<a name="ln-177"></a>    <span class="n">n</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-178"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-179"></a>        <span class="k">call </span><span class="n">get_rv_uniform</span><span class="p">(</span><span class="mf">0.0_rp</span><span class="p">,</span> <span class="mf">1.0_rp</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
<a name="ln-180"></a>        <span class="n">coords</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="nb">matmul</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">basis</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
<a name="ln-181"></a>    <span class="k">end do</span>
<a name="ln-182"></a>
<a name="ln-183"></a><span class="k">    end subroutine</span>
<a name="ln-184"></a>
<a name="ln-185"></a><span class="c">!********************************************************************************</span>
<a name="ln-186"></a>
<a name="ln-187"></a><span class="k">end module </span><span class="n">m_simbox</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> BROWNPAK was developed by Sarit Dutta</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>