<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for BROWNPAK">
   
    <meta name="author" content="Sarit Dutta" >
    <link rel="icon" href="../favicon.png">

    <title>m_vector.f90 &ndash; BROWNPAK</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">BROWNPAK <small>0.2</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>m_vector.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 6.9% of total for source files.">425 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/m_vector.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">m_vector.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_vector.html">m_vector</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_vector.f90.html#src">m_vector.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_vector.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilem_vectorf90EfferentGraph" width="308pt" height="52pt"
 viewBox="0.00 0.00 308.00 52.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_vector.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 48)">
<title>sourcefile~~m_vector.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-48 304,-48 304,4 -4,4"/>
<!-- sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_vector.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~m_vector.f90</title>
<polygon fill="none" stroke="#000000" points="300,-44 227,-44 227,-20 300,-20 300,-44"/>
<text text-anchor="middle" x="263.5" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_vector.f90</text>
</g>
<!-- sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_vector.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~m_precision.f90</title>
<g id="a_sourcefile~~m_vector.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/m_precision.f90.html" xlink:title="m_precision.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="87,-44 0,-44 0,-20 87,-20 87,-44"/>
<text text-anchor="middle" x="43.5" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_precision.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_vector.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_vector.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~m_vector.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M226.9903,-32.6018C215.4756,-32.7652 202.7066,-32.9193 191,-33 160.7785,-33.2084 153.2216,-33.1901 123,-33 114.7571,-32.9482 106.0337,-32.8661 97.5026,-32.7707"/>
<polygon fill="#ff0000" stroke="#ff0000" points="97.2779,-29.2679 87.237,-32.6489 97.1948,-36.2674 97.2779,-29.2679"/>
</g>
<!-- sourcefile~m_qsort.f90 -->
<g id="sourcefile~~m_vector.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~m_qsort.f90</title>
<g id="a_sourcefile~~m_vector.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/m_qsort.f90.html" xlink:title="m_qsort.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="191,-24 123,-24 123,0 191,0 191,-24"/>
<text text-anchor="middle" x="157" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_qsort.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_vector.f90&#45;&gt;sourcefile~m_qsort.f90 -->
<g id="sourcefile~~m_vector.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~m_vector.f90&#45;&gt;sourcefile~m_qsort.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M226.8487,-25.1171C218.5454,-23.5578 209.6438,-21.8862 201.0696,-20.276"/>
<polygon fill="#ff0000" stroke="#ff0000" points="201.6843,-16.8303 191.2101,-18.4244 200.3923,-23.7101 201.6843,-16.8303"/>
</g>
<!-- sourcefile~m_qsort.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_vector.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~m_qsort.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M122.9463,-18.0007C114.7862,-19.4386 105.8765,-21.0085 97.0693,-22.5605"/>
<polygon fill="#00ffff" stroke="#00ffff" points="96.4555,-19.1146 87.2146,-24.297 97.6703,-26.0084 96.4555,-19.1146"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_vector.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilem_vectorf90AfferentGraph" width="641pt" height="161pt"
 viewBox="0.00 0.00 641.00 161.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_vector.f90~~AfferentGraph" class="graph" transform="scale(.8325 .8325) rotate(0) translate(4 190)">
<title>sourcefile~~m_vector.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-190 766,-190 766,4 -4,4"/>
<!-- sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~m_vector.f90</title>
<polygon fill="none" stroke="#000000" points="73,-133 0,-133 0,-109 73,-109 73,-133"/>
<text text-anchor="middle" x="36.5" y="-118.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_vector.f90</text>
</g>
<!-- sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~m_cell_list.f90</title>
<g id="a_sourcefile~~m_vector.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/m_cell_list.f90.html" xlink:title="m_cell_list.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="301,-176 222,-176 222,-152 301,-152 301,-176"/>
<text text-anchor="middle" x="261.5" y="-161.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_cell_list.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_vector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M221.9974,-165.084C198.784,-165.2856 168.9042,-164.7926 142.5,-162"/>
</g>
<!-- sourcefile~m_connectivity.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~m_connectivity.f90</title>
<g id="a_sourcefile~~m_vector.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/m_connectivity.f90.html" xlink:title="m_connectivity.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="311,-92 212,-92 212,-68 311,-68 311,-92"/>
<text text-anchor="middle" x="261.5" y="-77.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_connectivity.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_vector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M211.7303,-84.6012C181.7728,-87.8473 142.978,-92.8937 109,-100 100.5184,-101.7739 91.5812,-104.0325 82.9897,-106.407"/>
<polygon fill="#ff0000" stroke="#ff0000" points="81.7668,-103.1162 73.1109,-109.2257 83.6875,-109.8476 81.7668,-103.1162"/>
</g>
<!-- sourcefile~m_table.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~m_table.f90</title>
<g id="a_sourcefile~~m_vector.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/m_table.f90.html" xlink:title="m_table.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="176,-133 109,-133 109,-109 176,-109 176,-133"/>
<text text-anchor="middle" x="142.5" y="-118.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_table.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_table.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_table.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M226.4397,-92.0796C213.6407,-96.4894 199.0154,-101.5283 185.5974,-106.1513"/>
<polygon fill="#00ffff" stroke="#00ffff" points="184.3982,-102.8625 176.0838,-109.4291 186.6785,-109.4807 184.3982,-102.8625"/>
</g>
<!-- sourcefile~m_table.f90&#45;&gt;sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~m_table.f90&#45;&gt;sourcefile~m_vector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M108.9609,-121C100.7651,-121 91.8483,-121 83.1619,-121"/>
<polygon fill="#ff0000" stroke="#ff0000" points="83.1277,-117.5001 73.1276,-121 83.1276,-124.5001 83.1277,-117.5001"/>
</g>
<!-- sourcefile~m_verlet.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~m_verlet.f90</title>
<g id="a_sourcefile~~m_vector.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/m_verlet.f90.html" xlink:title="m_verlet.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="296.5,-134 226.5,-134 226.5,-110 296.5,-110 296.5,-134"/>
<text text-anchor="middle" x="261.5" y="-119.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_verlet.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_vector.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_vector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M142.5,-162C115.9053,-159.1873 87.759,-147.8605 67.1586,-137.8234"/>
<polygon fill="#ff0000" stroke="#ff0000" points="68.4797,-134.5698 57.975,-133.1906 65.3269,-140.8196 68.4797,-134.5698"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M230.1766,-134.0385C198.0078,-146.1576 151.4137,-162.9427 142.5,-162"/>
</g>
<!-- sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_table.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_table.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M226.4397,-121.7054C213.8892,-121.5999 199.5827,-121.4797 186.3804,-121.3687"/>
<polygon fill="#00ffff" stroke="#00ffff" points="186.1129,-117.8665 176.0838,-121.2822 186.054,-124.8662 186.1129,-117.8665"/>
</g>
<!-- sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~m_mpcd.f90</title>
<g id="a_sourcefile~~m_vector.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/m_mpcd.f90.html" xlink:title="m_mpcd.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="556,-186 486,-186 486,-162 556,-162 556,-186"/>
<text text-anchor="middle" x="521" y="-171.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_mpcd.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_cell_list.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M485.7326,-172.6409C440.7453,-170.9073 362.6601,-167.8983 311.5345,-165.9281"/>
<polygon fill="#ff0000" stroke="#ff0000" points="311.4987,-162.4242 301.3713,-165.5365 311.2291,-169.419 311.4987,-162.4242"/>
</g>
<!-- sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~m_interaction.f90</title>
<g id="a_sourcefile~~m_vector.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/m_interaction.f90.html" xlink:title="m_interaction.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="440,-114 347,-114 347,-90 440,-90 440,-114"/>
<text text-anchor="middle" x="393.5" y="-99.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_interaction.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M493.6182,-161.8463C487.7418,-159.0651 481.6135,-156.0315 476,-153 457.0502,-142.7666 436.4429,-130.0287 420.5642,-119.8431"/>
<polygon fill="#00ffff" stroke="#00ffff" points="422.107,-116.6726 411.8097,-114.1791 418.3045,-122.5498 422.107,-116.6726"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_cell_list.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M370.2102,-114.0409C353.7832,-122.4186 331.1966,-133.7074 311,-143 307.4289,-144.6431 303.6933,-146.3138 299.9439,-147.9586"/>
<polygon fill="#ff0000" stroke="#ff0000" points="298.4713,-144.7822 290.6815,-151.9634 301.2494,-151.2073 298.4713,-144.7822"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_connectivity.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_connectivity.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M346.9617,-94.2436C338.6392,-92.8565 329.8632,-91.3939 321.2315,-89.9553"/>
<polygon fill="#7fff00" stroke="#7fff00" points="321.6401,-86.4752 311.2008,-88.2835 320.4893,-93.3799 321.6401,-86.4752"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_verlet.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_verlet.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M346.9617,-109.0513C333.9595,-111.0213 319.8505,-113.159 306.9141,-115.1191"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="306.1971,-111.6877 296.8343,-116.6463 307.2458,-118.6087 306.1971,-111.6877"/>
</g>
<!-- sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~m_bd_solver.f90</title>
<g id="a_sourcefile~~m_vector.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/m_bd_solver.f90.html" xlink:title="m_bd_solver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="566,-64 476,-64 476,-40 566,-40 566,-64"/>
<text text-anchor="middle" x="521" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_bd_solver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M490.1358,-64.1036C473.2685,-70.7182 452.1715,-78.9916 433.9966,-86.119"/>
<polygon fill="#00ffff" stroke="#00ffff" points="432.5538,-82.9252 424.5219,-89.8346 435.1094,-89.442 432.5538,-82.9252"/>
</g>
<!-- sourcefile~m_kmc.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~m_kmc.f90</title>
<g id="a_sourcefile~~m_vector.f90~~AfferentGraph_node9"><a xlink:href=".././sourcefile/m_kmc.f90.html" xlink:title="m_kmc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="553,-144 489,-144 489,-120 553,-120 553,-144"/>
<text text-anchor="middle" x="521" y="-129.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_kmc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_kmc.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~m_kmc.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M488.8264,-124.4297C477.0691,-121.6633 463.3948,-118.4458 450.1361,-115.3261"/>
<polygon fill="#00ffff" stroke="#00ffff" points="450.6526,-111.8522 440.1168,-112.9687 449.0493,-118.6661 450.6526,-111.8522"/>
</g>
<!-- sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~m_setup.f90</title>
<g id="a_sourcefile~~m_vector.f90~~AfferentGraph_node10"><a xlink:href=".././sourcefile/m_setup.f90.html" xlink:title="m_setup.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="672,-104 602,-104 602,-80 672,-80 672,-104"/>
<text text-anchor="middle" x="637" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_setup.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_mpcd.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M624.7574,-104.3719C611.2325,-117.5768 588.3918,-138.5461 566,-153 563.8451,-154.391 561.5833,-155.7423 559.2686,-157.0443"/>
<polygon fill="#ff0000" stroke="#ff0000" points="557.4245,-154.0592 550.1926,-161.8019 560.6745,-160.2591 557.4245,-154.0592"/>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M601.8531,-93.4434C562.2206,-95.071 497.2031,-97.7411 450.3302,-99.6661"/>
<polygon fill="#00ffff" stroke="#00ffff" points="450.1705,-96.1696 440.3226,-100.0771 450.4578,-103.1637 450.1705,-96.1696"/>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_bd_solver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M602.1962,-79.9987C590.7166,-76.0402 577.7856,-71.5813 565.6742,-67.4049"/>
<polygon fill="#ff0000" stroke="#ff0000" points="566.7749,-64.0823 556.1802,-64.1311 564.4929,-70.6999 566.7749,-64.0823"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~m_vector.f90~~AfferentGraph_node11"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="762,-84 708,-84 708,-60 762,-60 762,-84"/>
<text text-anchor="middle" x="735" y="-69.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_mpcd.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M718.4234,-84.0552C706.0193,-92.7578 688.4329,-104.4359 672,-113 637.3847,-131.04 596.1888,-147.3633 565.5773,-158.5749"/>
<polygon fill="#ff0000" stroke="#ff0000" points="564.2431,-155.3355 556.0322,-162.0311 566.6264,-161.9173 564.2431,-155.3355"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_bd_solver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M707.8968,-69.467C674.9597,-66.3888 618.556,-61.1174 576.3063,-57.1688"/>
<polygon fill="#ff0000" stroke="#ff0000" points="576.4476,-53.6669 566.1653,-56.2211 575.7962,-60.6365 576.4476,-53.6669"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M707.9616,-77.518C699.8936,-79.1646 690.824,-81.0155 681.9341,-82.8298"/>
<polygon fill="#00ff66" stroke="#00ff66" points="681.1346,-79.4207 672.0365,-84.8497 682.5344,-86.2793 681.1346,-79.4207"/>
</g>
<!-- sourcefile~m_relax.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~m_relax.f90</title>
<g id="a_sourcefile~~m_vector.f90~~AfferentGraph_node12"><a xlink:href=".././sourcefile/m_relax.f90.html" xlink:title="m_relax.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="670.5,-24 603.5,-24 603.5,0 670.5,0 670.5,-24"/>
<text text-anchor="middle" x="637" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_relax.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_relax.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_relax.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M715.1682,-59.8581C700.9552,-51.1562 681.5942,-39.3026 665.697,-29.5696"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="667.1584,-26.3604 656.8023,-24.1238 663.5032,-32.3304 667.1584,-26.3604"/>
</g>
<!-- sourcefile~m_relax.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_vector.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~m_relax.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M603.4514,-10.3685C569.8112,-9.9902 517.2274,-12.8827 476,-31 449.6851,-42.564 425.5153,-65.4522 410.2318,-82.1248"/>
<polygon fill="#00ffff" stroke="#00ffff" points="407.4974,-79.9328 403.4724,-89.7333 412.7306,-84.5819 407.4974,-79.9328"/>
</g>
</g>
</svg>
</div><script>var pansourcefilem_vectorf90AfferentGraph = svgPanZoom('#sourcefilem_vectorf90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_vector.html">m_vector</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_vector.f90.html#src">m_vector.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">module </span><span class="n">m_vector</span>
<a name="ln-2"></a>    <span class="c">!! Implements a vector as an extendable array.</span>
<a name="ln-3"></a>
<a name="ln-4"></a><span class="k">use </span><span class="n">m_precision</span>
<a name="ln-5"></a><span class="k">use </span><span class="n">m_qsort</span>
<a name="ln-6"></a>
<a name="ln-7"></a><span class="k">implicit none</span>
<a name="ln-8"></a>
<a name="ln-9"></a><span class="k">type </span><span class="n">ivector_t</span>
<a name="ln-10"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">len_init</span> <span class="o">=</span> <span class="mi">8</span> <span class="c">!Must be &gt; 0</span>
<a name="ln-11"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="nb">len</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-12"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">len_max</span> <span class="o">=</span> <span class="mi">16</span> <span class="c">!Must be &gt; len_init</span>
<a name="ln-13"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">buffer</span>
<a name="ln-14"></a>
<a name="ln-15"></a>    <span class="k">contains</span>
<a name="ln-16"></a><span class="k">        procedure</span> <span class="kd">::</span> <span class="n">delete</span> <span class="o">=&gt;</span> <span class="n">ivector_delete</span>
<a name="ln-17"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">clear</span> <span class="o">=&gt;</span> <span class="n">ivector_clear</span>
<a name="ln-18"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">get_val</span> <span class="o">=&gt;</span> <span class="n">ivector_get_val</span>
<a name="ln-19"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">set_val</span> <span class="o">=&gt;</span> <span class="n">ivector_set_val</span>
<a name="ln-20"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">get_data</span> <span class="o">=&gt;</span> <span class="n">ivector_get_data</span>
<a name="ln-21"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">append</span> <span class="o">=&gt;</span> <span class="n">ivector_append</span>
<a name="ln-22"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">shrink_to_fit</span> <span class="o">=&gt;</span> <span class="n">ivector_shrink_to_fit</span>
<a name="ln-23"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">sort</span> <span class="o">=&gt;</span> <span class="n">ivector_sort</span>
<a name="ln-24"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">unique</span> <span class="o">=&gt;</span> <span class="n">ivector_unique</span>
<a name="ln-25"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="k">print</span> <span class="o">=&gt;</span> <span class="n">ivector_print</span>
<a name="ln-26"></a><span class="k">end type </span><span class="n">ivector_t</span>
<a name="ln-27"></a>
<a name="ln-28"></a><span class="k">type </span><span class="n">dvector_t</span>
<a name="ln-29"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">len_init</span> <span class="o">=</span> <span class="mi">8</span> <span class="c">!Must be &gt; 0</span>
<a name="ln-30"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="nb">len</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-31"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">len_max</span> <span class="o">=</span> <span class="mi">16</span> <span class="c">!Must be &gt; len_init</span>
<a name="ln-32"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">buffer</span>
<a name="ln-33"></a>
<a name="ln-34"></a>    <span class="k">contains</span>
<a name="ln-35"></a><span class="k">        procedure</span> <span class="kd">::</span> <span class="n">delete</span> <span class="o">=&gt;</span> <span class="n">dvector_delete</span>
<a name="ln-36"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">clear</span> <span class="o">=&gt;</span> <span class="n">dvector_clear</span>
<a name="ln-37"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">get_val</span> <span class="o">=&gt;</span> <span class="n">dvector_get_val</span>
<a name="ln-38"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">set_val</span> <span class="o">=&gt;</span> <span class="n">dvector_set_val</span>
<a name="ln-39"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">get_data</span> <span class="o">=&gt;</span> <span class="n">dvector_get_data</span>
<a name="ln-40"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">append</span> <span class="o">=&gt;</span> <span class="n">dvector_append</span>
<a name="ln-41"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">shrink_to_fit</span> <span class="o">=&gt;</span> <span class="n">dvector_shrink_to_fit</span>
<a name="ln-42"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">sort</span> <span class="o">=&gt;</span> <span class="n">dvector_sort</span>
<a name="ln-43"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">unique</span> <span class="o">=&gt;</span> <span class="n">dvector_unique</span>
<a name="ln-44"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="k">print</span> <span class="o">=&gt;</span> <span class="n">dvector_print</span>
<a name="ln-45"></a><span class="k">end type </span><span class="n">dvector_t</span>
<a name="ln-46"></a>
<a name="ln-47"></a>
<a name="ln-48"></a><span class="k">interface </span><span class="n">assignment</span><span class="p">(</span><span class="o">=</span><span class="p">)</span>
<a name="ln-49"></a>    <span class="k">module procedure </span><span class="n">ivector_assign</span>
<a name="ln-50"></a>    <span class="k">module procedure </span><span class="n">dvector_assign</span>
<a name="ln-51"></a>    <span class="k">module procedure </span><span class="n">i_dvector_assign</span>
<a name="ln-52"></a><span class="k">end interface</span>
<a name="ln-53"></a>
<a name="ln-54"></a>
<a name="ln-55"></a><span class="k">contains</span>
<a name="ln-56"></a>
<a name="ln-57"></a><span class="c">!******************************************************************************</span>
<a name="ln-58"></a>
<a name="ln-59"></a><span class="c">!&gt; Creates an empty *ivector* with all elements equal to zero.</span>
<a name="ln-60"></a><span class="k">subroutine </span><span class="n">ivector_init</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">len_init</span><span class="p">,</span> <span class="n">ierr</span><span class="p">)</span>
<a name="ln-61"></a>
<a name="ln-62"></a>    <span class="k">type</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-63"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">len_init</span>
<a name="ln-64"></a>        <span class="c">!! Must be &gt; 0</span>
<a name="ln-65"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-66"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">istat</span>
<a name="ln-67"></a>
<a name="ln-68"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">ierr</span><span class="p">))</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-69"></a>
<a name="ln-70"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">len_init</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-71"></a><span class="k">        if</span> <span class="p">(</span><span class="n">len_init</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">this</span><span class="p">%</span><span class="n">len_init</span> <span class="o">=</span> <span class="n">len_init</span>
<a name="ln-72"></a>        <span class="n">this</span><span class="p">%</span><span class="n">len_max</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">len_init</span>
<a name="ln-73"></a>    <span class="k">end if</span>
<a name="ln-74"></a>
<a name="ln-75"></a><span class="k">    allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">len_max</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">istat</span><span class="p">)</span>
<a name="ln-76"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">istat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-77"></a><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;error: allocation failure for this%buffer of size&#39;</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="n">len_max</span>
<a name="ln-78"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">ierr</span><span class="p">))</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-79"></a>        <span class="k">return</span>
<a name="ln-80"></a><span class="k">    end if</span>
<a name="ln-81"></a>
<a name="ln-82"></a><span class="k">    </span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-83"></a>
<a name="ln-84"></a>    <span class="k">end subroutine</span>
<a name="ln-85"></a>
<a name="ln-86"></a><span class="c">!******************************************************************************</span>
<a name="ln-87"></a>
<a name="ln-88"></a><span class="c">!&gt; Creates an empty *dvector* with all elements equal to zero.</span>
<a name="ln-89"></a><span class="k">subroutine </span><span class="n">dvector_init</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">len_init</span><span class="p">,</span> <span class="n">ierr</span><span class="p">)</span>
<a name="ln-90"></a>
<a name="ln-91"></a>    <span class="k">type</span><span class="p">(</span><span class="n">dvector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-92"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">len_init</span>
<a name="ln-93"></a>        <span class="c">!! Must be &gt; 0</span>
<a name="ln-94"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-95"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">istat</span>
<a name="ln-96"></a>
<a name="ln-97"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">ierr</span><span class="p">))</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-98"></a>
<a name="ln-99"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">len_init</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-100"></a><span class="k">        if</span> <span class="p">(</span><span class="n">len_init</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">this</span><span class="p">%</span><span class="n">len_init</span> <span class="o">=</span> <span class="n">len_init</span>
<a name="ln-101"></a>        <span class="n">this</span><span class="p">%</span><span class="n">len_max</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">len_init</span>
<a name="ln-102"></a>    <span class="k">end if</span>
<a name="ln-103"></a>
<a name="ln-104"></a><span class="k">    allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">len_max</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">istat</span><span class="p">)</span>
<a name="ln-105"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">istat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-106"></a><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;error: allocation failure for this%buffer of size&#39;</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="n">len_max</span>
<a name="ln-107"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">ierr</span><span class="p">))</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-108"></a>        <span class="k">return</span>
<a name="ln-109"></a><span class="k">    end if</span>
<a name="ln-110"></a>
<a name="ln-111"></a><span class="k">    </span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-112"></a>
<a name="ln-113"></a>    <span class="k">end subroutine</span>
<a name="ln-114"></a>
<a name="ln-115"></a><span class="c">!******************************************************************************</span>
<a name="ln-116"></a>
<a name="ln-117"></a><span class="c">!&gt; Creates an *ivector* with all elements from an array</span>
<a name="ln-118"></a><span class="k">subroutine </span><span class="n">ivector_from_array</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<a name="ln-119"></a>
<a name="ln-120"></a>    <span class="k">type</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-121"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x</span>
<a name="ln-122"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">temp</span>
<a name="ln-123"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span>
<a name="ln-124"></a>
<a name="ln-125"></a>    <span class="k">call </span><span class="n">ivector_init</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-126"></a>    <span class="n">n</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-127"></a>
<a name="ln-128"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">len_max</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-129"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">temp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">))</span>
<a name="ln-130"></a>        <span class="n">temp</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-131"></a>        <span class="n">temp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span>
<a name="ln-132"></a>        <span class="k">call </span><span class="nb">move_alloc</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">)</span>
<a name="ln-133"></a>        <span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-134"></a>        <span class="n">this</span><span class="p">%</span><span class="n">len_max</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">n</span>
<a name="ln-135"></a>    <span class="k">else</span>
<a name="ln-136"></a><span class="k">        </span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span>
<a name="ln-137"></a>        <span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-138"></a>    <span class="k">end if</span>
<a name="ln-139"></a>
<a name="ln-140"></a><span class="k">    end subroutine</span>
<a name="ln-141"></a>
<a name="ln-142"></a><span class="c">!******************************************************************************</span>
<a name="ln-143"></a>
<a name="ln-144"></a><span class="c">!&gt; Creates a *dvector* with all elements from an array</span>
<a name="ln-145"></a><span class="k">subroutine </span><span class="n">dvector_from_array</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<a name="ln-146"></a>
<a name="ln-147"></a>    <span class="k">type</span><span class="p">(</span><span class="n">dvector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-148"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x</span>
<a name="ln-149"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">temp</span>
<a name="ln-150"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span>
<a name="ln-151"></a>
<a name="ln-152"></a>    <span class="k">call </span><span class="n">dvector_init</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-153"></a>    <span class="n">n</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-154"></a>
<a name="ln-155"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">len_max</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-156"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">temp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">))</span>
<a name="ln-157"></a>        <span class="n">temp</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-158"></a>        <span class="n">temp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span>
<a name="ln-159"></a>        <span class="k">call </span><span class="nb">move_alloc</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">)</span>
<a name="ln-160"></a>        <span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-161"></a>        <span class="n">this</span><span class="p">%</span><span class="n">len_max</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">n</span>
<a name="ln-162"></a>    <span class="k">else</span>
<a name="ln-163"></a><span class="k">        </span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span>
<a name="ln-164"></a>        <span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-165"></a>    <span class="k">end if</span>
<a name="ln-166"></a>
<a name="ln-167"></a><span class="k">    end subroutine</span>
<a name="ln-168"></a>
<a name="ln-169"></a><span class="c">!******************************************************************************</span>
<a name="ln-170"></a>
<a name="ln-171"></a><span class="c">!&gt; Deletes an *ivector*. No access is allowed to this object after this call.</span>
<a name="ln-172"></a><span class="k">subroutine </span><span class="n">ivector_delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-173"></a>
<a name="ln-174"></a>    <span class="k">class</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-175"></a>
<a name="ln-176"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">)</span>
<a name="ln-177"></a>
<a name="ln-178"></a>    <span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-179"></a>
<a name="ln-180"></a>    <span class="k">end subroutine</span>
<a name="ln-181"></a>
<a name="ln-182"></a><span class="c">!******************************************************************************</span>
<a name="ln-183"></a>
<a name="ln-184"></a><span class="c">!&gt; Deletes a *dvector*. No access is allowed to this object after this call.</span>
<a name="ln-185"></a><span class="k">subroutine </span><span class="n">dvector_delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-186"></a>
<a name="ln-187"></a>    <span class="k">class</span><span class="p">(</span><span class="n">dvector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-188"></a>
<a name="ln-189"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">)</span>
<a name="ln-190"></a>
<a name="ln-191"></a>    <span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-192"></a>
<a name="ln-193"></a>    <span class="k">end subroutine</span>
<a name="ln-194"></a>
<a name="ln-195"></a><span class="c">!******************************************************************************</span>
<a name="ln-196"></a>
<a name="ln-197"></a><span class="c">!&gt; Clears an *ivector*. Access allowed after a call to clear.</span>
<a name="ln-198"></a><span class="k">subroutine </span><span class="n">ivector_clear</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-199"></a>
<a name="ln-200"></a>    <span class="k">class</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-201"></a>
<a name="ln-202"></a>    <span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-203"></a>    <span class="n">this</span><span class="p">%</span><span class="n">buffer</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-204"></a>
<a name="ln-205"></a>    <span class="k">end subroutine</span>
<a name="ln-206"></a>
<a name="ln-207"></a><span class="c">!******************************************************************************</span>
<a name="ln-208"></a>
<a name="ln-209"></a><span class="c">!&gt; Clears a *dvector*. Access allowed after a call to clear.</span>
<a name="ln-210"></a><span class="k">subroutine </span><span class="n">dvector_clear</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-211"></a>
<a name="ln-212"></a>    <span class="k">class</span><span class="p">(</span><span class="n">dvector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-213"></a>
<a name="ln-214"></a>    <span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-215"></a>    <span class="n">this</span><span class="p">%</span><span class="n">buffer</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-216"></a>
<a name="ln-217"></a>    <span class="k">end subroutine</span>
<a name="ln-218"></a>
<a name="ln-219"></a><span class="c">!******************************************************************************</span>
<a name="ln-220"></a>
<a name="ln-221"></a><span class="c">!&gt; Copies the contents of *ivector* `other` to *ivector* `this`</span>
<a name="ln-222"></a><span class="c">!!</span>
<a name="ln-223"></a><span class="k">subroutine </span><span class="n">ivector_assign</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
<a name="ln-224"></a>
<a name="ln-225"></a>    <span class="k">class</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-226"></a>    <span class="k">class</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">other</span>
<a name="ln-227"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span>
<a name="ln-228"></a>
<a name="ln-229"></a>    <span class="n">n</span> <span class="o">=</span> <span class="n">other</span><span class="p">%</span><span class="nb">len</span>
<a name="ln-230"></a>
<a name="ln-231"></a><span class="nb">    </span><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">&gt;=</span> <span class="n">n</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-232"></a>        <span class="c">!Copy contents if buffer is large enough</span>
<a name="ln-233"></a>        <span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">other</span><span class="p">%</span><span class="n">buffer</span>
<a name="ln-234"></a>        <span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-235"></a>    <span class="k">else</span>
<a name="ln-236"></a>        <span class="c">!Need to enlarge buffer. Reallocate and copy</span>
<a name="ln-237"></a>        <span class="k">deallocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">)</span>
<a name="ln-238"></a>        <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">other</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">))</span>
<a name="ln-239"></a>        <span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-240"></a>        <span class="n">this</span><span class="p">%</span><span class="n">len_max</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-241"></a>    <span class="k">end if</span>
<a name="ln-242"></a>
<a name="ln-243"></a><span class="k">    end subroutine</span>
<a name="ln-244"></a>
<a name="ln-245"></a><span class="c">!******************************************************************************</span>
<a name="ln-246"></a>
<a name="ln-247"></a><span class="c">!&gt; Copies the contents of *dvector* `other` to *dvector* `this`</span>
<a name="ln-248"></a><span class="c">!!</span>
<a name="ln-249"></a><span class="k">subroutine </span><span class="n">dvector_assign</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
<a name="ln-250"></a>
<a name="ln-251"></a>    <span class="k">class</span><span class="p">(</span><span class="n">dvector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-252"></a>    <span class="k">class</span><span class="p">(</span><span class="n">dvector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">other</span>
<a name="ln-253"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span>
<a name="ln-254"></a>
<a name="ln-255"></a>    <span class="n">n</span> <span class="o">=</span> <span class="n">other</span><span class="p">%</span><span class="nb">len</span>
<a name="ln-256"></a>
<a name="ln-257"></a><span class="nb">    </span><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">&gt;=</span> <span class="n">n</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-258"></a>        <span class="c">!Copy contents if buffer is large enough</span>
<a name="ln-259"></a>        <span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">other</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">)</span>
<a name="ln-260"></a>        <span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-261"></a>    <span class="k">else</span>
<a name="ln-262"></a>        <span class="c">!Need to enlarge buffer. Reallocate and copy</span>
<a name="ln-263"></a>        <span class="k">deallocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">)</span>
<a name="ln-264"></a>        <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">other</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">))</span>
<a name="ln-265"></a>        <span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-266"></a>        <span class="n">this</span><span class="p">%</span><span class="n">len_max</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-267"></a>    <span class="k">end if</span>
<a name="ln-268"></a>
<a name="ln-269"></a><span class="k">    end subroutine</span>
<a name="ln-270"></a>
<a name="ln-271"></a><span class="c">!******************************************************************************</span>
<a name="ln-272"></a>
<a name="ln-273"></a><span class="k">subroutine </span><span class="n">i_dvector_assign</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
<a name="ln-274"></a>    <span class="c">!!  Copies the contents of *ivector* `other` to *dvector* `this`. Integers</span>
<a name="ln-275"></a>    <span class="c">!!  are cast to reals.</span>
<a name="ln-276"></a>    <span class="c">!&quot;&quot;</span>
<a name="ln-277"></a>
<a name="ln-278"></a>    <span class="k">class</span><span class="p">(</span><span class="n">dvector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-279"></a>    <span class="k">class</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">other</span>
<a name="ln-280"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span>
<a name="ln-281"></a>
<a name="ln-282"></a>    <span class="n">n</span> <span class="o">=</span> <span class="n">other</span><span class="p">%</span><span class="nb">len</span>
<a name="ln-283"></a>
<a name="ln-284"></a><span class="nb">    </span><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">&gt;=</span> <span class="n">n</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-285"></a>        <span class="c">!Copy contents if buffer is large enough</span>
<a name="ln-286"></a>        <span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="nb">dble</span><span class="p">(</span><span class="n">other</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">))</span>
<a name="ln-287"></a>        <span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-288"></a>    <span class="k">else</span>
<a name="ln-289"></a>        <span class="c">!Need to enlarge buffer. Reallocate and copy</span>
<a name="ln-290"></a>        <span class="k">deallocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">)</span>
<a name="ln-291"></a>        <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<a name="ln-292"></a>        <span class="n">this</span><span class="p">%</span><span class="n">buffer</span> <span class="o">=</span> <span class="nb">dble</span><span class="p">(</span><span class="n">other</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">))</span>
<a name="ln-293"></a>        <span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-294"></a>        <span class="n">this</span><span class="p">%</span><span class="n">len_max</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-295"></a>    <span class="k">end if</span>
<a name="ln-296"></a>
<a name="ln-297"></a><span class="k">    end subroutine</span>
<a name="ln-298"></a>
<a name="ln-299"></a><span class="c">!******************************************************************************</span>
<a name="ln-300"></a>
<a name="ln-301"></a><span class="c">!&gt; Returns the length of an *ivector*</span>
<a name="ln-302"></a><span class="k">function </span><span class="n">ivector_get_len</span><span class="p">(</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a name="ln-303"></a>
<a name="ln-304"></a>    <span class="k">class</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-305"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-306"></a>
<a name="ln-307"></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="nb">len</span>
<a name="ln-308"></a>
<a name="ln-309"></a><span class="nb">    </span><span class="k">end function</span>
<a name="ln-310"></a>
<a name="ln-311"></a><span class="c">!******************************************************************************</span>
<a name="ln-312"></a>
<a name="ln-313"></a><span class="c">!&gt; Returns the length of a *dvector*</span>
<a name="ln-314"></a><span class="k">function </span><span class="n">dvector_get_len</span><span class="p">(</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a name="ln-315"></a>
<a name="ln-316"></a>    <span class="k">class</span><span class="p">(</span><span class="n">dvector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-317"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-318"></a>
<a name="ln-319"></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="nb">len</span>
<a name="ln-320"></a>
<a name="ln-321"></a><span class="nb">    </span><span class="k">end function</span>
<a name="ln-322"></a>
<a name="ln-323"></a><span class="c">!******************************************************************************</span>
<a name="ln-324"></a>
<a name="ln-325"></a><span class="c">!&gt; Returns the ith element of an *ivector*.</span>
<a name="ln-326"></a><span class="k">function </span><span class="n">ivector_get_val</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a name="ln-327"></a>
<a name="ln-328"></a>    <span class="k">class</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-329"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-330"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-331"></a>
<a name="ln-332"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="n">this</span><span class="p">%</span><span class="nb">len</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-333"></a><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;error: out-of-bounds index &#39;</span><span class="p">,</span> <span class="n">i</span>
<a name="ln-334"></a>        <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;for ubound&#39;</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="nb">len</span>
<a name="ln-335"></a><span class="nb">        </span><span class="k">stop</span>
<a name="ln-336"></a><span class="k">    else</span>
<a name="ln-337"></a><span class="k">        </span><span class="n">res</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-338"></a>    <span class="k">end if</span>
<a name="ln-339"></a>
<a name="ln-340"></a><span class="k">    end function</span>
<a name="ln-341"></a>
<a name="ln-342"></a><span class="c">!******************************************************************************</span>
<a name="ln-343"></a>
<a name="ln-344"></a><span class="c">!&gt; Returns the ith element of a *dvector*.</span>
<a name="ln-345"></a><span class="k">function </span><span class="n">dvector_get_val</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a name="ln-346"></a>
<a name="ln-347"></a>    <span class="k">class</span><span class="p">(</span><span class="n">dvector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-348"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-349"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-350"></a>
<a name="ln-351"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="n">this</span><span class="p">%</span><span class="nb">len</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-352"></a><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;error: out-of-bounds index &#39;</span><span class="p">,</span> <span class="n">i</span>
<a name="ln-353"></a>        <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;for ubound&#39;</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="nb">len</span>
<a name="ln-354"></a><span class="nb">        </span><span class="k">stop</span>
<a name="ln-355"></a><span class="k">    else</span>
<a name="ln-356"></a><span class="k">        </span><span class="n">res</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-357"></a>    <span class="k">end if</span>
<a name="ln-358"></a>
<a name="ln-359"></a><span class="k">    end function</span>
<a name="ln-360"></a>
<a name="ln-361"></a><span class="c">!******************************************************************************</span>
<a name="ln-362"></a>
<a name="ln-363"></a><span class="c">!&gt; Sets the value of the ith element of an *ivector*. No bounds check is performed.</span>
<a name="ln-364"></a><span class="k">subroutine </span><span class="n">ivector_set_val</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
<a name="ln-365"></a>
<a name="ln-366"></a>    <span class="k">class</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-367"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-368"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">val</span>
<a name="ln-369"></a>
<a name="ln-370"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="n">this</span><span class="p">%</span><span class="nb">len</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-371"></a><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;error: out-of-bounds index &#39;</span><span class="p">,</span> <span class="n">i</span>
<a name="ln-372"></a>        <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;for ubound&#39;</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="nb">len</span>
<a name="ln-373"></a><span class="nb">        </span><span class="k">stop</span>
<a name="ln-374"></a><span class="k">    else</span>
<a name="ln-375"></a><span class="k">        </span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">val</span>
<a name="ln-376"></a>    <span class="k">end if</span>
<a name="ln-377"></a>
<a name="ln-378"></a><span class="k">    end subroutine</span>
<a name="ln-379"></a>
<a name="ln-380"></a><span class="c">!******************************************************************************</span>
<a name="ln-381"></a>
<a name="ln-382"></a><span class="c">!&gt; Sets the value of the ith element of a *dvector*. No bounds check is performed.</span>
<a name="ln-383"></a><span class="k">subroutine </span><span class="n">dvector_set_val</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
<a name="ln-384"></a>
<a name="ln-385"></a>    <span class="k">class</span><span class="p">(</span><span class="n">dvector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-386"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-387"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">val</span>
<a name="ln-388"></a>
<a name="ln-389"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="n">this</span><span class="p">%</span><span class="nb">len</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-390"></a><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;error: out-of-bounds index &#39;</span><span class="p">,</span> <span class="n">i</span>
<a name="ln-391"></a>        <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;for ubound&#39;</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="nb">len</span>
<a name="ln-392"></a><span class="nb">        </span><span class="k">stop</span>
<a name="ln-393"></a><span class="k">    else</span>
<a name="ln-394"></a><span class="k">        </span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">val</span>
<a name="ln-395"></a>    <span class="k">end if</span>
<a name="ln-396"></a>
<a name="ln-397"></a><span class="k">    end subroutine</span>
<a name="ln-398"></a>
<a name="ln-399"></a><span class="c">!******************************************************************************</span>
<a name="ln-400"></a>
<a name="ln-401"></a><span class="c">!&gt; Adds an element to the end of an *ivector*. Reallocation will take place if required.</span>
<a name="ln-402"></a><span class="k">subroutine </span><span class="n">ivector_append</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
<a name="ln-403"></a>
<a name="ln-404"></a>    <span class="k">class</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-405"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">val</span>
<a name="ln-406"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">temp</span>
<a name="ln-407"></a>
<a name="ln-408"></a>    <span class="c">!Double len_max if current length is equal to len_max</span>
<a name="ln-409"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">==</span> <span class="n">this</span><span class="p">%</span><span class="n">len_max</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-410"></a>
<a name="ln-411"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">temp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">this</span><span class="p">%</span><span class="n">len_max</span><span class="p">))</span>
<a name="ln-412"></a>        <span class="n">temp</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-413"></a>        <span class="n">temp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">this</span><span class="p">%</span><span class="nb">len</span><span class="p">)</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">this</span><span class="p">%</span><span class="nb">len</span><span class="p">)</span>
<a name="ln-414"></a>
<a name="ln-415"></a>        <span class="k">call </span><span class="nb">move_alloc</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">)</span>
<a name="ln-416"></a>        <span class="n">this</span><span class="p">%</span><span class="n">len_max</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">this</span><span class="p">%</span><span class="n">len_max</span>
<a name="ln-417"></a>
<a name="ln-418"></a>    <span class="k">end if</span>
<a name="ln-419"></a>
<a name="ln-420"></a><span class="k">    </span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="nb">len</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">val</span>
<a name="ln-421"></a>    <span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-422"></a>
<a name="ln-423"></a>    <span class="k">end subroutine</span>
<a name="ln-424"></a>
<a name="ln-425"></a><span class="c">!******************************************************************************</span>
<a name="ln-426"></a>
<a name="ln-427"></a><span class="c">!&gt; Adds an element to the end of a *dvector*. Reallocation will take place if required.</span>
<a name="ln-428"></a><span class="k">subroutine </span><span class="n">dvector_append</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
<a name="ln-429"></a>
<a name="ln-430"></a>    <span class="k">class</span><span class="p">(</span><span class="n">dvector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-431"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">val</span>
<a name="ln-432"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">temp</span>
<a name="ln-433"></a>
<a name="ln-434"></a>    <span class="c">!Double len_max if current length is equal to len_max</span>
<a name="ln-435"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">==</span> <span class="n">this</span><span class="p">%</span><span class="n">len_max</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-436"></a>
<a name="ln-437"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">temp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">this</span><span class="p">%</span><span class="n">len_max</span><span class="p">))</span>
<a name="ln-438"></a>        <span class="n">temp</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-439"></a>        <span class="n">temp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">this</span><span class="p">%</span><span class="nb">len</span><span class="p">)</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">this</span><span class="p">%</span><span class="nb">len</span><span class="p">)</span>
<a name="ln-440"></a>
<a name="ln-441"></a>        <span class="k">call </span><span class="nb">move_alloc</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">)</span>
<a name="ln-442"></a>        <span class="n">this</span><span class="p">%</span><span class="n">len_max</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">this</span><span class="p">%</span><span class="n">len_max</span>
<a name="ln-443"></a>
<a name="ln-444"></a>    <span class="k">end if</span>
<a name="ln-445"></a>
<a name="ln-446"></a><span class="k">    </span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="nb">len</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">val</span>
<a name="ln-447"></a>    <span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-448"></a>
<a name="ln-449"></a>    <span class="k">end subroutine</span>
<a name="ln-450"></a>
<a name="ln-451"></a><span class="c">!******************************************************************************</span>
<a name="ln-452"></a>
<a name="ln-453"></a><span class="c">!&gt; Returns a pointer to the underlying data of an *ivector*</span>
<a name="ln-454"></a><span class="c">! No bounds checking is performed</span>
<a name="ln-455"></a><span class="k">subroutine </span><span class="n">ivector_get_data</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">ibeg</span><span class="p">,</span> <span class="n">iend</span><span class="p">)</span>
<a name="ln-456"></a>
<a name="ln-457"></a>    <span class="k">class</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">),</span> <span class="k">target</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-458"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-459"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">ibeg</span>
<a name="ln-460"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">iend</span>
<a name="ln-461"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ibeg_</span>
<a name="ln-462"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iend_</span>
<a name="ln-463"></a>
<a name="ln-464"></a>    <span class="n">res</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-465"></a>    <span class="n">ibeg_</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-466"></a>    <span class="n">iend_</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="nb">len</span>
<a name="ln-467"></a>
<a name="ln-468"></a><span class="nb">    </span><span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">ibeg</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-469"></a><span class="k">        </span><span class="n">ibeg_</span> <span class="o">=</span> <span class="n">ibeg</span>
<a name="ln-470"></a>    <span class="k">end if</span>
<a name="ln-471"></a>
<a name="ln-472"></a><span class="k">    if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iend</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-473"></a><span class="k">        </span><span class="n">iend_</span> <span class="o">=</span> <span class="n">iend</span>
<a name="ln-474"></a>    <span class="k">end if</span>
<a name="ln-475"></a>
<a name="ln-476"></a><span class="k">    </span><span class="n">res</span> <span class="o">=&gt;</span> <span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="n">ibeg_</span><span class="p">:</span><span class="n">iend_</span><span class="p">)</span>
<a name="ln-477"></a>
<a name="ln-478"></a>    <span class="k">end subroutine</span>
<a name="ln-479"></a>
<a name="ln-480"></a><span class="c">!******************************************************************************</span>
<a name="ln-481"></a>
<a name="ln-482"></a><span class="c">!&gt; Returns a pointer to the underlying data of a *dvector*</span>
<a name="ln-483"></a><span class="c">! No bounds checking is performed</span>
<a name="ln-484"></a><span class="k">subroutine </span><span class="n">dvector_get_data</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">ibeg</span><span class="p">,</span> <span class="n">iend</span><span class="p">)</span>
<a name="ln-485"></a>
<a name="ln-486"></a>    <span class="k">class</span><span class="p">(</span><span class="n">dvector_t</span><span class="p">),</span> <span class="k">target</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-487"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-488"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">ibeg</span>
<a name="ln-489"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">iend</span>
<a name="ln-490"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ibeg_</span>
<a name="ln-491"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iend_</span>
<a name="ln-492"></a>
<a name="ln-493"></a>    <span class="n">res</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-494"></a>    <span class="n">ibeg_</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-495"></a>    <span class="n">iend_</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="nb">len</span>
<a name="ln-496"></a>
<a name="ln-497"></a><span class="nb">    </span><span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">ibeg</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-498"></a><span class="k">        </span><span class="n">ibeg_</span> <span class="o">=</span> <span class="n">ibeg</span>
<a name="ln-499"></a>    <span class="k">end if</span>
<a name="ln-500"></a>
<a name="ln-501"></a><span class="k">    if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iend</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-502"></a><span class="k">        </span><span class="n">iend_</span> <span class="o">=</span> <span class="n">iend</span>
<a name="ln-503"></a>    <span class="k">end if</span>
<a name="ln-504"></a>
<a name="ln-505"></a><span class="k">    </span><span class="n">res</span> <span class="o">=&gt;</span> <span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="n">ibeg_</span><span class="p">:</span><span class="n">iend_</span><span class="p">)</span>
<a name="ln-506"></a>
<a name="ln-507"></a>    <span class="k">end subroutine</span>
<a name="ln-508"></a>
<a name="ln-509"></a><span class="c">!******************************************************************************</span>
<a name="ln-510"></a>
<a name="ln-511"></a><span class="c">!&gt; Releases additional memory to fit underlying data of an *ivector* to a size</span>
<a name="ln-512"></a><span class="c">!&gt; this%len_init.</span>
<a name="ln-513"></a><span class="k">subroutine </span><span class="n">ivector_shrink_to_fit</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ierr</span><span class="p">)</span>
<a name="ln-514"></a>
<a name="ln-515"></a>    <span class="k">class</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-516"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-517"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">temp</span>
<a name="ln-518"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">istat</span>
<a name="ln-519"></a>
<a name="ln-520"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">ierr</span><span class="p">))</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-521"></a>
<a name="ln-522"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">&gt;</span> <span class="n">this</span><span class="p">%</span><span class="n">len_init</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-523"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">this</span><span class="p">%</span><span class="nb">len</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">istat</span><span class="p">)</span>
<a name="ln-524"></a>    <span class="k">else</span>
<a name="ln-525"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">temp</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">len_init</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">istat</span><span class="p">)</span>
<a name="ln-526"></a>        <span class="n">temp</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-527"></a>        <span class="n">temp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">this</span><span class="p">%</span><span class="nb">len</span><span class="p">)</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">this</span><span class="p">%</span><span class="nb">len</span><span class="p">)</span>
<a name="ln-528"></a>    <span class="k">end if</span>
<a name="ln-529"></a>
<a name="ln-530"></a><span class="k">    if</span> <span class="p">(</span><span class="n">istat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-531"></a><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;error: allocation failure for `temp` from `this%buffer`.&#39;</span>
<a name="ln-532"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">ierr</span><span class="p">))</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-533"></a>        <span class="k">return</span>
<a name="ln-534"></a><span class="k">    end if</span>
<a name="ln-535"></a>
<a name="ln-536"></a><span class="k">    call </span><span class="nb">move_alloc</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">)</span>
<a name="ln-537"></a>
<a name="ln-538"></a>    <span class="n">this</span><span class="p">%</span><span class="n">len_max</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">)</span>
<a name="ln-539"></a>
<a name="ln-540"></a>    <span class="k">end subroutine</span>
<a name="ln-541"></a>
<a name="ln-542"></a><span class="c">!******************************************************************************</span>
<a name="ln-543"></a>
<a name="ln-544"></a><span class="c">!&gt; Releases additional memory to fit underlying data of a *dvector* to a size</span>
<a name="ln-545"></a><span class="c">!&gt; this%len_init.</span>
<a name="ln-546"></a><span class="k">subroutine </span><span class="n">dvector_shrink_to_fit</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">ierr</span><span class="p">)</span>
<a name="ln-547"></a>
<a name="ln-548"></a>    <span class="k">class</span><span class="p">(</span><span class="n">dvector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-549"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-550"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">temp</span>
<a name="ln-551"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">istat</span>
<a name="ln-552"></a>
<a name="ln-553"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">ierr</span><span class="p">))</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-554"></a>
<a name="ln-555"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">&gt;</span> <span class="n">this</span><span class="p">%</span><span class="n">len_init</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-556"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">this</span><span class="p">%</span><span class="nb">len</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">istat</span><span class="p">)</span>
<a name="ln-557"></a>    <span class="k">else</span>
<a name="ln-558"></a><span class="k">        allocate</span><span class="p">(</span><span class="n">temp</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">len_init</span><span class="p">),</span> <span class="nb">stat</span><span class="o">=</span><span class="n">istat</span><span class="p">)</span>
<a name="ln-559"></a>        <span class="n">temp</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-560"></a>        <span class="n">temp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">this</span><span class="p">%</span><span class="nb">len</span><span class="p">)</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">this</span><span class="p">%</span><span class="nb">len</span><span class="p">)</span>
<a name="ln-561"></a>    <span class="k">end if</span>
<a name="ln-562"></a>
<a name="ln-563"></a><span class="k">    if</span> <span class="p">(</span><span class="n">istat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-564"></a><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;error: allocation failure for `temp` from `this%buffer`.&#39;</span>
<a name="ln-565"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">ierr</span><span class="p">))</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-566"></a>        <span class="k">return</span>
<a name="ln-567"></a><span class="k">    end if</span>
<a name="ln-568"></a>
<a name="ln-569"></a><span class="k">    call </span><span class="nb">move_alloc</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">)</span>
<a name="ln-570"></a>
<a name="ln-571"></a>    <span class="n">this</span><span class="p">%</span><span class="n">len_max</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">)</span>
<a name="ln-572"></a>
<a name="ln-573"></a>    <span class="k">end subroutine</span>
<a name="ln-574"></a>
<a name="ln-575"></a><span class="c">!******************************************************************************</span>
<a name="ln-576"></a>
<a name="ln-577"></a><span class="c">!&gt;  Sorts an *ivector* in ascending order. If `order` is provided, it will contain</span>
<a name="ln-578"></a><span class="c">!!  the sorted indices.  The size of `order` must be at least `this%len`.</span>
<a name="ln-579"></a><span class="k">subroutine </span><span class="n">ivector_sort</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
<a name="ln-580"></a>
<a name="ln-581"></a>    <span class="k">class</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-582"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">order</span>
<a name="ln-583"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span>
<a name="ln-584"></a>
<a name="ln-585"></a>    <span class="n">n</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="nb">len</span>
<a name="ln-586"></a><span class="nb">    </span><span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-587"></a><span class="k">        if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">order</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-588"></a><span class="k">            call </span><span class="n">iqsort</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">),</span> <span class="n">order</span><span class="p">)</span>
<a name="ln-589"></a>        <span class="k">else</span>
<a name="ln-590"></a><span class="k">            call </span><span class="n">iqsort</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">))</span>
<a name="ln-591"></a>        <span class="k">end if</span>
<a name="ln-592"></a><span class="k">    end if</span>
<a name="ln-593"></a>
<a name="ln-594"></a><span class="k">    end subroutine</span>
<a name="ln-595"></a>
<a name="ln-596"></a><span class="c">!******************************************************************************</span>
<a name="ln-597"></a>
<a name="ln-598"></a><span class="c">!&gt;  Sorts a *dvector* in ascending order. If `order` is provided, it will contain</span>
<a name="ln-599"></a><span class="c">!!  the sorted indices.  The size of `order` must be at least `this%len`.</span>
<a name="ln-600"></a><span class="k">subroutine </span><span class="n">dvector_sort</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
<a name="ln-601"></a>
<a name="ln-602"></a>    <span class="k">class</span><span class="p">(</span><span class="n">dvector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-603"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">order</span>
<a name="ln-604"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span>
<a name="ln-605"></a>
<a name="ln-606"></a>    <span class="n">n</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="nb">len</span>
<a name="ln-607"></a><span class="nb">    </span><span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-608"></a><span class="k">        if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">order</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-609"></a><span class="k">            call </span><span class="n">dqsort</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">),</span> <span class="n">order</span><span class="p">)</span>
<a name="ln-610"></a>        <span class="k">else</span>
<a name="ln-611"></a><span class="k">            call </span><span class="n">dqsort</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">))</span>
<a name="ln-612"></a>        <span class="k">end if</span>
<a name="ln-613"></a><span class="k">    end if</span>
<a name="ln-614"></a>
<a name="ln-615"></a><span class="k">    end subroutine</span>
<a name="ln-616"></a>
<a name="ln-617"></a><span class="c">!******************************************************************************</span>
<a name="ln-618"></a>
<a name="ln-619"></a><span class="c">!&gt; Sorts and removes all duplicate entries of an *ivector*. Note that the internal</span>
<a name="ln-620"></a><span class="c">!! buffer size remains unchanged. To reduce the buffer size, call</span>
<a name="ln-621"></a><span class="c">!! `ivector_shrink_to_fit`.</span>
<a name="ln-622"></a><span class="k">subroutine </span><span class="n">ivector_unique</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-623"></a>
<a name="ln-624"></a>    <span class="k">class</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-625"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="nb">len</span><span class="p">)</span> <span class="kd">::</span> <span class="n">temp</span>
<a name="ln-626"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span>
<a name="ln-627"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-628"></a>
<a name="ln-629"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">return</span> <span class="c">!Already sorted</span>
<a name="ln-630"></a>
<a name="ln-631"></a>    <span class="n">temp</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">this</span><span class="p">%</span><span class="nb">len</span><span class="p">)</span>
<a name="ln-632"></a>
<a name="ln-633"></a>    <span class="k">call </span><span class="n">iqsort</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
<a name="ln-634"></a>
<a name="ln-635"></a>    <span class="c">!The first element is unique by default</span>
<a name="ln-636"></a>    <span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-637"></a>    <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-638"></a>    <span class="c">!Successively copy non-duplicate elements</span>
<a name="ln-639"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="nb">len</span>
<a name="ln-640"></a><span class="nb">        </span><span class="k">if</span> <span class="p">(</span><span class="n">temp</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">/=</span> <span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-641"></a><span class="k">            </span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-642"></a>            <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-643"></a>        <span class="k">end if</span>
<a name="ln-644"></a><span class="k">    end do</span>
<a name="ln-645"></a>
<a name="ln-646"></a>    <span class="c">!Set the length to number of unique elements</span>
<a name="ln-647"></a>    <span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-648"></a>
<a name="ln-649"></a>    <span class="k">end subroutine</span>
<a name="ln-650"></a>
<a name="ln-651"></a><span class="c">!******************************************************************************</span>
<a name="ln-652"></a>
<a name="ln-653"></a><span class="c">!&gt; Sorts and removes all duplicate entries of a *dvector*. Note that the internal</span>
<a name="ln-654"></a><span class="c">!! buffer size remains unchanged. To reduce the buffer size, call</span>
<a name="ln-655"></a><span class="c">!! `dvector_shrink_to_fit`.</span>
<a name="ln-656"></a><span class="k">subroutine </span><span class="n">dvector_unique</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-657"></a>
<a name="ln-658"></a>    <span class="k">class</span><span class="p">(</span><span class="n">dvector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-659"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="nb">len</span><span class="p">)</span> <span class="kd">::</span> <span class="n">temp</span>
<a name="ln-660"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span>
<a name="ln-661"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-662"></a>
<a name="ln-663"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">return</span> <span class="c">!Already sorted</span>
<a name="ln-664"></a>
<a name="ln-665"></a>    <span class="n">temp</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">buffer</span>
<a name="ln-666"></a>
<a name="ln-667"></a>    <span class="k">call </span><span class="n">dqsort</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
<a name="ln-668"></a>
<a name="ln-669"></a>    <span class="c">!The first element is unique by default</span>
<a name="ln-670"></a>    <span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-671"></a>    <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-672"></a>    <span class="c">!Successively copy non-duplicate elements</span>
<a name="ln-673"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="nb">len</span>
<a name="ln-674"></a><span class="nb">        </span><span class="k">if</span> <span class="p">(</span><span class="n">temp</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">/=</span> <span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-675"></a><span class="k">            </span><span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-676"></a>            <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-677"></a>        <span class="k">end if</span>
<a name="ln-678"></a><span class="k">    end do</span>
<a name="ln-679"></a>
<a name="ln-680"></a>    <span class="c">!Set the length to number of unique elements</span>
<a name="ln-681"></a>    <span class="n">this</span><span class="p">%</span><span class="nb">len</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-682"></a>
<a name="ln-683"></a>    <span class="k">end subroutine</span>
<a name="ln-684"></a>
<a name="ln-685"></a><span class="c">!******************************************************************************</span>
<a name="ln-686"></a>
<a name="ln-687"></a><span class="c">!&gt; Prints an *ivector*</span>
<a name="ln-688"></a><span class="k">subroutine </span><span class="n">ivector_print</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-689"></a>
<a name="ln-690"></a>    <span class="k">class</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-691"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-692"></a>
<a name="ln-693"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="nb">len</span>
<a name="ln-694"></a><span class="nb">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(i0,1x,i0)&#39;</span><span class="p">)</span> <span class="n">i</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-695"></a>    <span class="k">end do</span>
<a name="ln-696"></a><span class="k">    </span>
<a name="ln-697"></a><span class="k">    end subroutine</span>
<a name="ln-698"></a>
<a name="ln-699"></a><span class="c">!******************************************************************************</span>
<a name="ln-700"></a>
<a name="ln-701"></a><span class="c">!&gt; Prints a *dvector*</span>
<a name="ln-702"></a><span class="k">subroutine </span><span class="n">dvector_print</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-703"></a>
<a name="ln-704"></a>    <span class="k">class</span><span class="p">(</span><span class="n">dvector_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-705"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-706"></a>
<a name="ln-707"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="nb">len</span>
<a name="ln-708"></a><span class="nb">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(i0,1x,f0.15)&#39;</span><span class="p">)</span> <span class="n">i</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="n">buffer</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-709"></a>    <span class="k">end do</span>
<a name="ln-710"></a><span class="k">    </span>
<a name="ln-711"></a><span class="k">    end subroutine</span>
<a name="ln-712"></a>
<a name="ln-713"></a><span class="c">!******************************************************************************</span>
<a name="ln-714"></a>
<a name="ln-715"></a><span class="k">end module </span><span class="n">m_vector</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> BROWNPAK was developed by Sarit Dutta</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>