<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for BROWNPAK">
   
    <meta name="author" content="Sarit Dutta" >
    <link rel="icon" href="../favicon.png">

    <title>pairtab_m.fpp &ndash; BROWNPAK</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">BROWNPAK <small>0.7</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
    <li><a href="../blockdata/nitbd.html">Block Data</a></li>
    
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../blockdata/nitbd.html">Block Data</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>pairtab_m.fpp
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 2.9% of total for source files.">249 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/pairtab_m.fpp"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">pairtab_m.fpp</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/pairtab_m.html">pairtab_m</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/pairtab_m.fpp.html#src">pairtab_m.fpp</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~pairtab_m.fpp~~EfferentGraph Pages: 1 -->
<svg id="sourcefilepairtab_mfppEfferentGraph" width="641pt" height="255pt"
 viewBox="0.00 0.00 641.00 255.37" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph" class="graph" transform="scale(.9183 .9183) rotate(0) translate(4 274.0792)">
<title>sourcefile~~pairtab_m.fpp~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-274.0792 694,-274.0792 694,4 -4,4"/>
<!-- sourcefile~pairtab_m.fpp -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_node1" class="node">
<title>sourcefile~pairtab_m.fpp</title>
<polygon fill="none" stroke="#000000" points="690,-196.6118 613,-196.6118 613,-172.6118 690,-172.6118 690,-196.6118"/>
<text text-anchor="middle" x="651.5" y="-182.2118" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">pairtab_m.fpp</text>
</g>
<!-- sourcefile~table_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_node2" class="node">
<title>sourcefile~table_m.f90</title>
<g id="a_sourcefile~~pairtab_m.fpp~~EfferentGraph_node2"><a xlink:href=".././sourcefile/table_m.f90.html" xlink:title="table_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="432.5,-236.6118 365.5,-236.6118 365.5,-212.6118 432.5,-212.6118 432.5,-236.6118"/>
<text text-anchor="middle" x="399" y="-222.2118" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">table_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~table_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge1" class="edge">
<title>sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~table_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M612.6655,-187.1811C577.3408,-189.9162 523.873,-195.0535 478,-203.6118 466.3467,-205.7859 453.8872,-208.7771 442.3884,-211.8206"/>
<polygon fill="#ff0000" stroke="#ff0000" points="441.3061,-208.4877 432.5751,-214.4894 443.1431,-215.2424 441.3061,-208.4877"/>
</g>
<!-- sourcefile~atmcfg_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_node3" class="node">
<title>sourcefile~atmcfg_m.f90</title>
<g id="a_sourcefile~~pairtab_m.fpp~~EfferentGraph_node3"><a xlink:href=".././sourcefile/atmcfg_m.f90.html" xlink:title="atmcfg_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="565.5,-236.6118 489.5,-236.6118 489.5,-212.6118 565.5,-212.6118 565.5,-236.6118"/>
<text text-anchor="middle" x="527.5" y="-222.2118" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">atmcfg_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~atmcfg_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge2" class="edge">
<title>sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~atmcfg_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M614.2959,-196.6131C601.9032,-200.6108 587.928,-205.1189 574.8709,-209.3309"/>
<polygon fill="#ff0000" stroke="#ff0000" points="573.549,-206.0796 565.1064,-212.4807 575.698,-212.7416 573.549,-206.0796"/>
</g>
<!-- sourcefile~connectivity_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_node4" class="node">
<title>sourcefile~connectivity_m.f90</title>
<g id="a_sourcefile~~pairtab_m.fpp~~EfferentGraph_node4"><a xlink:href=".././sourcefile/connectivity_m.f90.html" xlink:title="connectivity_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="577,-156.6118 478,-156.6118 478,-132.6118 577,-132.6118 577,-156.6118"/>
<text text-anchor="middle" x="527.5" y="-142.2118" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">connectivity_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~connectivity_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge3" class="edge">
<title>sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~connectivity_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M614.2959,-172.6105C601.9032,-168.6128 587.928,-164.1047 574.8709,-159.8928"/>
<polygon fill="#ff0000" stroke="#ff0000" points="575.698,-156.482 565.1064,-156.7429 573.549,-163.144 575.698,-156.482"/>
</g>
<!-- sourcefile~aabbtree_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_node5" class="node">
<title>sourcefile~aabbtree_m.f90</title>
<g id="a_sourcefile~~pairtab_m.fpp~~EfferentGraph_node5"><a xlink:href=".././sourcefile/aabbtree_m.f90.html" xlink:title="aabbtree_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="442,-38.6118 356,-38.6118 356,-14.6118 442,-14.6118 442,-38.6118"/>
<text text-anchor="middle" x="399" y="-24.2118" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">aabbtree_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~aabbtree_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge4" class="edge">
<title>sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~aabbtree_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M527.5,-104.6118C485.8137,-89.1078 480.0298,-75.6738 442,-52.6118 437.4544,-49.8553 432.6364,-46.9379 427.9332,-44.0923"/>
<polygon fill="#ff0000" stroke="#ff0000" points="429.5004,-40.9499 419.1322,-38.7701 425.8781,-46.9398 429.5004,-40.9499"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M639.2474,-172.4634C625.1961,-159.0618 600.9942,-137.5513 577,-123.6118 556.624,-111.7743 549.5869,-112.8264 527.5,-104.6118"/>
</g>
<!-- sourcefile~constants_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_node6" class="node">
<title>sourcefile~constants_m.f90</title>
<g id="a_sourcefile~~pairtab_m.fpp~~EfferentGraph_node6"><a xlink:href=".././sourcefile/constants_m.f90.html" xlink:title="constants_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="90,-136.6118 0,-136.6118 0,-112.6118 90,-112.6118 90,-136.6118"/>
<text text-anchor="middle" x="45" y="-122.2118" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">constants_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge5" class="edge">
<title>sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M641.0361,-196.6722C627.7524,-211.0688 603.3707,-234.5799 577,-245.6118 503.6032,-276.3167 478.265,-271.4624 399,-264.6118"/>
</g>
<!-- sourcefile~cell_list_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_node7" class="node">
<title>sourcefile~cell_list_m.f90</title>
<g id="a_sourcefile~~pairtab_m.fpp~~EfferentGraph_node7"><a xlink:href=".././sourcefile/cell_list_m.f90.html" xlink:title="cell_list_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="438.5,-118.6118 359.5,-118.6118 359.5,-94.6118 438.5,-94.6118 438.5,-118.6118"/>
<text text-anchor="middle" x="399" y="-104.2118" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">cell_list_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~cell_list_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge6" class="edge">
<title>sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~cell_list_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M527.5,-104.6118C502.706,-95.3904 473.3154,-95.1395 448.9042,-97.5279"/>
<polygon fill="#ff0000" stroke="#ff0000" points="448.3087,-94.0732 438.775,-98.6946 449.1098,-101.0273 448.3087,-94.0732"/>
</g>
<!-- sourcefile~simbox_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_node8" class="node">
<title>sourcefile~simbox_m.f90</title>
<g id="a_sourcefile~~pairtab_m.fpp~~EfferentGraph_node8"><a xlink:href=".././sourcefile/simbox_m.f90.html" xlink:title="simbox_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="320,-116.6118 242,-116.6118 242,-92.6118 320,-92.6118 320,-116.6118"/>
<text text-anchor="middle" x="281" y="-102.2118" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">simbox_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~simbox_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge7" class="edge">
<title>sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~simbox_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M527.5,-104.6118C455.7242,-77.6049 432.0992,-76.1225 356,-85.6118 347.5695,-86.6631 338.7265,-88.3547 330.1896,-90.3061"/>
<polygon fill="#ff0000" stroke="#ff0000" points="329.2442,-86.9338 320.3515,-92.6934 330.8949,-93.7364 329.2442,-86.9338"/>
</g>
<!-- sourcefile~vector_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_node9" class="node">
<title>sourcefile~vector_m.f90</title>
<g id="a_sourcefile~~pairtab_m.fpp~~EfferentGraph_node9"><a xlink:href=".././sourcefile/vector_m.f90.html" xlink:title="vector_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="317.5,-196.6118 244.5,-196.6118 244.5,-172.6118 317.5,-172.6118 317.5,-196.6118"/>
<text text-anchor="middle" x="281" y="-182.2118" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">vector_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~vector_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge8" class="edge">
<title>sourcefile~pairtab_m.fpp&#45;&gt;sourcefile~vector_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M527.5,-104.6118C517.7028,-100.968 392.2024,-144.7827 324.167,-169.0656"/>
<polygon fill="#ff0000" stroke="#ff0000" points="322.8042,-165.8358 314.5666,-172.4986 325.1612,-172.4271 322.8042,-165.8358"/>
</g>
<!-- sourcefile~table_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge10" class="edge">
<title>sourcefile~table_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M365.4305,-224.6118C341.8167,-224.6118 309.4757,-224.6118 281,-224.6118"/>
</g>
<!-- sourcefile~table_m.f90&#45;&gt;sourcefile~vector_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge9" class="edge">
<title>sourcefile~table_m.f90&#45;&gt;sourcefile~vector_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M365.1859,-213.1494C353.0295,-209.0286 339.117,-204.3125 326.1504,-199.917"/>
<polygon fill="#ff0000" stroke="#ff0000" points="327.0582,-196.5292 316.4639,-196.6335 324.8109,-203.1587 327.0582,-196.5292"/>
</g>
<!-- sourcefile~atmcfg_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge11" class="edge">
<title>sourcefile~atmcfg_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M399,-264.6118C343.83,-259.8437 336.3757,-224.6118 281,-224.6118"/>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M506.25,-236.7401C481.2266,-249.7089 438.1072,-267.9917 399,-264.6118"/>
</g>
<!-- sourcefile~connectivity_m.f90&#45;&gt;sourcefile~table_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge12" class="edge">
<title>sourcefile~connectivity_m.f90&#45;&gt;sourcefile~table_m.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M502.3356,-156.7326C494.3819,-160.8517 485.6705,-165.6699 478,-170.6118 460.9605,-181.59 458.7014,-187.1259 442,-198.6118 437.9028,-201.4296 433.4984,-204.2815 429.1267,-207.0127"/>
<polygon fill="#7fff00" stroke="#7fff00" points="427.0172,-204.1999 420.3079,-212.3997 430.6663,-210.1735 427.0172,-204.1999"/>
</g>
<!-- sourcefile~connectivity_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge14" class="edge">
<title>sourcefile~connectivity_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M399,-184.6118C345.1442,-197.4968 336.3757,-224.6118 281,-224.6118"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M281,-224.6118C229.8889,-224.6118 215.4033,-237.7137 166,-224.6118"/>
</g>
<!-- sourcefile~connectivity_m.f90&#45;&gt;sourcefile~vector_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge13" class="edge">
<title>sourcefile~connectivity_m.f90&#45;&gt;sourcefile~vector_m.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M399,-184.6118C375.9522,-190.126 349.6394,-190.6568 327.7184,-189.5819"/>
<polygon fill="#7fff00" stroke="#7fff00" points="327.8603,-186.0841 317.6644,-188.9638 327.4307,-193.0709 327.8603,-186.0841"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M493.216,-156.6594C467.5285,-165.3483 431.3811,-176.8646 399,-184.6118"/>
</g>
<!-- sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge18" class="edge">
<title>sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M355.7245,-37.9541C344.1727,-40.7251 331.6592,-43.4975 320,-45.6118 252.1433,-57.9169 231.5431,-43.163 166,-64.6118"/>
</g>
<!-- sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~vector_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge17" class="edge">
<title>sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~vector_m.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M389.9367,-38.7475C369.8234,-65.6788 321.2698,-130.6913 296.3378,-164.0748"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="293.4365,-162.1104 290.257,-172.2169 299.045,-166.2991 293.4365,-162.1104"/>
</g>
<!-- sourcefile~aabb_m.fpp -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_node10" class="node">
<title>sourcefile~aabb_m.fpp</title>
<g id="a_sourcefile~~pairtab_m.fpp~~EfferentGraph_node10"><a xlink:href=".././sourcefile/aabb_m.fpp.html" xlink:title="aabb_m.fpp">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="315,-36.6118 247,-36.6118 247,-12.6118 315,-12.6118 315,-36.6118"/>
<text text-anchor="middle" x="281" y="-22.2118" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">aabb_m.fpp</text>
</a>
</g>
</g>
<!-- sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~aabb_m.fpp -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge15" class="edge">
<title>sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~aabb_m.fpp</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M355.7312,-25.8784C345.7723,-25.7097 335.1684,-25.5299 325.1718,-25.3605"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="325.0845,-21.8586 315.0266,-25.1885 324.9658,-28.8576 325.0845,-21.8586"/>
</g>
<!-- sourcefile~strings_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_node13" class="node">
<title>sourcefile~strings_m.f90</title>
<g id="a_sourcefile~~pairtab_m.fpp~~EfferentGraph_node13"><a xlink:href=".././sourcefile/strings_m.f90.html" xlink:title="strings_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="204,-36.6118 128,-36.6118 128,-12.6118 204,-12.6118 204,-36.6118"/>
<text text-anchor="middle" x="166" y="-22.2118" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">strings_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~strings_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge16" class="edge">
<title>sourcefile~aabbtree_m.f90&#45;&gt;sourcefile~strings_m.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M365.2444,-14.5002C351.4152,-10.1418 335.1316,-5.7697 320,-3.6118 285.6806,1.2824 276.3522,1.0469 242,-3.6118 232.0299,-4.9639 221.5201,-7.2707 211.6022,-9.8725"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="210.6294,-6.5101 201.9236,-12.5482 212.4947,-13.257 210.6294,-6.5101"/>
</g>
<!-- sourcefile~cell_list_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge21" class="edge">
<title>sourcefile~cell_list_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M359.3284,-116.9929C313.2138,-128.1449 234.6507,-144.3241 166,-144.6118"/>
</g>
<!-- sourcefile~cell_list_m.f90&#45;&gt;sourcefile~simbox_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge19" class="edge">
<title>sourcefile~cell_list_m.f90&#45;&gt;sourcefile~simbox_m.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M359.3794,-105.9403C350.1357,-105.7836 340.1779,-105.6148 330.5634,-105.4519"/>
<polygon fill="#003fff" stroke="#003fff" points="330.3733,-101.9482 320.3154,-105.2782 330.2546,-108.9472 330.3733,-101.9482"/>
</g>
<!-- sourcefile~cell_list_m.f90&#45;&gt;sourcefile~vector_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge20" class="edge">
<title>sourcefile~cell_list_m.f90&#45;&gt;sourcefile~vector_m.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M378.2269,-118.7063C371.1017,-122.9772 363.1293,-127.8933 356,-132.6118 339.5417,-143.5047 336.2137,-147.3581 320,-158.6118 316.1352,-161.2943 312.027,-164.0912 307.9825,-166.814"/>
<polygon fill="#003fff" stroke="#003fff" points="305.7189,-164.117 299.3491,-172.5832 309.6082,-169.9371 305.7189,-164.117"/>
</g>
<!-- sourcefile~simbox_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge23" class="edge">
<title>sourcefile~simbox_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M259.7224,-116.7724C237.2,-128.4883 200.2441,-144.4683 166,-144.6118"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M166,-144.6118C144.2258,-144.7031 120.5389,-141.5298 99.9422,-137.6857"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="100.5878,-134.2457 90.1012,-135.756 99.2408,-141.1149 100.5878,-134.2457"/>
</g>
<!-- sourcefile~random_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_node11" class="node">
<title>sourcefile~random_m.f90</title>
<g id="a_sourcefile~~pairtab_m.fpp~~EfferentGraph_node11"><a xlink:href=".././sourcefile/random_m.f90.html" xlink:title="random_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="206,-116.6118 126,-116.6118 126,-92.6118 206,-92.6118 206,-116.6118"/>
<text text-anchor="middle" x="166" y="-102.2118" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">random_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simbox_m.f90&#45;&gt;sourcefile~random_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge22" class="edge">
<title>sourcefile~simbox_m.f90&#45;&gt;sourcefile~random_m.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M241.7452,-104.6118C233.6036,-104.6118 224.9176,-104.6118 216.4394,-104.6118"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="216.2517,-101.1119 206.2517,-104.6118 216.2517,-108.1119 216.2517,-101.1119"/>
</g>
<!-- sourcefile~vector_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge25" class="edge">
<title>sourcefile~vector_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M264.863,-196.6832C242.8309,-211.6661 201.9607,-234.1487 166,-224.6118"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M166,-224.6118C119.8502,-212.3728 80.1966,-170.0511 59.7618,-144.5533"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="62.4907,-142.3611 53.5869,-136.619 56.9665,-146.6603 62.4907,-142.3611"/>
</g>
<!-- sourcefile~qsort_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_node12" class="node">
<title>sourcefile~qsort_m.f90</title>
<g id="a_sourcefile~~pairtab_m.fpp~~EfferentGraph_node12"><a xlink:href=".././sourcefile/qsort_m.f90.html" xlink:title="qsort_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="200,-196.6118 132,-196.6118 132,-172.6118 200,-172.6118 200,-196.6118"/>
<text text-anchor="middle" x="166" y="-182.2118" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">qsort_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~vector_m.f90&#45;&gt;sourcefile~qsort_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge24" class="edge">
<title>sourcefile~vector_m.f90&#45;&gt;sourcefile~qsort_m.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M244.2971,-184.6118C233.4264,-184.6118 221.4096,-184.6118 210.1212,-184.6118"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="210.0128,-181.1119 200.0128,-184.6118 210.0127,-188.1119 210.0128,-181.1119"/>
</g>
<!-- sourcefile~aabb_m.fpp&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge27" class="edge">
<title>sourcefile~aabb_m.fpp&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M166,-64.6118C132.9487,-75.4278 97.5811,-93.8499 73.6744,-107.4346"/>
<polygon fill="#ff0000" stroke="#ff0000" points="71.7045,-104.5304 64.7921,-112.5597 75.2029,-110.5935 71.7045,-104.5304"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M247.3963,-36.6672C224.5234,-44.7824 193.5235,-55.6048 166,-64.6118"/>
</g>
<!-- sourcefile~aabb_m.fpp&#45;&gt;sourcefile~strings_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge26" class="edge">
<title>sourcefile~aabb_m.fpp&#45;&gt;sourcefile~strings_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M246.8076,-24.6118C236.6725,-24.6118 225.3744,-24.6118 214.5148,-24.6118"/>
<polygon fill="#ff0000" stroke="#ff0000" points="214.2896,-21.1119 204.2896,-24.6118 214.2896,-28.1119 214.2896,-21.1119"/>
</g>
<!-- sourcefile~random_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge28" class="edge">
<title>sourcefile~random_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M125.7088,-111.2715C117.5063,-112.6273 108.7438,-114.0756 100.1279,-115.4998"/>
<polygon fill="#7fff00" stroke="#7fff00" points="99.4185,-112.0695 90.1231,-117.1534 100.5601,-118.9757 99.4185,-112.0695"/>
</g>
<!-- sourcefile~qsort_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge29" class="edge">
<title>sourcefile~qsort_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M141.5138,-172.4699C123.391,-163.4834 98.4895,-151.1356 78.5199,-141.2333"/>
<polygon fill="#00ffff" stroke="#00ffff" points="79.9637,-138.0425 69.4497,-136.7357 76.8539,-144.3139 79.9637,-138.0425"/>
</g>
<!-- sourcefile~strings_m.f90&#45;&gt;sourcefile~constants_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~EfferentGraph_edge30" class="edge">
<title>sourcefile~strings_m.f90&#45;&gt;sourcefile~constants_m.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M146.0269,-36.6847C139.487,-40.875 132.2896,-45.7473 126,-50.6118 103.7292,-67.8365 80.1724,-89.8406 64.2394,-105.3626"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="61.7461,-102.9057 57.0692,-112.4124 66.6537,-107.8972 61.7461,-102.9057"/>
</g>
</g>
</svg>
</div><script>var pansourcefilepairtab_mfppEfferentGraph = svgPanZoom('#sourcefilepairtab_mfppEfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~pairtab_m.fpp~~AfferentGraph Pages: 1 -->
<svg id="sourcefilepairtab_mfppAfferentGraph" width="536pt" height="52pt"
 viewBox="0.00 0.00 536.00 52.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~pairtab_m.fpp~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 48)">
<title>sourcefile~~pairtab_m.fpp~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-48 532,-48 532,4 -4,4"/>
<!-- sourcefile~pairtab_m.fpp -->
<g id="sourcefile~~pairtab_m.fpp~~AfferentGraph_node1" class="node">
<title>sourcefile~pairtab_m.fpp</title>
<polygon fill="none" stroke="#000000" points="77,-44 0,-44 0,-20 77,-20 77,-44"/>
<text text-anchor="middle" x="38.5" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">pairtab_m.fpp</text>
</g>
<!-- sourcefile~interaction_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~AfferentGraph_node2" class="node">
<title>sourcefile~interaction_m.f90</title>
<g id="a_sourcefile~~pairtab_m.fpp~~AfferentGraph_node2"><a xlink:href=".././sourcefile/interaction_m.f90.html" xlink:title="interaction_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="206,-44 113,-44 113,-20 206,-20 206,-44"/>
<text text-anchor="middle" x="159.5" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">interaction_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~interaction_m.f90&#45;&gt;sourcefile~pairtab_m.fpp -->
<g id="sourcefile~~pairtab_m.fpp~~AfferentGraph_edge1" class="edge">
<title>sourcefile~interaction_m.f90&#45;&gt;sourcefile~pairtab_m.fpp</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M112.7182,-32C104.3971,-32 95.7105,-32 87.334,-32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="87.3157,-28.5001 77.3157,-32 87.3157,-35.5001 87.3157,-28.5001"/>
</g>
<!-- sourcefile~setup_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~AfferentGraph_node3" class="node">
<title>sourcefile~setup_m.f90</title>
<g id="a_sourcefile~~pairtab_m.fpp~~AfferentGraph_node3"><a xlink:href=".././sourcefile/setup_m.f90.html" xlink:title="setup_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="438,-44 368,-44 368,-20 438,-20 438,-44"/>
<text text-anchor="middle" x="403" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">setup_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~setup_m.f90&#45;&gt;sourcefile~interaction_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~AfferentGraph_edge2" class="edge">
<title>sourcefile~setup_m.f90&#45;&gt;sourcefile~interaction_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M367.9715,-32.5912C356.5076,-32.7586 343.7109,-32.9175 332,-33 292.001,-33.2817 281.9993,-33.2424 242,-33 233.6609,-32.9495 224.848,-32.8702 216.2079,-32.7779"/>
<polygon fill="#ff0000" stroke="#ff0000" points="216.2225,-29.2779 206.1835,-32.6644 216.1432,-36.2775 216.2225,-29.2779"/>
</g>
<!-- sourcefile~bd_solver_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~AfferentGraph_node4" class="node">
<title>sourcefile~bd_solver_m.f90</title>
<g id="a_sourcefile~~pairtab_m.fpp~~AfferentGraph_node4"><a xlink:href=".././sourcefile/bd_solver_m.f90.html" xlink:title="bd_solver_m.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="332,-24 242,-24 242,0 332,0 332,-24"/>
<text text-anchor="middle" x="287" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">bd_solver_m.f90</text>
</a>
</g>
</g>
<!-- sourcefile~setup_m.f90&#45;&gt;sourcefile~bd_solver_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~AfferentGraph_edge5" class="edge">
<title>sourcefile~setup_m.f90&#45;&gt;sourcefile~bd_solver_m.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M367.8814,-25.9451C359.8294,-24.5568 351.0767,-23.0477 342.4017,-21.552"/>
<polygon fill="#00ffff" stroke="#00ffff" points="342.7496,-18.0604 332.3003,-19.8104 341.5602,-24.9586 342.7496,-18.0604"/>
</g>
<!-- sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~interaction_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~AfferentGraph_edge3" class="edge">
<title>sourcefile~bd_solver_m.f90&#45;&gt;sourcefile~interaction_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M241.6893,-19.1076C233.5474,-20.3847 224.9666,-21.7307 216.5436,-23.052"/>
<polygon fill="#ff0000" stroke="#ff0000" points="215.7247,-19.6376 206.3879,-24.645 216.8095,-26.553 215.7247,-19.6376"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~AfferentGraph_node5" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~pairtab_m.fpp~~AfferentGraph_node5"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="528,-44 474,-44 474,-20 528,-20 528,-44"/>
<text text-anchor="middle" x="501" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~setup_m.f90 -->
<g id="sourcefile~~pairtab_m.fpp~~AfferentGraph_edge4" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~setup_m.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M473.9616,-32C465.9804,-32 457.0189,-32 448.2209,-32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="448.0365,-28.5001 438.0365,-32 448.0364,-35.5001 448.0365,-28.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/pairtab_m.html">pairtab_m</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/pairtab_m.fpp.html#src">pairtab_m.fpp</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="cp">#: include &#39;asserts.fypp&#39;</span>
<a name="ln-2"></a>
<a name="ln-3"></a><span class="k">module </span><span class="n">pairtab_m</span>
<a name="ln-4"></a>
<a name="ln-5"></a><span class="k">use </span><span class="n">constants_m</span>
<a name="ln-6"></a><span class="k">use </span><span class="n">vector_m</span>
<a name="ln-7"></a><span class="k">use </span><span class="n">table_m</span>
<a name="ln-8"></a><span class="k">use </span><span class="n">simbox_m</span>
<a name="ln-9"></a><span class="k">use </span><span class="n">aabbtree_m</span>
<a name="ln-10"></a><span class="k">use </span><span class="n">cell_list_m</span>
<a name="ln-11"></a><span class="k">use </span><span class="n">atmcfg_m</span>
<a name="ln-12"></a><span class="k">use </span><span class="n">connectivity_m</span>
<a name="ln-13"></a>
<a name="ln-14"></a><span class="k">implicit none</span>
<a name="ln-15"></a>
<a name="ln-16"></a><span class="k">private</span>
<a name="ln-17"></a><span class="k">public</span> <span class="kd">::</span> <span class="n">pt_init</span><span class="p">,</span> <span class="n">pt_delete</span><span class="p">,</span> <span class="n">pt_build</span>
<a name="ln-18"></a>
<a name="ln-19"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rcutoff</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-20"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tskin</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-21"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rskin_sq</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-22"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tskin_sq</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-23"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">mth_ptgen</span>
<a name="ln-24"></a>    <span class="c">!! Pair table generation method: {&#39;DIR&#39;, &#39;VER&#39;, &#39;AABBT&#39;, &#39;CL&#39;}</span>
<a name="ln-25"></a><span class="k">type</span><span class="p">(</span><span class="n">itable_t</span><span class="p">)</span> <span class="kd">::</span> <span class="n">exat_tab</span>
<a name="ln-26"></a><span class="k">type</span><span class="p">(</span><span class="n">aabbtree_t</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tree</span>
<a name="ln-27"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">coordinates_save</span>
<a name="ln-28"></a>    <span class="c">!!  (3, *num_atoms*) array</span>
<a name="ln-29"></a><span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">coordinates_dr</span>
<a name="ln-30"></a>    <span class="c">!!  (3, *num_atoms*) array</span>
<a name="ln-31"></a>
<a name="ln-32"></a><span class="k">contains</span>
<a name="ln-33"></a>
<a name="ln-34"></a><span class="c">!*******************************************************************************</span>
<a name="ln-35"></a> 
<a name="ln-36"></a><span class="k">subroutine </span><span class="n">pt_init</span><span class="p">(</span><span class="n">mth</span><span class="p">,</span> <span class="n">num_atoms</span><span class="p">,</span> <span class="n">excl_atoms</span><span class="p">,</span> <span class="n">rcut</span><span class="p">,</span> <span class="n">tskn</span><span class="p">,</span> <span class="n">bonds</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-37"></a>        <span class="n">simbox</span><span class="p">,</span> <span class="n">pair_tab</span><span class="p">)</span>
<a name="ln-38"></a>    <span class="c">!! Performs initial setup for building a pair list.</span>
<a name="ln-39"></a>
<a name="ln-40"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mth</span>
<a name="ln-41"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">num_atoms</span>
<a name="ln-42"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">excl_atoms</span>
<a name="ln-43"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rcut</span>
<a name="ln-44"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tskn</span>
<a name="ln-45"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">bonds</span>
<a name="ln-46"></a>    <span class="k">type</span><span class="p">(</span><span class="n">smbx_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">simbox</span>
<a name="ln-47"></a>    <span class="k">type</span><span class="p">(</span><span class="n">itable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pair_tab</span>
<a name="ln-48"></a>    <span class="k">type</span><span class="p">(</span><span class="n">itable_t</span><span class="p">)</span> <span class="kd">::</span> <span class="n">atbo_tab</span>
<a name="ln-49"></a>    <span class="k">type</span><span class="p">(</span><span class="n">itable_t</span><span class="p">)</span> <span class="kd">::</span> <span class="n">atat_tab</span>
<a name="ln-50"></a>
<a name="ln-51"></a>    <span class="n">mth_ptgen</span> <span class="o">=</span> <span class="n">mth</span><span class="p">;</span> <span class="n">rcutoff</span> <span class="o">=</span> <span class="n">rcut</span><span class="p">;</span> <span class="n">tskin</span> <span class="o">=</span> <span class="n">tskn</span>
<a name="ln-52"></a>
<a name="ln-53"></a>    <span class="c">!Build atom -&gt; bond table</span>
<a name="ln-54"></a>    <span class="k">call </span><span class="n">atbo_build</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">bonds</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">bonds</span><span class="p">,</span> <span class="n">atbo_tab</span><span class="p">)</span>
<a name="ln-55"></a>
<a name="ln-56"></a>    <span class="c">!Build atm -&gt; bonded atoms table</span>
<a name="ln-57"></a>    <span class="k">call </span><span class="n">atat_build</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">,</span> <span class="n">bonds</span><span class="p">,</span> <span class="n">atbo_tab</span><span class="p">,</span> <span class="n">atat_tab</span><span class="p">)</span>
<a name="ln-58"></a>
<a name="ln-59"></a>    <span class="c">!Build excluded atoms table</span>
<a name="ln-60"></a>    <span class="k">call </span><span class="n">exat_build</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">,</span> <span class="n">excl_atoms</span><span class="p">,</span> <span class="n">atat_tab</span><span class="p">,</span> <span class="n">exat_tab</span><span class="p">)</span>
<a name="ln-61"></a>
<a name="ln-62"></a>    <span class="c">!Delete tables no longer needed.</span>
<a name="ln-63"></a>    <span class="k">call </span><span class="n">atbo_tab</span><span class="p">%</span><span class="n">delete</span><span class="p">()</span>
<a name="ln-64"></a>    <span class="k">call </span><span class="n">atat_tab</span><span class="p">%</span><span class="n">delete</span><span class="p">()</span>
<a name="ln-65"></a>
<a name="ln-66"></a>    <span class="c">!Initialize the pair table</span>
<a name="ln-67"></a>    <span class="k">call </span><span class="n">itbl_init</span><span class="p">(</span><span class="n">pair_tab</span><span class="p">,</span> <span class="n">num_atoms</span><span class="p">)</span>
<a name="ln-68"></a>    <span class="c">!The last row of pair_tab will remain empty due to Newton&#39;s third law;</span>
<a name="ln-69"></a>    <span class="c">!this will be used in an assert statement.</span>
<a name="ln-70"></a>
<a name="ln-71"></a>    <span class="k">select case</span><span class="p">(</span><span class="n">mth_ptgen</span><span class="p">)</span>
<a name="ln-72"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;VER&#39;</span><span class="p">)</span>
<a name="ln-73"></a>        <span class="c">!Setup the verlet scheme</span>
<a name="ln-74"></a>        <span class="n">rskin_sq</span> <span class="o">=</span> <span class="p">(</span><span class="n">rcutoff</span><span class="o">+</span><span class="n">tskin</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">;</span> <span class="n">tskin_sq</span> <span class="o">=</span> <span class="n">tskin</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-75"></a>        <span class="k">allocate</span><span class="p">(</span> <span class="n">coordinates_save</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">num_atoms</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-76"></a>        <span class="k">allocate</span><span class="p">(</span> <span class="n">coordinates_dr</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">num_atoms</span><span class="p">)</span>   <span class="p">)</span>
<a name="ln-77"></a>        <span class="c">!Initializing to zero</span>
<a name="ln-78"></a>        <span class="n">coordinates_save</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-79"></a>        <span class="n">coordinates_dr</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-80"></a>
<a name="ln-81"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;AABBT&#39;</span><span class="p">)</span>
<a name="ln-82"></a>        <span class="c">!Setup an AABB tree and insert the atoms</span>
<a name="ln-83"></a>        <span class="k">call </span><span class="n">tree</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">,</span> <span class="n">tskin</span><span class="o">/</span><span class="n">rcutoff</span><span class="p">)</span>
<a name="ln-84"></a>
<a name="ln-85"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;CL&#39;</span><span class="p">)</span>
<a name="ln-86"></a>        <span class="c">!Setup a cell list</span>
<a name="ln-87"></a>        <span class="c">! For relaxation/BD simulation the cell list is used for short range</span>
<a name="ln-88"></a>        <span class="c">! force calculation.</span>
<a name="ln-89"></a>        <span class="k">call </span><span class="n">cl_init</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">,</span> <span class="n">rcutoff</span><span class="p">,</span> <span class="n">simbox</span><span class="p">)</span>
<a name="ln-90"></a>        <span class="k">call </span><span class="n">cl_set_cell_size</span><span class="p">(</span><span class="n">rcutoff</span><span class="p">,</span> <span class="n">simbox</span><span class="p">)</span>
<a name="ln-91"></a>        <span class="k">call </span><span class="n">cl_build_cell_nbrs</span><span class="p">()</span>
<a name="ln-92"></a>
<a name="ln-93"></a>    <span class="k">case </span><span class="n">default</span>
<a name="ln-94"></a>        <span class="c">!Perform a direct N^2 calculation</span>
<a name="ln-95"></a>        <span class="n">rskin_sq</span> <span class="o">=</span> <span class="n">rcutoff</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-96"></a>    <span class="k">end select</span>
<a name="ln-97"></a>
<a name="ln-98"></a><span class="k">    end subroutine</span>
<a name="ln-99"></a> 
<a name="ln-100"></a><span class="c">!*******************************************************************************</span>
<a name="ln-101"></a> 
<a name="ln-102"></a><span class="k">subroutine </span><span class="n">pt_delete</span><span class="p">(</span><span class="n">pair_tab</span><span class="p">)</span> 
<a name="ln-103"></a>    <span class="c">!! Cleanup for pair list calculation.</span>
<a name="ln-104"></a>
<a name="ln-105"></a>    <span class="k">type</span><span class="p">(</span><span class="n">itable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pair_tab</span>
<a name="ln-106"></a>
<a name="ln-107"></a>    <span class="k">select case</span><span class="p">(</span><span class="n">mth_ptgen</span><span class="p">)</span>
<a name="ln-108"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;VER&#39;</span><span class="p">)</span>
<a name="ln-109"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">coordinates_save</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">coordinates_save</span><span class="p">)</span>
<a name="ln-110"></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">coordinates_dr</span><span class="p">)</span>  <span class="p">)</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">coordinates_dr</span><span class="p">)</span>
<a name="ln-111"></a>        <span class="n">rskin_sq</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">tskin_sq</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-112"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;AABBT&#39;</span><span class="p">)</span>
<a name="ln-113"></a>        <span class="k">call </span><span class="n">tree</span><span class="p">%</span><span class="n">delete</span><span class="p">()</span>
<a name="ln-114"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;CL&#39;</span><span class="p">)</span>
<a name="ln-115"></a>        <span class="k">call </span><span class="n">cl_delete</span><span class="p">()</span>
<a name="ln-116"></a>    <span class="k">case </span><span class="n">default</span>
<a name="ln-117"></a>        <span class="n">rskin_sq</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-118"></a>    <span class="k">end select</span>
<a name="ln-119"></a>
<a name="ln-120"></a><span class="k">    </span><span class="n">rcutoff</span> <span class="o">=</span> <span class="mf">0.0_rp</span><span class="p">;</span> <span class="n">tskin</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
<a name="ln-121"></a>
<a name="ln-122"></a>    <span class="k">call </span><span class="n">pair_tab</span><span class="p">%</span><span class="n">delete</span><span class="p">()</span>
<a name="ln-123"></a>    <span class="k">call </span><span class="n">exat_tab</span><span class="p">%</span><span class="n">delete</span><span class="p">()</span>
<a name="ln-124"></a>
<a name="ln-125"></a>    <span class="k">end subroutine</span>
<a name="ln-126"></a> 
<a name="ln-127"></a><span class="c">!*******************************************************************************</span>
<a name="ln-128"></a> 
<a name="ln-129"></a><span class="k">subroutine </span><span class="n">pt_build</span><span class="p">(</span><span class="n">simbox</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">,</span> <span class="n">pair_tab</span><span class="p">)</span>
<a name="ln-130"></a>    <span class="c">!! Builds a pair table. The resulting table is stored in the module variable</span>
<a name="ln-131"></a>    <span class="c">!! `pair_tab`.</span>
<a name="ln-132"></a>
<a name="ln-133"></a>    <span class="k">type</span><span class="p">(</span><span class="n">smbx_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">simbox</span>
<a name="ln-134"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">coordinates</span>
<a name="ln-135"></a>    <span class="k">type</span><span class="p">(</span><span class="n">itable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pair_tab</span>
<a name="ln-136"></a>
<a name="ln-137"></a>    <span class="k">select case</span><span class="p">(</span><span class="n">mth_ptgen</span><span class="p">)</span>
<a name="ln-138"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;VER&#39;</span><span class="p">)</span>
<a name="ln-139"></a>        <span class="k">call </span><span class="n">build_pt_verlet</span><span class="p">(</span><span class="n">simbox</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">,</span> <span class="n">pair_tab</span><span class="p">)</span>
<a name="ln-140"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;AABBT&#39;</span><span class="p">)</span>
<a name="ln-141"></a>        <span class="k">call </span><span class="n">build_pt_aabbtree</span><span class="p">(</span><span class="n">simbox</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">,</span> <span class="n">pair_tab</span><span class="p">)</span>
<a name="ln-142"></a>    <span class="k">case</span><span class="p">(</span><span class="s1">&#39;CL&#39;</span><span class="p">)</span>
<a name="ln-143"></a>        <span class="k">call </span><span class="n">build_pt_cell_list</span><span class="p">(</span><span class="n">simbox</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">,</span> <span class="n">pair_tab</span><span class="p">)</span>
<a name="ln-144"></a>    <span class="k">case </span><span class="n">default</span>
<a name="ln-145"></a>        <span class="k">call </span><span class="n">build_pt_n2</span><span class="p">(</span><span class="n">simbox</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">,</span> <span class="n">pair_tab</span><span class="p">)</span>
<a name="ln-146"></a>    <span class="k">end select</span>
<a name="ln-147"></a>
<a name="ln-148"></a><span class="k">    end subroutine</span>
<a name="ln-149"></a> 
<a name="ln-150"></a><span class="c">!******************************************************************************</span>
<a name="ln-151"></a>
<a name="ln-152"></a><span class="k">subroutine </span><span class="n">build_pt_n2</span> <span class="p">(</span><span class="n">simbox</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">,</span> <span class="n">pair_tab</span><span class="p">)</span>
<a name="ln-153"></a>    <span class="c">!! Builds a pair table using direct N^2 looping over all pairs.</span>
<a name="ln-154"></a>
<a name="ln-155"></a>    <span class="k">type</span><span class="p">(</span><span class="n">smbx_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">simbox</span>
<a name="ln-156"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">coordinates</span>
<a name="ln-157"></a>    <span class="k">type</span><span class="p">(</span><span class="n">itable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pair_tab</span>
<a name="ln-158"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">pnbrs</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-159"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ri</span>
<a name="ln-160"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rj</span>
<a name="ln-161"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rij</span>
<a name="ln-162"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rij_sq</span>
<a name="ln-163"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-164"></a>
<a name="ln-165"></a>    <span class="c">!Clear out the pair table</span>
<a name="ln-166"></a>    <span class="k">call </span><span class="n">pair_tab</span><span class="p">%</span><span class="n">clear</span><span class="p">()</span>
<a name="ln-167"></a>
<a name="ln-168"></a>    <span class="n">num_atoms</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-169"></a>
<a name="ln-170"></a>    <span class="c">!Loop over all pairs to build list</span>
<a name="ln-171"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-172"></a>        <span class="n">ri</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-173"></a>        <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-174"></a>            <span class="c">!Check if atom j is an excluded atom for atom i</span>
<a name="ln-175"></a>            <span class="k">if</span> <span class="p">(</span> <span class="n">exat_tab</span><span class="p">%</span><span class="n">is_in</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="p">)</span> <span class="k">cycle</span>
<a name="ln-176"></a><span class="k">            </span><span class="n">rj</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">j</span><span class="p">)</span>
<a name="ln-177"></a>            <span class="n">rij</span> <span class="o">=</span> <span class="n">rj</span> <span class="o">-</span> <span class="n">ri</span>
<a name="ln-178"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">simbox</span><span class="p">%</span><span class="n">imcon</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">simbox</span><span class="p">%</span><span class="n">get_image</span><span class="p">(</span><span class="n">rij</span><span class="p">)</span>
<a name="ln-179"></a>            <span class="n">rij_sq</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">rij</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-180"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">rij_sq</span> <span class="o">&lt;</span> <span class="n">rskin_sq</span><span class="p">)</span> <span class="k">call </span><span class="n">pair_tab</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
<a name="ln-181"></a>        <span class="k">end do</span>
<a name="ln-182"></a><span class="k">    end do</span>
<a name="ln-183"></a>
<a name="ln-184"></a><span class="k">    call </span><span class="n">pair_tab</span><span class="p">%</span><span class="n">get_row</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">,</span><span class="n">pnbrs</span><span class="p">)</span>
<a name="ln-185"></a>    <span class="err">@</span><span class="p">:</span><span class="n">ASSERT</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pnbrs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-186"></a>
<a name="ln-187"></a>    <span class="c">!Release additional memory</span>
<a name="ln-188"></a>    <span class="k">call </span><span class="n">pair_tab</span><span class="p">%</span><span class="n">shrink_to_fit</span><span class="p">()</span>
<a name="ln-189"></a>
<a name="ln-190"></a>    <span class="k">end subroutine</span>
<a name="ln-191"></a>
<a name="ln-192"></a><span class="c">!******************************************************************************</span>
<a name="ln-193"></a>
<a name="ln-194"></a><span class="k">subroutine </span><span class="n">build_pt_verlet</span><span class="p">(</span><span class="n">simbox</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">,</span> <span class="n">pair_tab</span><span class="p">)</span>
<a name="ln-195"></a>    <span class="c">!! Builds a pair table using the Verlet scheme.</span>
<a name="ln-196"></a>
<a name="ln-197"></a>    <span class="k">type</span><span class="p">(</span><span class="n">smbx_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">simbox</span>
<a name="ln-198"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">coordinates</span>
<a name="ln-199"></a>    <span class="k">type</span><span class="p">(</span><span class="n">itable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pair_tab</span>
<a name="ln-200"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">pnbrs</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-201"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ri</span>
<a name="ln-202"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rj</span>
<a name="ln-203"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rij</span>
<a name="ln-204"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dr_sq_max</span>
<a name="ln-205"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rij_sq</span>
<a name="ln-206"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">save</span> <span class="kd">::</span> <span class="n">first_call</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-207"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-208"></a>
<a name="ln-209"></a>    <span class="n">num_atoms</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-210"></a>
<a name="ln-211"></a>    <span class="c">!On first call no check for rebuilding</span>
<a name="ln-212"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">first_call</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-213"></a>        <span class="c">!Check whether rebuilding the list is necessary</span>
<a name="ln-214"></a>        <span class="n">coordinates_dr</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">num_atoms</span><span class="p">)</span> <span class="o">-</span> <span class="n">coordinates_save</span>
<a name="ln-215"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">simbox</span><span class="p">%</span><span class="n">imcon</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-216"></a><span class="k">            do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-217"></a>                <span class="k">call </span><span class="n">simbox</span><span class="p">%</span><span class="n">get_image</span><span class="p">(</span><span class="n">coordinates_dr</span><span class="p">(:,</span><span class="n">i</span><span class="p">))</span>
<a name="ln-218"></a>            <span class="k">end do</span>
<a name="ln-219"></a><span class="k">        end if</span>
<a name="ln-220"></a><span class="k">        </span><span class="n">dr_sq_max</span> <span class="o">=</span> <span class="nb">maxval</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">coordinates_dr</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-221"></a>        <span class="k">if</span> <span class="p">(</span> <span class="mi">4</span><span class="o">*</span><span class="n">dr_sq_max</span> <span class="o">&lt;</span> <span class="n">tskin_sq</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-222"></a><span class="k">    end if</span>
<a name="ln-223"></a>
<a name="ln-224"></a><span class="k">    </span><span class="n">first_call</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-225"></a>
<a name="ln-226"></a>    <span class="c">!Clear out the pair table</span>
<a name="ln-227"></a>    <span class="k">call </span><span class="n">pair_tab</span><span class="p">%</span><span class="n">clear</span><span class="p">()</span>
<a name="ln-228"></a>
<a name="ln-229"></a>    <span class="c">!Loop over all pairs to build list</span>
<a name="ln-230"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-231"></a>        <span class="n">ri</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span>
<a name="ln-232"></a>        <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-233"></a>            <span class="c">!Check if atom j is an excluded atom for atom i</span>
<a name="ln-234"></a>            <span class="k">if</span> <span class="p">(</span> <span class="n">exat_tab</span><span class="p">%</span><span class="n">is_in</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="p">)</span> <span class="k">cycle</span>
<a name="ln-235"></a><span class="k">            </span><span class="n">rj</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">j</span><span class="p">)</span>
<a name="ln-236"></a>            <span class="n">rij</span> <span class="o">=</span> <span class="n">rj</span> <span class="o">-</span> <span class="n">ri</span>
<a name="ln-237"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">simbox</span><span class="p">%</span><span class="n">imcon</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">simbox</span><span class="p">%</span><span class="n">get_image</span><span class="p">(</span><span class="n">rij</span><span class="p">)</span>
<a name="ln-238"></a>            <span class="n">rij_sq</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">rij</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-239"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">rij_sq</span> <span class="o">&lt;</span> <span class="n">rskin_sq</span><span class="p">)</span> <span class="k">call </span><span class="n">pair_tab</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
<a name="ln-240"></a>        <span class="k">end do</span>
<a name="ln-241"></a><span class="k">    end do</span>
<a name="ln-242"></a>
<a name="ln-243"></a><span class="k">    call </span><span class="n">pair_tab</span><span class="p">%</span><span class="n">get_row</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">,</span><span class="n">pnbrs</span><span class="p">)</span>
<a name="ln-244"></a>    <span class="err">@</span><span class="p">:</span><span class="n">ASSERT</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pnbrs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-245"></a>
<a name="ln-246"></a>    <span class="c">!Release additional memory</span>
<a name="ln-247"></a>    <span class="k">call </span><span class="n">pair_tab</span><span class="p">%</span><span class="n">shrink_to_fit</span><span class="p">()</span>
<a name="ln-248"></a>
<a name="ln-249"></a>    <span class="c">!Back up positions</span>
<a name="ln-250"></a>    <span class="n">coordinates_save</span> <span class="o">=</span> <span class="n">coordinates</span>
<a name="ln-251"></a>
<a name="ln-252"></a>    <span class="k">end subroutine</span>
<a name="ln-253"></a>
<a name="ln-254"></a><span class="c">!*******************************************************************************</span>
<a name="ln-255"></a>
<a name="ln-256"></a><span class="k">subroutine </span><span class="n">build_pt_aabbtree</span><span class="p">(</span><span class="n">simbox</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">,</span> <span class="n">pair_tab</span><span class="p">)</span>
<a name="ln-257"></a>
<a name="ln-258"></a>    <span class="k">type</span><span class="p">(</span><span class="n">smbx_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">simbox</span>
<a name="ln-259"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">coordinates</span>
<a name="ln-260"></a>    <span class="k">type</span><span class="p">(</span><span class="n">itable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pair_tab</span>
<a name="ln-261"></a>    <span class="k">type</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nbrs</span>
<a name="ln-262"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">pnbrs</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-263"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ia</span><span class="p">,</span> <span class="n">inbr</span><span class="p">,</span> <span class="n">ia_nbr</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-264"></a>
<a name="ln-265"></a>    <span class="n">num_atoms</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-266"></a>
<a name="ln-267"></a>    <span class="c">!Clear out the pair table</span>
<a name="ln-268"></a>    <span class="k">call </span><span class="n">pair_tab</span><span class="p">%</span><span class="n">clear</span><span class="p">()</span>
<a name="ln-269"></a>
<a name="ln-270"></a>    <span class="c">!Clear out the AABB tree</span>
<a name="ln-271"></a>    <span class="k">call </span><span class="n">tree</span><span class="p">%</span><span class="n">clear</span><span class="p">()</span>
<a name="ln-272"></a>    <span class="c">!Insert atoms into the tree</span>
<a name="ln-273"></a>    <span class="k">do </span><span class="n">ia</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-274"></a>        <span class="k">call </span><span class="n">tree</span><span class="p">%</span><span class="n">insert</span><span class="p">(</span><span class="n">ia</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">ia</span><span class="p">),</span> <span class="n">rcutoff</span><span class="p">)</span>
<a name="ln-275"></a>    <span class="k">end do</span>
<a name="ln-276"></a>
<a name="ln-277"></a>    <span class="c">!Loop over all atoms to find neighbors and insert into pair_tab.</span>
<a name="ln-278"></a>    <span class="k">call </span><span class="n">ivector_init</span><span class="p">(</span><span class="n">nbrs</span><span class="p">)</span>
<a name="ln-279"></a>    <span class="k">do </span><span class="n">ia</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-280"></a>        <span class="k">call </span><span class="n">tree</span><span class="p">%</span><span class="n">query</span><span class="p">(</span><span class="n">ia</span><span class="p">,</span> <span class="n">nbrs</span><span class="p">)</span>
<a name="ln-281"></a>        <span class="k">call </span><span class="n">nbrs</span><span class="p">%</span><span class="n">sort</span><span class="p">()</span>
<a name="ln-282"></a>        <span class="k">call </span><span class="n">nbrs</span><span class="p">%</span><span class="n">get_data</span><span class="p">(</span><span class="n">pnbrs</span><span class="p">)</span>
<a name="ln-283"></a>        <span class="k">do </span><span class="n">inbr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">pnbrs</span><span class="p">)</span>
<a name="ln-284"></a>            <span class="n">ia_nbr</span> <span class="o">=</span> <span class="n">pnbrs</span><span class="p">(</span><span class="n">inbr</span><span class="p">)</span>
<a name="ln-285"></a>            <span class="c">!Check if atom ia_nbr is an excluded atom for atom ia</span>
<a name="ln-286"></a>            <span class="k">if</span> <span class="p">(</span> <span class="n">exat_tab</span><span class="p">%</span><span class="n">is_in</span><span class="p">(</span><span class="n">ia</span><span class="p">,</span><span class="n">ia_nbr</span><span class="p">)</span> <span class="p">)</span> <span class="k">cycle</span>
<a name="ln-287"></a><span class="k">            if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">pair_tab</span><span class="p">%</span><span class="n">is_in</span><span class="p">(</span><span class="n">ia_nbr</span><span class="p">,</span><span class="n">ia</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-288"></a><span class="k">                call </span><span class="n">pair_tab</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="n">ia</span><span class="p">,</span> <span class="n">ia_nbr</span><span class="p">)</span>
<a name="ln-289"></a>            <span class="k">end if</span>
<a name="ln-290"></a><span class="k">        end do</span>
<a name="ln-291"></a><span class="k">    end do</span>
<a name="ln-292"></a>
<a name="ln-293"></a><span class="k">    call </span><span class="n">pair_tab</span><span class="p">%</span><span class="n">get_row</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">,</span><span class="n">pnbrs</span><span class="p">)</span>
<a name="ln-294"></a>    <span class="err">@</span><span class="p">:</span><span class="n">ASSERT</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pnbrs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-295"></a>
<a name="ln-296"></a>    <span class="k">call </span><span class="n">nbrs</span><span class="p">%</span><span class="n">delete</span><span class="p">()</span>
<a name="ln-297"></a>
<a name="ln-298"></a>    <span class="c">!Release additional memory</span>
<a name="ln-299"></a>    <span class="k">call </span><span class="n">pair_tab</span><span class="p">%</span><span class="n">shrink_to_fit</span><span class="p">()</span>
<a name="ln-300"></a>
<a name="ln-301"></a>    <span class="k">end subroutine</span>
<a name="ln-302"></a>
<a name="ln-303"></a><span class="c">!******************************************************************************</span>
<a name="ln-304"></a>
<a name="ln-305"></a><span class="k">subroutine </span><span class="n">build_pt_cell_list</span> <span class="p">(</span><span class="n">simbox</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">,</span> <span class="n">pair_tab</span><span class="p">)</span>
<a name="ln-306"></a>    <span class="c">!! Builds a pair table using cell list.</span>
<a name="ln-307"></a>
<a name="ln-308"></a>    <span class="k">type</span><span class="p">(</span><span class="n">smbx_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">simbox</span>
<a name="ln-309"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">coordinates</span>
<a name="ln-310"></a>    <span class="k">type</span><span class="p">(</span><span class="n">itable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pair_tab</span>
<a name="ln-311"></a>    <span class="k">type</span><span class="p">(</span><span class="n">ivector_t</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ptaov</span>
<a name="ln-312"></a>        <span class="c">!Pair table as an array of vectors.</span>
<a name="ln-313"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">aic</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-314"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">ainc</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-315"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">nbr_cells</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-316"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">pnbrs</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-317"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">num_cells</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-318"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">icell</span><span class="p">,</span> <span class="n">jcell</span><span class="p">,</span> <span class="n">iatm</span><span class="p">,</span> <span class="n">jatm</span>
<a name="ln-319"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span>
<a name="ln-320"></a>
<a name="ln-321"></a>    <span class="n">num_atoms</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-322"></a>
<a name="ln-323"></a>    <span class="c">!Clear out the pair table</span>
<a name="ln-324"></a>    <span class="k">call </span><span class="n">pair_tab</span><span class="p">%</span><span class="n">clear</span><span class="p">()</span>
<a name="ln-325"></a>
<a name="ln-326"></a>    <span class="c">!Initialize ptaov</span>
<a name="ln-327"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">ptaov</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">))</span>
<a name="ln-328"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">ptaov</span><span class="p">)</span>
<a name="ln-329"></a>        <span class="k">call </span><span class="n">ivector_init</span><span class="p">(</span><span class="n">ptaov</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-330"></a>    <span class="k">end do</span>
<a name="ln-331"></a>
<a name="ln-332"></a><span class="k">    call </span><span class="n">cl_build</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
<a name="ln-333"></a>    <span class="n">num_cells</span> <span class="o">=</span> <span class="n">cl_get_num_cells</span><span class="p">()</span>
<a name="ln-334"></a>
<a name="ln-335"></a>    <span class="k">do </span><span class="n">icell</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">num_cells</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-336"></a>        <span class="k">call </span><span class="n">cl_get_contents</span><span class="p">(</span><span class="n">icell</span><span class="p">,</span> <span class="n">aic</span><span class="p">)</span>
<a name="ln-337"></a>        <span class="k">call </span><span class="n">cl_get_nbr_cells</span><span class="p">(</span><span class="n">icell</span><span class="p">,</span> <span class="n">nbr_cells</span><span class="p">)</span>
<a name="ln-338"></a>
<a name="ln-339"></a>        <span class="c">!Interaction with particles within the cell</span>
<a name="ln-340"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">aic</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-341"></a>            <span class="n">iatm</span> <span class="o">=</span> <span class="n">aic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-342"></a>            <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">aic</span><span class="p">)</span>
<a name="ln-343"></a>                <span class="n">jatm</span> <span class="o">=</span> <span class="n">aic</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a name="ln-344"></a>                <span class="c">!Check if atom jatm is an excluded atom for atom iatm</span>
<a name="ln-345"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">exat_tab</span><span class="p">%</span><span class="n">is_in</span><span class="p">(</span><span class="n">iatm</span><span class="p">,</span><span class="n">jatm</span><span class="p">)</span> <span class="p">)</span> <span class="k">cycle</span>
<a name="ln-346"></a><span class="k">                call </span><span class="n">ptaov</span><span class="p">(</span><span class="n">iatm</span><span class="p">)%</span><span class="n">append</span><span class="p">(</span><span class="n">jatm</span><span class="p">)</span>
<a name="ln-347"></a>            <span class="k">end do</span>
<a name="ln-348"></a><span class="k">        end do</span>
<a name="ln-349"></a>
<a name="ln-350"></a>        <span class="c">!Interaction with particles belonging to neighboring cells</span>
<a name="ln-351"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">aic</span><span class="p">)</span>
<a name="ln-352"></a>            <span class="n">iatm</span> <span class="o">=</span> <span class="n">aic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-353"></a>            <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">nbr_cells</span><span class="p">)</span>
<a name="ln-354"></a>                <span class="n">jcell</span> <span class="o">=</span> <span class="n">nbr_cells</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a name="ln-355"></a>                <span class="k">call </span><span class="n">cl_get_contents</span><span class="p">(</span><span class="n">jcell</span><span class="p">,</span> <span class="n">ainc</span><span class="p">)</span>
<a name="ln-356"></a>                <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">ainc</span><span class="p">)</span>
<a name="ln-357"></a>                    <span class="n">jatm</span> <span class="o">=</span> <span class="n">ainc</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-358"></a>                    <span class="c">!Check if atom jatm is an excluded atom for atom iatm</span>
<a name="ln-359"></a>                    <span class="k">if</span> <span class="p">(</span> <span class="n">exat_tab</span><span class="p">%</span><span class="n">is_in</span><span class="p">(</span><span class="n">iatm</span><span class="p">,</span><span class="n">jatm</span><span class="p">)</span> <span class="p">)</span> <span class="k">cycle</span>
<a name="ln-360"></a><span class="k">                    call </span><span class="n">ptaov</span><span class="p">(</span><span class="n">iatm</span><span class="p">)%</span><span class="n">append</span><span class="p">(</span><span class="n">jatm</span><span class="p">)</span>
<a name="ln-361"></a>                <span class="k">end do</span>
<a name="ln-362"></a><span class="k">            end do</span>
<a name="ln-363"></a><span class="k">        end do</span>
<a name="ln-364"></a><span class="k">    end do</span>
<a name="ln-365"></a>
<a name="ln-366"></a>    <span class="c">!Copy the entries in ptaov to pair_tab</span>
<a name="ln-367"></a>    <span class="k">do </span><span class="n">iatm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span>
<a name="ln-368"></a>        <span class="k">call </span><span class="n">ptaov</span><span class="p">(</span><span class="n">iatm</span><span class="p">)%</span><span class="n">get_data</span><span class="p">(</span><span class="n">pnbrs</span><span class="p">)</span>
<a name="ln-369"></a>        <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">pnbrs</span><span class="p">)</span>
<a name="ln-370"></a>            <span class="k">call </span><span class="n">pair_tab</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="n">iatm</span><span class="p">,</span><span class="n">pnbrs</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
<a name="ln-371"></a>        <span class="k">end do</span>
<a name="ln-372"></a><span class="k">    end do</span>
<a name="ln-373"></a>
<a name="ln-374"></a><span class="k">    call </span><span class="n">pair_tab</span><span class="p">%</span><span class="n">get_row</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">,</span><span class="n">pnbrs</span><span class="p">)</span>
<a name="ln-375"></a>    <span class="err">@</span><span class="p">:</span><span class="n">ASSERT</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pnbrs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-376"></a>
<a name="ln-377"></a>    <span class="c">!Release additional memory</span>
<a name="ln-378"></a>    <span class="k">call </span><span class="n">pair_tab</span><span class="p">%</span><span class="n">shrink_to_fit</span><span class="p">()</span>
<a name="ln-379"></a>
<a name="ln-380"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">ptaov</span><span class="p">)</span>
<a name="ln-381"></a>        <span class="k">call </span><span class="n">ptaov</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">delete</span><span class="p">()</span>
<a name="ln-382"></a>    <span class="k">end do</span>
<a name="ln-383"></a><span class="k">    deallocate</span><span class="p">(</span><span class="n">ptaov</span><span class="p">)</span>
<a name="ln-384"></a>
<a name="ln-385"></a>    <span class="k">end subroutine</span>
<a name="ln-386"></a>
<a name="ln-387"></a><span class="c">!*******************************************************************************</span>
<a name="ln-388"></a>
<a name="ln-389"></a><span class="k">end module </span><span class="n">pairtab_m</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> BROWNPAK was developed by Sarit Dutta</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>