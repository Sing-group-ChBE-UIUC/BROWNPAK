<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for BROWNPAK">
   
    <meta name="author" content="Sarit Dutta" >
    <link rel="icon" href="../favicon.png">

    <title>m_trajectory.f90 &ndash; BROWNPAK</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">BROWNPAK <small>0.2</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>m_trajectory.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 4.4% of total for source files.">269 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/m_trajectory.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">m_trajectory.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_trajectory.html">m_trajectory</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_trajectory.f90.html#src">m_trajectory.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_trajectory.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilem_trajectoryf90EfferentGraph" width="219pt" height="74pt"
 viewBox="0.00 0.00 219.00 74.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_trajectory.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 70)">
<title>sourcefile~~m_trajectory.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-70 215,-70 215,4 -4,4"/>
<!-- sourcefile~m_trajectory.f90 -->
<g id="sourcefile~~m_trajectory.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~m_trajectory.f90</title>
<polygon fill="none" stroke="#000000" points="211,-45 123,-45 123,-21 211,-21 211,-45"/>
<text text-anchor="middle" x="167" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_trajectory.f90</text>
</g>
<!-- sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_trajectory.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~m_logger.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/m_logger.f90.html" xlink:title="m_logger.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="80.5,-66 6.5,-66 6.5,-42 80.5,-42 80.5,-66"/>
<text text-anchor="middle" x="43.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_logger.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_trajectory.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_logger.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M122.7625,-40.5222C112.2724,-42.3059 101.0473,-44.2146 90.4415,-46.0181"/>
<polygon fill="#ff0000" stroke="#ff0000" points="89.7787,-42.5804 80.507,-47.7073 90.9522,-49.4814 89.7787,-42.5804"/>
</g>
<!-- sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_trajectory.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~m_precision.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/m_precision.f90.html" xlink:title="m_precision.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="87,-24 0,-24 0,0 87,0 87,-24"/>
<text text-anchor="middle" x="43.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_precision.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_trajectory.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M122.7625,-25.4778C114.405,-24.0567 105.581,-22.5563 96.9753,-21.093"/>
<polygon fill="#ff0000" stroke="#ff0000" points="97.4596,-17.6252 87.0143,-19.3992 96.2861,-24.5261 97.4596,-17.6252"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_trajectory.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilem_trajectoryf90AfferentGraph" width="641pt" height="430pt"
 viewBox="0.00 0.00 641.00 429.60" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph" class="graph" transform="scale(.7855 .7855) rotate(0) translate(4 542.8901)">
<title>sourcefile~~m_trajectory.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-542.8901 812,-542.8901 812,4 -4,4"/>
<!-- sourcefile~m_trajectory.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~m_trajectory.f90</title>
<polygon fill="none" stroke="#000000" points="88,-262.2373 0,-262.2373 0,-238.2373 88,-238.2373 88,-262.2373"/>
<text text-anchor="middle" x="44" y="-247.8373" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_trajectory.f90</text>
</g>
<!-- sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~m_globals.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/m_globals.f90.html" xlink:title="m_globals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="202,-262.2373 124,-262.2373 124,-238.2373 202,-238.2373 202,-262.2373"/>
<text text-anchor="middle" x="163" y="-247.8373" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_globals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_trajectory.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_trajectory.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M123.7052,-250.2373C115.6193,-250.2373 106.9686,-250.2373 98.4565,-250.2373"/>
<polygon fill="#ff0000" stroke="#ff0000" points="98.1897,-246.7374 88.1896,-250.2373 98.1896,-253.7374 98.1897,-246.7374"/>
</g>
<!-- sourcefile~m_ia_vdw.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~m_ia_vdw.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/m_ia_vdw.f90.html" xlink:title="m_ia_vdw.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="326,-304.2373 249,-304.2373 249,-280.2373 326,-280.2373 326,-304.2373"/>
<text text-anchor="middle" x="287.5" y="-289.8373" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_vdw.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M251.8233,-280.2017C238.2787,-275.6325 222.6679,-270.3662 208.3481,-265.5354"/>
<polygon fill="#ff0000" stroke="#ff0000" points="209.2761,-262.1547 198.6819,-262.2745 207.0385,-268.7875 209.2761,-262.1547"/>
</g>
<!-- sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~m_cell_list.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/m_cell_list.f90.html" xlink:title="m_cell_list.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="327,-464.2373 248,-464.2373 248,-440.2373 327,-440.2373 327,-464.2373"/>
<text text-anchor="middle" x="287.5" y="-449.8373" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_cell_list.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M256.6884,-440.2214C249.9032,-436.5083 243.1991,-431.8744 238,-426.2373 196.1656,-380.8777 175.5514,-308.663 167.3902,-272.4598"/>
<polygon fill="#ff0000" stroke="#ff0000" points="170.7633,-271.4959 165.2476,-262.4501 163.9184,-272.9612 170.7633,-271.4959"/>
</g>
<!-- sourcefile~m_ia_tether.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~m_ia_tether.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/m_ia_tether.f90.html" xlink:title="m_ia_tether.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="330,-262.2373 245,-262.2373 245,-238.2373 330,-238.2373 330,-262.2373"/>
<text text-anchor="middle" x="287.5" y="-247.8373" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_tether.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_ia_tether.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~m_ia_tether.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M244.6542,-250.2373C234.2067,-250.2373 222.949,-250.2373 212.2304,-250.2373"/>
<polygon fill="#ff0000" stroke="#ff0000" points="212.163,-246.7374 202.163,-250.2373 212.163,-253.7374 212.163,-246.7374"/>
</g>
<!-- sourcefile~m_ia_angle.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~m_ia_angle.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/m_ia_angle.f90.html" xlink:title="m_ia_angle.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="329.5,-220.2373 245.5,-220.2373 245.5,-196.2373 329.5,-196.2373 329.5,-220.2373"/>
<text text-anchor="middle" x="287.5" y="-205.8373" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_angle.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_ia_angle.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~m_ia_angle.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M251.8233,-220.2728C238.2787,-224.842 222.6679,-230.1083 208.3481,-234.9391"/>
<polygon fill="#ff0000" stroke="#ff0000" points="207.0385,-231.687 198.6819,-238.2 209.2761,-238.3198 207.0385,-231.687"/>
</g>
<!-- sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~m_mpcd.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/m_mpcd.f90.html" xlink:title="m_mpcd.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="582,-464.2373 512,-464.2373 512,-440.2373 582,-440.2373 582,-464.2373"/>
<text text-anchor="middle" x="547" y="-449.8373" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_mpcd.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M419.5,-492.2373C361.0063,-496.7393 337.6584,-522.666 287.5,-492.2373"/>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_cell_list.f90</title>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M419.5,-492.2373C383.7768,-494.9867 344.7198,-480.8579 318.4293,-468.6413"/>
<polygon fill="#ff5000" stroke="#ff5000" points="319.8783,-465.4544 309.3508,-464.2618 316.8369,-471.7591 319.8783,-465.4544"/>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M520.8374,-464.3027C495.5421,-475.0309 455.8153,-489.4422 419.5,-492.2373"/>
</g>
<!-- sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~m_stats_io.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node10"><a xlink:href=".././sourcefile/m_stats_io.f90.html" xlink:title="m_stats_io.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="460,-464.2373 379,-464.2373 379,-440.2373 460,-440.2373 460,-464.2373"/>
<text text-anchor="middle" x="419.5" y="-449.8373" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_stats_io.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge34" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_stats_io.f90</title>
<path fill="none" stroke="#00ff35" stroke-dasharray="5,2" d="M511.8226,-452.2373C499.1353,-452.2373 484.5444,-452.2373 470.7636,-452.2373"/>
<polygon fill="#00ff35" stroke="#00ff35" points="470.4283,-448.7374 460.4283,-452.2373 470.4282,-455.7374 470.4283,-448.7374"/>
</g>
<!-- sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~m_config_io.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node12"><a xlink:href=".././sourcefile/m_config_io.f90.html" xlink:title="m_config_io.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463,-365.2373 376,-365.2373 376,-341.2373 463,-341.2373 463,-365.2373"/>
<text text-anchor="middle" x="419.5" y="-350.8373" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_config_io.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge39" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_config_io.f90</title>
<path fill="none" stroke="#00ffd6" stroke-dasharray="5,2" d="M531.366,-440.0979C509.3806,-423.0269 469.1418,-391.7827 443.3918,-371.7885"/>
<polygon fill="#00ffd6" stroke="#00ffd6" points="445.307,-368.8444 435.2619,-365.4759 441.0139,-374.3734 445.307,-368.8444"/>
</g>
<!-- sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~m_interaction.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node13"><a xlink:href=".././sourcefile/m_interaction.f90.html" xlink:title="m_interaction.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="466,-304.2373 373,-304.2373 373,-280.2373 466,-280.2373 466,-304.2373"/>
<text text-anchor="middle" x="419.5" y="-289.8373" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_interaction.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge40" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#00d6ff" stroke-dasharray="5,2" d="M536.9014,-439.8946C527.4762,-428.1715 513.2205,-409.9097 502,-393.2373 484.4236,-367.1206 486.2025,-356.38 466,-332.2373 459.5761,-324.5605 451.6004,-317.1283 444.0785,-310.7961"/>
<polygon fill="#00d6ff" stroke="#00d6ff" points="446.1607,-307.9785 436.1895,-304.3972 441.7511,-313.4149 446.1607,-307.9785"/>
</g>
<!-- sourcefile~m_control_io.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~m_control_io.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/m_control_io.f90.html" xlink:title="m_control_io.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="718,-502.2373 628,-502.2373 628,-478.2373 718,-478.2373 718,-502.2373"/>
<text text-anchor="middle" x="673" y="-487.8373" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_control_io.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_control_io.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~m_control_io.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M547,-530.2373C430.7975,-539.4023 387.1585,-552.6955 287.5,-492.2373"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M646.1757,-502.4373C621.1356,-512.928 582.4154,-526.8844 547,-530.2373"/>
</g>
<!-- sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~m_bd_solver.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node9"><a xlink:href=".././sourcefile/m_bd_solver.f90.html" xlink:title="m_bd_solver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="592,-384.2373 502,-384.2373 502,-360.2373 592,-360.2373 592,-384.2373"/>
<text text-anchor="middle" x="547" y="-369.8373" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_bd_solver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M521.5102,-384.242C474.063,-404.8483 369.5658,-441.9927 287.5,-412.2373"/>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge31" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_stats_io.f90</title>
<path fill="none" stroke="#00ff35" stroke-dasharray="5,2" d="M524.6588,-384.3424C517.31,-388.5348 509.1855,-393.4003 502,-398.2373 485.185,-409.5563 482.8943,-415.0369 466,-426.2373 461.3747,-429.3037 456.3631,-432.361 451.4005,-435.2449"/>
<polygon fill="#00ff35" stroke="#00ff35" points="449.5963,-432.2443 442.6146,-440.2134 453.042,-438.3375 449.5963,-432.2443"/>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge36" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_config_io.f90</title>
<path fill="none" stroke="#00ffd6" stroke-dasharray="5,2" d="M501.6893,-365.4851C492.5431,-364.1221 482.843,-362.6766 473.435,-361.2746"/>
<polygon fill="#00ffd6" stroke="#00ffd6" points="473.7877,-357.7886 463.3811,-359.7764 472.7559,-364.7122 473.7877,-357.7886"/>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge41" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#00d6ff" stroke-dasharray="5,2" d="M525.3399,-360.0472C517.8897,-355.7686 509.5302,-350.8721 502,-346.2373 482.9345,-334.5023 461.8177,-320.6643 445.7213,-309.9345"/>
<polygon fill="#00d6ff" stroke="#00d6ff" points="447.5977,-306.9788 437.3402,-304.3264 443.7048,-312.7966 447.5977,-306.9788"/>
</g>
<!-- sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M287.5,-492.2373C267.3526,-480.0147 254.3089,-490.2469 238,-473.2373 182.999,-415.873 168.2795,-316.8945 164.3822,-272.6914"/>
<polygon fill="#ff0000" stroke="#ff0000" points="167.8514,-272.1571 163.591,-262.4567 160.8722,-272.6967 167.8514,-272.1571"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M395.002,-464.3234C362.1018,-479.7674 305.6698,-503.26 287.5,-492.2373"/>
</g>
<!-- sourcefile~m_ia_external.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~m_ia_external.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node11"><a xlink:href=".././sourcefile/m_ia_external.f90.html" xlink:title="m_ia_external.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="335.5,-178.2373 239.5,-178.2373 239.5,-154.2373 335.5,-154.2373 335.5,-178.2373"/>
<text text-anchor="middle" x="287.5" y="-163.8373" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_external.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_ia_external.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~m_ia_external.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M255.1163,-178.3297C249.2641,-180.9721 243.3323,-183.9684 238,-187.2373 217.5718,-199.7603 196.9099,-217.5839 182.4603,-231.0791"/>
<polygon fill="#ff0000" stroke="#ff0000" points="179.945,-228.6412 175.1128,-238.0699 184.7701,-233.7125 179.945,-228.6412"/>
</g>
<!-- sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M407.3704,-365.5363C384.4044,-387.2638 332.8089,-428.6654 287.5,-412.2373"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M287.5,-412.2373C265.3463,-404.2047 255.6051,-408.9015 238,-393.2373 200.5305,-359.8984 178.8027,-303.317 169.1143,-272.2618"/>
<polygon fill="#ff0000" stroke="#ff0000" points="172.3924,-271.0064 166.1834,-262.4216 165.6836,-273.0047 172.3924,-271.0064"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M387.9847,-304.3317C350.9623,-316.6451 288.221,-331.5312 238,-313.2373 214.5424,-304.6924 193.3235,-285.2284 179.4905,-270.1795"/>
<polygon fill="#ff0000" stroke="#ff0000" points="181.8396,-267.5518 172.598,-262.3706 176.5915,-272.1841 181.8396,-267.5518"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_vdw.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_vdw.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M372.9617,-292.2373C361.1355,-292.2373 348.3937,-292.2373 336.4514,-292.2373"/>
<polygon fill="#ff0000" stroke="#ff0000" points="336.2055,-288.7374 326.2055,-292.2373 336.2055,-295.7374 336.2055,-288.7374"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_cell_list.f90</title>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M401.2205,-304.5605C391.7449,-311.7152 380.5977,-321.4375 373,-332.2373 347.2591,-368.8267 366.7151,-392.7948 337,-426.2373 334.1711,-429.421 330.8579,-432.2772 327.3095,-434.8245"/>
<polygon fill="#ff5000" stroke="#ff5000" points="325.3287,-431.9354 318.7202,-440.2166 329.0505,-437.864 325.3287,-431.9354"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_tether.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_tether.f90</title>
<path fill="none" stroke="#ffa100" stroke-dasharray="5,2" d="M381.6741,-280.2017C367.1755,-275.5885 350.4438,-270.2648 335.1423,-265.3962"/>
<polygon fill="#ffa100" stroke="#ffa100" points="335.9219,-261.9714 325.3314,-262.2745 333.7995,-268.6419 335.9219,-261.9714"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_angle.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_angle.f90</title>
<path fill="none" stroke="#fff100" stroke-dasharray="5,2" d="M397.0575,-280.1255C389.1918,-275.5209 380.4638,-269.99 373,-264.2373 355.3254,-250.6143 355.5889,-241.5834 337,-229.2373 334.6307,-227.6636 332.1241,-226.1671 329.5466,-224.7516"/>
<polygon fill="#fff100" stroke="#fff100" points="331.1126,-221.6215 320.606,-220.257 327.9685,-227.8757 331.1126,-221.6215"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_external.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge35" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_external.f90</title>
<path fill="none" stroke="#00ff86" stroke-dasharray="5,2" d="M393.3594,-280.1362C386.1072,-275.8716 378.6752,-270.5398 373,-264.2373 347.7209,-236.1636 364.1908,-213.4636 337,-187.2373 335.7528,-186.0343 334.4262,-184.8953 333.0383,-183.8175"/>
<polygon fill="#00ff86" stroke="#00ff86" points="334.8355,-180.8112 324.5446,-178.2916 331.0181,-186.6788 334.8355,-180.8112"/>
</g>
<!-- sourcefile~m_connectivity.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~m_connectivity.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node14"><a xlink:href=".././sourcefile/m_connectivity.f90.html" xlink:title="m_connectivity.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="337,-136.2373 238,-136.2373 238,-112.2373 337,-112.2373 337,-136.2373"/>
<text text-anchor="middle" x="287.5" y="-121.8373" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_connectivity.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_connectivity.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge45" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_connectivity.f90</title>
<path fill="none" stroke="#0086ff" stroke-dasharray="5,2" d="M391.8016,-280.0553C384.8578,-275.8917 377.977,-270.6331 373,-264.2373 339.0656,-220.6289 373.9172,-186.3512 337,-145.2373 336.1229,-144.2605 335.1929,-143.3277 334.2183,-142.4369"/>
<polygon fill="#0086ff" stroke="#0086ff" points="336.1438,-139.5083 326.015,-136.4005 331.9949,-145.1464 336.1438,-139.5083"/>
</g>
<!-- sourcefile~m_verlet.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~m_verlet.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node17"><a xlink:href=".././sourcefile/m_verlet.f90.html" xlink:title="m_verlet.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="322.5,-94.2373 252.5,-94.2373 252.5,-70.2373 322.5,-70.2373 322.5,-94.2373"/>
<text text-anchor="middle" x="287.5" y="-79.8373" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_verlet.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_verlet.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge47" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_verlet.f90</title>
<path fill="none" stroke="#6b00ff" stroke-dasharray="5,2" d="M391.0008,-280.0001C384.2248,-275.8817 377.6276,-270.6594 373,-264.2373 330.1354,-204.7492 383.9421,-159.5634 337,-103.2373 335.3004,-101.1979 333.3677,-99.3526 331.2744,-97.6832"/>
<polygon fill="#6b00ff" stroke="#6b00ff" points="332.8637,-94.544 322.5596,-92.079 329.0775,-100.4317 332.8637,-94.544"/>
</g>
<!-- sourcefile~m_ia_bond.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node18" class="node">
<title>sourcefile~m_ia_bond.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node18"><a xlink:href=".././sourcefile/m_ia_bond.f90.html" xlink:title="m_ia_bond.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="328.5,-52.2373 246.5,-52.2373 246.5,-28.2373 328.5,-28.2373 328.5,-52.2373"/>
<text text-anchor="middle" x="287.5" y="-37.8373" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_bond.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_bond.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge48" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_bond.f90</title>
<path fill="none" stroke="#bb00ff" stroke-dasharray="5,2" d="M390.8059,-280.1373C384.0314,-276.0178 377.4836,-270.7607 373,-264.2373 321.0989,-188.7235 394.0833,-132.914 337,-61.2373 336.3021,-60.361 335.5609,-59.5207 334.782,-58.715"/>
<polygon fill="#bb00ff" stroke="#bb00ff" points="336.8837,-55.9136 326.9035,-52.3575 332.4878,-61.3612 336.8837,-55.9136"/>
</g>
<!-- sourcefile~m_ia_dihedral.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node21" class="node">
<title>sourcefile~m_ia_dihedral.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node21"><a xlink:href=".././sourcefile/m_ia_dihedral.f90.html" xlink:title="m_ia_dihedral.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="335.5,-384.2373 239.5,-384.2373 239.5,-360.2373 335.5,-360.2373 335.5,-384.2373"/>
<text text-anchor="middle" x="287.5" y="-369.8373" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_dihedral.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_dihedral.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge50" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_dihedral.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M402.1066,-304.3224C385.6191,-315.6092 360.0192,-332.7003 337,-346.2373 331.8004,-349.295 326.2085,-352.4002 320.7211,-355.3498"/>
<polygon fill="#ff0050" stroke="#ff0050" points="318.8791,-352.3644 311.6725,-360.1307 322.1493,-358.5536 318.8791,-352.3644"/>
</g>
<!-- sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M252.3093,-136.2839C247.2424,-138.8189 242.2969,-141.7917 238,-145.2373 208.9447,-168.5362 185.9968,-205.8564 173.4777,-229.1605"/>
<polygon fill="#ff0000" stroke="#ff0000" points="170.2804,-227.7225 168.7634,-238.2082 176.4882,-230.9571 170.2804,-227.7225"/>
</g>
<!-- sourcefile~m_kmc.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~m_kmc.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node15"><a xlink:href=".././sourcefile/m_kmc.f90.html" xlink:title="m_kmc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="579,-262.2373 515,-262.2373 515,-238.2373 579,-238.2373 579,-262.2373"/>
<text text-anchor="middle" x="547" y="-247.8373" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_kmc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_kmc.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~m_kmc.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M514.9431,-258.9296C487.5638,-264.4333 448.1748,-267.6258 419.5,-250.2373"/>
</g>
<!-- sourcefile~m_kmc.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge43" class="edge">
<title>sourcefile~m_kmc.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#00d6ff" stroke-dasharray="5,2" d="M514.8264,-260.8356C500.0422,-265.7057 482.2268,-271.5743 466.0182,-276.9136"/>
<polygon fill="#00d6ff" stroke="#00d6ff" points="464.578,-273.7029 456.1752,-280.156 466.7682,-280.3515 464.578,-273.7029"/>
</g>
<!-- sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~m_setup.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node16"><a xlink:href=".././sourcefile/m_setup.f90.html" xlink:title="m_setup.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="708,-403.2373 638,-403.2373 638,-379.2373 708,-379.2373 708,-403.2373"/>
<text text-anchor="middle" x="673" y="-388.8373" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_setup.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M419.5,-250.2373C326.2823,-193.7098 426.1129,-82.0368 337,-19.2373 301.0337,6.1089 273.5939,6.6292 238,-19.2373 203.3692,-44.4038 176.4897,-174.9804 166.853,-227.9131"/>
<polygon fill="#ff0000" stroke="#ff0000" points="163.3707,-227.505 165.0618,-237.964 170.2621,-228.7332 163.3707,-227.505"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M671.2432,-379.0091C665.9734,-347.4385 647.1018,-263.2921 592,-229.2373 557.974,-208.208 541.6898,-224.2651 502,-229.2373 464.4575,-233.9404 452.0183,-269.5793 419.5,-250.2373"/>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_mpcd.f90</title>
<path fill="none" stroke="#bbff00" stroke-dasharray="5,2" d="M648.1065,-403.2889C628.9507,-412.5627 602.266,-425.4815 581.1206,-435.7186"/>
<polygon fill="#bbff00" stroke="#bbff00" points="579.3174,-432.7029 571.8418,-440.2107 582.3677,-439.0034 579.3174,-432.7029"/>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_bd_solver.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M637.902,-385.9447C626.8656,-384.2805 614.3977,-382.4004 602.3128,-380.5781"/>
<polygon fill="#1aff00" stroke="#1aff00" points="602.7015,-377.0972 592.2914,-379.0669 601.6577,-384.0189 602.7015,-377.0972"/>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge32" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_stats_io.f90</title>
<path fill="none" stroke="#00ff35" stroke-dasharray="5,2" d="M637.91,-399.2352C603.3094,-407.1712 548.9453,-419.7729 502,-431.2373 491.6636,-433.7615 480.6163,-436.5268 470.0754,-439.1979"/>
<polygon fill="#00ff35" stroke="#00ff35" points="468.9926,-435.8618 460.1641,-441.7191 470.7183,-442.6457 468.9926,-435.8618"/>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge37" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_config_io.f90</title>
<path fill="none" stroke="#00ffd6" stroke-dasharray="5,2" d="M547,-332.2373C518.0706,-324.6605 484.6978,-330.6687 459.3534,-338.1683"/>
<polygon fill="#00ffd6" stroke="#00ffd6" points="458.2,-334.862 449.714,-341.2054 460.3036,-341.5385 458.2,-334.862"/>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge42" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#00d6ff" stroke-dasharray="5,2" d="M652.9165,-379.0098C628.7518,-364.9794 586.4891,-342.5796 547,-332.2373"/>
<path fill="none" stroke="#00d6ff" stroke-dasharray="5,2" d="M547,-332.2373C519.2869,-324.9791 488.643,-315.4159 464.3441,-307.4604"/>
<polygon fill="#00d6ff" stroke="#00d6ff" points="465.2792,-304.0834 454.6861,-304.2739 463.0859,-310.7309 465.2792,-304.0834"/>
</g>
<!-- sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M252.3438,-93.4712C247.1573,-96.1308 242.1661,-99.3552 238,-103.2373 200.3122,-138.3558 178.5674,-196.6573 168.9616,-228.2532"/>
<polygon fill="#ff0000" stroke="#ff0000" points="165.491,-227.6542 166.0639,-238.2335 172.2134,-229.606 165.491,-227.6542"/>
</g>
<!-- sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M249.7592,-52.3746C245.4483,-54.8365 241.392,-57.7647 238,-61.2373 191.5259,-108.8147 172.8354,-188.7289 166.2052,-227.6149"/>
<polygon fill="#ff0000" stroke="#ff0000" points="162.6899,-227.4355 164.5792,-237.8605 169.6034,-228.5327 162.6899,-227.4355"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node19" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node19"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="808,-462.2373 754,-462.2373 754,-438.2373 808,-438.2373 808,-462.2373"/>
<text text-anchor="middle" x="781" y="-447.8373" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M772.5662,-462.2791C761.7511,-476.657 741.5545,-500.1493 718,-511.2373 648.8145,-543.8054 623.1273,-523.0302 547,-530.2373"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_mpcd.f90</title>
<path fill="none" stroke="#bbff00" stroke-dasharray="5,2" d="M673,-450.2373C646.5108,-446.3298 616.5508,-446.6156 592.4931,-447.9783"/>
<polygon fill="#bbff00" stroke="#bbff00" points="591.9834,-444.504 582.2309,-448.644 592.4365,-451.4893 591.9834,-444.504"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_control_io.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_control_io.f90</title>
<path fill="none" stroke="#6bff00" stroke-dasharray="5,2" d="M753.747,-460.3309C742.0949,-464.6466 728.2199,-469.7855 715.2866,-474.5755"/>
<polygon fill="#6bff00" stroke="#6bff00" points="713.7943,-471.3958 705.6325,-478.1512 716.2256,-477.9601 713.7943,-471.3958"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_bd_solver.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M753.765,-452.4248C731.8305,-453.6625 700.2674,-454.2595 673,-450.2373"/>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M673,-450.2373C630.1972,-443.9233 589.2558,-412.2443 566.2015,-391.2507"/>
<polygon fill="#1aff00" stroke="#1aff00" points="568.5084,-388.6159 558.8192,-384.3298 563.7208,-393.7226 568.5084,-388.6159"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge46" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M758.884,-438.1554C743.1588,-429.5648 721.8136,-417.904 704.3373,-408.3567"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="705.5403,-405.0257 695.0864,-403.303 702.1843,-411.1688 705.5403,-405.0257"/>
</g>
<!-- sourcefile~m_relax.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node20" class="node">
<title>sourcefile~m_relax.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node20"><a xlink:href=".././sourcefile/m_relax.f90.html" xlink:title="m_relax.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="580.5,-304.2373 513.5,-304.2373 513.5,-280.2373 580.5,-280.2373 580.5,-304.2373"/>
<text text-anchor="middle" x="547" y="-289.8373" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_relax.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_relax.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge49" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_relax.f90</title>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M774.084,-438.1838C763.7712,-421.1088 742.8853,-389.7846 718,-370.2373 679.4163,-339.9298 627.1645,-318.3158 590.6115,-305.6387"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="591.3367,-302.1893 580.7424,-302.3003 589.0936,-308.8202 591.3367,-302.1893"/>
</g>
<!-- sourcefile~m_relax.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~m_relax.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M513.3838,-283.0266C481.2613,-273.8941 435.4422,-259.9047 419.5,-250.2373"/>
</g>
<!-- sourcefile~m_relax.f90&#45;&gt;sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge33" class="edge">
<title>sourcefile~m_relax.f90&#45;&gt;sourcefile~m_stats_io.f90</title>
<path fill="none" stroke="#00ff35" stroke-dasharray="5,2" d="M521.1827,-304.2494C514.4668,-308.1183 507.563,-312.8276 502,-318.2373 497.3479,-322.7611 454.1481,-394.3972 432.1889,-431.0232"/>
<polygon fill="#00ff35" stroke="#00ff35" points="428.9896,-429.5531 426.8534,-439.9304 434.9947,-433.1502 428.9896,-429.5531"/>
</g>
<!-- sourcefile~m_relax.f90&#45;&gt;sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge38" class="edge">
<title>sourcefile~m_relax.f90&#45;&gt;sourcefile~m_config_io.f90</title>
<path fill="none" stroke="#00ffd6" stroke-dasharray="5,2" d="M521.8101,-304.2889C502.339,-313.6045 475.1805,-326.5979 453.738,-336.8567"/>
<polygon fill="#00ffd6" stroke="#00ffd6" points="452.1478,-333.7375 444.6376,-341.2107 455.1689,-340.0521 452.1478,-333.7375"/>
</g>
<!-- sourcefile~m_relax.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge44" class="edge">
<title>sourcefile~m_relax.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#00d6ff" stroke-dasharray="5,2" d="M513.1671,-292.2373C501.9856,-292.2373 489.2162,-292.2373 476.7787,-292.2373"/>
<polygon fill="#00d6ff" stroke="#00d6ff" points="476.4515,-288.7374 466.4515,-292.2373 476.4515,-295.7374 476.4515,-288.7374"/>
</g>
<!-- sourcefile~m_ia_dihedral.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~m_ia_dihedral.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M259.4836,-360.1461C252.0975,-356.2769 244.4085,-351.5872 238,-346.2373 211.8355,-324.3944 188.8918,-292.0096 175.4821,-271.011"/>
<polygon fill="#ff0000" stroke="#ff0000" points="178.4392,-269.1385 170.1758,-262.5078 172.5007,-272.8444 178.4392,-269.1385"/>
</g>
</g>
</svg>
</div><script>var pansourcefilem_trajectoryf90AfferentGraph = svgPanZoom('#sourcefilem_trajectoryf90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_trajectory.html">m_trajectory</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_trajectory.f90.html#src">m_trajectory.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">module </span><span class="n">m_trajectory</span>
<a name="ln-2"></a>    <span class="c">!! Routines for reading and writing frames from a trajectory file.</span>
<a name="ln-3"></a> 
<a name="ln-4"></a><span class="k">use </span><span class="n">m_precision</span>
<a name="ln-5"></a><span class="k">use </span><span class="n">m_logger</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">logger</span> <span class="o">=&gt;</span> <span class="n">master_logger</span>
<a name="ln-6"></a>
<a name="ln-7"></a><span class="k">implicit none</span>
<a name="ln-8"></a>
<a name="ln-9"></a><span class="k">type </span><span class="n">trajectory_t</span>
<a name="ln-10"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">header_size</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-11"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">frame_size</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-12"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">num_atoms</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-13"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">num_mpcd_atoms</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-14"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">num_atoms_tot</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-15"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">frmcmp</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-16"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">fn</span>
<a name="ln-17"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">file_id</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-18"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">num_frames</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-19"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">isopen</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-20"></a>
<a name="ln-21"></a>    <span class="k">contains</span>
<a name="ln-22"></a><span class="k">        procedure</span> <span class="kd">::</span> <span class="n">create</span>       <span class="o">=&gt;</span> <span class="n">traj_create</span>
<a name="ln-23"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="k">open</span>         <span class="o">=&gt;</span> <span class="n">traj_open</span>
<a name="ln-24"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">clear</span>        <span class="o">=&gt;</span> <span class="n">traj_clear</span>
<a name="ln-25"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="k">close</span>        <span class="o">=&gt;</span> <span class="n">traj_close</span>
<a name="ln-26"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="k">read</span>         <span class="o">=&gt;</span> <span class="n">traj_read</span>
<a name="ln-27"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">append_frame</span> <span class="o">=&gt;</span> <span class="n">traj_append_frame</span>
<a name="ln-28"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">write_frame</span>  <span class="o">=&gt;</span> <span class="n">traj_write_frame</span>
<a name="ln-29"></a>        <span class="k">generic</span>   <span class="kd">::</span> <span class="n">init</span>         <span class="o">=&gt;</span> <span class="n">create</span><span class="p">,</span> <span class="k">open</span>
<a name="ln-30"></a><span class="k">end type </span><span class="n">trajectory_t</span>
<a name="ln-31"></a> 
<a name="ln-32"></a><span class="k">contains</span>
<a name="ln-33"></a>
<a name="ln-34"></a><span class="c">!******************************************************************************</span>
<a name="ln-35"></a>
<a name="ln-36"></a><span class="k">subroutine </span><span class="n">traj_create</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">na</span><span class="p">,</span> <span class="n">nam</span><span class="p">,</span> <span class="n">frmcmp</span><span class="p">)</span>
<a name="ln-37"></a>    <span class="c">!!  Creates a `trajectory_t` object with a new underlying file named `fn`.  If</span>
<a name="ln-38"></a>    <span class="c">!!  `fn` already exists, it will be truncated.  The file `fn` is opened for both</span>
<a name="ln-39"></a>    <span class="c">!!  reading and writing.</span>
<a name="ln-40"></a>
<a name="ln-41"></a>    <span class="k">class</span><span class="p">(</span><span class="n">trajectory_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-42"></a>        <span class="c">!! *trajectory_t* instance.</span>
<a name="ln-43"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fn</span>
<a name="ln-44"></a>        <span class="c">!! Name of the underlying trajectory file.</span>
<a name="ln-45"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">na</span>
<a name="ln-46"></a>        <span class="c">!! Number of non-MPCD atoms</span>
<a name="ln-47"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nam</span>
<a name="ln-48"></a>        <span class="c">!! Number of MPCD atoms, pass zero to indicate no data from MPCD</span>
<a name="ln-49"></a>        <span class="c">!! particles are present.</span>
<a name="ln-50"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">frmcmp</span>
<a name="ln-51"></a>        <span class="c">!! Binary flags indicating whether that component is present in a frame.</span>
<a name="ln-52"></a>        <span class="c">!! frmcmp(1): coordinates, frmcmp(2): velocities, frmcmp(3): forces,</span>
<a name="ln-53"></a>        <span class="c">!! frmcmp(4): charges</span>
<a name="ln-54"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">nat</span><span class="p">,</span> <span class="n">file_id</span>
<a name="ln-55"></a>
<a name="ln-56"></a>    <span class="n">nat</span> <span class="o">=</span> <span class="n">na</span> <span class="o">+</span> <span class="n">nam</span>
<a name="ln-57"></a>    <span class="n">this</span><span class="p">%</span><span class="n">num_atoms</span> <span class="o">=</span> <span class="n">na</span><span class="p">;</span> <span class="n">this</span><span class="p">%</span><span class="n">num_mpcd_atoms</span> <span class="o">=</span> <span class="n">nam</span><span class="p">;</span> <span class="n">this</span><span class="p">%</span><span class="n">num_atoms_tot</span> <span class="o">=</span> <span class="n">nat</span>
<a name="ln-58"></a>    <span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span> <span class="o">=</span> <span class="n">frmcmp</span>
<a name="ln-59"></a>    
<a name="ln-60"></a>    <span class="c">!Frame components: nts, coordinates, velocities, forces, charge</span>
<a name="ln-61"></a>    <span class="c">!nts data</span>
<a name="ln-62"></a>    <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span> <span class="o">=</span> <span class="n">sizeof_long_int</span>
<a name="ln-63"></a>    <span class="c">!Coordinate data</span>
<a name="ln-64"></a>    <span class="k">if</span> <span class="p">(</span> <span class="n">frmcmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span> <span class="p">)</span> <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">nat</span><span class="o">*</span><span class="n">sizeof_real</span>
<a name="ln-65"></a>    <span class="c">!Velocity data</span>
<a name="ln-66"></a>    <span class="k">if</span> <span class="p">(</span> <span class="n">frmcmp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span> <span class="p">)</span> <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">nat</span><span class="o">*</span><span class="n">sizeof_real</span>
<a name="ln-67"></a>    <span class="c">!Force data</span>
<a name="ln-68"></a>    <span class="k">if</span> <span class="p">(</span> <span class="n">frmcmp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span> <span class="p">)</span> <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">na</span><span class="o">*</span><span class="n">sizeof_real</span>
<a name="ln-69"></a>    <span class="c">!Charge data</span>
<a name="ln-70"></a>    <span class="k">if</span> <span class="p">(</span> <span class="n">frmcmp</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span> <span class="p">)</span> <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span> <span class="o">+</span> <span class="n">na</span><span class="o">*</span><span class="n">sizeof_real</span>
<a name="ln-71"></a>
<a name="ln-72"></a>    <span class="c">! Representation of header:</span>
<a name="ln-73"></a>    <span class="c">!     * 1 int for `header_size`</span>
<a name="ln-74"></a>    <span class="c">!     * 1 int for `frame_size`</span>
<a name="ln-75"></a>    <span class="c">!     * 2 ints:  `num_atoms`, `num_mpcd_atoms`</span>
<a name="ln-76"></a>    <span class="c">!     * 4 ints:  `frmcmp`</span>
<a name="ln-77"></a>
<a name="ln-78"></a>    <span class="n">this</span><span class="p">%</span><span class="n">header_size</span> <span class="o">=</span> <span class="mi">8</span><span class="o">*</span><span class="n">sizeof_int</span>
<a name="ln-79"></a>
<a name="ln-80"></a>    <span class="c">!Create trajectory file</span>
<a name="ln-81"></a>    <span class="k">open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">file_id</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">fn</span><span class="p">,</span> <span class="nb">access</span><span class="o">=</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="s1">&#39;unformatted&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-82"></a>            <span class="n">action</span><span class="o">=</span><span class="s1">&#39;readwrite&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">)</span>
<a name="ln-83"></a>
<a name="ln-84"></a>    <span class="n">this</span><span class="p">%</span><span class="n">fn</span> <span class="o">=</span> <span class="n">fn</span>
<a name="ln-85"></a>    <span class="n">this</span><span class="p">%</span><span class="n">file_id</span> <span class="o">=</span> <span class="n">file_id</span>
<a name="ln-86"></a>    <span class="n">this</span><span class="p">%</span><span class="n">num_frames</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-87"></a>    <span class="n">this</span><span class="p">%</span><span class="n">isopen</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-88"></a>
<a name="ln-89"></a>    <span class="k">write</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">this</span><span class="p">%</span><span class="n">header_size</span>
<a name="ln-90"></a>    <span class="k">write</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span>
<a name="ln-91"></a>    <span class="k">write</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">this</span><span class="p">%</span><span class="n">num_atoms</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="n">num_mpcd_atoms</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span>
<a name="ln-92"></a>
<a name="ln-93"></a>    <span class="k">end subroutine</span>
<a name="ln-94"></a>
<a name="ln-95"></a><span class="c">!******************************************************************************</span>
<a name="ln-96"></a>
<a name="ln-97"></a><span class="k">subroutine </span><span class="n">traj_open</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">ierr</span><span class="p">)</span>
<a name="ln-98"></a>    <span class="c">!!  Creates a `trajectory_t` object with a prexisting underlying file named</span>
<a name="ln-99"></a>    <span class="c">!!  `fn`.  If `fn` does not exist, an error will be generated. If</span>
<a name="ln-100"></a>    <span class="c">!!  `mode` == &#39;rw&#39;, the file `fn` is opened for both reading and writing.</span>
<a name="ln-101"></a>    <span class="c">!!  If `mode` == &#39;r&#39;, the file `fn` is opened only for reading.</span>
<a name="ln-102"></a>    <span class="c">!&quot;&quot;</span>
<a name="ln-103"></a>    <span class="k">class</span><span class="p">(</span><span class="n">trajectory_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-104"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fn</span>
<a name="ln-105"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mode</span>
<a name="ln-106"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-107"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ip_long</span><span class="p">)</span> <span class="kd">::</span> <span class="n">file_size</span>
<a name="ln-108"></a>    
<a name="ln-109"></a>    <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-110"></a>    <span class="n">this</span><span class="p">%</span><span class="n">fn</span> <span class="o">=</span> <span class="n">fn</span>
<a name="ln-111"></a>
<a name="ln-112"></a>    <span class="c">!Readwrite mode</span>
<a name="ln-113"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;rw&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-114"></a><span class="k">        open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">this</span><span class="p">%</span><span class="n">fn</span><span class="p">,</span> <span class="nb">access</span><span class="o">=</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-115"></a>            <span class="n">form</span><span class="o">=</span><span class="s1">&#39;unformatted&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;readwrite&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;old&#39;</span><span class="p">)</span>
<a name="ln-116"></a>    <span class="c">!Readonly mode</span>
<a name="ln-117"></a>    <span class="k">else if</span> <span class="p">(</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-118"></a><span class="k">        open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">this</span><span class="p">%</span><span class="n">fn</span><span class="p">,</span> <span class="nb">access</span><span class="o">=</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-119"></a>            <span class="n">form</span><span class="o">=</span><span class="s1">&#39;unformatted&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;read&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;old&#39;</span><span class="p">)</span>
<a name="ln-120"></a>    <span class="c">!Unknown mode</span>
<a name="ln-121"></a>    <span class="k">else</span>
<a name="ln-122"></a><span class="k">        call </span><span class="n">logger</span><span class="p">%</span><span class="n">fatal</span><span class="p">(</span><span class="s1">&#39;traj_open&#39;</span><span class="p">,</span> <span class="s1">&#39;file open error. Bad mode &#39;</span><span class="o">//</span><span class="n">mode</span><span class="p">)</span>
<a name="ln-123"></a>        <span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-124"></a>        <span class="k">return</span>
<a name="ln-125"></a><span class="k">    end if</span>
<a name="ln-126"></a>
<a name="ln-127"></a><span class="k">    </span><span class="n">this</span><span class="p">%</span><span class="n">isopen</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-128"></a>
<a name="ln-129"></a>    <span class="c">!Get size of the file</span>
<a name="ln-130"></a>    <span class="k">inquire</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">file_size</span><span class="p">)</span>
<a name="ln-131"></a>
<a name="ln-132"></a>    <span class="k">read</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">this</span><span class="p">%</span><span class="n">header_size</span>
<a name="ln-133"></a>    <span class="k">read</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span>
<a name="ln-134"></a>    <span class="k">read</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">this</span><span class="p">%</span><span class="n">num_atoms</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="n">num_mpcd_atoms</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span>
<a name="ln-135"></a>
<a name="ln-136"></a>    <span class="n">this</span><span class="p">%</span><span class="n">num_atoms_tot</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">num_atoms</span> <span class="o">+</span> <span class="n">this</span><span class="p">%</span><span class="n">num_mpcd_atoms</span>
<a name="ln-137"></a>
<a name="ln-138"></a>    <span class="c">!Integer division to find `num_frames`</span>
<a name="ln-139"></a>    <span class="n">this</span><span class="p">%</span><span class="n">num_frames</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">file_size</span><span class="o">-</span><span class="n">this</span><span class="p">%</span><span class="n">header_size</span><span class="p">)</span><span class="o">/</span><span class="n">this</span><span class="p">%</span><span class="n">frame_size</span><span class="p">,</span> <span class="n">ip</span><span class="p">)</span> 
<a name="ln-140"></a>
<a name="ln-141"></a>    <span class="k">end subroutine</span>
<a name="ln-142"></a>
<a name="ln-143"></a><span class="c">!******************************************************************************</span>
<a name="ln-144"></a>
<a name="ln-145"></a><span class="k">subroutine </span><span class="n">traj_clear</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-146"></a>   <span class="c">!! After a call to this subroutine, all memory within `this` is deallocated,</span>
<a name="ln-147"></a>   <span class="c">!! all components of `this` are reset to zero, and the underlying file is</span>
<a name="ln-148"></a>   <span class="c">!! closed (if open).</span>
<a name="ln-149"></a>
<a name="ln-150"></a>    <span class="k">class</span><span class="p">(</span><span class="n">trajectory_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-151"></a>
<a name="ln-152"></a>    <span class="k">call </span><span class="n">this</span><span class="p">%</span><span class="k">close</span><span class="p">()</span>
<a name="ln-153"></a>
<a name="ln-154"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">fn</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">fn</span><span class="p">)</span>
<a name="ln-155"></a>
<a name="ln-156"></a>    <span class="n">this</span><span class="p">%</span><span class="n">header_size</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-157"></a>    <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-158"></a>    <span class="n">this</span><span class="p">%</span><span class="n">num_atoms</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-159"></a>    <span class="n">this</span><span class="p">%</span><span class="n">num_mpcd_atoms</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-160"></a>    <span class="n">this</span><span class="p">%</span><span class="n">num_atoms_tot</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-161"></a>    <span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-162"></a>    <span class="n">this</span><span class="p">%</span><span class="n">file_id</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-163"></a>    <span class="n">this</span><span class="p">%</span><span class="n">num_frames</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-164"></a>
<a name="ln-165"></a>    <span class="k">end subroutine</span>
<a name="ln-166"></a>
<a name="ln-167"></a><span class="c">!******************************************************************************</span>
<a name="ln-168"></a>
<a name="ln-169"></a><span class="k">subroutine </span><span class="n">traj_close</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-170"></a>    <span class="c">!! Closes the underlying file of a `trajectory_t`.</span>
<a name="ln-171"></a>
<a name="ln-172"></a>    <span class="k">class</span><span class="p">(</span><span class="n">trajectory_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-173"></a>
<a name="ln-174"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">isopen</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-175"></a><span class="k">        close</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span>
<a name="ln-176"></a>        <span class="n">this</span><span class="p">%</span><span class="n">isopen</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-177"></a>    <span class="k">end if</span>
<a name="ln-178"></a>
<a name="ln-179"></a><span class="k">    end subroutine</span>
<a name="ln-180"></a>
<a name="ln-181"></a><span class="c">!******************************************************************************</span>
<a name="ln-182"></a>
<a name="ln-183"></a><span class="k">subroutine </span><span class="n">traj_read</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">iframe</span><span class="p">,</span> <span class="n">nts</span><span class="p">,</span> <span class="n">ierr</span><span class="p">,</span> <span class="n">mflag</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-184"></a>        <span class="n">coordinates</span><span class="p">,</span> <span class="n">velocities</span><span class="p">,</span> <span class="n">forces</span><span class="p">,</span> <span class="n">charge</span><span class="p">)</span>
<a name="ln-185"></a>    <span class="c">!! Read from an open trajectory.</span>
<a name="ln-186"></a>
<a name="ln-187"></a>    <span class="k">class</span><span class="p">(</span><span class="n">trajectory_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-188"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iframe</span>
<a name="ln-189"></a>        <span class="c">!! Frame number</span>
<a name="ln-190"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ip_long</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nts</span>
<a name="ln-191"></a>        <span class="c">!! Time step counter</span>
<a name="ln-192"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-193"></a>        <span class="c">!! Error flag</span>
<a name="ln-194"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>  <span class="kd">::</span> <span class="n">mflag</span>
<a name="ln-195"></a>        <span class="c">!! 1: Only non-MPCD data, 2: Only MPCD data, 3: All data</span>
<a name="ln-196"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">coordinates</span>
<a name="ln-197"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">velocities</span>
<a name="ln-198"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">forces</span>
<a name="ln-199"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">charge</span>
<a name="ln-200"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ip_long</span><span class="p">)</span> <span class="kd">::</span> <span class="n">offset_frm</span>
<a name="ln-201"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ip_long</span><span class="p">)</span> <span class="kd">::</span> <span class="n">offset_if</span>
<a name="ln-202"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ip_long</span><span class="p">)</span> <span class="kd">::</span> <span class="n">offset_tot</span>
<a name="ln-203"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">na</span><span class="p">,</span> <span class="n">nat</span><span class="p">,</span> <span class="n">nam</span>
<a name="ln-204"></a>
<a name="ln-205"></a>    <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-206"></a>    <span class="n">na</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">num_atoms</span><span class="p">;</span> <span class="n">nam</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">num_mpcd_atoms</span><span class="p">;</span> <span class="n">nat</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">num_atoms_tot</span>
<a name="ln-207"></a>
<a name="ln-208"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">iframe</span> <span class="o">&gt;</span> <span class="n">this</span><span class="p">%</span><span class="n">num_frames</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-209"></a><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;`iframe`&#39;</span><span class="p">,</span> <span class="n">iframe</span><span class="p">,</span> <span class="s1">&#39;out of bounds for `num_frames`&#39;</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="n">num_frames</span>
<a name="ln-210"></a>        <span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-211"></a>        <span class="k">return</span>
<a name="ln-212"></a><span class="k">    end if</span>
<a name="ln-213"></a>
<a name="ln-214"></a><span class="k">    select case</span><span class="p">(</span><span class="n">mflag</span><span class="p">)</span>
<a name="ln-215"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-216"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">na</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-217"></a><span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;No data for non-MPCD atoms&#39;</span><span class="p">;</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">return</span>
<a name="ln-218"></a><span class="k">        end if</span>
<a name="ln-219"></a><span class="k">    case</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-220"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">nam</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-221"></a><span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;No data for MPCD atoms&#39;</span><span class="p">;</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">return</span>
<a name="ln-222"></a><span class="k">        end if</span>
<a name="ln-223"></a><span class="k">    case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-224"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">nat</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-225"></a><span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;No data for any atoms&#39;</span><span class="p">;</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">return</span>
<a name="ln-226"></a><span class="k">        end if</span>
<a name="ln-227"></a><span class="k">    case </span><span class="n">default</span>
<a name="ln-228"></a>        <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Unknown mflag = &#39;</span><span class="p">,</span> <span class="n">mflag</span><span class="p">;</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">return</span>
<a name="ln-229"></a><span class="k">    end select</span>
<a name="ln-230"></a>
<a name="ln-231"></a><span class="k">    </span><span class="n">offset_frm</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span>
<a name="ln-232"></a>    <span class="n">offset_frm</span> <span class="o">=</span> <span class="p">(</span><span class="n">iframe</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">offset_frm</span> <span class="o">+</span> <span class="n">this</span><span class="p">%</span><span class="n">header_size</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-233"></a>
<a name="ln-234"></a>    <span class="k">read</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">offset_frm</span><span class="p">)</span> <span class="n">nts</span>
<a name="ln-235"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">coordinates</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-236"></a><span class="k">        if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-237"></a><span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;No coordinate data in frame&#39;</span><span class="p">;</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">return</span>
<a name="ln-238"></a><span class="k">        else</span>
<a name="ln-239"></a><span class="k">            select case</span><span class="p">(</span><span class="n">mflag</span><span class="p">)</span>
<a name="ln-240"></a>            <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-241"></a>                <span class="n">offset_if</span> <span class="o">=</span> <span class="n">sizeof_long_int</span>
<a name="ln-242"></a>                <span class="n">offset_tot</span> <span class="o">=</span> <span class="n">offset_frm</span> <span class="o">+</span> <span class="n">offset_if</span>
<a name="ln-243"></a>                <span class="k">read</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">offset_tot</span><span class="p">)</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">na</span><span class="p">)</span>
<a name="ln-244"></a>            <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-245"></a>                <span class="n">offset_if</span> <span class="o">=</span> <span class="n">sizeof_long_int</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">na</span><span class="o">*</span><span class="n">sizeof_real</span>
<a name="ln-246"></a>                <span class="n">offset_tot</span> <span class="o">=</span> <span class="n">offset_frm</span> <span class="o">+</span> <span class="n">offset_if</span>
<a name="ln-247"></a>                <span class="k">read</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">offset_tot</span><span class="p">)</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">nam</span><span class="p">)</span>
<a name="ln-248"></a>            <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-249"></a>                <span class="n">offset_if</span> <span class="o">=</span> <span class="n">sizeof_long_int</span>
<a name="ln-250"></a>                <span class="n">offset_tot</span> <span class="o">=</span> <span class="n">offset_frm</span> <span class="o">+</span> <span class="n">offset_if</span>
<a name="ln-251"></a>                <span class="k">read</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">offset_tot</span><span class="p">)</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">nat</span><span class="p">)</span>
<a name="ln-252"></a>            <span class="k">end select</span>
<a name="ln-253"></a><span class="k">        end if</span>
<a name="ln-254"></a><span class="k">    end if</span>
<a name="ln-255"></a>
<a name="ln-256"></a><span class="k">    if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">velocities</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-257"></a><span class="k">        if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-258"></a><span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;No velocity data in frame&#39;</span><span class="p">;</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">return</span>
<a name="ln-259"></a><span class="k">        else</span>
<a name="ln-260"></a><span class="k">            select case</span><span class="p">(</span><span class="n">mflag</span><span class="p">)</span>
<a name="ln-261"></a>            <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-262"></a>                <span class="n">offset_if</span> <span class="o">=</span> <span class="n">sizeof_long_int</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">nat</span><span class="o">*</span><span class="n">sizeof_real</span><span class="o">*</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-263"></a>                <span class="n">offset_tot</span> <span class="o">=</span> <span class="n">offset_frm</span> <span class="o">+</span> <span class="n">offset_if</span>
<a name="ln-264"></a>                <span class="k">read</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">offset_tot</span><span class="p">)</span> <span class="n">velocities</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">na</span><span class="p">)</span>
<a name="ln-265"></a>            <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-266"></a>                <span class="n">offset_if</span> <span class="o">=</span> <span class="n">sizeof_long_int</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">nat</span><span class="o">*</span><span class="n">sizeof_real</span><span class="o">*</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-267"></a>                            <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">na</span><span class="o">*</span><span class="n">sizeof_real</span><span class="o">*</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-268"></a>                <span class="n">offset_tot</span> <span class="o">=</span> <span class="n">offset_frm</span> <span class="o">+</span> <span class="n">offset_if</span>
<a name="ln-269"></a>                <span class="k">read</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">offset_tot</span><span class="p">)</span> <span class="n">velocities</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">nam</span><span class="p">)</span>
<a name="ln-270"></a>            <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-271"></a>                <span class="n">offset_if</span> <span class="o">=</span> <span class="n">sizeof_long_int</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">nat</span><span class="o">*</span><span class="n">sizeof_real</span><span class="o">*</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-272"></a>                <span class="n">offset_tot</span> <span class="o">=</span> <span class="n">offset_frm</span> <span class="o">+</span> <span class="n">offset_if</span>
<a name="ln-273"></a>                <span class="k">read</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">offset_tot</span><span class="p">)</span> <span class="n">velocities</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">nat</span><span class="p">)</span>
<a name="ln-274"></a>            <span class="k">end select</span>
<a name="ln-275"></a><span class="k">        end if</span>
<a name="ln-276"></a><span class="k">    end if</span>
<a name="ln-277"></a>
<a name="ln-278"></a><span class="k">    if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">forces</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-279"></a><span class="k">        if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-280"></a><span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;No force data in frame&#39;</span><span class="p">;</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">return</span>
<a name="ln-281"></a><span class="k">        else</span>
<a name="ln-282"></a><span class="k">            </span><span class="n">offset_if</span> <span class="o">=</span> <span class="n">sizeof_long_int</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">nat</span><span class="o">*</span><span class="n">sizeof_real</span><span class="o">*</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-283"></a>                        <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">nat</span><span class="o">*</span><span class="n">sizeof_real</span><span class="o">*</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-284"></a>            <span class="n">offset_tot</span> <span class="o">=</span> <span class="n">offset_frm</span> <span class="o">+</span> <span class="n">offset_if</span>
<a name="ln-285"></a>            <span class="k">read</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">offset_tot</span><span class="p">)</span> <span class="n">forces</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">na</span><span class="p">)</span>
<a name="ln-286"></a>        <span class="k">end if</span>
<a name="ln-287"></a><span class="k">    end if</span>
<a name="ln-288"></a>
<a name="ln-289"></a><span class="k">    if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">charge</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-290"></a><span class="k">        if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-291"></a><span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;No charge data in frame&#39;</span><span class="p">;</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">return</span>
<a name="ln-292"></a><span class="k">        else</span>
<a name="ln-293"></a><span class="k">            </span><span class="n">offset_if</span> <span class="o">=</span> <span class="n">sizeof_long_int</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">nat</span><span class="o">*</span><span class="n">sizeof_real</span><span class="o">*</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-294"></a>                        <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">nat</span><span class="o">*</span><span class="n">sizeof_real</span><span class="o">*</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-295"></a>                        <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">na</span><span class="o">*</span><span class="n">sizeof_real</span><span class="o">*</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-296"></a>            <span class="n">offset_tot</span> <span class="o">=</span> <span class="n">offset_frm</span> <span class="o">+</span> <span class="n">offset_if</span>
<a name="ln-297"></a>            <span class="k">read</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">offset_tot</span><span class="p">)</span> <span class="n">charge</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">na</span><span class="p">)</span>
<a name="ln-298"></a>        <span class="k">end if</span>
<a name="ln-299"></a><span class="k">    end if</span>
<a name="ln-300"></a>
<a name="ln-301"></a><span class="k">    end subroutine</span>
<a name="ln-302"></a>
<a name="ln-303"></a><span class="c">!******************************************************************************</span>
<a name="ln-304"></a>
<a name="ln-305"></a><span class="k">subroutine </span><span class="n">traj_append_frame</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">nts</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">,</span> <span class="n">velocities</span><span class="p">,</span> <span class="n">forces</span><span class="p">,</span> <span class="n">charge</span><span class="p">)</span>
<a name="ln-306"></a>    <span class="c">!! Write a frame to an open trajectory</span>
<a name="ln-307"></a>
<a name="ln-308"></a>    <span class="k">class</span><span class="p">(</span><span class="n">trajectory_t</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-309"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ip_long</span><span class="p">),</span>         <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nts</span>
<a name="ln-310"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">coordinates</span>
<a name="ln-311"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">velocities</span>
<a name="ln-312"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">forces</span>
<a name="ln-313"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">charge</span>
<a name="ln-314"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iframe</span>
<a name="ln-315"></a>
<a name="ln-316"></a>    <span class="n">iframe</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">num_frames</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-317"></a>    <span class="k">call </span><span class="n">this</span><span class="p">%</span><span class="n">write_frame</span><span class="p">(</span><span class="n">iframe</span><span class="p">,</span> <span class="n">nts</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">,</span> <span class="n">velocities</span><span class="p">,</span> <span class="n">forces</span><span class="p">,</span> <span class="n">charge</span><span class="p">)</span>
<a name="ln-318"></a>
<a name="ln-319"></a>    <span class="k">end subroutine</span>
<a name="ln-320"></a>
<a name="ln-321"></a><span class="c">!******************************************************************************</span>
<a name="ln-322"></a>
<a name="ln-323"></a><span class="k">subroutine </span><span class="n">traj_write_frame</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">iframe</span><span class="p">,</span> <span class="n">nts</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">,</span> <span class="n">velocities</span><span class="p">,</span> <span class="n">forces</span><span class="p">,</span> <span class="n">charge</span><span class="p">)</span>
<a name="ln-324"></a>    <span class="c">!! Write a frame to an open trajectory</span>
<a name="ln-325"></a>
<a name="ln-326"></a>    <span class="k">class</span><span class="p">(</span><span class="n">trajectory_t</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-327"></a>    <span class="kt">integer</span><span class="p">,</span>                  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iframe</span>
<a name="ln-328"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ip_long</span><span class="p">),</span>         <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nts</span>
<a name="ln-329"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">coordinates</span>
<a name="ln-330"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">velocities</span>
<a name="ln-331"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">forces</span>
<a name="ln-332"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">charge</span>
<a name="ln-333"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ip_long</span><span class="p">)</span> <span class="kd">::</span> <span class="n">offset</span>
<a name="ln-334"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">na</span><span class="p">,</span> <span class="n">nat</span><span class="p">,</span> <span class="n">nam</span>
<a name="ln-335"></a>
<a name="ln-336"></a>    <span class="n">na</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">num_atoms</span><span class="p">;</span> <span class="n">nam</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">num_mpcd_atoms</span><span class="p">;</span> <span class="n">nat</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">num_atoms_tot</span>
<a name="ln-337"></a>
<a name="ln-338"></a>    <span class="c">! Added one to handle appending a frame</span>
<a name="ln-339"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">iframe</span> <span class="o">&gt;</span> <span class="n">this</span><span class="p">%</span><span class="n">num_frames</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-340"></a><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;`iframe`&#39;</span><span class="p">,</span> <span class="n">iframe</span><span class="p">,</span> <span class="s1">&#39;out of bounds for `num_frames`&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-341"></a>            <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">num_frames</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-342"></a>        <span class="k">return</span>
<a name="ln-343"></a><span class="k">    end if</span>
<a name="ln-344"></a>
<a name="ln-345"></a><span class="k">    </span><span class="n">offset</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span>
<a name="ln-346"></a>    <span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">iframe</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">offset</span> <span class="o">+</span> <span class="n">this</span><span class="p">%</span><span class="n">header_size</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-347"></a>
<a name="ln-348"></a>    <span class="k">write</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span> <span class="n">nts</span>
<a name="ln-349"></a>
<a name="ln-350"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-351"></a><span class="k">        if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">num_atoms</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-352"></a><span class="k">            write</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">na</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-353"></a>        <span class="k">else if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">num_mpcd_atoms</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-354"></a><span class="k">            write</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">na</span><span class="p">)</span>
<a name="ln-355"></a>        <span class="k">else</span>
<a name="ln-356"></a><span class="k">            write</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">nat</span><span class="p">)</span>
<a name="ln-357"></a>        <span class="k">end if</span>
<a name="ln-358"></a><span class="k">    end if</span>
<a name="ln-359"></a>
<a name="ln-360"></a><span class="k">    if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-361"></a><span class="k">        if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">num_atoms</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-362"></a><span class="k">            write</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">velocities</span><span class="p">(:,</span><span class="n">na</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-363"></a>        <span class="k">else if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">num_mpcd_atoms</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-364"></a><span class="k">            write</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">velocities</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">na</span><span class="p">)</span>
<a name="ln-365"></a>        <span class="k">else</span>
<a name="ln-366"></a><span class="k">            write</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">velocities</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">nat</span><span class="p">)</span>
<a name="ln-367"></a>        <span class="k">end if</span>
<a name="ln-368"></a><span class="k">    end if</span>
<a name="ln-369"></a>
<a name="ln-370"></a><span class="k">    if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">forces</span>
<a name="ln-371"></a>
<a name="ln-372"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">charge</span>
<a name="ln-373"></a>
<a name="ln-374"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">iframe</span> <span class="o">==</span> <span class="n">this</span><span class="p">%</span><span class="n">num_frames</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="n">this</span><span class="p">%</span><span class="n">num_frames</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">num_frames</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-375"></a>
<a name="ln-376"></a>    <span class="k">end subroutine</span>
<a name="ln-377"></a>
<a name="ln-378"></a><span class="c">!******************************************************************************</span>
<a name="ln-379"></a>
<a name="ln-380"></a><span class="k">end module </span><span class="n">m_trajectory</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> BROWNPAK was developed by Sarit Dutta</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>