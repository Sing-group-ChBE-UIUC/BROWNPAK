<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for BROWNPAK">
   
    <meta name="author" content="Sarit Dutta" >
    <link rel="icon" href="../favicon.png">

    <title>m_trajectory.f90 &ndash; BROWNPAK</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">BROWNPAK <small>0.2</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>User Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>m_trajectory.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 4.3% of total for source files.">269 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/m_trajectory.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">m_trajectory.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_trajectory.html">m_trajectory</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_trajectory.f90.html#src">m_trajectory.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_trajectory.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilem_trajectoryf90EfferentGraph" width="219pt" height="74pt"
 viewBox="0.00 0.00 219.00 74.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_trajectory.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 70)">
<title>sourcefile~~m_trajectory.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-70 215,-70 215,4 -4,4"/>
<!-- sourcefile~m_trajectory.f90 -->
<g id="sourcefile~~m_trajectory.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~m_trajectory.f90</title>
<polygon fill="none" stroke="#000000" points="211,-45 123,-45 123,-21 211,-21 211,-45"/>
<text text-anchor="middle" x="167" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_trajectory.f90</text>
</g>
<!-- sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_trajectory.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~m_logger.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/m_logger.f90.html" xlink:title="m_logger.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="80.5,-66 6.5,-66 6.5,-42 80.5,-42 80.5,-66"/>
<text text-anchor="middle" x="43.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_logger.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_logger.f90 -->
<g id="sourcefile~~m_trajectory.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_logger.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M122.7625,-40.5222C112.2724,-42.3059 101.0473,-44.2146 90.4415,-46.0181"/>
<polygon fill="#ff0000" stroke="#ff0000" points="89.7787,-42.5804 80.507,-47.7073 90.9522,-49.4814 89.7787,-42.5804"/>
</g>
<!-- sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_trajectory.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~m_precision.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/m_precision.f90.html" xlink:title="m_precision.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="87,-24 0,-24 0,0 87,0 87,-24"/>
<text text-anchor="middle" x="43.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_precision.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_precision.f90 -->
<g id="sourcefile~~m_trajectory.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~m_trajectory.f90&#45;&gt;sourcefile~m_precision.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M122.7625,-25.4778C114.405,-24.0567 105.581,-22.5563 96.9753,-21.093"/>
<polygon fill="#ff0000" stroke="#ff0000" points="97.4596,-17.6252 87.0143,-19.3992 96.2861,-24.5261 97.4596,-17.6252"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~m_trajectory.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilem_trajectoryf90AfferentGraph" width="641pt" height="383pt"
 viewBox="0.00 0.00 641.00 382.99" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph" class="graph" transform="scale(.7855 .7855) rotate(0) translate(4 483.5494)">
<title>sourcefile~~m_trajectory.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-483.5494 812,-483.5494 812,4 -4,4"/>
<!-- sourcefile~m_trajectory.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~m_trajectory.f90</title>
<polygon fill="none" stroke="#000000" points="88,-246.8714 0,-246.8714 0,-222.8714 88,-222.8714 88,-246.8714"/>
<text text-anchor="middle" x="44" y="-232.4714" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">m_trajectory.f90</text>
</g>
<!-- sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~m_globals.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/m_globals.f90.html" xlink:title="m_globals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="202,-246.8714 124,-246.8714 124,-222.8714 202,-222.8714 202,-246.8714"/>
<text text-anchor="middle" x="163" y="-232.4714" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_globals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_globals.f90&#45;&gt;sourcefile~m_trajectory.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~m_globals.f90&#45;&gt;sourcefile~m_trajectory.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M123.7052,-234.8714C115.6193,-234.8714 106.9686,-234.8714 98.4565,-234.8714"/>
<polygon fill="#ff0000" stroke="#ff0000" points="98.1897,-231.3715 88.1896,-234.8714 98.1896,-238.3715 98.1897,-231.3715"/>
</g>
<!-- sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~m_mpcd.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/m_mpcd.f90.html" xlink:title="m_mpcd.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="582,-221.8714 512,-221.8714 512,-197.8714 582,-197.8714 582,-221.8714"/>
<text text-anchor="middle" x="547" y="-207.4714" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_mpcd.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M419.5,-425.8714C394.0773,-442.7663 314.7845,-477.5575 287.5,-463.8714"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M287.5,-463.8714C266.4364,-453.3057 254.4663,-461.7287 238,-444.8714 185.7276,-391.3573 169.6363,-298.9833 164.8879,-256.9027"/>
<polygon fill="#ff0000" stroke="#ff0000" points="168.3635,-256.4842 163.869,-246.89 161.3995,-257.193 168.3635,-256.4842"/>
</g>
<!-- sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~m_cell_list.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node15"><a xlink:href=".././sourcefile/m_cell_list.f90.html" xlink:title="m_cell_list.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="327,-435.8714 248,-435.8714 248,-411.8714 327,-411.8714 327,-435.8714"/>
<text text-anchor="middle" x="287.5" y="-421.4714" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_cell_list.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge33" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_cell_list.f90</title>
<path fill="none" stroke="#0035ff" stroke-dasharray="5,2" d="M541.5032,-222.1372C522.5093,-263.9635 458.6688,-399.8414 419.5,-425.8714"/>
<path fill="none" stroke="#0035ff" stroke-dasharray="5,2" d="M419.5,-425.8714C395.6341,-441.7317 363.5948,-441.623 337.0583,-437.3603"/>
<polygon fill="#0035ff" stroke="#0035ff" points="337.6535,-433.9112 327.1858,-435.5479 336.3894,-440.7961 337.6535,-433.9112"/>
</g>
<!-- sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node19" class="node">
<title>sourcefile~m_stats_io.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node19"><a xlink:href=".././sourcefile/m_stats_io.f90.html" xlink:title="m_stats_io.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="460,-141.8714 379,-141.8714 379,-117.8714 460,-117.8714 460,-141.8714"/>
<text text-anchor="middle" x="419.5" y="-127.4714" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_stats_io.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge38" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_stats_io.f90</title>
<path fill="none" stroke="#ff00f1" stroke-dasharray="5,2" d="M525.3399,-197.6813C517.8897,-193.4027 509.5302,-188.5062 502,-183.8714 482.9345,-172.1365 461.8177,-158.2984 445.7213,-147.5686"/>
<polygon fill="#ff00f1" stroke="#ff00f1" points="447.5977,-144.6129 437.3402,-141.9605 443.7048,-150.4307 447.5977,-144.6129"/>
</g>
<!-- sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node20" class="node">
<title>sourcefile~m_interaction.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node20"><a xlink:href=".././sourcefile/m_interaction.f90.html" xlink:title="m_interaction.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="466,-202.8714 373,-202.8714 373,-178.8714 466,-178.8714 466,-202.8714"/>
<text text-anchor="middle" x="419.5" y="-188.4714" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_interaction.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge42" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M511.8226,-204.6292C500.7661,-202.9816 488.264,-201.1185 476.1122,-199.3077"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="476.4332,-195.8169 466.0265,-197.8047 475.4014,-202.7405 476.4332,-195.8169"/>
</g>
<!-- sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node21" class="node">
<title>sourcefile~m_config_io.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node21"><a xlink:href=".././sourcefile/m_config_io.f90.html" xlink:title="m_config_io.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463,-61.8714 376,-61.8714 376,-37.8714 463,-37.8714 463,-61.8714"/>
<text text-anchor="middle" x="419.5" y="-47.4714" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_config_io.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge47" class="edge">
<title>sourcefile~m_mpcd.f90&#45;&gt;sourcefile~m_config_io.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M519.8617,-197.6875C513.452,-193.9171 507.028,-189.299 502,-183.8714 476.8727,-156.7471 485.5617,-140.2473 466,-108.8714 457.4225,-95.1135 446.2105,-80.8047 436.9453,-69.7243"/>
<polygon fill="#ff0050" stroke="#ff0050" points="439.465,-67.2848 430.3154,-61.9429 434.1367,-71.8246 439.465,-67.2848"/>
</g>
<!-- sourcefile~m_control_io.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~m_control_io.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/m_control_io.f90.html" xlink:title="m_control_io.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="718,-475.8714 628,-475.8714 628,-451.8714 718,-451.8714 718,-475.8714"/>
<text text-anchor="middle" x="673" y="-461.4714" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_control_io.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_control_io.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~m_control_io.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M627.8957,-454.9614C602.9555,-452.1742 572.0409,-452.3542 547,-463.8714"/>
</g>
<!-- sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~m_bd_solver.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/m_bd_solver.f90.html" xlink:title="m_bd_solver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="592,-141.8714 502,-141.8714 502,-117.8714 592,-117.8714 592,-141.8714"/>
<text text-anchor="middle" x="547" y="-127.4714" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_bd_solver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M502.914,-117.8188C458.7923,-105.2482 394.4697,-85.3882 373,-70.8714 352.6333,-57.1003 357.0902,-43.0428 337,-28.8714 317.7437,-15.2882 309.8733,-2.4724 287.5,-9.8714"/>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge39" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_stats_io.f90</title>
<path fill="none" stroke="#ff00f1" stroke-dasharray="5,2" d="M501.6893,-129.8714C491.597,-129.8714 480.8301,-129.8714 470.5256,-129.8714"/>
<polygon fill="#ff00f1" stroke="#ff00f1" points="470.4173,-126.3715 460.4173,-129.8714 470.4173,-133.3715 470.4173,-126.3715"/>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge43" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M521.8101,-141.923C502.339,-151.2386 475.1805,-164.2321 453.738,-174.4908"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="452.1478,-171.3716 444.6376,-178.8448 455.1689,-177.6862 452.1478,-171.3716"/>
</g>
<!-- sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge48" class="edge">
<title>sourcefile~m_bd_solver.f90&#45;&gt;sourcefile~m_config_io.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M524.6588,-117.7662C517.31,-113.5738 509.1855,-108.7083 502,-103.8714 485.185,-92.5523 482.8943,-87.0717 466,-75.8714 461.3747,-72.8049 456.3631,-69.7476 451.4005,-66.8637"/>
<polygon fill="#ff0050" stroke="#ff0050" points="453.042,-63.7711 442.6146,-61.8952 449.5963,-69.8643 453.042,-63.7711"/>
</g>
<!-- sourcefile~m_ia_external.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~m_ia_external.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/m_ia_external.f90.html" xlink:title="m_ia_external.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="335.5,-61.8714 239.5,-61.8714 239.5,-37.8714 335.5,-37.8714 335.5,-61.8714"/>
<text text-anchor="middle" x="287.5" y="-47.4714" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_external.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_ia_external.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~m_ia_external.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M257.0982,-61.8896C250.2207,-65.6218 243.3721,-70.2637 238,-75.8714 199.5151,-116.0435 177.8117,-179.6154 168.5028,-212.9002"/>
<polygon fill="#ff0000" stroke="#ff0000" points="165.1181,-212.0095 165.9104,-222.5747 171.8795,-213.8214 165.1181,-212.0095"/>
</g>
<!-- sourcefile~m_kmc.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~m_kmc.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/m_kmc.f90.html" xlink:title="m_kmc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="579,-349.8714 515,-349.8714 515,-325.8714 579,-325.8714 579,-349.8714"/>
<text text-anchor="middle" x="547" y="-335.4714" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_kmc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_kmc.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~m_kmc.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M419.5,-463.8714C362.3711,-477.2155 339.9392,-490.1754 287.5,-463.8714"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M540.7786,-349.9893C525.1446,-378.6927 481.0189,-449.5018 419.5,-463.8714"/>
</g>
<!-- sourcefile~m_kmc.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge44" class="edge">
<title>sourcefile~m_kmc.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M536.5661,-325.8417C514.6188,-300.5378 463.4951,-241.5951 436.6539,-210.6488"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="439.2743,-208.3283 430.078,-203.0672 433.9863,-212.9149 439.2743,-208.3283"/>
</g>
<!-- sourcefile~m_verlet.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~m_verlet.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/m_verlet.f90.html" xlink:title="m_verlet.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="322.5,-393.8714 252.5,-393.8714 252.5,-369.8714 322.5,-369.8714 322.5,-393.8714"/>
<text text-anchor="middle" x="287.5" y="-379.4714" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_verlet.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~m_verlet.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M252.3037,-370.268C247.1809,-367.6645 242.2199,-364.5543 238,-360.8714 204.6664,-331.7793 182.0255,-284.115 170.9222,-256.5041"/>
<polygon fill="#ff0000" stroke="#ff0000" points="174.1102,-255.0443 167.2334,-246.9844 167.583,-257.5735 174.1102,-255.0443"/>
</g>
<!-- sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~m_setup.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node9"><a xlink:href=".././sourcefile/m_setup.f90.html" xlink:title="m_setup.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="708,-181.8714 638,-181.8714 638,-157.8714 708,-157.8714 708,-181.8714"/>
<text text-anchor="middle" x="673" y="-167.4714" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_setup.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M547,-463.8714C495.5176,-487.5499 474.6813,-450.9821 419.5,-463.8714"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M670.0629,-181.9781C657.1121,-234.1126 603.2531,-437.9986 547,-463.8714"/>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_mpcd.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M637.902,-181.0136C623.6856,-185.5267 607.0937,-190.794 592.005,-195.584"/>
<polygon fill="#ff0000" stroke="#ff0000" points="590.819,-192.2884 582.3468,-198.6502 592.9371,-198.9602 590.819,-192.2884"/>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_bd_solver.f90</title>
<path fill="none" stroke="#ffa100" stroke-dasharray="5,2" d="M637.902,-158.7291C624.5309,-154.4844 609.0585,-149.5725 594.7119,-145.018"/>
<polygon fill="#ffa100" stroke="#ffa100" points="595.5894,-141.6245 584.9991,-141.9346 593.4713,-148.2964 595.5894,-141.6245"/>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge41" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_stats_io.f90</title>
<path fill="none" stroke="#ff00f1" stroke-dasharray="5,2" d="M547,-169.8714C514.2538,-168.6531 478.8279,-156.6017 453.6485,-146.0427"/>
<polygon fill="#ff00f1" stroke="#ff00f1" points="454.7604,-142.71 444.1932,-141.9454 451.9771,-149.133 454.7604,-142.71"/>
<path fill="none" stroke="#ff00f1" stroke-dasharray="5,2" d="M637.9547,-170.5691C612.6665,-170.9024 577.7131,-171.014 547,-169.8714"/>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge45" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M547,-169.8714C523.1851,-168.9854 497.18,-172.4508 474.9033,-176.8088"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="474.0384,-173.4134 464.9516,-178.8615 475.4525,-180.2691 474.0384,-173.4134"/>
</g>
<!-- sourcefile~m_setup.f90&#45;&gt;sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge50" class="edge">
<title>sourcefile~m_setup.f90&#45;&gt;sourcefile~m_config_io.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M659.5785,-157.6301C644.2118,-144.1452 617.8185,-122.5603 592,-108.8714 554.2046,-88.8322 508.235,-73.507 473.2577,-63.504"/>
<polygon fill="#ff0050" stroke="#ff0050" points="473.8128,-60.0248 463.2394,-60.6979 471.9248,-66.7654 473.8128,-60.0248"/>
</g>
<!-- sourcefile~m_connectivity.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~m_connectivity.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node10"><a xlink:href=".././sourcefile/m_connectivity.f90.html" xlink:title="m_connectivity.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="337,-351.8714 238,-351.8714 238,-327.8714 337,-327.8714 337,-351.8714"/>
<text text-anchor="middle" x="287.5" y="-337.4714" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_connectivity.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~m_connectivity.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M253.4102,-327.7766C248.0348,-325.2113 242.7052,-322.2417 238,-318.8714 213.1657,-301.0824 190.7064,-273.715 176.9748,-255.0892"/>
<polygon fill="#ff0000" stroke="#ff0000" points="179.8144,-253.043 171.1327,-246.9703 174.1325,-257.1316 179.8144,-253.043"/>
</g>
<!-- sourcefile~m_ia_vdw.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~m_ia_vdw.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node11"><a xlink:href=".././sourcefile/m_ia_vdw.f90.html" xlink:title="m_ia_vdw.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="326,-309.8714 249,-309.8714 249,-285.8714 326,-285.8714 326,-309.8714"/>
<text text-anchor="middle" x="287.5" y="-295.4714" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_vdw.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~m_ia_vdw.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M257.684,-285.8449C251.138,-283.0323 244.2864,-279.9536 238,-276.8714 222.5403,-269.2914 205.7818,-260.0129 192.0352,-252.1065"/>
<polygon fill="#ff0000" stroke="#ff0000" points="193.4579,-248.8853 183.0526,-246.8898 189.9424,-254.9385 193.4579,-248.8853"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node12"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="808,-201.8714 754,-201.8714 754,-177.8714 808,-177.8714 808,-201.8714"/>
<text text-anchor="middle" x="781" y="-187.4714" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M673,-49.8714C568.1283,-5.0188 533.2156,-18.736 419.5,-9.8714"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M419.5,-9.8714C361.0974,-4.311 343.1853,8.5927 287.5,-9.8714"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M776.6043,-177.8531C765.0877,-148.5014 730.8626,-73.8189 673,-49.8714"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M287.5,-9.8714C265.1325,-17.2879 254.5179,-12.0646 238,-28.8714 186.6803,-81.0885 170.1385,-171.1456 165.0857,-212.692"/>
<polygon fill="#ff0000" stroke="#ff0000" points="161.5851,-212.5061 163.9677,-222.8295 168.5429,-213.2735 161.5851,-212.5061"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_mpcd.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_mpcd.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M753.6993,-192.2048C714.0509,-195.5935 640.057,-201.9178 592.1974,-206.0083"/>
<polygon fill="#ff0000" stroke="#ff0000" points="591.7739,-202.5317 582.1083,-206.8706 592.3701,-209.5062 591.7739,-202.5317"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_control_io.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_control_io.f90</title>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M776.22,-201.9983C759.4606,-244.5176 703.2132,-387.2194 681.5791,-442.106"/>
<polygon fill="#ff5000" stroke="#ff5000" points="678.2582,-440.9867 677.8473,-451.5735 684.7706,-443.5536 678.2582,-440.9867"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_bd_solver.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_bd_solver.f90</title>
<path fill="none" stroke="#ffa100" stroke-dasharray="5,2" d="M673,-49.8714C629.4156,-31.2308 583.7784,-80.0858 561.2797,-109.489"/>
<polygon fill="#ffa100" stroke="#ffa100" points="558.4537,-107.424 555.3176,-117.5441 564.0801,-111.5886 558.4537,-107.424"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_setup.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M753.747,-184.8245C742.9092,-182.8175 730.1483,-180.4544 718.0108,-178.2067"/>
<polygon fill="#1aff00" stroke="#1aff00" points="718.488,-174.7356 708.0179,-176.3562 717.2134,-181.6186 718.488,-174.7356"/>
</g>
<!-- sourcefile~m_relax.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~m_relax.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node13"><a xlink:href=".././sourcefile/m_relax.f90.html" xlink:title="m_relax.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="580.5,-61.8714 513.5,-61.8714 513.5,-37.8714 580.5,-37.8714 580.5,-61.8714"/>
<text text-anchor="middle" x="547" y="-47.4714" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_relax.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~m_relax.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge31" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~m_relax.f90</title>
<path fill="none" stroke="#00d6ff" stroke-dasharray="5,2" d="M673,-49.8714C647.1913,-38.8332 615.598,-38.8609 590.5038,-41.6342"/>
<polygon fill="#00d6ff" stroke="#00d6ff" points="590.0061,-38.1692 580.5337,-42.915 590.8982,-45.1122 590.0061,-38.1692"/>
</g>
<!-- sourcefile~m_relax.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~m_relax.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M520.8361,-37.822C495.54,-27.1053 455.8125,-12.7021 419.5,-9.8714"/>
</g>
<!-- sourcefile~m_relax.f90&#45;&gt;sourcefile~m_stats_io.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge40" class="edge">
<title>sourcefile~m_relax.f90&#45;&gt;sourcefile~m_stats_io.f90</title>
<path fill="none" stroke="#ff00f1" stroke-dasharray="5,2" d="M527.6355,-62.0216C506.2624,-75.4322 471.6754,-97.1339 447.3852,-112.3747"/>
<polygon fill="#ff00f1" stroke="#ff00f1" points="445.2394,-109.5892 438.629,-117.8689 448.9599,-115.5186 445.2394,-109.5892"/>
</g>
<!-- sourcefile~m_relax.f90&#45;&gt;sourcefile~m_interaction.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge46" class="edge">
<title>sourcefile~m_relax.f90&#45;&gt;sourcefile~m_interaction.f90</title>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M537.7139,-62.0151C519.8545,-85.274 481.1491,-135.1912 466,-150.8714 458.9362,-158.1828 450.6741,-165.6039 443.0897,-172.036"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="440.672,-169.4943 435.2147,-178.5755 445.144,-174.8796 440.672,-169.4943"/>
</g>
<!-- sourcefile~m_relax.f90&#45;&gt;sourcefile~m_config_io.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge49" class="edge">
<title>sourcefile~m_relax.f90&#45;&gt;sourcefile~m_config_io.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M513.1671,-49.8714C500.939,-49.8714 486.8116,-49.8714 473.2963,-49.8714"/>
<polygon fill="#ff0050" stroke="#ff0050" points="473.1219,-46.3715 463.1219,-49.8714 473.1219,-53.3715 473.1219,-46.3715"/>
</g>
<!-- sourcefile~m_ia_angle.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~m_ia_angle.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node14"><a xlink:href=".././sourcefile/m_ia_angle.f90.html" xlink:title="m_ia_angle.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="329.5,-267.8714 245.5,-267.8714 245.5,-243.8714 329.5,-243.8714 329.5,-267.8714"/>
<text text-anchor="middle" x="287.5" y="-253.4714" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_angle.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_ia_angle.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~m_ia_angle.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M245.35,-248.7617C234.656,-246.9579 223.0754,-245.0046 212.0708,-243.1484"/>
<polygon fill="#ff0000" stroke="#ff0000" points="212.6112,-239.6902 202.1683,-241.4781 211.4469,-246.5926 212.6112,-239.6902"/>
</g>
<!-- sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~m_cell_list.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M250.1473,-411.7367C245.7216,-409.2679 241.531,-406.3371 238,-402.8714 195.8569,-361.5071 175.4681,-292.2702 167.3918,-256.9908"/>
<polygon fill="#ff0000" stroke="#ff0000" points="170.8088,-256.2325 165.2702,-247.2006 163.9676,-257.715 170.8088,-256.2325"/>
</g>
<!-- sourcefile~m_ia_dihedral.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~m_ia_dihedral.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node16"><a xlink:href=".././sourcefile/m_ia_dihedral.f90.html" xlink:title="m_ia_dihedral.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="335.5,-225.8714 239.5,-225.8714 239.5,-201.8714 335.5,-201.8714 335.5,-225.8714"/>
<text text-anchor="middle" x="287.5" y="-211.4714" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_dihedral.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_ia_dihedral.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~m_ia_dihedral.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M239.365,-221.9905C230.4162,-223.5 221.0565,-225.0787 212.0797,-226.5929"/>
<polygon fill="#ff0000" stroke="#ff0000" points="211.4282,-223.1532 202.1497,-228.2678 212.5925,-230.0557 211.4282,-223.1532"/>
</g>
<!-- sourcefile~m_ia_tether.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~m_ia_tether.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node17"><a xlink:href=".././sourcefile/m_ia_tether.f90.html" xlink:title="m_ia_tether.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="330,-183.8714 245,-183.8714 245,-159.8714 330,-159.8714 330,-183.8714"/>
<text text-anchor="middle" x="287.5" y="-169.4714" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_tether.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_ia_tether.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~m_ia_tether.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M257.684,-183.8978C251.138,-186.7105 244.2864,-189.7891 238,-192.8714 222.5403,-200.4513 205.7818,-209.7298 192.0352,-217.6362"/>
<polygon fill="#ff0000" stroke="#ff0000" points="189.9424,-214.8042 183.0526,-222.8529 193.4579,-220.8574 189.9424,-214.8042"/>
</g>
<!-- sourcefile~m_ia_bond.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_node18" class="node">
<title>sourcefile~m_ia_bond.f90</title>
<g id="a_sourcefile~~m_trajectory.f90~~AfferentGraph_node18"><a xlink:href=".././sourcefile/m_ia_bond.f90.html" xlink:title="m_ia_bond.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="328.5,-141.8714 246.5,-141.8714 246.5,-117.8714 328.5,-117.8714 328.5,-141.8714"/>
<text text-anchor="middle" x="287.5" y="-127.4714" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">m_ia_bond.f90</text>
</a>
</g>
</g>
<!-- sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~m_ia_bond.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M253.4102,-141.9661C248.0348,-144.5314 242.7052,-147.501 238,-150.8714 213.1657,-168.6603 190.7064,-196.0277 176.9748,-214.6536"/>
<polygon fill="#ff0000" stroke="#ff0000" points="174.1325,-212.6111 171.1327,-222.7724 179.8144,-216.6997 174.1325,-212.6111"/>
</g>
<!-- sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~m_stats_io.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M391.4538,-117.8258C384.8305,-114.0528 378.1933,-109.3987 373,-103.8714 347.6822,-76.9247 364.1823,-53.9359 337,-28.8714 319.6759,-12.8969 309.8733,-2.4724 287.5,-9.8714"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M404.3292,-178.8107C394.9832,-171.1434 382.9306,-160.8195 373,-150.8714 355.6308,-133.4715 359.3362,-119.1446 337,-108.8714 297.0254,-90.4857 276.2507,-87.1255 238,-108.8714 198.7769,-131.17 177.9156,-182.986 168.7916,-212.7603"/>
<polygon fill="#ff0000" stroke="#ff0000" points="165.3514,-212.0591 165.9489,-222.6371 172.0783,-213.9953 165.3514,-212.0591"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_external.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_external.f90</title>
<path fill="none" stroke="#fff100" stroke-dasharray="5,2" d="M402.0197,-178.6411C392.5544,-171.3769 381.1623,-161.5206 373,-150.8714 350.5071,-121.5254 362.6684,-102.4842 337,-75.8714 333.8833,-72.64 330.2771,-69.7275 326.4599,-67.1243"/>
<polygon fill="#fff100" stroke="#fff100" points="328.2399,-64.1104 317.8749,-61.9154 324.6088,-70.095 328.2399,-64.1104"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_verlet.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_verlet.f90</title>
<path fill="none" stroke="#6bff00" stroke-dasharray="5,2" d="M416.7852,-202.907C409.3237,-233.3966 385.7416,-314.535 337,-360.8714 335.3234,-362.4653 333.5075,-363.9474 331.595,-365.3244"/>
<polygon fill="#6bff00" stroke="#6bff00" points="329.456,-362.5284 322.724,-370.7095 333.0885,-368.5121 329.456,-362.5284"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_connectivity.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_connectivity.f90</title>
<path fill="none" stroke="#00ff35" stroke-dasharray="5,2" d="M414.5614,-203.1696C403.9419,-228.1967 376.6414,-285.4987 337,-318.8714 335.4735,-320.1564 333.8569,-321.3733 332.1757,-322.5245"/>
<polygon fill="#00ff35" stroke="#00ff35" points="330.1773,-319.64 323.3517,-327.7433 333.7407,-325.6652 330.1773,-319.64"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_vdw.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_vdw.f90</title>
<path fill="none" stroke="#00ff86" stroke-dasharray="5,2" d="M410.5756,-202.9162C396.6198,-221.0458 367.9995,-255.4947 337,-276.8714 334.8818,-278.332 332.6459,-279.7216 330.3422,-281.0384"/>
<polygon fill="#00ff86" stroke="#00ff86" points="328.5006,-278.0505 321.2265,-285.7536 331.7167,-284.268 328.5006,-278.0505"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_angle.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge32" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_angle.f90</title>
<path fill="none" stroke="#0086ff" stroke-dasharray="5,2" d="M398.0558,-202.9829C381.5595,-212.1343 358.0926,-224.7969 337,-234.8714 333.599,-236.4958 330.0395,-238.1302 326.4561,-239.731"/>
<polygon fill="#0086ff" stroke="#0086ff" points="324.769,-236.6486 317.0073,-243.8601 327.5721,-243.0629 324.769,-236.6486"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_cell_list.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge34" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_cell_list.f90</title>
<path fill="none" stroke="#0035ff" stroke-dasharray="5,2" d="M418.0945,-202.9275C413.3594,-238.3251 394.8939,-343.2075 337,-402.8714 335.9436,-403.96 334.8219,-404.9951 333.6474,-405.979"/>
<polygon fill="#0035ff" stroke="#0035ff" points="331.5121,-403.1999 325.2628,-411.7554 335.4834,-408.9643 331.5121,-403.1999"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_dihedral.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge35" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_dihedral.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M372.9617,-198.9803C364.2251,-200.5026 354.9889,-202.1119 345.9444,-203.6879"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="345.102,-200.2818 335.8512,-205.4465 346.3036,-207.1779 345.102,-200.2818"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_tether.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge36" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_tether.f90</title>
<path fill="none" stroke="#6b00ff" stroke-dasharray="5,2" d="M372.9617,-184.1727C362.3869,-182.6505 351.08,-181.023 340.2672,-179.4666"/>
<polygon fill="#6b00ff" stroke="#6b00ff" points="340.4885,-175.9625 330.0918,-178.002 339.4911,-182.8911 340.4885,-175.9625"/>
</g>
<!-- sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_bond.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge37" class="edge">
<title>sourcefile~m_interaction.f90&#45;&gt;sourcefile~m_ia_bond.f90</title>
<path fill="none" stroke="#bb00ff" stroke-dasharray="5,2" d="M395.4643,-178.8232C379.0864,-170.7111 356.8551,-159.8895 337,-150.8714 333.4209,-149.2457 329.68,-147.5867 325.9272,-145.9493"/>
<polygon fill="#bb00ff" stroke="#bb00ff" points="327.2288,-142.699 316.6601,-141.9548 324.4579,-149.1273 327.2288,-142.699"/>
</g>
<!-- sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_globals.f90 -->
<g id="sourcefile~~m_trajectory.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~m_config_io.f90&#45;&gt;sourcefile~m_globals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M392.7897,-37.8112C360.2255,-23.8028 307.1087,-3.3866 287.5,-9.8714"/>
</g>
</g>
</svg>
</div><script>var pansourcefilem_trajectoryf90AfferentGraph = svgPanZoom('#sourcefilem_trajectoryf90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_trajectory.html">m_trajectory</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_trajectory.f90.html#src">m_trajectory.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">module </span><span class="n">m_trajectory</span>
<a name="ln-2"></a>    <span class="c">!! Routines for reading and writing frames from a trajectory file.</span>
<a name="ln-3"></a> 
<a name="ln-4"></a><span class="k">use </span><span class="n">m_precision</span>
<a name="ln-5"></a><span class="k">use </span><span class="n">m_logger</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">logger</span> <span class="o">=&gt;</span> <span class="n">master_logger</span>
<a name="ln-6"></a>
<a name="ln-7"></a><span class="k">implicit none</span>
<a name="ln-8"></a>
<a name="ln-9"></a><span class="k">type </span><span class="n">trajectory_t</span>
<a name="ln-10"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">header_size</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-11"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">frame_size</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-12"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">num_atoms</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-13"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">num_mpcd_atoms</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-14"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">num_atoms_tot</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-15"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">frmcmp</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-16"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">fn</span>
<a name="ln-17"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">file_id</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-18"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">num_frames</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-19"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">isopen</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-20"></a>
<a name="ln-21"></a>    <span class="k">contains</span>
<a name="ln-22"></a><span class="k">        procedure</span> <span class="kd">::</span> <span class="n">create</span>       <span class="o">=&gt;</span> <span class="n">traj_create</span>
<a name="ln-23"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="k">open</span>         <span class="o">=&gt;</span> <span class="n">traj_open</span>
<a name="ln-24"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">clear</span>        <span class="o">=&gt;</span> <span class="n">traj_clear</span>
<a name="ln-25"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="k">close</span>        <span class="o">=&gt;</span> <span class="n">traj_close</span>
<a name="ln-26"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="k">read</span>         <span class="o">=&gt;</span> <span class="n">traj_read</span>
<a name="ln-27"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">append_frame</span> <span class="o">=&gt;</span> <span class="n">traj_append_frame</span>
<a name="ln-28"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">write_frame</span>  <span class="o">=&gt;</span> <span class="n">traj_write_frame</span>
<a name="ln-29"></a>        <span class="k">generic</span>   <span class="kd">::</span> <span class="n">init</span>         <span class="o">=&gt;</span> <span class="n">create</span><span class="p">,</span> <span class="k">open</span>
<a name="ln-30"></a><span class="k">end type </span><span class="n">trajectory_t</span>
<a name="ln-31"></a> 
<a name="ln-32"></a><span class="k">contains</span>
<a name="ln-33"></a>
<a name="ln-34"></a><span class="c">!******************************************************************************</span>
<a name="ln-35"></a>
<a name="ln-36"></a><span class="k">subroutine </span><span class="n">traj_create</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">na</span><span class="p">,</span> <span class="n">nam</span><span class="p">,</span> <span class="n">frmcmp</span><span class="p">)</span>
<a name="ln-37"></a>    <span class="c">!!  Creates a `trajectory_t` object with a new underlying file named `fn`.  If</span>
<a name="ln-38"></a>    <span class="c">!!  `fn` already exists, it will be truncated.  The file `fn` is opened for both</span>
<a name="ln-39"></a>    <span class="c">!!  reading and writing.</span>
<a name="ln-40"></a>
<a name="ln-41"></a>    <span class="k">class</span><span class="p">(</span><span class="n">trajectory_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-42"></a>        <span class="c">!! *trajectory_t* instance.</span>
<a name="ln-43"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fn</span>
<a name="ln-44"></a>        <span class="c">!! Name of the underlying trajectory file.</span>
<a name="ln-45"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">na</span>
<a name="ln-46"></a>        <span class="c">!! Number of non-MPCD atoms</span>
<a name="ln-47"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nam</span>
<a name="ln-48"></a>        <span class="c">!! Number of MPCD atoms, pass zero to indicate no data from MPCD</span>
<a name="ln-49"></a>        <span class="c">!! particles are present.</span>
<a name="ln-50"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">frmcmp</span>
<a name="ln-51"></a>        <span class="c">!! Binary flags indicating whether that component is present in a frame.</span>
<a name="ln-52"></a>        <span class="c">!! frmcmp(1): coordinates, frmcmp(2): velocities, frmcmp(3): forces,</span>
<a name="ln-53"></a>        <span class="c">!! frmcmp(4): charges</span>
<a name="ln-54"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">nat</span><span class="p">,</span> <span class="n">file_id</span>
<a name="ln-55"></a>
<a name="ln-56"></a>    <span class="n">nat</span> <span class="o">=</span> <span class="n">na</span> <span class="o">+</span> <span class="n">nam</span>
<a name="ln-57"></a>    <span class="n">this</span><span class="p">%</span><span class="n">num_atoms</span> <span class="o">=</span> <span class="n">na</span><span class="p">;</span> <span class="n">this</span><span class="p">%</span><span class="n">num_mpcd_atoms</span> <span class="o">=</span> <span class="n">nam</span><span class="p">;</span> <span class="n">this</span><span class="p">%</span><span class="n">num_atoms_tot</span> <span class="o">=</span> <span class="n">nat</span>
<a name="ln-58"></a>    <span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span> <span class="o">=</span> <span class="n">frmcmp</span>
<a name="ln-59"></a>    
<a name="ln-60"></a>    <span class="c">!Frame components: nts, coordinates, velocities, forces, charge</span>
<a name="ln-61"></a>    <span class="c">!nts data</span>
<a name="ln-62"></a>    <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span> <span class="o">=</span> <span class="n">sizeof_long_int</span>
<a name="ln-63"></a>    <span class="c">!Coordinate data</span>
<a name="ln-64"></a>    <span class="k">if</span> <span class="p">(</span> <span class="n">frmcmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span> <span class="p">)</span> <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">nat</span><span class="o">*</span><span class="n">sizeof_real</span>
<a name="ln-65"></a>    <span class="c">!Velocity data</span>
<a name="ln-66"></a>    <span class="k">if</span> <span class="p">(</span> <span class="n">frmcmp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span> <span class="p">)</span> <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">nat</span><span class="o">*</span><span class="n">sizeof_real</span>
<a name="ln-67"></a>    <span class="c">!Force data</span>
<a name="ln-68"></a>    <span class="k">if</span> <span class="p">(</span> <span class="n">frmcmp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span> <span class="p">)</span> <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">na</span><span class="o">*</span><span class="n">sizeof_real</span>
<a name="ln-69"></a>    <span class="c">!Charge data</span>
<a name="ln-70"></a>    <span class="k">if</span> <span class="p">(</span> <span class="n">frmcmp</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span> <span class="p">)</span> <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span> <span class="o">+</span> <span class="n">na</span><span class="o">*</span><span class="n">sizeof_real</span>
<a name="ln-71"></a>
<a name="ln-72"></a>    <span class="c">! Representation of header:</span>
<a name="ln-73"></a>    <span class="c">!     * 1 int for `header_size`</span>
<a name="ln-74"></a>    <span class="c">!     * 1 int for `frame_size`</span>
<a name="ln-75"></a>    <span class="c">!     * 2 ints:  `num_atoms`, `num_mpcd_atoms`</span>
<a name="ln-76"></a>    <span class="c">!     * 4 ints:  `frmcmp`</span>
<a name="ln-77"></a>
<a name="ln-78"></a>    <span class="n">this</span><span class="p">%</span><span class="n">header_size</span> <span class="o">=</span> <span class="mi">8</span><span class="o">*</span><span class="n">sizeof_int</span>
<a name="ln-79"></a>
<a name="ln-80"></a>    <span class="c">!Create trajectory file</span>
<a name="ln-81"></a>    <span class="k">open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">file_id</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">fn</span><span class="p">,</span> <span class="nb">access</span><span class="o">=</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="s1">&#39;unformatted&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-82"></a>            <span class="n">action</span><span class="o">=</span><span class="s1">&#39;readwrite&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">)</span>
<a name="ln-83"></a>
<a name="ln-84"></a>    <span class="n">this</span><span class="p">%</span><span class="n">fn</span> <span class="o">=</span> <span class="n">fn</span>
<a name="ln-85"></a>    <span class="n">this</span><span class="p">%</span><span class="n">file_id</span> <span class="o">=</span> <span class="n">file_id</span>
<a name="ln-86"></a>    <span class="n">this</span><span class="p">%</span><span class="n">num_frames</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-87"></a>    <span class="n">this</span><span class="p">%</span><span class="n">isopen</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-88"></a>
<a name="ln-89"></a>    <span class="k">write</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">this</span><span class="p">%</span><span class="n">header_size</span>
<a name="ln-90"></a>    <span class="k">write</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span>
<a name="ln-91"></a>    <span class="k">write</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">this</span><span class="p">%</span><span class="n">num_atoms</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="n">num_mpcd_atoms</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span>
<a name="ln-92"></a>
<a name="ln-93"></a>    <span class="k">end subroutine</span>
<a name="ln-94"></a>
<a name="ln-95"></a><span class="c">!******************************************************************************</span>
<a name="ln-96"></a>
<a name="ln-97"></a><span class="k">subroutine </span><span class="n">traj_open</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">ierr</span><span class="p">)</span>
<a name="ln-98"></a>    <span class="c">!!  Creates a `trajectory_t` object with a prexisting underlying file named</span>
<a name="ln-99"></a>    <span class="c">!!  `fn`.  If `fn` does not exist, an error will be generated. If</span>
<a name="ln-100"></a>    <span class="c">!!  `mode` == &#39;rw&#39;, the file `fn` is opened for both reading and writing.</span>
<a name="ln-101"></a>    <span class="c">!!  If `mode` == &#39;r&#39;, the file `fn` is opened only for reading.</span>
<a name="ln-102"></a>    <span class="c">!&quot;&quot;</span>
<a name="ln-103"></a>    <span class="k">class</span><span class="p">(</span><span class="n">trajectory_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-104"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fn</span>
<a name="ln-105"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mode</span>
<a name="ln-106"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-107"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ip_long</span><span class="p">)</span> <span class="kd">::</span> <span class="n">file_size</span>
<a name="ln-108"></a>    
<a name="ln-109"></a>    <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-110"></a>    <span class="n">this</span><span class="p">%</span><span class="n">fn</span> <span class="o">=</span> <span class="n">fn</span>
<a name="ln-111"></a>
<a name="ln-112"></a>    <span class="c">!Readwrite mode</span>
<a name="ln-113"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;rw&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-114"></a><span class="k">        open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">this</span><span class="p">%</span><span class="n">fn</span><span class="p">,</span> <span class="nb">access</span><span class="o">=</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-115"></a>            <span class="n">form</span><span class="o">=</span><span class="s1">&#39;unformatted&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;readwrite&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;old&#39;</span><span class="p">)</span>
<a name="ln-116"></a>    <span class="c">!Readonly mode</span>
<a name="ln-117"></a>    <span class="k">else if</span> <span class="p">(</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-118"></a><span class="k">        open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">this</span><span class="p">%</span><span class="n">fn</span><span class="p">,</span> <span class="nb">access</span><span class="o">=</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-119"></a>            <span class="n">form</span><span class="o">=</span><span class="s1">&#39;unformatted&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;read&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;old&#39;</span><span class="p">)</span>
<a name="ln-120"></a>    <span class="c">!Unknown mode</span>
<a name="ln-121"></a>    <span class="k">else</span>
<a name="ln-122"></a><span class="k">        call </span><span class="n">logger</span><span class="p">%</span><span class="n">fatal</span><span class="p">(</span><span class="s1">&#39;traj_open&#39;</span><span class="p">,</span> <span class="s1">&#39;file open error. Bad mode &#39;</span><span class="o">//</span><span class="n">mode</span><span class="p">)</span>
<a name="ln-123"></a>        <span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-124"></a>        <span class="k">return</span>
<a name="ln-125"></a><span class="k">    end if</span>
<a name="ln-126"></a>
<a name="ln-127"></a><span class="k">    </span><span class="n">this</span><span class="p">%</span><span class="n">isopen</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-128"></a>
<a name="ln-129"></a>    <span class="c">!Get size of the file</span>
<a name="ln-130"></a>    <span class="k">inquire</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">file_size</span><span class="p">)</span>
<a name="ln-131"></a>
<a name="ln-132"></a>    <span class="k">read</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">this</span><span class="p">%</span><span class="n">header_size</span>
<a name="ln-133"></a>    <span class="k">read</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span>
<a name="ln-134"></a>    <span class="k">read</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">this</span><span class="p">%</span><span class="n">num_atoms</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="n">num_mpcd_atoms</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span>
<a name="ln-135"></a>
<a name="ln-136"></a>    <span class="n">this</span><span class="p">%</span><span class="n">num_atoms_tot</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">num_atoms</span> <span class="o">+</span> <span class="n">this</span><span class="p">%</span><span class="n">num_mpcd_atoms</span>
<a name="ln-137"></a>
<a name="ln-138"></a>    <span class="c">!Integer division to find `num_frames`</span>
<a name="ln-139"></a>    <span class="n">this</span><span class="p">%</span><span class="n">num_frames</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">file_size</span><span class="o">-</span><span class="n">this</span><span class="p">%</span><span class="n">header_size</span><span class="p">)</span><span class="o">/</span><span class="n">this</span><span class="p">%</span><span class="n">frame_size</span><span class="p">,</span> <span class="n">ip</span><span class="p">)</span> 
<a name="ln-140"></a>
<a name="ln-141"></a>    <span class="k">end subroutine</span>
<a name="ln-142"></a>
<a name="ln-143"></a><span class="c">!******************************************************************************</span>
<a name="ln-144"></a>
<a name="ln-145"></a><span class="k">subroutine </span><span class="n">traj_clear</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-146"></a>   <span class="c">!! After a call to this subroutine, all memory within `this` is deallocated,</span>
<a name="ln-147"></a>   <span class="c">!! all components of `this` are reset to zero, and the underlying file is</span>
<a name="ln-148"></a>   <span class="c">!! closed (if open).</span>
<a name="ln-149"></a>
<a name="ln-150"></a>    <span class="k">class</span><span class="p">(</span><span class="n">trajectory_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-151"></a>
<a name="ln-152"></a>    <span class="k">call </span><span class="n">this</span><span class="p">%</span><span class="k">close</span><span class="p">()</span>
<a name="ln-153"></a>
<a name="ln-154"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">fn</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">fn</span><span class="p">)</span>
<a name="ln-155"></a>
<a name="ln-156"></a>    <span class="n">this</span><span class="p">%</span><span class="n">header_size</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-157"></a>    <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-158"></a>    <span class="n">this</span><span class="p">%</span><span class="n">num_atoms</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-159"></a>    <span class="n">this</span><span class="p">%</span><span class="n">num_mpcd_atoms</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-160"></a>    <span class="n">this</span><span class="p">%</span><span class="n">num_atoms_tot</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-161"></a>    <span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-162"></a>    <span class="n">this</span><span class="p">%</span><span class="n">file_id</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-163"></a>    <span class="n">this</span><span class="p">%</span><span class="n">num_frames</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-164"></a>
<a name="ln-165"></a>    <span class="k">end subroutine</span>
<a name="ln-166"></a>
<a name="ln-167"></a><span class="c">!******************************************************************************</span>
<a name="ln-168"></a>
<a name="ln-169"></a><span class="k">subroutine </span><span class="n">traj_close</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-170"></a>    <span class="c">!! Closes the underlying file of a `trajectory_t`.</span>
<a name="ln-171"></a>
<a name="ln-172"></a>    <span class="k">class</span><span class="p">(</span><span class="n">trajectory_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-173"></a>
<a name="ln-174"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">isopen</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-175"></a><span class="k">        close</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span>
<a name="ln-176"></a>        <span class="n">this</span><span class="p">%</span><span class="n">isopen</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-177"></a>    <span class="k">end if</span>
<a name="ln-178"></a>
<a name="ln-179"></a><span class="k">    end subroutine</span>
<a name="ln-180"></a>
<a name="ln-181"></a><span class="c">!******************************************************************************</span>
<a name="ln-182"></a>
<a name="ln-183"></a><span class="k">subroutine </span><span class="n">traj_read</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">iframe</span><span class="p">,</span> <span class="n">nts</span><span class="p">,</span> <span class="n">ierr</span><span class="p">,</span> <span class="n">mflag</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-184"></a>        <span class="n">coordinates</span><span class="p">,</span> <span class="n">velocities</span><span class="p">,</span> <span class="n">forces</span><span class="p">,</span> <span class="n">charge</span><span class="p">)</span>
<a name="ln-185"></a>    <span class="c">!! Read from an open trajectory.</span>
<a name="ln-186"></a>
<a name="ln-187"></a>    <span class="k">class</span><span class="p">(</span><span class="n">trajectory_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-188"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iframe</span>
<a name="ln-189"></a>        <span class="c">!! Frame number</span>
<a name="ln-190"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ip_long</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nts</span>
<a name="ln-191"></a>        <span class="c">!! Time step counter</span>
<a name="ln-192"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ierr</span>
<a name="ln-193"></a>        <span class="c">!! Error flag</span>
<a name="ln-194"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>  <span class="kd">::</span> <span class="n">mflag</span>
<a name="ln-195"></a>        <span class="c">!! 1: Only non-MPCD data, 2: Only MPCD data, 3: All data</span>
<a name="ln-196"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">coordinates</span>
<a name="ln-197"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">velocities</span>
<a name="ln-198"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">forces</span>
<a name="ln-199"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">charge</span>
<a name="ln-200"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ip_long</span><span class="p">)</span> <span class="kd">::</span> <span class="n">offset_frm</span>
<a name="ln-201"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ip_long</span><span class="p">)</span> <span class="kd">::</span> <span class="n">offset_if</span>
<a name="ln-202"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ip_long</span><span class="p">)</span> <span class="kd">::</span> <span class="n">offset_tot</span>
<a name="ln-203"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">na</span><span class="p">,</span> <span class="n">nat</span><span class="p">,</span> <span class="n">nam</span>
<a name="ln-204"></a>
<a name="ln-205"></a>    <span class="n">ierr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-206"></a>    <span class="n">na</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">num_atoms</span><span class="p">;</span> <span class="n">nam</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">num_mpcd_atoms</span><span class="p">;</span> <span class="n">nat</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">num_atoms_tot</span>
<a name="ln-207"></a>
<a name="ln-208"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">iframe</span> <span class="o">&gt;</span> <span class="n">this</span><span class="p">%</span><span class="n">num_frames</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-209"></a><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;`iframe`&#39;</span><span class="p">,</span> <span class="n">iframe</span><span class="p">,</span> <span class="s1">&#39;out of bounds for `num_frames`&#39;</span><span class="p">,</span> <span class="n">this</span><span class="p">%</span><span class="n">num_frames</span>
<a name="ln-210"></a>        <span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-211"></a>        <span class="k">return</span>
<a name="ln-212"></a><span class="k">    end if</span>
<a name="ln-213"></a>
<a name="ln-214"></a><span class="k">    select case</span><span class="p">(</span><span class="n">mflag</span><span class="p">)</span>
<a name="ln-215"></a>    <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-216"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">na</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-217"></a><span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;No data for non-MPCD atoms&#39;</span><span class="p">;</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">return</span>
<a name="ln-218"></a><span class="k">        end if</span>
<a name="ln-219"></a><span class="k">    case</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-220"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">nam</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-221"></a><span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;No data for MPCD atoms&#39;</span><span class="p">;</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">return</span>
<a name="ln-222"></a><span class="k">        end if</span>
<a name="ln-223"></a><span class="k">    case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-224"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">nat</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-225"></a><span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;No data for any atoms&#39;</span><span class="p">;</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">return</span>
<a name="ln-226"></a><span class="k">        end if</span>
<a name="ln-227"></a><span class="k">    case </span><span class="n">default</span>
<a name="ln-228"></a>        <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Unknown mflag = &#39;</span><span class="p">,</span> <span class="n">mflag</span><span class="p">;</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">return</span>
<a name="ln-229"></a><span class="k">    end select</span>
<a name="ln-230"></a>
<a name="ln-231"></a><span class="k">    </span><span class="n">offset_frm</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span>
<a name="ln-232"></a>    <span class="n">offset_frm</span> <span class="o">=</span> <span class="p">(</span><span class="n">iframe</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">offset_frm</span> <span class="o">+</span> <span class="n">this</span><span class="p">%</span><span class="n">header_size</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-233"></a>
<a name="ln-234"></a>    <span class="k">read</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">offset_frm</span><span class="p">)</span> <span class="n">nts</span>
<a name="ln-235"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">coordinates</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-236"></a><span class="k">        if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-237"></a><span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;No coordinate data in frame&#39;</span><span class="p">;</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">return</span>
<a name="ln-238"></a><span class="k">        else</span>
<a name="ln-239"></a><span class="k">            select case</span><span class="p">(</span><span class="n">mflag</span><span class="p">)</span>
<a name="ln-240"></a>            <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-241"></a>                <span class="n">offset_if</span> <span class="o">=</span> <span class="n">sizeof_long_int</span>
<a name="ln-242"></a>                <span class="n">offset_tot</span> <span class="o">=</span> <span class="n">offset_frm</span> <span class="o">+</span> <span class="n">offset_if</span>
<a name="ln-243"></a>                <span class="k">read</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">offset_tot</span><span class="p">)</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">na</span><span class="p">)</span>
<a name="ln-244"></a>            <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-245"></a>                <span class="n">offset_if</span> <span class="o">=</span> <span class="n">sizeof_long_int</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">na</span><span class="o">*</span><span class="n">sizeof_real</span>
<a name="ln-246"></a>                <span class="n">offset_tot</span> <span class="o">=</span> <span class="n">offset_frm</span> <span class="o">+</span> <span class="n">offset_if</span>
<a name="ln-247"></a>                <span class="k">read</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">offset_tot</span><span class="p">)</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">nam</span><span class="p">)</span>
<a name="ln-248"></a>            <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-249"></a>                <span class="n">offset_if</span> <span class="o">=</span> <span class="n">sizeof_long_int</span>
<a name="ln-250"></a>                <span class="n">offset_tot</span> <span class="o">=</span> <span class="n">offset_frm</span> <span class="o">+</span> <span class="n">offset_if</span>
<a name="ln-251"></a>                <span class="k">read</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">offset_tot</span><span class="p">)</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">nat</span><span class="p">)</span>
<a name="ln-252"></a>            <span class="k">end select</span>
<a name="ln-253"></a><span class="k">        end if</span>
<a name="ln-254"></a><span class="k">    end if</span>
<a name="ln-255"></a>
<a name="ln-256"></a><span class="k">    if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">velocities</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-257"></a><span class="k">        if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-258"></a><span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;No velocity data in frame&#39;</span><span class="p">;</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">return</span>
<a name="ln-259"></a><span class="k">        else</span>
<a name="ln-260"></a><span class="k">            select case</span><span class="p">(</span><span class="n">mflag</span><span class="p">)</span>
<a name="ln-261"></a>            <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-262"></a>                <span class="n">offset_if</span> <span class="o">=</span> <span class="n">sizeof_long_int</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">nat</span><span class="o">*</span><span class="n">sizeof_real</span><span class="o">*</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-263"></a>                <span class="n">offset_tot</span> <span class="o">=</span> <span class="n">offset_frm</span> <span class="o">+</span> <span class="n">offset_if</span>
<a name="ln-264"></a>                <span class="k">read</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">offset_tot</span><span class="p">)</span> <span class="n">velocities</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">na</span><span class="p">)</span>
<a name="ln-265"></a>            <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-266"></a>                <span class="n">offset_if</span> <span class="o">=</span> <span class="n">sizeof_long_int</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">nat</span><span class="o">*</span><span class="n">sizeof_real</span><span class="o">*</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-267"></a>                            <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">na</span><span class="o">*</span><span class="n">sizeof_real</span><span class="o">*</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-268"></a>                <span class="n">offset_tot</span> <span class="o">=</span> <span class="n">offset_frm</span> <span class="o">+</span> <span class="n">offset_if</span>
<a name="ln-269"></a>                <span class="k">read</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">offset_tot</span><span class="p">)</span> <span class="n">velocities</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">nam</span><span class="p">)</span>
<a name="ln-270"></a>            <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-271"></a>                <span class="n">offset_if</span> <span class="o">=</span> <span class="n">sizeof_long_int</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">nat</span><span class="o">*</span><span class="n">sizeof_real</span><span class="o">*</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-272"></a>                <span class="n">offset_tot</span> <span class="o">=</span> <span class="n">offset_frm</span> <span class="o">+</span> <span class="n">offset_if</span>
<a name="ln-273"></a>                <span class="k">read</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">offset_tot</span><span class="p">)</span> <span class="n">velocities</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">nat</span><span class="p">)</span>
<a name="ln-274"></a>            <span class="k">end select</span>
<a name="ln-275"></a><span class="k">        end if</span>
<a name="ln-276"></a><span class="k">    end if</span>
<a name="ln-277"></a>
<a name="ln-278"></a><span class="k">    if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">forces</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-279"></a><span class="k">        if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-280"></a><span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;No force data in frame&#39;</span><span class="p">;</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">return</span>
<a name="ln-281"></a><span class="k">        else</span>
<a name="ln-282"></a><span class="k">            </span><span class="n">offset_if</span> <span class="o">=</span> <span class="n">sizeof_long_int</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">nat</span><span class="o">*</span><span class="n">sizeof_real</span><span class="o">*</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-283"></a>                        <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">nat</span><span class="o">*</span><span class="n">sizeof_real</span><span class="o">*</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-284"></a>            <span class="n">offset_tot</span> <span class="o">=</span> <span class="n">offset_frm</span> <span class="o">+</span> <span class="n">offset_if</span>
<a name="ln-285"></a>            <span class="k">read</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">offset_tot</span><span class="p">)</span> <span class="n">forces</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">na</span><span class="p">)</span>
<a name="ln-286"></a>        <span class="k">end if</span>
<a name="ln-287"></a><span class="k">    end if</span>
<a name="ln-288"></a>
<a name="ln-289"></a><span class="k">    if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">charge</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-290"></a><span class="k">        if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-291"></a><span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;No charge data in frame&#39;</span><span class="p">;</span> <span class="n">ierr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">return</span>
<a name="ln-292"></a><span class="k">        else</span>
<a name="ln-293"></a><span class="k">            </span><span class="n">offset_if</span> <span class="o">=</span> <span class="n">sizeof_long_int</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">nat</span><span class="o">*</span><span class="n">sizeof_real</span><span class="o">*</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-294"></a>                        <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">nat</span><span class="o">*</span><span class="n">sizeof_real</span><span class="o">*</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-295"></a>                        <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">na</span><span class="o">*</span><span class="n">sizeof_real</span><span class="o">*</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-296"></a>            <span class="n">offset_tot</span> <span class="o">=</span> <span class="n">offset_frm</span> <span class="o">+</span> <span class="n">offset_if</span>
<a name="ln-297"></a>            <span class="k">read</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">offset_tot</span><span class="p">)</span> <span class="n">charge</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">na</span><span class="p">)</span>
<a name="ln-298"></a>        <span class="k">end if</span>
<a name="ln-299"></a><span class="k">    end if</span>
<a name="ln-300"></a>
<a name="ln-301"></a><span class="k">    end subroutine</span>
<a name="ln-302"></a>
<a name="ln-303"></a><span class="c">!******************************************************************************</span>
<a name="ln-304"></a>
<a name="ln-305"></a><span class="k">subroutine </span><span class="n">traj_append_frame</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">nts</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">,</span> <span class="n">velocities</span><span class="p">,</span> <span class="n">forces</span><span class="p">,</span> <span class="n">charge</span><span class="p">)</span>
<a name="ln-306"></a>    <span class="c">!! Write a frame to an open trajectory</span>
<a name="ln-307"></a>
<a name="ln-308"></a>    <span class="k">class</span><span class="p">(</span><span class="n">trajectory_t</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-309"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ip_long</span><span class="p">),</span>         <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nts</span>
<a name="ln-310"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">coordinates</span>
<a name="ln-311"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">velocities</span>
<a name="ln-312"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">forces</span>
<a name="ln-313"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">charge</span>
<a name="ln-314"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iframe</span>
<a name="ln-315"></a>
<a name="ln-316"></a>    <span class="n">iframe</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">num_frames</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-317"></a>    <span class="k">call </span><span class="n">this</span><span class="p">%</span><span class="n">write_frame</span><span class="p">(</span><span class="n">iframe</span><span class="p">,</span> <span class="n">nts</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">,</span> <span class="n">velocities</span><span class="p">,</span> <span class="n">forces</span><span class="p">,</span> <span class="n">charge</span><span class="p">)</span>
<a name="ln-318"></a>
<a name="ln-319"></a>    <span class="k">end subroutine</span>
<a name="ln-320"></a>
<a name="ln-321"></a><span class="c">!******************************************************************************</span>
<a name="ln-322"></a>
<a name="ln-323"></a><span class="k">subroutine </span><span class="n">traj_write_frame</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">iframe</span><span class="p">,</span> <span class="n">nts</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">,</span> <span class="n">velocities</span><span class="p">,</span> <span class="n">forces</span><span class="p">,</span> <span class="n">charge</span><span class="p">)</span>
<a name="ln-324"></a>    <span class="c">!! Write a frame to an open trajectory</span>
<a name="ln-325"></a>
<a name="ln-326"></a>    <span class="k">class</span><span class="p">(</span><span class="n">trajectory_t</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">in</span> <span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-327"></a>    <span class="kt">integer</span><span class="p">,</span>                  <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iframe</span>
<a name="ln-328"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ip_long</span><span class="p">),</span>         <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nts</span>
<a name="ln-329"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">coordinates</span>
<a name="ln-330"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">velocities</span>
<a name="ln-331"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">forces</span>
<a name="ln-332"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">charge</span>
<a name="ln-333"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ip_long</span><span class="p">)</span> <span class="kd">::</span> <span class="n">offset</span>
<a name="ln-334"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">na</span><span class="p">,</span> <span class="n">nat</span><span class="p">,</span> <span class="n">nam</span>
<a name="ln-335"></a>
<a name="ln-336"></a>    <span class="n">na</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">num_atoms</span><span class="p">;</span> <span class="n">nam</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">num_mpcd_atoms</span><span class="p">;</span> <span class="n">nat</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">num_atoms_tot</span>
<a name="ln-337"></a>
<a name="ln-338"></a>    <span class="c">! Added one to handle appending a frame</span>
<a name="ln-339"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">iframe</span> <span class="o">&gt;</span> <span class="n">this</span><span class="p">%</span><span class="n">num_frames</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-340"></a><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;`iframe`&#39;</span><span class="p">,</span> <span class="n">iframe</span><span class="p">,</span> <span class="s1">&#39;out of bounds for `num_frames`&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-341"></a>            <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">num_frames</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-342"></a>        <span class="k">return</span>
<a name="ln-343"></a><span class="k">    end if</span>
<a name="ln-344"></a>
<a name="ln-345"></a><span class="k">    </span><span class="n">offset</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">frame_size</span>
<a name="ln-346"></a>    <span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">iframe</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">offset</span> <span class="o">+</span> <span class="n">this</span><span class="p">%</span><span class="n">header_size</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-347"></a>
<a name="ln-348"></a>    <span class="k">write</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span> <span class="n">nts</span>
<a name="ln-349"></a>
<a name="ln-350"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-351"></a><span class="k">        if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">num_atoms</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-352"></a><span class="k">            write</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="n">na</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-353"></a>        <span class="k">else if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">num_mpcd_atoms</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-354"></a><span class="k">            write</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">na</span><span class="p">)</span>
<a name="ln-355"></a>        <span class="k">else</span>
<a name="ln-356"></a><span class="k">            write</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">coordinates</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">nat</span><span class="p">)</span>
<a name="ln-357"></a>        <span class="k">end if</span>
<a name="ln-358"></a><span class="k">    end if</span>
<a name="ln-359"></a>
<a name="ln-360"></a><span class="k">    if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-361"></a><span class="k">        if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">num_atoms</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-362"></a><span class="k">            write</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">velocities</span><span class="p">(:,</span><span class="n">na</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-363"></a>        <span class="k">else if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">num_mpcd_atoms</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-364"></a><span class="k">            write</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">velocities</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">na</span><span class="p">)</span>
<a name="ln-365"></a>        <span class="k">else</span>
<a name="ln-366"></a><span class="k">            write</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">velocities</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="n">nat</span><span class="p">)</span>
<a name="ln-367"></a>        <span class="k">end if</span>
<a name="ln-368"></a><span class="k">    end if</span>
<a name="ln-369"></a>
<a name="ln-370"></a><span class="k">    if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">forces</span>
<a name="ln-371"></a>
<a name="ln-372"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">frmcmp</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">file_id</span><span class="p">)</span> <span class="n">charge</span>
<a name="ln-373"></a>
<a name="ln-374"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">iframe</span> <span class="o">==</span> <span class="n">this</span><span class="p">%</span><span class="n">num_frames</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="n">this</span><span class="p">%</span><span class="n">num_frames</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">num_frames</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-375"></a>
<a name="ln-376"></a>    <span class="k">end subroutine</span>
<a name="ln-377"></a>
<a name="ln-378"></a><span class="c">!******************************************************************************</span>
<a name="ln-379"></a>
<a name="ln-380"></a><span class="k">end module </span><span class="n">m_trajectory</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> BROWNPAK was developed by Sarit Dutta</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>